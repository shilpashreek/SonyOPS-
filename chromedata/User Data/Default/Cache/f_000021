function APIWrapper(){APIWrapper.prototype.getFrameRate=function(){var n,t;return activePlayerInstance!=null&&activePlayerInstance!=-1?(t=getCMPInstanceByInstanceId(activePlayerInstance),n=document.getElementById(activePlayerInstance+"_frameRate").value):isCMPPlayerLoaded.toUpperCase()=="FALSE"&&(n=parseFloat(document.getElementById("hdnFrameRate").value)),n};APIWrapper.prototype.getSom=function(){var n;return activePlayerInstance!=null&&activePlayerInstance!=-1?n=document.getElementById(activePlayerInstance+"_som").value:isCMPPlayerLoaded.toUpperCase()=="FALSE"&&(n=document.getElementById("defaultSOM").value),n};APIWrapper.prototype.getTimeCodeDisplayFormat=function(){var n="NDF",t;return activePlayerInstance!=null&&activePlayerInstance!=-1&&(t=getCMPInstanceByInstanceId(activePlayerInstance),n=t._cmpModel.mediaInfo.timecodeDisplayFormat),n};APIWrapper.prototype.getActiveSegmentId=function(){return activePlayerInstance!=null&&activePlayerInstance!=-1&&getCMPInstanceByInstanceId(activePlayerInstance)._cmpModel._marker?getCMPInstanceByInstanceId(activePlayerInstance)._cmpModel._marker._id:null};APIWrapper.prototype.catalogOnComplete=function(n){if($("CatalogPlayerContainer")&&document.getElementById($("CatalogPlayerContainer").value).addEventListener(LoadEvent.LOAD_MARKER_ON_VIDEO_READY,this.LoadRangeMarker),selStata_OnClick(n),$("CatalogPlayerContainer")){var t=$("closePFTPopup").getAttribute("onclick");t='disposeCMPInstance("CatalogPlayerContainer");'+t;$("closePFTPopup").setAttribute("onclick",t);createCMPInstance("CatalogPlayerContainer");document.getElementById($("CatalogPlayerContainer").value).addEventListener(AnnotationEvent.SEGMENT_ANNOTATION_CREATED,this.segmentCreated)}this.setStandardLastSceneTCWrapper();$("waitingCatalogPopup").style.display="none"};APIWrapper.prototype.catalogV2OnComplete=function(n){var t,i;$("CatalogPlayerV2Container")&&(t=document.getElementById($("CatalogPlayerV2Container").value),t.addEventListener(LoadEvent.LOAD_MARKER_ON_VIDEO_READY,this.LoadRangeMarker),i=$("closePFTPopup").getAttribute("onclick"),i='savePlayerViewedStateToPreference("CatalogPlayerV2Container");disposeCMPInstance("CatalogPlayerV2Container");'+i,$("closePFTPopup").setAttribute("onclick",i),createCMPInstance("CatalogPlayerV2Container"),t.addEventListener(AnnotationEvent.SEGMENT_ANNOTATION_CREATED,this.segmentCreated),t.addEventListener(AnnotationEvent.CHECK_MARKER_VALIDATION,this.checkMarkerValidation),t.addEventListener(AnnotationEvent.VALIDATE_MARKERS_ON_FRAME_SEEK,this.validateMarkersOnFrameSeek),t.addEventListener(AnnotationEvent.CREATE_SCTE35_SEGMENT,this.scte35SegmentCreated));selStata_OnClickV2(n,undefined,undefined,undefined,undefined,"false");this.setStandardLastSceneTCWrapper()};APIWrapper.prototype.catalogUCOnComplete=function(){if($("CatalogPlayerUCContainer")){var n=document.getElementById($("CatalogPlayerUCContainer").value);createCMPInstance("CatalogPlayerUCContainer");n.addEventListener(AnnotationEvent.SEGMENT_ANNOTATION_CREATED,addCatalogUCSegment)}};APIWrapper.prototype.getMediaURL=function(){var n,t;return activePlayerInstance!=null&&activePlayerInstance!=-1?(t=getCMPInstanceByInstanceId(activePlayerInstance),n=t._cmpModel.mediaInfo._mediaUrl):isCMPPlayerLoaded.toUpperCase()=="FALSE"&&(n=document.getElementById("essLocation").value),n};APIWrapper.prototype.setStandardLastSceneTCWrapper=function(){var n,t,i;$("CatalogPlayerContainer")?(i=$("CatalogPlayerContainer").value,n=this.getFrameRate(),t=$(i+"_som").value):$("CatalogPlayerV2Container")?(i=$("CatalogPlayerV2Container").value,n=parseFloat(this.getFrameRate()),t=this.getSom()):(n=parseFloat($("hdnFrameRate").value),t=$("defaultSOM").value);SetStandardLastSceneTC(n,t)};APIWrapper.prototype.onBreakStructureSegmentCreated=function(n){GetClipsBreakStructureSegmentBox(n.detail.annotationStartTimeTCWithoutSOM,n.detail.annotationEndTimeTCWithoutSOM,n.detail.annotationStartTimeInSecs,n.detail.annotationEndTimeInSecs)};APIWrapper.prototype.segmentCreated=function(n){GetClipsAddSegmentBox(n.detail.annotationStartTimeTCWithoutSOM,n.detail.annotationEndTimeTCWithoutSOM,n.detail.annotationStartTimeInSecs,n.detail.annotationEndTimeInSecs)};APIWrapper.prototype.scte35SegmentCreated=function(n){createSCTE35Segment(n.detail.scte35StartTimeTCWithoutSOM,n.detail.scte35EndTimeTCWithoutSOM,n.detail.scte35StartTimeTCWithSOM,n.detail.scte35EndTimeTCWithSOM,n.detail.scte35duration,n.detail.scte35Type)};APIWrapper.prototype.onBrkStructureSegmentCreated=function(n){GetClipsBrkStructureSegmentBox(n.detail.annotationStartTimeTCWithSOM,n.detail.annotationEndTimeTCWithSOM,n.detail.annotationStartTimeInSecs,n.detail.annotationEndTimeInSecs)};APIWrapper.prototype.seekToTimeCodeOnCatalogSave=function(n,t){var i,u,r;$("IframeHTML5Player")&&(document.getElementById("IframeHTML5Player").contentWindow?i=document.getElementById("IframeHTML5Player").contentWindow:document.getElementById("IframeHTML5Player").contentDocument&&(i=document.getElementById("IframeHTML5Player").contentDocument),i.focus());try{clipStartTime=parseFloat(n)/1e3;clipEndTime=parseFloat(t)/1e3;$("IframeHTML5Player")?(i.$("#slider2")[0].style.display="block",i.$("#slider2").slider("option","values",[clipStartTime,clipEndTime]),document.getElementById("IframeHTML5Player").contentDocument.getElementById("slider1").style.display="none"):$("CatalogPlayerContainer")&&(u=$("CatalogPlayerContainer").value,r=new CLEARMediaPlayerAPI(u),r.loadRangeMarker(n,t,"false",!0),r.seekToPosition(t,"pause"))}catch(f){}};APIWrapper.prototype.loadCatalogSegment=function(n,t,i){if($("IframeHTML5Player")&&isHTML5VideoReady){var r;if(document.getElementById("IframeHTML5Player").contentWindow.document.getElementById("vdVideo").readyState>=3){document.getElementById("IframeHTML5Player").contentWindow?r=document.getElementById("IframeHTML5Player").contentWindow:document.getElementById("IframeHTML5Player").contentDocument&&(r=document.getElementById("IframeHTML5Player").contentDocument);r.focus();try{r.fnShowClip(n,t,!0);document.getElementById("IframeHTML5Player").contentDocument.getElementById("slider1").style.display="none"}catch(u){}}else console.log("Cannot seek. Player state = "+document.getElementById("IframeHTML5Player").contentWindow.document.getElementById("vdVideo").readyState)}else $("SilverlightControlHost")?setTimeout(function(){xapObject.Content.SL2JS.SeekToTimeCode(n,t,!1)},500):$("IframeClearMediaPlayer")?ClearMediaPlayerSeekToSegmentTimeCode(n,t,"true"):$("CatalogPlayerContainer")?document.getElementById($("CatalogPlayerContainer").value).dispatchEvent(new CustomEvent(LoadEvent.LOAD_MARKER_ON_VIDEO_READY)):$("CatalogPlayerV2Container")&&document.getElementById($("CatalogPlayerV2Container").value).dispatchEvent(new CustomEvent(LoadEvent.LOAD_MARKER_ON_VIDEO_READY,{detail:{segmentId:i}}))};APIWrapper.prototype.LoadRangeMarker=function(n){var t,i,e;t=n.detail!=undefined&&n.detail!=null&&n.detail.startTimecode?n.detail.startTimecode:GetStartTimeCode(null);i=n.detail!=undefined&&n.detail!=null&&n.detail.endTimeCode?n.detail.endTimeCode:GetEndTimeCode(null);n.detail&&(e=n.detail.segmentId);var r=new APIWrapper,s=r.getSom(),u=r.getFrameRate(),f=r.getTimeCodeDisplayFormat();if((t!=undefined||t!=null)&&(i!=undefined||i!=null)){var o=CMPUtils.ConvertTimeCodeToMilliseconds(s,u,f),h=CMPUtils.ConvertTimeCodeToMilliseconds(t,u,f)-o,c=CMPUtils.ConvertTimeCodeToMilliseconds(i,u,f)-o,l=activePlayerInstance,a=new CLEARMediaPlayerAPI(l);a.loadRangeMarker(h,c,"false",!0,e)}};APIWrapper.prototype.editRangeMarkers=function(n,t){var u=new APIWrapper,e=u.getSom(),i=u.getFrameRate(),r=this.getTimeCodeDisplayFormat();if((n!=undefined||n!=null)&&(t!=undefined||t!=null)){var f=CMPUtils.ConvertTimeCodeToMilliseconds(e,i,r),o=CMPUtils.ConvertTimeCodeToMilliseconds(n,i,r)-f,s=CMPUtils.ConvertTimeCodeToMilliseconds(t,i,r)-f,h=activePlayerInstance,c=new CLEARMediaPlayerAPI(h);c.editRangeMarkers(o,s,"false",!0)}};APIWrapper.prototype.onReviewMarkOutClick=function(n){var t=n.detail.annotationStartTimeInSecs,i=n.detail.annotationStartTimeTCWithoutSOM,r=n.detail.annotationEndTimeInSecs,u=n.detail.annotationEndTimeTCWithoutSOM;document.getElementById("ReviewPlayerInstance")?GetClipsCommentBox(i,u,t,r):document.getElementById("ComplianceReviewPlayerInstance")&&showAddComplianceReviewSegment(i,u,t,r)};APIWrapper.prototype.onReviewPointAnnotationClick=function(n){var t=n.detail.annotationTimeInSecs,i=n.detail.annotationTimeWithoutSom;document.getElementById("ReviewPlayerInstance")?GetAnnotationCommentBox("",i,t):document.getElementById("ComplianceReviewPlayerInstance")&&showAddPointAnnotationReview(i,t)};APIWrapper.prototype.onReviewComplete=function(){var n="ComplianceReviewPlayerInstance",t="ReviewPlayerInstance",i;document.getElementById(t)?(createCMPInstance(t),$(document.getElementById(t).value).addEventListener(AnnotationEvent.SEGMENT_ANNOTATION_CREATED,this.onReviewMarkOutClick),$(document.getElementById(t).value).addEventListener(AnnotationEvent.POINT_ANNOTATION_CREATED,this.onReviewPointAnnotationClick)):document.getElementById(n)&&(i=createCMPInstance(n),$(document.getElementById(n).value).addEventListener(AnnotationEvent.SEGMENT_ANNOTATION_CREATED,this.onReviewMarkOutClick),$(document.getElementById(n).value).addEventListener(AnnotationEvent.POINT_ANNOTATION_CREATED,this.onReviewPointAnnotationClick),$(document.getElementById(n).value).addEventListener(LoadEvent.CMP_READY,LoadComplianceThumbnails),$(document.getElementById(n).value).addEventListener(LoadEvent.CMP_INITIALISED,loadAssetReviewMarkers))};APIWrapper.prototype.onReviewPopUpClose=function(){var n;activePlayerInstance!=-1?(n='savePlayerViewedStateToPreference("ReviewPlayerInstance");',n+='disposeCMPInstance("ReviewPlayerInstance");',n+=$("closePFTPopup").getAttribute("onclick"),n+="ShowChartPanel();",n+='LoadPanel($("ActivePanel").value, $("ActiveUrl").value);'):(n=$("closePFTPopup").getAttribute("onclick"),n+="ShowChartPanel();",n+='LoadPanel($("ActivePanel").value, $("ActiveUrl").value);');$("closePFTPopup").setAttribute("onclick",n)};APIWrapper.prototype.onReviewSaveAnnotationComplete=function(n,t,i){$("IframeClearMediaPlayer")?ClearMediaPlayerAddAnnotation(n,t,i):$("IframeHTML5Player")?document.getElementById("IframeHTML5Player").contentWindow.fnVideoPlayedPaused():(this.clearMarkInOutOnSave(),$(activePlayerInstance).dispatchEvent(new CustomEvent(AnnotationEvent.SAVE_ANNOTATION,{detail:{annotationMessage:i}})),this.setFocus())};APIWrapper.prototype.updateReviewAnnotationComments=function(n){var r=this.getFrameRate(),e=this.getSom(),o=CMPUtils.ConvertTimeCodeToMilliseconds(e,r),s=document.getElementById("EditCommentsHead"),h=CMPUtils.ConvertTimeCodeToMilliseconds(s.textContent,r),t=document.getElementById("AnnotationTCOut").value,i=h-o,u,f;t==""&&(t=i);$("IframeClearMediaPlayer")?ClearMediaPlayerAddAnnotation(i,t,n):activePlayerInstance!=-1&&(u=$("ReviewPlayerInstance").value,f=new CLEARMediaPlayerAPI(u),f.editAnnotation(i,t,n))};APIWrapper.prototype.removeReviewAnnotationComments=function(n,t){var i=this.getFrameRate(),r=CMPUtils.ConvertTimeCodeToMilliseconds(n,i),u=CMPUtils.ConvertTimeCodeToMilliseconds(t,i),f,e;$("IframeClearMediaPlayer")?ClearMediaPlayerRemoveAnnotation(r,u):activePlayerInstance!=-1&&(f=$("ReviewPlayerInstance").value,e=new CLEARMediaPlayerAPI(f),e.removeAnnotation(r,u))};APIWrapper.prototype.getStreamClass=function(){var n;return activePlayerInstance!=null&&activePlayerInstance!=-1?n=document.getElementById(activePlayerInstance+"_assetClass").value:isCMPPlayerLoaded.toUpperCase()=="FALSE"&&(n=document.getElementById("hndstreamClass").value),n};APIWrapper.prototype.onBreakStructureLoadComplete=function(){if($("BreakStructureContainer")){createCMPInstance("BreakStructureContainer");var n=$("closePFTPopup").getAttribute("onclick");n='savePlayerViewedStateToPreference("BreakStructureContainer");disposeCMPInstance("BreakStructureContainer");'+n;$("closePFTPopup").setAttribute("onclick",n);document.getElementById($("BreakStructureContainer").value).addEventListener(AnnotationEvent.SEGMENT_ANNOTATION_CREATED,this.onBreakStructureSegmentCreated)}initializeBreakStructure()};APIWrapper.prototype.getBreakStructureMediaDuration=function(){if($("IframeHTML5Player"))return document.getElementById("IframeHTML5Player").contentWindow.document.getElementsByTagName("video")[0].duration;var n=$("BreakStructureContainer").value,t=new CLEARMediaPlayerAPI(n);return t.getMediaDuration()};APIWrapper.prototype.clearMarkers=function(){if(document.getElementById("IframeHTML5Player")&&document.getElementById("IframeHTML5Player").contentDocument.getElementById("slider2")&&(document.getElementById("IframeHTML5Player").contentDocument.getElementById("slider2").style.display="none"),activePlayerInstance!=null&&activePlayerInstance!=-1){var n=getCMPInstanceByInstanceId(activePlayerInstance);activePlayerInstance&&(n._cmpModel.segmentTimelineMetadata!=null&&(n._cmpModel.segmentTimelineMetadata.ResetLastFiredIndexAndClearTimers(),n._cmpModel.segmentTimelineMetadata.RemoveValue()),document.getElementById(activePlayerInstance).dispatchEvent(new CustomEvent(AnnotationEvent.REMOVE_MARKERS)))}else return};APIWrapper.prototype.updateMarkerCanvasComment=function(n,t,i){$("CatalogPlayerV2Container")?$(activePlayerInstance).dispatchEvent(new CustomEvent(MarkerEvent.UPDATE_MARKERCANVASCOMMENT,{detail:{markerCanvasJson:n,isDelete:i}})):UpdateMarkerCanvasComment(n,t,i)};APIWrapper.prototype.ChangeEditMode=function(){if($("CatalogPlayerV2Container")){var n=new CLEARMediaPlayerAPI(activePlayerInstance);n.changeEditMode()}};APIWrapper.prototype.isSomRequired=function(){if(activePlayerInstance!=null&&activePlayerInstance!=-1){var n=getCMPInstanceByInstanceId(activePlayerInstance);return $(n._instanceId+"_isSomRequired").value}if(isCMPPlayerLoaded.toUpperCase()=="FALSE")return $("IsSomNeeded").value};APIWrapper.prototype.loadCatalogVersionV1OnComplete=function(n,t,i){if($("CatalogPlayerContainer")&&document.getElementById($("CatalogPlayerContainer").value).addEventListener(LoadEvent.LOAD_MARKER_ON_VIDEO_READY,this.LoadRangeMarker),createCMPInstance("CatalogPlayerContainer"),selStata_OnClick(n,!1,t,i),$("CatalogPlayerContainer")){var r=$("closePFTPopup").getAttribute("onclick");r='savePlayerViewedStateToPreference("CatalogPlayerContainer"); disposeCMPInstance("CatalogPlayerContainer");'+r;$("closePFTPopup").setAttribute("onclick",r);document.getElementById($("CatalogPlayerContainer").value).addEventListener(LoadEvent.CMP_READY,this.onCMPVideoReady);document.getElementById($("CatalogPlayerContainer").value).addEventListener(AnnotationEvent.SEGMENT_ANNOTATION_CREATED,this.segmentCreated)}(new APIWrapper).setStandardLastSceneTCWrapper();$("waitingCatalogPopup").style.display="none"};APIWrapper.prototype.loadCatalogVersionV2OnComplete=function(n,t,i){if($("CatalogPlayerV2Container")&&document.getElementById($("CatalogPlayerV2Container").value).addEventListener(LoadEvent.LOAD_MARKER_ON_VIDEO_READY,this.LoadRangeMarker),createCMPInstance("CatalogPlayerV2Container"),selStata_OnClickV2(n,!1,t,i,undefined,"false"),selStata_OnClickV2LeftPanel(n,!1,t,i),$("CatalogPlayerV2Container")){var r=$("closePFTPopup").getAttribute("onclick");r='disposeCMPInstance("CatalogPlayerV2Container");'+r;$("closePFTPopup").setAttribute("onclick",r);document.getElementById($("CatalogPlayerV2Container").value).addEventListener(LoadEvent.CMP_READY,this.onCMPVideoReady);document.getElementById($("CatalogPlayerV2Container").value).addEventListener(AnnotationEvent.SEGMENT_ANNOTATION_CREATED,this.segmentCreated);document.getElementById($("CatalogPlayerV2Container").value).addEventListener(AnnotationEvent.CHECK_MARKER_VALIDATION,this.checkMarkerValidation);document.getElementById($("CatalogPlayerV2Container").value).addEventListener(AnnotationEvent.VALIDATE_MARKERS_ON_FRAME_SEEK,this.validateMarkersOnFrameSeek)}$("waitingCatalogPopup").style.display="none"};APIWrapper.prototype.clearMarkInOutOnSave=function(){activePlayerInstance!=null&&activePlayerInstance!=-1&&(document.getElementById(activePlayerInstance).dispatchEvent(new CustomEvent(MarkerEvent.REMOVE_MARKER)),document.getElementById(activePlayerInstance).dispatchEvent(new CustomEvent(AnnotationEvent.RESET_MARKER_BUTTONS)))};APIWrapper.prototype.setFocus=function(){var n,t;$("IframeHTML5Player")?(document.getElementById("IframeHTML5Player").contentWindow?n=document.getElementById("IframeHTML5Player").contentWindow:document.getElementById("IframeHTML5Player").contentDocument&&(n=document.getElementById("IframeHTML5Player").contentDocument),n.focus()):activePlayerInstance!=null&&activePlayerInstance!=-1&&(t=new CLEARMediaPlayerAPI(activePlayerInstance),t.SetFocus())};APIWrapper.prototype.EditTimeCodeV2=function(n,t,i,r,u,f,e,o){var s,h;if($("IframeHTML5Player")){document.getElementById("IframeHTML5Player").contentWindow?s=document.getElementById("IframeHTML5Player").contentWindow:document.getElementById("IframeHTML5Player").contentDocument&&(s=document.getElementById("IframeHTML5Player").contentDocument);try{s.fnEditClipV2(i,r,!0,u,f,e,o);document.getElementById("IframeHTML5Player").contentDocument.getElementById("slider1").style.display="none"}catch(c){}}else $("SilverlightControlHost")?xapObject.Content.SL2JS.SeekToTimeCode(i,r,u):$("CatalogPlayerV2Container")&&(h=new APIWrapper,this.clearMarkInOutOnSave(),h.editRangeMarkers(n,t,f));this.setFocus()};APIWrapper.prototype.restoreOnComplete=function(){var n,t;if($("RestorePlayerContainer")==null){if(n=CheckForCloudEditorErrors("hdnErrorDetails","RestoreAssets"),n=n==""?CheckForCloudEditorErrors("hdnAssetContainerErrorDetails","RestoreAssets"):n,n!="")return showErrorDetails(n,"0")}else t=$("closePFTPopup").getAttribute("onclick"),t='disposeCMPInstance("RestorePlayerContainer");'+t,$("closePFTPopup").setAttribute("onclick",t),createCMPInstance("RestorePlayerContainer");url="/BC/Product/Modules/Search/Restore/Restore.aspx?ConfigName="+ConfigName+"&callingContext=OldRestore";(new PFTAjaxWrapper).Updater("RestoreDetails",url,{method:"POST",postBody:$("metaDataXml").value,contentType:"text/xml",onComplete:function(){}})};APIWrapper.prototype.newMediaPublishOnComplete=function(){var n,t,i,r;if($("NewMediaPublishPlayerContainer"))n=$("closePFTPopup").getAttribute("onclick"),n='disposeCMPInstance("NewMediaPublishPlayerContainer");'+n,$("closePFTPopup").setAttribute("onclick",n),addEventListenerForCreateScreenshot("NewMediaPublishPlayerContainer"),addEventListenerForDeleteScreenshot("NewMediaPublishPlayerContainer"),addEventListenerForSelectScreenshot("NewMediaPublishPlayerContainer"),addEventListenerForDeleteClip("NewMediaPublishPlayerContainer"),addEventListenerForSwitchSequenceMode("NewMediaPublishPlayerContainer"),addEventListenerForFullScreenHandle("NewMediaPublishPlayerContainer"),createCMPInstance("NewMediaPublishPlayerContainer");else if(t=CheckForCloudEditorErrors("hdnErrorDetails","PublishAssets"),t!="")return showErrorDetails(t,"0");PublishTabs=document.getElementById("PublishTabIds").value.split(",");i=PublishTabs.length-1;r=PublishTabs[i];PublishTabs.splice(i,1);HideProgressBar()};APIWrapper.prototype.ViewPublishedAssetsOnComplete=function(){if($("NewMediaPublishPlayerContainer")){var n=$("closePFTPopup").getAttribute("onclick");n='disposeCMPInstance("NewMediaPublishPlayerContainer");'+n;$("closePFTPopup").setAttribute("onclick",n);addEventListenerForCreateScreenshot("NewMediaPublishPlayerContainer");addEventListenerForDeleteScreenshot("NewMediaPublishPlayerContainer");addEventListenerForSelectScreenshot("NewMediaPublishPlayerContainer");addEventListenerForDeleteClip("NewMediaPublishPlayerContainer");addEventListenerForSwitchSequenceMode("NewMediaPublishPlayerContainer");addEventListenerForFullScreenHandle("NewMediaPublishPlayerContainer");createCMPInstance("NewMediaPublishPlayerContainer")}};APIWrapper.prototype.getPlayerMode=function(){var n,t;return activePlayerInstance!=null&&activePlayerInstance!=-1?(t=getCMPInstanceByInstanceId(activePlayerInstance),n=document.getElementById(activePlayerInstance+"_playerMode").value):isCMPPlayerLoaded.toUpperCase()=="FALSE"&&$("hdnPlayerMode")!=null&&(n=$("hdnPlayerMode").value),n};APIWrapper.prototype.assetViewerOnComplete=function(n,t,i){var r,u;document.getElementById("AssetViewerPlayerInstance")!=null&&(r=document.getElementById("AssetViewerPlayerInstance").value,document.getElementById(r).removeEventListener(LoadEvent.CMP_INITIALISED,this.showOrHideButtons),u=this,document.getElementById(r).addEventListener(LoadEvent.CMP_INITIALISED,function(){u.showOrHideButtons(n,t,i)}))};APIWrapper.prototype.showOrHideButtons=function(n,t,i){if(document.getElementById("AssetViewerPlayerInstance")!=null){var c=document.getElementById("AssetViewerPlayerInstance").value,r=new CLEARMediaPlayerAPI(c),o=$("selectedViewerMode").getAttribute("selectedViewerModeType").toUpperCase(),f=t,s=f.toUpperCase()=="PLAYLIST"?!0:!1,l=r.checkIfMixedFramerate(),u=f.toUpperCase()=="VIDEO"||f.toUpperCase()=="PLAYLIST"?!0:!1,e=l||!u?!1:!0,h=f.toUpperCase()=="VIDEO"||n?!0:!1;o=="REVIEW"?(f.toUpperCase()=="VIDEO"||i?r.toggleUIControlVisibility("EnableSegmentNavigation",!1,!1):r.toggleUIControlVisibility("EnableSegmentNavigation",u,u),r.toggleUIControlVisibility("EnableAVFrameNavigation",u,u),f.toUpperCase()=="VIDEO"&&r.toggleUIControlVisibility("EnablePlayRateButtons",u,u),r.toggleUIControlVisibility("EnableMarkInOut",e,e),r.toggleUIControlVisibility("EnableAddMarker",!1,!1),r.toggleUIControlVisibility("EnableMarkAnnotation",u,u),r.toggleUIControlVisibility("ShowTakeRunningTime",s,!1)):o=="ADV"?(f.toUpperCase()=="VIDEO"?r.toggleUIControlVisibility("EnableSegmentNavigation",!1,!1):r.toggleUIControlVisibility("EnableSegmentNavigation",u,u),r.toggleUIControlVisibility("EnableAddMarker",h,h),f.toUpperCase()=="VIDEO"&&r.toggleUIControlVisibility("EnablePlayRateButtons",u,u),r.toggleUIControlVisibility("EnableAVFrameNavigation",u,u),r.toggleUIControlVisibility("EnableMarkAnnotation",u,u),r.toggleUIControlVisibility("ShowTakeRunningTime",s,!1),r.toggleUIControlVisibility("EnableMarkInOut",e,e),r.toggleUIControlVisibility("EnableTakeTotalTimeline",!0,!0)):o=="EXEC"?(f.toUpperCase()=="VIDEO"?r.toggleUIControlVisibility("EnableSegmentNavigation",!1,!1):r.toggleUIControlVisibility("EnableSegmentNavigation",u,u),r.toggleUIControlVisibility("EnableMarkInOut",!1,!1),r.toggleUIControlVisibility("EnableAddMarker",!1,!1),r.toggleUIControlVisibility("EnableMarkAnnotation",!1,!1),r.toggleUIControlVisibility("EnableAVFrameNavigation",!1,!1),f.toUpperCase()=="VIDEO"&&r.toggleUIControlVisibility("EnablePlayRateButtons",u,u),r.toggleUIControlVisibility("ShowTakeRunningTime",s,!1)):(f.toUpperCase()=="VIDEO"||i?r.toggleUIControlVisibility("EnableSegmentNavigation",!1,!1):r.toggleUIControlVisibility("EnableSegmentNavigation",u,u),f.toUpperCase()=="VIDEO"&&r.toggleUIControlVisibility("EnableAVFrameNavigation",u,u),r.toggleUIControlVisibility("EnableMarkInOut",!1,!1),f.toUpperCase()=="VIDEO"&&r.toggleUIControlVisibility("EnablePlayRateButtons",u,u),r.toggleUIControlVisibility("EnableAddMarker",!1,!1),r.toggleUIControlVisibility("EnableMarkAnnotation",!1,!1),r.toggleUIControlVisibility("ShowTakeRunningTime",!1,!1),r.toggleUIControlVisibility("EnableTakeTotalTimeline",!1,!1));r.rebuildHelpScreen()}};APIWrapper.prototype.checkMarkerValidation=function(n){ValidateMarkers(n.detail.markIn,n.detail.markOut,n.detail.currentMarkerMarkIn,n.detail.currentMarkerMarkOut,n.detail.isMarkOutDone)};APIWrapper.prototype.validateMarkersOnFrameSeek=function(n){ValidateMarkersOnFrameSeek(n.detail.currentTime,n.detail.markOutTime)};APIWrapper.prototype.getCloudXml=function(n){var t="",i,r;if($("IframeCloudEditor")){try{document.getElementById("IframeCloudEditor").contentWindow.exportTimelineXML()}catch(u){document.getElementById("IframeCloudEditor").contentDocument.exportTimelineXML()}try{t=document.getElementById("IframeCloudEditor").contentWindow.document.getElementById("cloudXml").value}catch(u){t=document.getElementById("IframeCloudEditor").contentDocument.getElementById("cloudXml").value}}else $(n)?(i=$(n).value,r=new CLEARMediaPlayerAPI(i),t=r.getSequenceAsXml(),t=exportXMLOutputHandle(t,n)):t="<Sequence><\/Sequence>";return t};APIWrapper.prototype.getMidARollBreakTime=function(){var t="",n,f,i,r;if($("NewMediaPublishPlayerContainer")){var e=$("NewMediaPublishPlayerContainer").value,u=new CLEARMediaPlayerAPI(e),o=u.getCurrentSequenceMode();o=="sequenceClip"?u.initialiseSequencePreviewMode():(i=u.getCurrentPlaybackTime(),t=CMPUtils.ConvertSecondsToTimeCode(i,this.getFrameRate()),r=fnCheckTimecodeGap("YoutubeMidRoll",t,Math.round(i)),r!=""?(u.pause(),showErrorDetails(r,"0")):GenerateMidRollBreaks("YoutubeMidRoll",t,Math.round(i)))}else{try{n=document.getElementById("IframeCloudEditor").contentWindow}catch(s){n=document.getElementById("IframeCloudEditor").contentDocument}f=n.boolEditorOpened;f==!0?n.fnChangePlayerMode():(t=n.document.getElementById("runningTime").innerHTML,i=n.fnCalculateSecsFromFrame(t),r=fnCheckTimecodeGap("YoutubeMidRoll",t,Math.round(i)),r!=""?(n.document.getElementById("mainPlayer").pause(),n.document.getElementById("btnPlayPause").className="icons play",showErrorDetails(r,"0")):GenerateMidRollBreaks("YoutubeMidRoll",t,Math.round(i)))}};APIWrapper.prototype.fullFillmentOnComplete=function(){var t,n;if($("FullFillmentV3PlayerContainer"))$("closePFTPopup")!=null&&(t=$("closePFTPopup").getAttribute("onclick")),t='disposeCMPInstance("FullFillmentV3PlayerContainer");'+t,$("closePFTPopup")!=null&&$("closePFTPopup").setAttribute("onclick",t),addEventListenerForCreateScreenshot("FullFillmentV3PlayerContainer"),addEventListenerForDeleteScreenshot("FullFillmentV3PlayerContainer"),addEventListenerForSelectScreenshot("FullFillmentV3PlayerContainer"),addEventListenerForClipDeletion("FullFillmentV3PlayerContainer"),addEventListenerForThumbNailSelected("FullFillmentV3PlayerContainer"),createCMPInstance("FullFillmentV3PlayerContainer");else if((n=CheckForCloudEditorErrors("hdnErrorDetails","EmailPublishPanel"),n!="")||(n=CheckForCloudEditorErrors("hdnAssetContainerErrorDetails","EmailPublishPanel"),n!=""))return showErrorDetails(n,"0")};APIWrapper.prototype.onPublishViewComplete=function(){var n=$("closePFTPopup").getAttribute("onclick");n='disposeCMPInstance("PublishViewPlayerContainer");'+n;$("closePFTPopup").setAttribute("onclick",n);addEventListenerForCreateScreenshot("PublishViewPlayerContainer");addEventListenerForDeleteScreenshot("PublishViewPlayerContainer");addEventListenerForSelectScreenshot("PublishViewPlayerContainer");addEventListenerForDeleteClip("PublishViewPlayerContainer");createCMPInstance("PublishViewPlayerContainer")};APIWrapper.prototype.onCMPVideoReady=function(){$("selSceneTimes")&&($("selSceneTimes").style.display!="none"&&SeekToTimeCode(),DisableMarkerCanvas());$("tblCatalogV2")&&(document.getElementsByClassName("markerUnitWrapSelected").length!=0&&SeekToTimeCode(),DisableCatalogV2Buttons())};APIWrapper.prototype.onClickOfHidePreviewPanel=function(n){var t=new CLEARMediaPlayerAPI(n);t.pause()};APIWrapper.prototype.isMixedFrameRateEnabledForEmailPublish=function(){if($("FullFillmentV3PlayerContainer"))return new CLEARMediaPlayerAPI(activePlayerInstance).checkIfMixedFramerate()?!0:!1;var n=document.getElementById("StoryTellerPlayerInstance").value;if(n!=null)return new CLEARMediaPlayerAPI(activePlayerInstance).checkIfMixedFramerate()};APIWrapper.prototype.showOrHideNonAvControlsInViewerModes=function(){if(document.getElementById("AssetViewerPlayerInstance")!=null){var t=document.getElementById("AssetViewerPlayerInstance").value,n=new CLEARMediaPlayerAPI(t),i=$("selectedViewerMode").innerHTML;switch(i.toUpperCase()){case"ADVANCED":case"REVIEW":n.toggleUIControlVisibility("EnableZoomInOut",!0);n.toggleUIControlVisibility("EnableRotate",!0);n.toggleUIControlVisibility("EnableMultipleContainer",!0);n.toggleUIControlVisibility("EnableSlideShow",!0);n.toggleUIControlVisibility("EnableChangeViewType",!0);break;case"INFORMATION":n.toggleUIControlVisibility("EnableZoomInOut",!1);n.toggleUIControlVisibility("EnableRotate",!0);n.toggleUIControlVisibility("EnableMultipleContainer",!1);n.toggleUIControlVisibility("EnableSlideShow",!1);n.toggleUIControlVisibility("EnableChangeViewType",!1)}}};APIWrapper.prototype.switchToSingleItemInViewer=function(){if(document.getElementById("AssetViewerPlayerInstance")!=null){var n=document.getElementById("AssetViewerPlayerInstance").value,t=new CLEARMediaPlayerAPI(n);t.switchToSingleItemInViewer()}};APIWrapper.prototype.isLive=function(){if(activePlayerInstance!=null&&activePlayerInstance!=-1){var n=activePlayerInstance,t=new CLEARMediaPlayerAPI(n);return t.isLive()}};APIWrapper.prototype.seekToLive=function(){if(activePlayerInstance!=null&&activePlayerInstance!=-1){var n=activePlayerInstance,t=new CLEARMediaPlayerAPI(n);t.seekToLive()}}}function addEventListenerForSwitchSequenceMode(n){document.getElementById($(n).value).addEventListener(SequenceEvent.SWITCH_SEQUENCE_MODE,switchSequencMode)}function addEventListenerForCreateScreenshot(n){document.getElementById($(n).value).addEventListener(SequenceEvent.STILL_CAPTURE,fnstillCapture)}function addEventListenerForDeleteScreenshot(n){document.getElementById($(n).value).addEventListener(SequenceEvent.DELETE_STILL_CAPTURE,deleteStillCapture)}function addEventListenerForSelectScreenshot(n){document.getElementById($(n).value).addEventListener(SequenceEvent.SELECT_SCREENSHOT,selectScreenshot)}function addEventListenerForDeleteClip(n){document.getElementById($(n).value).addEventListener(SequenceEvent.CLIP_DELETED,deleteClip)}function addEventListenerForFullScreenHandle(n){document.getElementById($(n).value).addEventListener(SequenceEvent.FULL_SCREEN_HANDLE,fullScreen)}function fnstillCapture(n){var e=n.detail.clipScreenshot,o=n.detail.clipObj,t=e.clipOrderId,i=o.title,s=n.detail.frameRate,r=o.id,u=e.id,h=CMPUtils.ConvertTimeCodeToSecs(o.startOfMedia,s),c=e.captureTimeSecs+h,f=CMPUtils.ConvertSecondsToTimeCode(c,s);window.parent.document.getElementById("PublishYoutubeStillCaptureData")&&(window.parent.document.getElementById("PublishYoutubeStillCaptureData").style.display="none");window.parent.document.getElementById("PublishDailyMotionStillCaptureData")&&(window.parent.document.getElementById("PublishDailyMotionStillCaptureData").style.display="none");window.parent.document.getElementById("PublishSpotifyStillCaptureData")&&(window.parent.document.getElementById("PublishSpotifyStillCaptureData").style.display="none");window.parent.document.getElementById("PublishVerizonStillCaptureData")&&(window.parent.document.getElementById("PublishVerizonStillCaptureData").style.display="none");addRow("PublishYoutubeStillCapture",t,u,i,f,r);addRow("PublishDittoStillCapture",t,u,i,f,r);addRow("PublishDailyMotionStillCapture",t,u,i,f,r);addRow("PublishSpotifyStillCapture",t,u,i,f,r);addRow("PublishVerizonStillCapture",t,u,i,f,r)}function addRow(n,t,i,r,u,f){var o,h,c,l;if(window.parent.document.getElementById(n)){o=window.parent.document.getElementById(n);o.style.display="";var a=o.rows.length,s=o.insertRow(a),v=s.insertCell(0),e=[];e[0]="type|checkbox";e[1]="name|chkbox[]";e[2]="tableID|"+n;e[3]="ClipOrderId|"+t;e[4]="timcode|"+u;e[5]="ClipTitle|"+r;e[6]="ClipId|"+f;h=buildHtmlDOMElementWithStandardAttributes("input",n+"_"+i,i,e);v.appendChild(h);c=s.insertCell(1);c.innerHTML=r;l=s.insertCell(2);l.innerHTML=u;s.insertCell(3);window.parent.loadFlexcroll(n+"_div")}}function deleteStillCapture(n){var i=n.detail.screenshotArray,t;onStillCaptureDelete(i.length);t=n.detail.screenshotId;deleteScreenshot("PublishYoutubeStillCapture",t);deleteScreenshot("PublishDittoStillCapture",t);deleteScreenshot("PublishDailyMotionStillCapture",t);deleteScreenshot("PublishSpotifyStillCapture",t);deleteScreenshot("PublishVerizonStillCapture",t)}function deleteScreenshot(n,t){if($(n)&&window.parent.document.getElementById(n)){currentElement=window.parent.document.getElementById(n+"_"+t);var i=currentElement.parentElement.parentElement.parentElement;i.removeChild(currentElement.parentElement.parentElement)}}function onStillCaptureDelete(n){n==0&&(window.parent.document.getElementById("PublishYoutubeStillCaptureData")&&(window.parent.document.getElementById("PublishYoutubeStillCaptureData").style.display=""),window.parent.document.getElementById("PublishYoutubeStillCapture")&&(window.parent.document.getElementById("PublishYoutubeStillCapture").style.display="none"),window.parent.document.getElementById("PublishDittoStillCapture")&&(window.parent.document.getElementById("PublishDittoStillCapture").style.display="none"),window.parent.document.getElementById("PublishDailyMotionStillCaptureData")&&(window.parent.document.getElementById("PublishDailyMotionStillCaptureData").style.display=""),window.parent.document.getElementById("PublishDailyMotionStillCapture")&&(window.parent.document.getElementById("PublishDailyMotionStillCapture").style.display="none"),window.parent.document.getElementById("PublishSpotifyStillCaptureData")&&(window.parent.document.getElementById("PublishSpotifyStillCaptureData").style.display=""),window.parent.document.getElementById("PublishSpotifyStillCapture")&&(window.parent.document.getElementById("PublishSpotifyStillCapture").style.display="none"),window.parent.document.getElementById("PublishVerizonStillCaptureData")&&(window.parent.document.getElementById("PublishVerizonStillCaptureData").style.display=""),window.parent.document.getElementById("PublishVerizonStillCapture")&&(window.parent.document.getElementById("PublishVerizonStillCapture").style.display="none"))}function deleteClip(n){var i=n.detail.ceProjectObject.sequence.screenshots,t=n.detail.clipUiId;deleteRelatedScreenshots("PublishYoutubeStillCapture",t);deleteRelatedScreenshots("PublishDittoStillCapture",t);deleteRelatedScreenshots("PublishDailyMotionStillCapture",t);deleteRelatedScreenshots("PublishSpotifyStillCapture",t);deleteRelatedScreenshots("PublishVerizonStillCapture",t);deleteHeaderRow("PublishYoutubeStillCapture");deleteHeaderRow("PublishDittoStillCapture");deleteHeaderRow("PublishDailyMotionStillCapture");deleteHeaderRow("PublishSpotifyStillCapture");deleteHeaderRow("PublishVerizonStillCapture");onStillCaptureDelete(i.length)}function deleteRelatedScreenshots(n,t){var o,s,r,i,u,f,e;if($(n)&&window.parent.document.getElementById(n))for(o=window.parent.document.getElementById(n),s=o.rows.length,r=s-1;r>=0;r--)if(i=o.rows[r],i&&(u=i.getElementsByTagName("input"),u))for(f=0;f<u.length;f++)if(e=u[f],e&&e.type=="checkbox"&&e.getAttribute("clipOrderId")==t){i.parentNode.removeChild(i);break}}function deleteHeaderRow(n){var r,u,t,i;if($(n)&&window.parent.document.getElementById(n))for(r=window.parent.document.getElementById(n),u=r.rows.length,t=u-1;t>=0;t--)i=r.rows[t],i&&u==1&&i.parentNode.removeChild(i)}function selectScreenshot(n){var t=n.detail.screenshotId,i=n.detail.isSelected}function switchSequencMode(n){var i=n.detail.mode,t=window.parent.document.getElementById("btnAddMidRoll");t&&(t.className=i=="edit"?"createMidroll":"createMidrollBlink")}function fullScreen(){}function exportXMLOutputHandle(n){return n}function addEventListenerForClipDeletion(n){document.getElementById($(n).value).addEventListener(SequenceEvent.CLIP_DELETED,onClipDelete)}function addEventListenerForThumbNailSelected(n){document.getElementById($(n).value).addEventListener(SequenceEvent.SELECT_SCREENSHOT,onThumbNailSelect)}function onClipDelete(n){onClipDeleted_SecEssence(n.detail.clipId)}function onThumbNailSelect(n){var t=n.detail.isSelected}function CMPUtils(){}function sort_basedOnSegmentInOut(n,t){return n._startTime==t._startTime?parseFloat(n._endTime)-parseFloat(t._endTime):parseFloat(n._startTime)-parseFloat(t._startTime)}function CLEARMediaPlayerAPI(n){this._eventDispatcher=document.getElementById(n);this._cmpInstance=getCMPInstanceByInstanceId(n);CLEARMediaPlayerAPI.prototype.setMediaSource=function(n){if(!this._cmpInstance._injector.getInstance("mediaManager").validateAndChangeMediaInfo(n.mediaInfo,n.playerMode))return!1;this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.SET_MEDIA_SOURCE,{detail:{url:n.mediaInfo.mediaUrl,autoPlay:n.autoPlay}}));this._eventDispatcher.dispatchEvent(new CustomEvent(ShortCutEvent.UPDATE_SHORTCUT))};CLEARMediaPlayerAPI.prototype.play=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAY))};CLEARMediaPlayerAPI.prototype.pause=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PAUSE))};CLEARMediaPlayerAPI.prototype.seekToPosition=function(n,t){this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SEEK,{detail:{positionInMsec:n,stateAfterSeek:t}}))};CLEARMediaPlayerAPI.prototype.loadRangeMarker=function(n,t,i,r,u){this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_RANGE_MARKER,{detail:{startTimeInMsec:n,endTimeInMsec:t,autoPlay:i,showMarkerIcons:r,segmentId:u}}))};CLEARMediaPlayerAPI.prototype.getMediaDuration=function(){return this._cmpInstance._injector.getInstance("mediaManager").getMediaDuration()};CLEARMediaPlayerAPI.prototype.getCurrentPlaybackTime=function(){return this._cmpInstance._injector.getInstance("mediaManager").getCurrentTime()};CLEARMediaPlayerAPI.prototype.addOrUpdatePointMarker=function(){};CLEARMediaPlayerAPI.prototype.addOrUpdateRangeMarker=function(){};CLEARMediaPlayerAPI.prototype.deletePointMarker=function(){};CLEARMediaPlayerAPI.prototype.deleteRangeMarker=function(){};CLEARMediaPlayerAPI.prototype.deleteAllRangeMarkers=function(){};CLEARMediaPlayerAPI.prototype.resetActiveMarker=function(){};CLEARMediaPlayerAPI.prototype.setActiveRangeMarker=function(){};CLEARMediaPlayerAPI.prototype.setActivePointMarker=function(){};CLEARMediaPlayerAPI.prototype.getMarkerList=function(){};CLEARMediaPlayerAPI.prototype.addToTimeline=function(){};CLEARMediaPlayerAPI.prototype.loadSegment=function(n,t,i){this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT_BASED_ON_SEGMENTUIID,{detail:{segmentUiId:n,pauseOnSegmentDurationReached:i,autoPlay:t}}))};CLEARMediaPlayerAPI.prototype.loadSequence=function(n,t,i,r,u){this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.CREATE_CEPROJECT,{detail:{sequenceXml:n,videoSequenceXml:t,audioEssenceCollection:i,timedTextTrackCollection:r,playerMode:u}}))};CLEARMediaPlayerAPI.prototype.getSequenceAsXml=function(){return new SequenceManager(this._cmpInstance._cmpModel,this._cmpInstance._instanceId,this._cmpInstance._nativeApi).GetSequenceObjectAsXml(this._cmpInstance._cmpModel.ceProject)};CLEARMediaPlayerAPI.prototype.getSequenceInfo=function(){return new SequenceManager(this._cmpInstance._cmpModel,this._cmpInstance._instanceId,this._cmpInstance._nativeApi).getSequenceObject(this._cmpInstance._cmpModel._playerInfo.sequenceInfo.SequenceXml)};CLEARMediaPlayerAPI.prototype.getLastTCOutForContiguousSegment=function(){};CLEARMediaPlayerAPI.prototype.addOrUpdateClip=function(n,t){this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.CREATE_CLIP,{detail:{clipObject:n,isImplicitSegment:t}}))};CLEARMediaPlayerAPI.prototype.getTimedTextDTOFromFileContents=function(){};CLEARMediaPlayerAPI.prototype.addOrUpdateSegment=function(){};CLEARMediaPlayerAPI.prototype.captureFrame=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.CAPTURE_FRAME))};CLEARMediaPlayerAPI.prototype.deleteFrame=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.DELETE_CAPTURE_FRAME,{detail:{screenshotId:n}}))};CLEARMediaPlayerAPI.prototype.editAnnotation=function(n,t,i){this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.EDIT_ANNOTATION,{detail:{startTimeCode:n,endTimeCode:t,message:i}}))};CLEARMediaPlayerAPI.prototype.saveAnnotation=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.SAVE_ANNOTATION,{detail:{annotationMessage:n}}))};CLEARMediaPlayerAPI.prototype.removeAnnotation=function(n,t){this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.REMOVE_ANNOTATION,{detail:{startTimeCode:n,endTimeCode:t}}))};CLEARMediaPlayerAPI.prototype.updateMarkerCanvas=function(n,t){this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.UPDATE_MARKERVALUES,{detail:{markerCanvasJson:n,isDelete:t}}))};CLEARMediaPlayerAPI.prototype.selectMarkerCanvas=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.SELECT_MARKER_CANVAS,{detail:{selectedMarkerCanvasName:n}}))};CLEARMediaPlayerAPI.prototype.updateMarkerCanvasComment=function(n,t){this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.UPDATE_MARKERVALUES,{detail:{markerCanvasJson:n,isDelete:t}}))};CLEARMediaPlayerAPI.prototype.SelectYourMarker=function(n,t,i){this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.FILTER_MARKERCANVAS,{detail:{MarkerCanvasName:n,MarkerCanvasSelectedRow:t,MarkerCanvasSelectedDiv:i}}))};CLEARMediaPlayerAPI.prototype.SetFocus=function(){this._cmpInstance&&this._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.SET_FOCUS,{detail:{playerinstanceIdentifier:this._cmpInstance._instanceId}}))};CLEARMediaPlayerAPI.prototype.editRangeMarkers=function(n,t,i,r,u,f){this._eventDispatcher.dispatchEvent(new CustomEvent(PlayerMode.EDIT));this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_RANGE_MARKER,{detail:{startTimeInMsec:n,endTimeInMsec:t,autoPlay:i,showMarkerIcons:r,isRetainCurrentPos:u,loopToSegStartOnSegEnd:f}}))};CLEARMediaPlayerAPI.prototype.setMarkInPosition=function(n,t){this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.SET_MARK_IN_POSITION,{detail:{markInTime:n,markOutTime:t}}))};CLEARMediaPlayerAPI.prototype.setMarkOutPosition=function(n,t){this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.SET_MARK_OUT_POSITION,{detail:{markInTime:n,markOutTime:t}}))};CLEARMediaPlayerAPI.prototype.seekToAccumulatedTimeOnFrameSeek=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.SEEK_TO_ACCUMULATED_TIME_ON_FRAME_SEEK))};CLEARMediaPlayerAPI.prototype.setAccumulatedTime=function(){document.getElementById($("CatalogPlayerV2Container").value).dispatchEvent(new CustomEvent(TransportEvent.SET_ACCUMULATE_TIME,{detail:{accumulateTime:0}}))};CLEARMediaPlayerAPI.prototype.seekToTimeCodeOnFrameSeek=function(n){document.getElementById($("CatalogPlayerV2Container").value).dispatchEvent(new CustomEvent(TransportEvent.SEEK,{detail:{positionInMsec:n*1e3,stateAfterSeek:"pause"}}))};CLEARMediaPlayerAPI.prototype.createMarkers=function(n,t){document.getElementById($("CatalogPlayerV2Container").value).dispatchEvent(new CustomEvent(MarkerEvent.CREATE_MARKER,{detail:{markIn:n,markOut:t,isMarkOutDone:"false"}}));document.getElementById($("CatalogPlayerV2Container").value).dispatchEvent(new CustomEvent(TransportEvent.SEEK,{detail:{positionInMsec:n*1e3,stateAfterSeek:"pause"}}))};CLEARMediaPlayerAPI.prototype.toggleUIControlVisibility=function(n,t,i){this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.TOGGLE_UI_CONTROL_VISIBILITY,{detail:{controlKeyName:n,isEnable:t,isDisplay:i}}))};CLEARMediaPlayerAPI.prototype.getCurrentSequenceMode=function(){return new SequenceManager(this._cmpInstance._cmpModel,this._cmpInstance._instanceId,this._cmpInstance._nativeApi).getCurrentSequenceMode()};CLEARMediaPlayerAPI.prototype.initialiseSequencePreviewMode=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.INITIALISE_SEQUENCE_PREVIEW_MODE,{detail:{autoPlay:!0}}))};CLEARMediaPlayerAPI.prototype.changeEditMode=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.REMOVE_MARKERS))};CLEARMediaPlayerAPI.prototype.convertAllImplicitToExplicitSegments=function(){return new SequenceManager(this._cmpInstance._cmpModel,this._cmpInstance._instanceId,this._cmpInstance._nativeApi).convertAllImplicitToExplicitSegments()};CLEARMediaPlayerAPI.prototype.getSessionAliveTimerInterval=function(){return CMPUtils.IsNullOrEmpty(this._cmpInstance._cmpModel.playerInfo.CMPConfig.CMPConfigValue.SessionAliveTimerIntervalInMs)?9e5:this._cmpInstance._cmpModel.playerInfo.CMPConfig.CMPConfigValue.SessionAliveTimerIntervalInMs};CLEARMediaPlayerAPI.prototype.isSessionAliveCheckEnabled=function(){return CMPUtils.IsNullOrEmpty(this._cmpInstance._cmpModel.playerInfo.CMPConfig.CMPConfigValue.IsSessionAliveCheckEnabled)?"false":this._cmpInstance._cmpModel.playerInfo.CMPConfig.CMPConfigValue.IsSessionAliveCheckEnabled};CLEARMediaPlayerAPI.prototype.addMarkerLayer=function(n){var t=JSON.parse(n);this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.ADD_MARKER_LAYER,{detail:{markerLayer:t}}))};CLEARMediaPlayerAPI.prototype.buildMarkerLayerDD=function(n){var t=JSON.parse(n);this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.BUILD_MARKER_LAYER_DD,{detail:{markerLayer:t}}))};CLEARMediaPlayerAPI.prototype.addOrUpdateMarker=function(n,t){var u=JSON.parse(t),i=document.getElementById(n),r;i&&(r=i.getElementsByTagName("a")[0].textContent);this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.ADD_OR_UPDATE_MARKER,{detail:{marker:u,markerLayerId:n,markerLayerName:r}}))};CLEARMediaPlayerAPI.prototype.deleteMarker=function(n,t){var i=document.getElementById(n),r;i&&(r=i.getElementsByTagName("a")[0].textContent);this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.DELETE_MARKER,{detail:{markerId:t,markerLayerId:n,markerLayerName:r}}))};CLEARMediaPlayerAPI.prototype.checkIfMixedFramerate=function(){return this._cmpInstance._cmpModel.isMixedFrameRate};CLEARMediaPlayerAPI.prototype.updatePreviewableSegmentList=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.UPDATE_PREVIEWABLE_SEGMENTS,{detail:{segments:n}}))};CLEARMediaPlayerAPI.prototype.updateSegmentsPosition=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.UPDATE_SEGMENTS_POSITION,{detail:{segments:n}}))};CLEARMediaPlayerAPI.prototype.switchToSingleItemInViewer=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(NonAvViewerEvent.SWITCH_TO_SINGLE_ITEM_VIEW))};CLEARMediaPlayerAPI.prototype.deleteSequence=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.DELETE_SEQUENCE))};CLEARMediaPlayerAPI.prototype.isLive=function(){return this._cmpInstance._cmpModel.mediaInfo.isLive};CLEARMediaPlayerAPI.prototype.seekToLive=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SEEK_TO_LIVE))};CLEARMediaPlayerAPI.prototype.setAssetClass=function(n){this._cmpInstance._cmpModel._mediaInfo._assetClass=n};CLEARMediaPlayerAPI.prototype.getPlayerMode=function(){return this._cmpInstance._cmpModel.playerMode};CLEARMediaPlayerAPI.prototype.getPlayerState=function(){return this._cmpInstance._stateMachine.currentState.constructor.name};CLEARMediaPlayerAPI.prototype.getSequenceClipInfo=function(){return this._cmpInstance._cmpModel._sequenceClipInfo};CLEARMediaPlayerAPI.prototype.getCeProject=function(){return this._cmpInstance._cmpModel._ceProject};CLEARMediaPlayerAPI.prototype.getMediaInfo=function(){return this._cmpInstance._cmpModel._mediaInfo};CLEARMediaPlayerAPI.prototype.urlUnloaded=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.UNLOAD_MEDIA_URL))};CLEARMediaPlayerAPI.prototype.resetPlaylistSequencePosition=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.UPDATE_TIMELINE_SEGMENT_POSITION,{detail:{segmentList:n}}))};CLEARMediaPlayerAPI.prototype.initialiseSegmentEditMode=function(n,t,i){this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.INITIALISE_SEQUENCE_SEGMENT_EDIT_MODE,{detail:{seqPosition:n,autoPlay:t,pauseAtLastFrame:i}}))};CLEARMediaPlayerAPI.prototype.delteSegment=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.DELETE_SEGMENT,{detail:{segmentUIId:n}}))};CLEARMediaPlayerAPI.prototype.getFrameRateBasedOnMode=function(){return this._cmpInstance._injector.getInstance("mediaManager").getFrameRateBasedOnMode()};CLEARMediaPlayerAPI.prototype.rebuildHelpScreen=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.REBUILD_HELPSCREEN))};CLEARMediaPlayerAPI.prototype.navigateToPrevSegment=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(SeekEvent.NAVIGATE_TO_PREVIOUS_TCIN))};CLEARMediaPlayerAPI.prototype.navigateToNextSegment=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(SeekEvent.NAVIGATE_TO_NEXT_TCIN))};CLEARMediaPlayerAPI.prototype.getCurrentSegment=function(){return this._cmpInstance._cmpModel.currentSegment};CLEARMediaPlayerAPI.prototype.getSegmentsToSkip=function(){return this._cmpInstance._cmpModel.segmentsToSkipPreview};CLEARMediaPlayerAPI.prototype.isResumePlayBackEnabled=function(){return CMPUtils.IsNullOrEmpty(this._cmpInstance._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MaintainPlaybackStateOnMarkInOut"])?"false":this._cmpInstance._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MaintainPlaybackStateOnMarkInOut"]};CLEARMediaPlayerAPI.prototype.getTimeCodeDisplayFormat=function(){return this._cmpInstance._cmpModel.mediaInfo.timecodeDisplayFormat};CLEARMediaPlayerAPI.prototype.initialiseCplPreview=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.INITIALISE_CPL_PREVIEW_MODE,{detail:{autoPlay:n}}))};CLEARMediaPlayerAPI.prototype.setPlayerMediaInfo=function(n){this._cmpInstance._injector.getInstance("mediaManager").setPlayerMediaInfo(n)};CLEARMediaPlayerAPI.prototype.showMarkerlayers=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.SHOW_MARKER_ON_SEGMENT))};CLEARMediaPlayerAPI.prototype.hideMarkerlayers=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.HIDE_MARKER_ON_SEGMENT))};CLEARMediaPlayerAPI.prototype.loadMarkerlayers=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.LOAD_MARKER_LAYER,{detail:{markerLayerId:n}}))};CLEARMediaPlayerAPI.prototype.addTimedTextDataObject=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(TTTEvent.ADD_TIMEDTEXT_DATA_OBJECT,{detail:{timedTextDataObjectArray:n}}))};CLEARMediaPlayerAPI.prototype.onTrackChanged=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(TTTEvent.ON_TRACK_CHANGED,{detail:{timedTextTrack:n}}))};CLEARMediaPlayerAPI.prototype.updateTimedTextDataObject=function(n,t){this._eventDispatcher.dispatchEvent(new CustomEvent(TTTEvent.UPDATE_TIMEDTEXT_DATA_OBJECT,{detail:{timedTextDataObjectArray:n,updateType:t}}))};CLEARMediaPlayerAPI.prototype.deleteTimedTextDataObject=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(TTTEvent.DELETE_TIMEDTEXT_DATA_OBJECT,{detail:{index:n}}))};CLEARMediaPlayerAPI.prototype.toggleCustomTimedTextTrackMode=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(TTTEvent.TOGGLE_CUSTOM_TIMEDTEXT_MODE,{detail:{isEnabled:n}}))};CLEARMediaPlayerAPI.prototype.toggleTimedTextTrackEditMode=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(TTTEvent.TOGGLE_TIMEDTEXT_EDIT_MODE,{detail:{isEnabled:n}}))};CLEARMediaPlayerAPI.prototype.setTimedTextTrackInfo=function(n,t){this._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.SET_TIMED_TEXT_TRACK_INFO,{detail:{charPerLine:n,charPerSec:t}}))};CLEARMediaPlayerAPI.prototype.changeAudioTrack=function(n,t){this._eventDispatcher.dispatchEvent(new CustomEvent(AudioEvent.CHANGE_AUDIO_TRACK,{detail:{audioEssenceId:n,audioTrackId:t}}))};CLEARMediaPlayerAPI.prototype.addOrUpdateMarkersToTimeline=function(n,t){var i=JSON.parse(t);this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.ADD_OR_UPDATE_MARKERS_TO_TIMELINE,{detail:{markers:i,markersLayerId:n}}))};CLEARMediaPlayerAPI.prototype.deleteMarkersFromTimeline=function(n,t){var i=JSON.parse(t);this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.DELETE_MARKERS_TO_TIMELINE,{detail:{markers:i,markersLayerId:n}}))};CLEARMediaPlayerAPI.prototype.clearMarkersToTimeline=function(n){for(var i,t=0;t<_this._cmpModel.markerCollection.length;t++)i=_this._cmpModel.markerCollection[t].markers,this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.CLEAR_MARKERS_TO_TIMELINE,{detail:{markers:i,markersLayerId:n}}))}}function CMPEventHandler(n,t){var i,r,u,f;this._eventDispatcher=document.getElementById(t);i=n.getInstance("stateMachine");this._stateMachine=i;r=n.getInstance("cmpModel");this._cmpModel=r;u=n.getInstance("nativeApi");this._nativeApi=u;this._loadTimeManager=n.getInstance("loadTimeManager");this._annotationHandler=new AnnotationHandler(n,t);this._screenshotHandler=new ScreenshotHandler(n,t);this._timeLineMarkerHandler=new TimelineMarkerHandler(n,t);this._injector=n;this._instanceId=t;this._tttManager=new TTTManager(n,t);this._timelineManager=n.getInstance("timelineManager");this._sequenceManager=n.getInstance("sequenceManager");this._timelineHandler=new TimelineHandler(n,t);this._mediaHandler=new MediaHandler(n,t);this._sequenceHandler=new SequenceHandler(n,t);this._nonAvHandler=new NonAvHandler(n,t);this._liveHandler=new LiveHandler(n,t);this._sessionHandler=new SessionHandler(t);f=this;this._eventDispatcher.addEventListener(LoadEvent.SET_MEDIA_SOURCE,this._mediaHandler.setMediaResource);this._eventDispatcher.addEventListener(CMPEvent.SET_CMP_STATE_EVENT,this._mediaHandler.setCmpState);this._eventDispatcher.addEventListener(LoadEvent.LOAD_SEGMENT,this._loadTimeManager.loadSegment);this._eventDispatcher.addEventListener(LoadEvent.LOAD_SEGMENT_BASED_ON_SEGMENTUIID,this._timelineHandler.loadSegmentBasedOnSegmentUiId);this._eventDispatcher.addEventListener(TimelineMetadataEvent.MARKER_TIME_REACHED,this._annotationHandler.onShowAnnotation);this._eventDispatcher.addEventListener(PlaylistMetadataEvent.PLAYLIST_MARKER_DURATION_REACHED,this._timelineManager.segmentDurationReached);this._eventDispatcher.addEventListener(TimelineMetadataEvent.MARKER_DURATION_REACHED,this._annotationHandler.onHideAnnotation);this._eventDispatcher.addEventListener(AnnotationEvent.POINT_ANNOTATION,this._timelineHandler.onPointAnnotation);this._eventDispatcher.addEventListener(AnnotationEvent.MARK_IN,this._timelineHandler.onMarkIn);this._eventDispatcher.addEventListener(AnnotationEvent.MARK_OUT,this._timelineHandler.onMarkOut);this._eventDispatcher.addEventListener(AnnotationEvent.REMOVE_MARKERS,this._timelineHandler.onRemoveMarker);this._eventDispatcher.addEventListener(AnnotationEvent.SAVE_ANNOTATION,this._annotationHandler.saveAnnotation);this._eventDispatcher.addEventListener(AnnotationEvent.EDIT_ANNOTATION,this._annotationHandler.editAnnotation);this._eventDispatcher.addEventListener(AnnotationEvent.REMOVE_ANNOTATION,this._annotationHandler.removeAnnotation);this._eventDispatcher.addEventListener(TimelineMetadataEvent.MARKER_TIME_REACHED,this._tttManager.showTimedText);this._eventDispatcher.addEventListener(TimelineMetadataEvent.MARKER_DURATION_REACHED,this._tttManager.hideTimedText);this._eventDispatcher.addEventListener(AnnotationEvent.FINETUNE_SAVE,this._annotationHandler.fineTuneSave);this._eventDispatcher.addEventListener(SequenceEvent.CREATE_CLIP,this._sequenceManager.addOrUpdateClip);this._eventDispatcher.addEventListener(SequenceEvent.DELETE_SEGMENT,this._timelineHandler.deleteTimelineSegment);this._eventDispatcher.addEventListener(SequenceEvent.UPDATE_SEGMENT_DURATION,this._timelineHandler.updateCroppedSegmentDuration);this._eventDispatcher.addEventListener(SequenceEvent.GET_SEQUENCE_OBJECT_AS_XML,this._timelineHandler.saveTimelineSegmentSequence);this._eventDispatcher.addEventListener(SequenceEvent.UPDATE_TIMELINE_SEGMENT_POSITION,this._timelineHandler.updateTimelineSegmentPosition);this._eventDispatcher.addEventListener(SequenceEvent.UPDATE_TIMELINE_SEGMENT_TITLE,this._timelineHandler.updateTimelineSegmentTitle);this._eventDispatcher.addEventListener(LoadEvent.LOAD_RANGE_MARKER,this._timelineHandler.loadRangeMarker);this._eventDispatcher.addEventListener(TimelineMetadataEvent.RESET_TIMELINE_METADATA,this._tttManager.resetTTTTimelineMetadata);this._eventDispatcher.addEventListener(TimelineMetadataEvent.RESET_TIMELINE_METADATA,this._annotationHandler.resetAnnotationTimelineMetadata);this._eventDispatcher.addEventListener(TransportEvent.STOP_SUCCESS,this._timelineHandler.onRemoveMarker);this._eventDispatcher.addEventListener(AnnotationEvent.ENABLE_MARKER_EDIT_MODE,this._annotationHandler.enableMarkerEditMode);this._eventDispatcher.addEventListener(SequenceEvent.UPDATE_CLIP_POSITION,this._timelineHandler.updateClipPosition);this._eventDispatcher.addEventListener(SequenceEvent.DELETE_CLIP,this._timelineHandler.deleteClipInTimeLine);this._eventDispatcher.addEventListener(TTTEvent.CHANGE_FONT_SIZE,this._tttManager.changeFontSize);this._eventDispatcher.addEventListener(TTTEvent.CHANGE_SUBTITLE_SETTING_POSITION,this._tttManager.changeSubtitleContainerPosition);this._eventDispatcher.addEventListener(TTTEvent.CHANGE_TEXT_COLOR,this._tttManager.changeTextColor);this._eventDispatcher.addEventListener(AnnotationEvent.SET_MARK_IN_POSITION,this._annotationHandler.setMarkInPosition);this._eventDispatcher.addEventListener(AnnotationEvent.SET_MARK_OUT_POSITION,this._annotationHandler.setMarkOutPosition);this._eventDispatcher.addEventListener(AnnotationEvent.SEEK_TO_ACCUMULATED_TIME_ON_FRAME_SEEK,this._annotationHandler.seekToAccumulatedTimeOnFrameSeek);this._eventDispatcher.addEventListener(AnnotationEvent.SEEK_TO_ACCUMULATED_TIME_ON_FRAME_SEEK,this._mediaHandler.resetFullyWatchedMedia);this._eventDispatcher.addEventListener(SequenceEvent.CREATE_SEGMENT,this._sequenceHandler.buildSegmentSavePopup);this._eventDispatcher.addEventListener(SequenceEvent.SAVE_SEGMENT,this._sequenceHandler.createSegmentForSequence);this._eventDispatcher.addEventListener(SequenceEvent.LOAD_SEGMENT,this._timelineHandler.segmentClickHandler);this._eventDispatcher.addEventListener(SequenceEvent.DELETE_SEGMENT_INFO,this._sequenceManager.deleteSegmentInfo);this._eventDispatcher.addEventListener(SequenceEvent.INITIATE_SEGMENT_PANEL,this._sequenceHandler.initiateSegmentPanel);this._eventDispatcher.addEventListener(SequenceEvent.INITIATE_SEGMENT_DELETE,this._sequenceHandler.initiateSegmentDelete);this._eventDispatcher.addEventListener(PlayerMode.EDIT,this._annotationHandler.setPlayerEditMode);this._eventDispatcher.addEventListener(TTTEvent.CALCULATE_FONT_SIZE,this._tttManager.calculateFontSize);this._eventDispatcher.addEventListener(TTTEvent.UPDATE_TIMED_TEXT_POSITION,this._tttManager.updateTTTPosition);this._eventDispatcher.addEventListener(TTTEvent.RESET_TTT_INFO,this._tttManager.resetTTTInfo);this._eventDispatcher.addEventListener(LoadEvent.UNLOAD_MEDIA_URL,this._mediaHandler.removeMediaSource);this._eventDispatcher.addEventListener(TTTEvent.SET_TTT_INFO_ON_TOGGLE_FULLSCREEN,this._tttManager.setTTTInfoOnToggleFullscreen);this._eventDispatcher.addEventListener(UIEvent.HIDE_TRANSPORTBAR,this._tttManager.setTTTInfoOnToggleFullscreen);this._eventDispatcher.addEventListener(SequenceEvent.SEND_THUMB_EXTRACTION_REQUEST,this._screenshotHandler.buildExtractionRequest);this._eventDispatcher.addEventListener(SequenceEvent.UPDATE_THUMB_EXTRACTION_ON_LOAD,this._sequenceManager.updateThumbExtractionOnLoad);this._eventDispatcher.addEventListener(SequenceEvent.CONVERT_IMPLICIT_TO_EXPLICIT_SEGMENTS,this._sequenceManager.convertAllImplicitToExplicitSegmentsHandler);this._eventDispatcher.addEventListener(SeekEvent.NAVIGATE_TO_PREVIOUS_TCIN,this._timeLineMarkerHandler.navigateToPreviousMarkerPosition);this._eventDispatcher.addEventListener(SeekEvent.NAVIGATE_TO_NEXT_TCIN,this._timeLineMarkerHandler.navigateToNextMarkerPosition);this._eventDispatcher.addEventListener(SeekEvent.NAVIGATE_TO_NEXT_TCIN,this._mediaHandler.resetFullyWatchedMedia);this._eventDispatcher.addEventListener(MarkerEvent.ADD_OR_UPDATE_MARKER,this._timeLineMarkerHandler.addOrUpdateMarker);this._eventDispatcher.addEventListener(MarkerEvent.ADD_OR_UPDATE_MARKERS_TO_TIMELINE,this._timeLineMarkerHandler.addOrUpdateMarkersToTimeline);this._eventDispatcher.addEventListener(MarkerEvent.DELETE_MARKERS_TO_TIMELINE,this._timeLineMarkerHandler.deleteMarkersFromTimeline);this._eventDispatcher.addEventListener(MarkerEvent.CLEAR_MARKERS_TO_TIMELINE,this._timeLineMarkerHandler.clearMarkersToTimeline);this._eventDispatcher.addEventListener(MarkerEvent.DELETE_MARKER,this._timeLineMarkerHandler.deleteMarker);this._eventDispatcher.addEventListener(SequenceEvent.GET_PLAYLIST_DURATION,this._sequenceManager.getPlaylistDurationListener);this._eventDispatcher.addEventListener(SequenceEvent.DELETE_SEQUENCE,this._timelineHandler.deleteSequence);this._eventDispatcher.addEventListener(MarkerEvent.ADD_MARKER_LAYER,this._timeLineMarkerHandler.addMarkerLayer);this._eventDispatcher.addEventListener(MarkerEvent.VALIDATE_MARKER_LAYER_CHANGE,this._timeLineMarkerHandler.validateMarkerLayerChange);this._eventDispatcher.addEventListener(NonAvViewerEvent.SCALE,this._nonAvHandler.handleScale);this._eventDispatcher.addEventListener(NonAvViewerEvent.NAVIGATE_NEXTITEM,this._nonAvHandler.handleNavigateNextItem);this._eventDispatcher.addEventListener(NonAvViewerEvent.NAVIGATE_PREVIOUSITEM,this._nonAvHandler.handleNavigatePreviousItem);this._eventDispatcher.addEventListener(NonAvViewerEvent.GO_TO_PAGE,this._nonAvHandler.jumpToPage);this._eventDispatcher.addEventListener(NonAvViewerEvent.ROTATE_CLOCKWISE,this._nonAvHandler.rotateClockWise);this._eventDispatcher.addEventListener(NonAvViewerEvent.ROTATE_ANTI_CLOCKWISE,this._nonAvHandler.rotateAntiClockWise);this._eventDispatcher.addEventListener(NonAvViewerEvent.RESIZE_NONAV,this._nonAvHandler.resizeNonAvView);this._eventDispatcher.addEventListener(NonAvViewerEvent.MOUSE_DRAG,this._nonAvHandler.handleMouseDrag);this._eventDispatcher.addEventListener(NonAvViewerEvent.GRID_LAYOUT_CHANGE,this._nonAvHandler.onGridLayoutChange);this._eventDispatcher.addEventListener(NonAvViewerEvent.DEFAULT_MULTIPLE_CONTAINER,this._nonAvHandler.defaultMultipleContainer);this._eventDispatcher.addEventListener(NonAvViewerEvent.NONAV_OVERLAY_CLICKED,this._nonAvHandler.handelNonAvOverlayClicked);this._eventDispatcher.addEventListener(NonAvViewerEvent.PLAY_SLIDE_SHOW,this._nonAvHandler.playSlideShow);this._eventDispatcher.addEventListener(NonAvViewerEvent.PAUSE_SLIDE_SHOW,this._nonAvHandler.pauseSlideShow);this._eventDispatcher.addEventListener(SequenceEvent.UPDATE_PREVIEWABLE_SEGMENTS,this._sequenceManager.updatePreviewableSegmentList);this._eventDispatcher.addEventListener(SequenceEvent.UPDATE_SEGMENTS_POSITION,this._sequenceManager.updateSegmentsPosition);this._eventDispatcher.addEventListener(ConfigurationEvent.SET_CONFIGURATION,validateCMPCloudEditorErrors);this._eventDispatcher.addEventListener(NonAvViewerEvent.CHANGE_VIEW_TYPE,this._nonAvHandler.handleChangeViewType);this._eventDispatcher.addEventListener(SequenceEvent.CREATE_CEPROJECT,this._sequenceManager.createClearEditorProjectObject);this._eventDispatcher.addEventListener(AnnotationEvent.INITIATE_SCTE35_SEGMENT,this._annotationHandler.createScte35Segment);this._eventDispatcher.addEventListener(LiveEvent.FEED_ENDED,this._liveHandler.onLiveFeedEnded);this._eventDispatcher.addEventListener(LiveEvent.UPADTE_POSITION_ON_LIVEDURATION_CHANGE,this._liveHandler.updatePositionOnLiveDurationChange);this._eventDispatcher.addEventListener(SequenceEvent.UPDATE_SEGMENT_BY_ID,this._sequenceManager.updateSegmentById);this._eventDispatcher.addEventListener(SequenceEvent.SPLICE_CLIP,this._sequenceManager.spliceClip);this._eventDispatcher.addEventListener(TimelineEvent.TIMELINE_EDITED,this._sequenceManager.timelineEditDetected);this._eventDispatcher.addEventListener(TimelineEvent.LAST_FRAME_REACHED,this._sessionHandler.resetSlideLock);this._eventDispatcher.addEventListener(AudioEvent.ADD_EMBEDDED_AUDIO_TRACKS,this._mediaHandler.addEmbeddedAudioTracks)}function UIEventHandler(n,t){this._eventDispatcher=document.getElementById(t);this._transportHandler=new TransportHandler(n,t);this._tttManager=new TTTManager(n,t);var i=n.getInstance("cmpModel");this._timelineHandler=new TimelineHandler(n,t);this._mediaHandler=new MediaHandler(n,t);this._sequenceHandler=new SequenceHandler(n,t);this._eventDispatcher.addEventListener(TransportEvent.PLAY,this._transportHandler.play);this._eventDispatcher.addEventListener(TransportEvent.PLAY,this._mediaHandler.resetFullyWatchedMedia);this._eventDispatcher.addEventListener(TransportEvent.PAUSE,this._transportHandler.pause);this._eventDispatcher.addEventListener(TransportEvent.STOP,this._transportHandler.stop);this._eventDispatcher.addEventListener(TransportEvent.SEEK,this._transportHandler.seek);this._eventDispatcher.addEventListener(TransportEvent.SEEK,this._mediaHandler.resetFullyWatchedMedia);this._eventDispatcher.addEventListener(TransportEvent.SEEK_TO_LIVE,this._transportHandler.seekToLive);this._eventDispatcher.addEventListener(TransportEvent.SEEK_TO_LIVE,this._mediaHandler.resetFullyWatchedMedia);this._eventDispatcher.addEventListener(TransportEvent.FRAME_FORWARD,this._transportHandler.frameForward);this._eventDispatcher.addEventListener(TransportEvent.FRAME_FORWARD,this._mediaHandler.resetFullyWatchedMedia);this._eventDispatcher.addEventListener(TransportEvent.FRAME_BACKWARD,this._transportHandler.frameBackward);this._eventDispatcher.addEventListener(TransportEvent.SECOND_FORWARD,this._transportHandler.secondForward);this._eventDispatcher.addEventListener(TransportEvent.SECOND_FORWARD,this._mediaHandler.resetFullyWatchedMedia);this._eventDispatcher.addEventListener(TransportEvent.SECOND_BACKWARD,this._transportHandler.secondBackward);this._eventDispatcher.addEventListener(TransportEvent.MINUTE_FORWARD,this._transportHandler.minuteForward);this._eventDispatcher.addEventListener(TransportEvent.MINUTE_BACKWARD,this._transportHandler.minuteBackward);this._eventDispatcher.addEventListener(TransportEvent.MINUTE_FORWARD,this._mediaHandler.resetFullyWatchedMedia);this._eventDispatcher.addEventListener(TransportEvent.SET_LAST_PLAYBACK_TIME,this._transportHandler.setLastPlayBackTime);this._eventDispatcher.addEventListener(TransportEvent.PLAY_FORWARD,this._transportHandler.playForward);this._eventDispatcher.addEventListener(TransportEvent.PLAY_FORWARD,this._mediaHandler.resetFullyWatchedMedia);this._eventDispatcher.addEventListener(TransportEvent.PLAY_BACKWARD,this._transportHandler.playBackward);this._eventDispatcher.addEventListener(TransportEvent.RESET_PLAYBACK_SPEED,this._transportHandler.resetPlaybackSpeed);this._eventDispatcher.addEventListener(SeekBarEvent.ON_DRAG_SEEKBAR,this._transportHandler.onDragSeekBar);this._eventDispatcher.addEventListener(SeekBarEvent.ON_DRAG_SEEKBAR,this._mediaHandler.resetFullyWatchedMedia);this._eventDispatcher.addEventListener(AudioEvent.SWITCH_AUDIO_TRACKS,this._mediaHandler.switchAudioTracks);this._eventDispatcher.addEventListener(AudioEvent.SET_VOLUME,this._mediaHandler.setVolume);this._eventDispatcher.addEventListener(AudioEvent.MUTE_VOLUME,this._mediaHandler.muteVolume);this._eventDispatcher.addEventListener(AudioEvent.UNMUTE_VOLUME,this._mediaHandler.unMuteVolume);this._eventDispatcher.addEventListener(AudioEvent.CHANGE_AUDIO_TRACK,this._transportHandler.changeAudioTrack);this._eventDispatcher.addEventListener(TTTEvent.ON_TRACK_CHANGED,this._tttManager.onTrackChanged);this._eventDispatcher.addEventListener(TTTEvent.ADD_TIMEDTEXT_DATA_OBJECT,this._tttManager.addTimedTextDataObject);this._eventDispatcher.addEventListener(TTTEvent.GET_TIMEDTEXT_DATA,this._tttManager.getTimedTextDataObject);this._eventDispatcher.addEventListener(TTTEvent.UPDATE_TIMEDTEXT_DATA_OBJECT,this._tttManager.updateTimedTextDataObject);this._eventDispatcher.addEventListener(TTTEvent.DELETE_TIMEDTEXT_DATA_OBJECT,this._tttManager.deleteTimedTextDataObject);this._eventDispatcher.addEventListener(TTTEvent.REINDEX_TIMEDTEXT_DATA_OBJECT,this._tttManager.reindexTimedTextDataObject);this._eventDispatcher.addEventListener(TTTEvent.TOGGLE_CUSTOM_TIMEDTEXT_MODE,this._tttManager.toggleCustomTimedTextTrackMode);this._eventDispatcher.addEventListener(TTTEvent.TOGGLE_TIMEDTEXT_EDIT_MODE,this._tttManager.toggleTimedTextTrackEditMode);this._eventDispatcher.addEventListener(TransportEvent.CAPTURE_FRAME,this._transportHandler.captureFrame);this._eventDispatcher.addEventListener(SequenceEvent.DELETE_CAPTURE_FRAME,this._timelineHandler.deleteCapturedFrame);this._eventDispatcher.addEventListener(SequenceEvent.INITIALISE_SEQUENCE_SEGMENT_EDIT_MODE,this._transportHandler.initialiseSegmentEditMode);this._eventDispatcher.addEventListener(SequenceEvent.INITIALISE_SEQUENCE_PREVIEW_MODE,this._transportHandler.initialiseSequencePreviewMode);this._eventDispatcher.addEventListener(SequenceEvent.INITIALISE_SEQUENCE_PREVIEW_MODE,this._mediaHandler.resetFullyWatchedMedia);this._eventDispatcher.addEventListener(SequenceEvent.INITIALISE_SEQUENCE_CLIP_MODE,this._transportHandler.initialiseSequenceClipMode);this._eventDispatcher.addEventListener(SequenceEvent.INITIALISE_CPL_PREVIEW_MODE,this._transportHandler.initialiseCplPreviewMode);this._eventDispatcher.addEventListener(SequenceEvent.INITIALISE_CPL_PREVIEW_MODE,this._mediaHandler.resetFullyWatchedMedia);this._eventDispatcher.addEventListener(TransportEvent.SET_ACCUMULATE_TIME,this._transportHandler.setAccumulatedTime);this._eventDispatcher.addEventListener(SequenceEvent.CREATE_CAPTURE_FRAME,this._timelineHandler.createCaptureFrame);this._eventDispatcher.addEventListener(SequenceEvent.LOAD_CLIP,this._timelineHandler.loadClip);this._eventDispatcher.addEventListener(SeekEvent.NAVIGATE_TO_PREVIOUS_TCIN,this._timelineHandler.previousSegment);this._eventDispatcher.addEventListener(SeekEvent.NAVIGATE_TO_NEXT_TCIN,this._timelineHandler.nextSegment);this._eventDispatcher.addEventListener(SeekEvent.NAVIGATE_TO_NEXT_TCIN,this._mediaHandler.resetFullyWatchedMedia);this._eventDispatcher.addEventListener(SequenceEvent.HANDLE_EXPORT_CLIPS,this._sequenceHandler.handleExportClips);this._eventDispatcher.addEventListener(TransportEvent.TOGGLE_UI_CONTROL_VISIBILITY,this._transportHandler.toggleUIControlVisibility);this._eventDispatcher.addEventListener(TransportEvent.WATERMARKING_FONTSIZE_HANDLING_ON_FULLSCREEN_TOGGLE,this._transportHandler.fnHandleWatermarkingOnFullscreenToggle);this._eventDispatcher.addEventListener(LoadEvent.GET_MEDIAINFO,this._mediaHandler.getMediaInfo);this._eventDispatcher.addEventListener(UIEvent.HIDE_MEDIA_INFO,this._mediaHandler.hideMediaInfo);this._eventDispatcher.addEventListener(UIEvent.ADD_MARKER,this._timelineHandler.onAddMarker);this._eventDispatcher.addEventListener(TransportEvent.DRAG_START,this._transportHandler.onDragStart);this._eventDispatcher.addEventListener(TransportEvent.DRAG_STOP,this._transportHandler.onDragStop);this._eventDispatcher.addEventListener(TransportEvent.DRAG_STOP,this._mediaHandler.resetFullyWatchedMedia);this._eventDispatcher.addEventListener(TransportEvent.SET_PIN_CONTROL_VALUE,this._transportHandler.setPinControlValue);this._eventDispatcher.addEventListener(TransportEvent.SET_TAKE_OR_TOTAL_CONTROL_VALUE,this._transportHandler.setTakeOrTotalControlValue);this._eventDispatcher.addEventListener(SequenceEvent.REINIT_TIMELINE_THUMBNAIL,this._timelineHandler.reInitTimelineThumbmail)}function SessionHandler(n){SessionHandler.prototype.resetSlideLock=function(){var t=window.PFTObserver,i;t!=undefined&&t!=null&&typeof t=="object"&&(i=PFTObserver.isActivityRegistered(n+"_player"),i&&PFTObserver.resetIdleTimer())}}function TransportHandler(n,t){this._stateMachine=n.getInstance("stateMachine");this._cmpModel=n.getInstance("cmpModel");this._instanceId=t;this._eventDispatcher=document.getElementById(this._instanceId);this._nativeApi=n.getInstance("nativeApi");this._tttManager=new TTTManager(n,t);this._annotationManager=new AnnotationManager(this._stateMachine,this._cmpModel,this._nativeApi,this._instanceId);this._mediaManager=n.getInstance("mediaManager");this._sequenceManager=n.getInstance("sequenceManager");this._audioManager=n.getInstance("audioManager");this._absoluteCMPConfig=[];var i=this;TransportHandler.prototype.play=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.PLAY}}))};TransportHandler.prototype.pause=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.PAUSE}}));i._eventDispatcher.dispatchEvent(new CustomEvent(LastPlayBackTimeEvent.ADD_OR_UPDATE_LPT,{detail:{playerContainerId:t}}))};TransportHandler.prototype.stop=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.STOP}}));i._eventDispatcher.dispatchEvent(new CustomEvent(LastPlayBackTimeEvent.ADD_OR_UPDATE_LPT,{detail:{playerContainerId:t}}))};TransportHandler.prototype.seek=function(n){n.detail.stateAfterSeek!=null&&n.detail.stateAfterSeek!=undefined&&(i._cmpModel.stateAfterSeek=n.detail.stateAfterSeek);i.calculateSeekTime(n.detail.positionInMsec/1e3)};TransportHandler.prototype.frameForward=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.FRAME_FORWARD}}))};TransportHandler.prototype.frameBackward=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.FRAME_BACKWARD}}))};TransportHandler.prototype.secondForward=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.SECOND_FORWARD}}))};TransportHandler.prototype.secondBackward=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.SECOND_BACKWARD}}))};TransportHandler.prototype.minuteForward=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.MINUTE_FORWARD}}))};TransportHandler.prototype.minuteBackward=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.MINUTE_BACKWARD}}))};TransportHandler.prototype.setLastPlayBackTime=function(n){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.SET_LAST_PLAYBACK_TIME,time:n.detail.time}}))};TransportHandler.prototype.playForward=function(){i._cmpModel.externalAudioTrackIndex==-1&&(i._cmpModel.currentPlaybackSpeedIndex>=i._cmpModel.playbackSpeedRange.length-1||i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.PLAY_FORWARD}})))};TransportHandler.prototype.playBackward=function(){i._cmpModel.externalAudioTrackIndex==-1&&(i._cmpModel.currentPlaybackSpeedIndex<=0||i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.PLAY_BACKWARD}})))};TransportHandler.prototype.resetPlaybackSpeed=function(){i._cmpModel.currentPlaybackSpeedIndex=CMPUtils.getDefaultSpeedIndex(i._cmpModel.playbackSpeedRange);var n=i._cmpModel.currentPlaybackSpeedIndex,t=i._cmpModel.playbackSpeedRange,r=CMPUtils.getPlaybackDirection(t,n);i._nativeApi.SetPlaybackSpeed(t[n],r);i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAYBACK_SPEED_CHANGE,{detail:{playbackSpeed:t[n],playbackDirection:CMPUtils.getPlaybackDirection(t,n)}}))};TransportHandler.prototype.reset=function(){i._mediaManager.getCurrentTime()>=i._cmpModel.mediaDuration?(i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.Pause}})),i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.Seek,positionToSeek:i._cmpModel.playerInfo.MediaInfo.SeekStart*1e3}}))):i._mediaManager.getCurrentTime()<parseInt(i._cmpModel.playerInfo.MediaInfo.SeekStart)&&(i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.PAUSE}})),i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.SEEK,positionToSeek:i._cmpModel.playerInfo.MediaInfo.SeekStart*1e3}})))};TransportHandler.prototype.onDragSeekBar=function(n){i.calculateSeekTime(n.detail.PositionToSeek)};TransportHandler.prototype.calculateSeekTime=function(n){var t,r;i._cmpModel._ceProject!=null&&i._cmpModel._ceProject._sequence!=undefined&&i._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW?(t=i._sequenceManager.getSegmentBasedOnSequenceTime(i._cmpModel._ceProject._sequence,n),i._cmpModel.timelineMetadata.resetIndex(n),r=parseFloat(t.startTime)+parseFloat(n-t.startTimeInSequence),i._cmpModel.segmentsToSkipPreview.indexOf(t.position)!=-1&&(t=new TimelineManager(i._nativeApi,i._cmpModel,i._instanceId).getNextSegment(t.position+1),r=t.startTime),n=n*1e3,(i._nativeApi.GetCurrentState().toUpperCase()=="PLAYING"||i._nativeApi.GetCurrentState().toUpperCase()=="BUFFERING"&&i._cmpModel.oldState.toUpperCase()=="PLAYING")&&(i._cmpModel.autoPlay=!0),CMPUtils.IsNullOrEmpty(i._cmpModel.segmentTimelineMetadata)||i._cmpModel.segmentTimelineMetadata.reset(!1),i._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:t,positionToSeek:r*1e3}}))):i._cmpModel.playerMode==PlayerMode.STRATA?i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.SEEK,positionToSeek:n*1e3+parseFloat(i._cmpModel.mediaInfo.startSeek)}})):i._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW?(t=i._sequenceManager.getSegmentBasedOnSequenceTime(i._cmpModel._ceProject._sequence,n),r=parseFloat(t.startTime)+parseFloat(n-t.startTimeInSequence),i._cmpModel.segmentsToSkipPreview.indexOf(t.position)!=-1&&(t=new TimelineManager(i._nativeApi,i._cmpModel,i._instanceId).getNextSegmentOfCeProject(t.position+1,i._cmpModel.ceProjectForVideo),r=t.startTime),i._cmpModel.timelineMetadata.resetIndex(n),CMPUtils.IsNullOrEmpty(i._cmpModel.videoTimeline)||i._cmpModel.videoTimeline.resetIndex(n),CMPUtils.IsNullOrEmpty(i._cmpModel.audioTimeline)||i._cmpModel.audioTimeline.resetIndex(n),(i._nativeApi.GetCurrentState().toUpperCase()=="PLAYING"||i._nativeApi.GetCurrentState().toUpperCase()=="BUFFERING"&&i._cmpModel.oldState.toUpperCase()=="PLAYING")&&(i._cmpModel.autoPlay=!0),i._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:t,positionToSeek:n*1e3}}))):(CMPUtils.IsNullOrEmpty(i._cmpModel.segmentTimelineMetadata)||i._cmpModel.segmentTimelineMetadata.reset(!1),i._cmpModel.accumulatedSeekTimeInSec!=0&&(i._cmpModel.accumulatedSeekTimeInSec=n),i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.SEEK,positionToSeek:n*1e3}})))};TransportHandler.prototype.captureFrame=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.CAPTURE_FRAME}}))};TransportHandler.prototype.initialiseSegmentEditMode=function(n){var t=CMPUtils.IsNullOrEmpty(n.detail.seqPosition)?1:n.detail.seqPosition,r=n.detail.autoPlay!=!0?!1:!0;i._cmpModel._pauseAtLastFrame=n.detail.pauseAtLastFrame!=!0?!1:!0;i._cmpModel._segmentDurationReached=!1;i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:SequenceEvent.SWITCH_SEQUENCE_MODE,mode:PlayerMode.SEQUENCE_SEGMENT_EDIT,segPosition:t,autoPlay:r}}))};TransportHandler.prototype.initialiseSequencePreviewMode=function(n){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:SequenceEvent.SWITCH_SEQUENCE_MODE,mode:PlayerMode.SEQUENCE_PREVIEW,autoPlay:n.detail.autoPlay}}))};TransportHandler.prototype.initialiseSequenceClipMode=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:SequenceEvent.LOAD_CLIP}}))};TransportHandler.prototype.setAccumulatedTime=function(n){i._cmpModel.accumulatedSeekTimeInSec=n.detail.accumulateTime;n.detail.accumulateTime};TransportHandler.prototype.updateTransportBarControls=function(n){var r=n.detail.controlKeyName,t=n.detail.isEnable;switch(r.toLowerCase()){case"enablemarkinout":i._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.Enable"]=t.toString();i._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.Display"]=t.toString();i._eventDispatcher.dispatchEvent(new CustomEvent(ShortCutEvent.ADD_OR_REMOVE_SHORTCUT,{detail:{controlKeyName:r,isEnable:t}}));i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SHOW_HIDE_CONTROLS,{detail:{controlKeyName:r,isEnable:t}}));break;case"enablemarkannotation":i._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkAnnotation.Enable"]=t.toString();i._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkAnnotation.Display"]=t.toString();i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SHOW_HIDE_CONTROLS,{detail:{controlKeyName:r,isEnable:t}}));break;default:return}};TransportHandler.prototype.fnHandleWatermarkingOnFullscreenToggle=function(){i._nativeApi.GetSupportedFeatures().contains("GetAndAssignStlyesForWaterMarking")&&i._nativeApi.GetAndAssignStlyesForWaterMarking()};TransportHandler.prototype.toggleUIControlVisibility=function(n){var r=n.detail.controlKeyName,t=n.detail.isEnable,u=n.detail.isDisplay===undefined?t:n.detail.isDisplay&&t;switch(r.toLowerCase()){case"enablemarkinout":i.handleToggleUIControlVisibility(r,"VideoPanelConfig.MarkInOut.Enable",t,"VideoPanelConfig.MarkInOut.Display",u);t||i._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.REMOVE_MARKER));break;case"enablemarkannotation":i.handleToggleUIControlVisibility(r,"VideoPanelConfig.MarkAnnotation.Enable",t,"VideoPanelConfig.MarkAnnotation.Display",u);break;case"enablerotate":i.handleToggleUIControlVisibility(r,"NonAvConfig.EnableRotate",t,null,null);break;case"enablezoominout":i.handleToggleUIControlVisibility(r,"NonAvConfig.EnableZoomInOut",t,null,null);break;case"enablemultiplecontainer":i.handleToggleUIControlVisibility(r,"NonAvConfig.EnableMultipleContainer",t,null,null);break;case"enableslideshow":i.handleToggleUIControlVisibility(r,"NonAvConfig.EnableSlideShow",t,null,null);break;case"enablechangeviewtype":i.handleToggleUIControlVisibility(r,"NonAvConfig.EnableChangeViewType",t,null,null);break;case"enableframenavigation":i.handleToggleUIControlVisibility(r,"NonAvConfig.EnableFrameNavigation",t,null,null);break;case"enableavframenavigation":i.handleToggleUIControlVisibility("enableframenavigation","VideoPanelConfig.FrameNavigation.Enable",t,"VideoPanelConfig.FrameNavigation.Display",u);break;case"enablesegmentnavigation":i.handleToggleUIControlVisibility(r,"VideoPanelConfig.PrevNextSegment.Enable",t,"VideoPanelConfig.PrevNextSegment.Display",u);break;case"enableplayratebuttons":i.handleToggleUIControlVisibility(r,"VideoPanelConfig.PlayRateButtons.Enable",t,"VideoPanelConfig.PlayRateButtons.Display",u);break;case"enablesecondsnavigation":i.handleToggleUIControlVisibility(r,"VideoPanelConfig.SecondsNavigation.Enable",t,"VideoPanelConfig.SecondsNavigation.Display",u);break;case"enableminutesnavigation":i.handleToggleUIControlVisibility(r,"VideoPanelConfig.MinutesNavigation.Enable",t,"VideoPanelConfig.MinutesNavigation.Display",u);break;case"enableaddmarker":i.handleToggleUIControlVisibility(r,"VideoPanelConfig.AddMarker.Enable",t,"VideoPanelConfig.AddMarker.Display",u);break;case"showtakerunningtime":i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SHOW_HIDE_CONTROLS,{detail:{controlKeyName:r,isEnable:t}}));break;case"enabletaketotaltimeline":i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SHOW_HIDE_CONTROLS,{detail:{controlKeyName:r,isEnable:t}}));break;default:return}};TransportHandler.prototype.handleToggleUIControlVisibility=function(n,t,r,u,f){if(i._absoluteCMPConfig[t.toLowerCase()]===undefined&&(i._absoluteCMPConfig[t.toLowerCase()]=i._cmpModel.playerInfo.CMPConfig.CMPConfigValue[t]),i._absoluteCMPConfig[t.toLowerCase()]=="true"&&(i._cmpModel.playerInfo.CMPConfig.CMPConfigValue[t]=r.toString(),i._eventDispatcher.dispatchEvent(new CustomEvent(ShortCutEvent.ADD_OR_REMOVE_SHORTCUT,{detail:{controlKeyName:n,isEnable:r}})),u!=null&&f!=null)){var o=i._cmpModel.playerInfo.CMPConfig.CMPConfigValue[u],e=o.toLowerCase()==="true";i._cmpModel.playerInfo.CMPConfig.CMPConfigValue[u]=="true"&&(e=f);i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SHOW_HIDE_CONTROLS,{detail:{controlKeyName:n,isEnable:e}}))}};TransportHandler.prototype.seekToLive=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.SEEK_TO_LIVE}}))};TransportHandler.prototype.initialiseCplPreviewMode=function(n){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:SequenceEvent.SWITCH_SEQUENCE_MODE,mode:PlayerMode.SEQUENCE_CPL_PREVIEW,autoPlay:n.detail.autoPlay}}))};TransportHandler.prototype.onDragStart=function(n){n.detail.isTimelineThumbnailEnabled&&(i._stateMachine.currentState==i._stateMachine.stateCollection.PLAYING?(i._cmpModel.dragPersistedState="PLAYING",i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.PAUSE}}))):i._stateMachine.currentState==i._stateMachine.stateCollection.BUFFERING&&(i._cmpModel.dragPersistedState=i._cmpModel.oldState,i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.PAUSE}}))))};TransportHandler.prototype.onDragStop=function(n){n.detail.isTimelineThumbnailEnabled&&i._cmpModel.dragPersistedState=="PLAYING"&&i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.PLAY}}));i._cmpModel.dragPersistedState=null};TransportHandler.prototype.changeAudioTrack=function(n){i._audioManager.changeAudioTrack(n.detail.audioEssenceId,n.detail.audioTrackId)};TransportHandler.prototype.setPinControlValue=function(n){i._cmpModel._preferenceSetting.rememberViewerSettings&&(i._cmpModel._preferenceSetting.viewerSettings.playerPreferencesSettings.avViewer.common.isPinned=n.detail.isPinned)};TransportHandler.prototype.setTakeOrTotalControlValue=function(n){i._cmpModel._preferenceSetting.rememberViewerSettings&&(i._cmpModel._preferenceSetting.viewerSettings.playerPreferencesSettings.avViewer.common.takeOrTotal=n.detail.takeOrTotal);i._cmpModel.takeOrTotal=n.detail.takeOrTotal}}function TimelineHandler(n,t){this._stateMachine=n.getInstance("stateMachine");this._cmpModel=n.getInstance("cmpModel");this._instanceId=t;this._nativeApi=n.getInstance("nativeApi");this._eventDispatcher=document.getElementById(t);this._sequenceManager=n.getInstance("sequenceManager");this._loadTimeManager=n.getInstance("loadTimeManager");this._sequenceClipManager=n.getInstance("sequenceClipManager");this._timelineManager=n.getInstance("timelineManager");this._mediaManager=n.getInstance("mediaManager");var i=this;TimelineHandler.prototype.loadRangeMarker=function(n){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:LoadEvent.LOAD_RANGE_MARKER,startTimeInMsec:n.detail.startTimeInMsec,endTimeInMsec:n.detail.endTimeInMsec,autoPlay:n.detail.autoPlay,isRetainCurrentPos:n.detail.isRetainCurrentPos,isPlayerInEditMode:n.detail.isPlayerInEditMode,segmentId:n.detail.segmentId,loopToSegStartOnSegEnd:n.detail.loopToSegStartOnSegEnd}}))};TimelineHandler.prototype.segmentClickHandler=function(n){var t=n.detail.segment;i.loadSegment(t)};TimelineHandler.prototype.loadSegment=function(n){var t=this._mediaManager.getFrameRateBasedOnMode(),i;this._cmpModel.playerMode==PlayerMode.SEQUENCE_CLIP?n.clipOrderId!=this._cmpModel.currentClipOrderId?this._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:SequenceEvent.LOAD_CLIP,clipOrderId:n.clipOrderId}})):this._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:LoadEvent.LOAD_RANGE_MARKER,startTimeInMsec:CMPUtils.RoundOffToNearestFrameWithMilliSecs(n.startTime*1e3,t),endTimeInMsec:CMPUtils.RoundOffToNearestFrameWithMilliSecs(n.endTime*1e3,t),autoPlay:"false",showMarkerIcons:!0,segment:n}})):(this._nativeApi.GetCurrentState().toUpperCase()=="PLAYING"&&(this._cmpModel.autoPlay=!0),i=CMPUtils.RoundOffToNearestFrameWithMilliSecs(n.startTime*1e3,t),this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&(i=CMPUtils.RoundOffToNearestFrameWithMilliSecs(n.startTimeInSequence*1e3,t)),this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:n,positionToSeek:i}})),this._cmpModel.timelineMetadata.resetIndex(CMPUtils.RoundOffToNearestFrame(n.startTimeInSequence,t)),this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&(this._cmpModel.videoTimeline.resetIndex(CMPUtils.RoundOffToNearestFrame(n.startTimeInSequence,t)),this._cmpModel.audioTimeline&&this._cmpModel.audioTimeline.resetIndex(CMPUtils.RoundOffToNearestFrame(n.startTimeInSequence,t))))};TimelineHandler.prototype.loadClip=function(n){var t=n.detail.clipOrderId;i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:SequenceEvent.LOAD_CLIP,clipOrderId:t}}))};TimelineHandler.prototype.previousSegment=function(){var n=null,t;i._cmpModel.playerMode==PlayerMode.SEQUENCE_CLIP?CMPUtils.IsNullOrEmpty(i._cmpModel.currentSegment)||i._cmpModel.currentSegment.implictSegment!=!1?n=CMPUtils.getFirstSegmentForClip(i._cmpModel.ceProject.sequence,i._cmpModel.currentClipOrderId):(t=CMPUtils.getSegmentBasedOnPosition(i._cmpModel.ceProject.sequence,i._cmpModel.currentSegment.position-1),t.clipOrderId==i._cmpModel.currentSegment.clipOrderId&&(n=t)):(i._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||i._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT||i._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW)&&(n=i._cmpModel.currentSegment.position==1?i._timelineManager.getPrevSegment(i._cmpModel.ceProject.sequence.segments.length):i._timelineManager.getPrevSegment(i._cmpModel.currentSegment.position-1),i._cmpModel.timelineMetadata.reset());n!=null&&i.loadSegment(n)};TimelineHandler.prototype.nextSegment=function(){var n=null,t;i._cmpModel.playerMode==PlayerMode.SEQUENCE_CLIP?CMPUtils.IsNullOrEmpty(i._cmpModel.currentSegment)||i._cmpModel.currentSegment.implictSegment!=!1?n=CMPUtils.getFirstSegmentForClip(i._cmpModel.ceProject.sequence,i._cmpModel.currentClipOrderId):(t=CMPUtils.getSegmentBasedOnPosition(i._cmpModel.ceProject.sequence,i._cmpModel.currentSegment.position+1),t.clipOrderId==i._cmpModel.currentSegment.clipOrderId&&(n=t)):(i._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||i._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT||i._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW)&&(n=i._cmpModel.currentSegment.position==i._cmpModel.ceProject.sequence.segments.length?i._timelineManager.getNextSegment(1):i._timelineManager.getNextSegment(i._cmpModel.currentSegment.position+1));n!=null&&i.loadSegment(n)};TimelineHandler.prototype.onMarkIn=function(){CMPUtils.getPlaybackDirection(i._cmpModel.playbackSpeedRange,i._cmpModel.currentPlaybackSpeedIndex)!="reverse"&&(i._cmpModel.playerMode!=PlayerMode.SEQUENCE_CPL_PREVIEW||i._cmpModel.playerInfo.MediaInfo.PlaylistSubType.toUpperCase()!="IMF")&&i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:AnnotationEvent.MARK_IN}}))};TimelineHandler.prototype.onPointAnnotation=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:AnnotationEvent.POINT_ANNOTATION}}))};TimelineHandler.prototype.onMarkOut=function(){CMPUtils.getPlaybackDirection(i._cmpModel.playbackSpeedRange,i._cmpModel.currentPlaybackSpeedIndex)!="reverse"&&(i._cmpModel.playerMode!=PlayerMode.SEQUENCE_CPL_PREVIEW||i._cmpModel.playerInfo.MediaInfo.PlaylistSubType.toUpperCase()!="IMF")&&i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:AnnotationEvent.MARK_OUT}}))};TimelineHandler.prototype.onAddMarker=function(){var n=i._mediaManager.getFrameRateBasedOnMode(),t=CMPUtils.ConvertTimeCodeToSecs(i._cmpModel.mediaInfo.som,n,i._cmpModel.mediaInfo.timecodeDisplayFormat),r=CMPUtils.ConvertSecondsToTimeCode(i._cmpModel._marker._markIn+t,n,i._cmpModel.mediaInfo.timecodeDisplayFormat),u=CMPUtils.ConvertSecondsToTimeCode(i._cmpModel._marker._markIn,n,i._cmpModel.mediaInfo.timecodeDisplayFormat),f=CMPUtils.ConvertSecondsToTimeCode(i._cmpModel._marker._markOut+t,n,i._cmpModel.mediaInfo.timecodeDisplayFormat),e=CMPUtils.ConvertSecondsToTimeCode(i._cmpModel._marker._markOut,n,i._cmpModel.mediaInfo.timecodeDisplayFormat);i._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.ADD_MARKER,{detail:{TCInWithSOM:r,TCOutWithSOM:f,TCInWithoutSOM:u,TCOutWithoutSOM:e}}))};TimelineHandler.prototype.onRemoveMarker=function(){new AnnotationManager(i._stateMachine,i._cmpModel,i._nativeApi,i._instanceId).onRemoveMarker()};TimelineHandler.prototype.loadSegmentBasedOnSegmentUiId=function(n){var t=CMPUtils.getSegmentForSegmentUidFromSequence(i._cmpModel._ceProject._sequence,n.detail.segmentUiId);CMPUtils.IsNullOrEmpty(n.detail.pauseOnSegmentDurationReached)&&(i._cmpModel.pauseOnSegmentDurationReached=n.detail.pauseOnSegmentDurationReached);CMPUtils.IsNullOrEmpty(n.detail.autoPlay)||(i._cmpModel.autoPlay=n.detail.autoPlay);i.loadSegment(t)};TimelineHandler.prototype.updateCroppedSegmentDuration=function(n){i._sequenceManager.updateSegment(n.detail.segmentStartTime,n.detail.segmentEndTime,n.detail.title)};TimelineHandler.prototype.updateTimelineSegmentTitle=function(n){i._sequenceManager.updateSegment(null,null,n.detail.title)};TimelineHandler.prototype.deleteTimelineSegment=function(n){var t=n.detail.segmentUIId;i._sequenceManager.deleteClipAndSegment(t)};TimelineHandler.prototype.updateTimelineSegmentPosition=function(n){i._sequenceManager.updateTimelineSegmentPosition(n.detail.segmentList)};TimelineHandler.prototype.saveTimelineSegmentSequence=function(n){var t=i._cmpModel.ceProject.sequence,r=i._sequenceManager.GetSequenceObjectAsXml(i._cmpModel.ceProject),o=r.outerHTML,u=i._sequenceManager.GetPlaylistDuration(t.segments),f=t.frameRate!=null?t.frameRate:25,e=t.segments!=null?t.segments.length:0;i._eventDispatcher.dispatchEvent(new CustomEvent(TimelineBarEvent.SAVE_TIMELINE_SEQUNCE_XML,{detail:{SequenceXml:r,FrameRate:f,NoOfSegment:e,PlaylistDuration:u,Type:n.detail.type}}))};TimelineHandler.prototype.createCaptureFrame=function(n){i._sequenceClipManager.createCaptureFrame(n.detail.vidCaptureTimeSecs)};TimelineHandler.prototype.deleteCapturedFrame=function(n){i._sequenceClipManager.deleteCapturedFrame(n.detail.screenshotId)};TimelineHandler.prototype.updateClipPosition=function(n){var u,t;i._eventDispatcher.dispatchEvent(new CustomEvent(TimelineEvent.TIMELINE_EDITED));var e=n.detail.clipUiId,o=n.detail.shiftPosition,r=i._cmpModel.sequenceClipInfo.sort(function(n,t){return n._position-t._position}),f=CMPUtils.getSequenceClipInfoObjectWithClipUiId(e,i._cmpModel.sequenceClipInfo);for(o==="leftShift"?(u=parseInt(f.position)-1,u<=0&&(u=r.length)):o==="rightShift"&&(u=parseInt(f.position)+1,u>r.length&&(u=1)),t=0;t<r.length;t++)r[t].clipUiId==e&&r.splice(t,1);for(f.position=u.toString(),r.splice(u-1,0,f),t=0;t<r.length;t++)r[t].position=(t+1).toString();CMPUtils.setSegmentPosition(i._cmpModel.ceProject.sequence.segments,i._cmpModel.ceProject.bin.clips,i._cmpModel.sequenceClipInfo);CMPUtils.calculateSegmentTimeInSequence(i._cmpModel.ceProject.sequence.segments);i._cmpModel.playerMode===PlayerMode.SEQUENCE_PREVIEW&&(i._timelineManager.loadSequenceTimelineMetadata(),i._cmpModel.timelineMetadata.resetIndex(i._mediaManager.getCurrentTime()));i._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.CLIP_POSITION_UPDATED,{detail:{ceProjectObject:i._cmpModel.ceProject,sequenceClipInfo:i._cmpModel.sequenceClipInfo,clipUiId:e,shiftPosition:o}}))};TimelineHandler.prototype.deleteClipInTimeLine=function(n){i._sequenceClipManager.deleteClip(n.detail.clipUiId)};TimelineHandler.prototype.deleteSequence=function(){i._sequenceManager.deleteSequence()};TimelineHandler.prototype.timelineEditDetected=function(){i._sequenceManager.timelineEditDetected()};TimelineHandler.prototype.reInitTimelineThumbmail=function(n){var t={},u,r;n.detail.reloadWithCurrentSegment?i._cmpModel.playerInfo.CMPConfig.CMPConfigValue.EnableTimelineThumbnail&&i._cmpModel.playerInfo.CMPConfig.CMPConfigValue.EnableTimelineThumbnail.toUpperCase()==="TRUE"&&(u=CMPUtils.IsNullOrEmpty(n.detail.currentSegment)?i._cmpModel.currentSegment:n.detail.currentSegment,CMPUtils.IsNullOrEmpty(i._cmpModel.timelinethumbnail)||(r={},r.cmpModel=i._cmpModel,r.currentSegment=u,t.sequenceHandle=r,i._cmpModel.timelinethumbnail.reInit(t))):i._cmpModel.playerInfo.CMPConfig.CMPConfigValue.EnableTimelineThumbnail&&i._cmpModel.playerInfo.CMPConfig.CMPConfigValue.EnableTimelineThumbnail.toUpperCase()==="TRUE"&&(CMPUtils.IsNullOrEmpty(i._cmpModel.timelinethumbnail)||(t.sequenceHandle=i._instanceId+"_ClearMediaPlayer",i._cmpModel.timelinethumbnail.reInit(t)))}}function ScreenshotHandler(n,t){this._stateMachine=n.getInstance("stateMachine");this._cmpModel=n.getInstance("cmpModel");this._mediaManager=n.getInstance("mediaManager");this._instanceId=t;this._eventDispatcher=document.getElementById(t);var i=this;ScreenshotHandler.prototype.sendExtractionRequest=function(n,t,r){n="request="+n+"&RanNum="+r;jQuery.ajax({type:"POST",url:t,contentType:"application/x-www-form-urlencoded",data:n,success:function(n){var t=JSON.parse(n).ThumbInfo,f=t.GroupId,r=t.ThumbData,u=t.FrameInfoIds;i.updateScreenshotDTO(u,r)},error:function(){var n=this.data.substring(this.data.indexOf("=")+1);i.updateThumbUi(JSON.parse(n).FrameInfo[0].Id,"/BC/Product/Images/CMP/tabCrash.png","error")}})};ScreenshotHandler.prototype.updateThumbUi=function(n,t,r){for(var t,e=i._cmpModel.ceProject.sequence.screenshots.length,f=i._cmpModel.ceProject.sequence.screenshots,u=0;u<e;u++)f[u].id==n&&i._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.UPDATE_THUMB_UI,{detail:{index:u,thumbData:t,id:f[u].id,status:r}}))};ScreenshotHandler.prototype.updateScreenshotDTO=function(n,t){for(var o,u,e,r,t,f=0;f<n.length;f++)for(o=i._cmpModel.ceProject.sequence.screenshots.length,u=i._cmpModel.ceProject.sequence.screenshots,r=0;r<o;r++)u[r].id==n[f]&&(t!=null?(u[r].dataUri=t,t=u[r].dataUri,e="success"):(t="/BC/Product/Images/CMP/tabCrash.png",e="error"),this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.UPDATE_THUMB_UI,{detail:{index:r,thumbData:t,id:u[r].id,status:e}})));i._cmpModel.ceProject.sequence.screenshots=u};ScreenshotHandler.prototype.buildExtractionRequest=function(n){var r=n.detail.screenshots,t,s,u,f,e,c;CMPUtils.IsNullOrEmpty(r)&&(r=i.getCapturesRequiringExtraction());var l=r.length,o=i._mediaManager.getFrameRateBasedOnMode(),a=document.getElementById("hdnRanNum").value;for(t=0;t<l;t++)if(CMPUtils.IsNullOrEmpty(r[t].dataUri)){i._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.UPDATE_THUMB_UI,{detail:{index:t,thumbData:"/BC/Product/Images/Elements/spacer.png",id:r[t].id,status:"loading"}}));s=CMPUtils.convertSecondsToFrameCount(r[t].captureTimeSecs,o)+1;u=i.getClipUrl(r[t].clipOrderId);u=u.split("?");f=i.parseURL(u[0]);e=null;u[1]&&(e=u[1].split("=")[1]);var v=window.location.protocol+"//"+f.domain+"/ThumbnailExtraction/ThumbExtractor.aspx?Id="+e+"&action=SingleThumbExtract",h=[],y=new FrameInfo(r[t].id,r[t].id,f.path,s,o);h.push(y);c=new ExtractionRequest(h,i._cmpModel.secureInfo,0);i.sendExtractionRequest(JSON.stringify(c),v,a)}};ScreenshotHandler.prototype.getClipUrl=function(n){for(var u,r=i._cmpModel.sequenceClipInfo,f=r.length,t=0;t<f;t++)if(r[t]._clipUiId==n)return u=CMPUtils.getClipObjectWithClipUiId(r[t]._clipUiId,i._cmpModel.ceProject.bin.clips,i._cmpModel.sequenceClipInfo),clipThumbnailUrl=u.url};ScreenshotHandler.prototype.getCapturesRequiringExtraction=function(){for(var t=[],r=i._cmpModel.ceProject.sequence.screenshots,u=r.length,n=0;n<u;n++)i.checkIfExtractionRequired&&t.push(r[n]);return t};ScreenshotHandler.prototype.checkIfExtractionRequired=function(n){return CMPUtils.IsNullOrEmpty(n.dataUri)?!0:!1};ScreenshotHandler.prototype.parseURL=function(n){if(parsed_url={},n==null||n.length==0)return parsed_url;protocol_i=n.indexOf("://");parsed_url.protocol=n.substr(0,protocol_i);remaining_url=n.substr(protocol_i+3,n.length);domain_i=remaining_url.indexOf("/");domain_i=domain_i==-1?remaining_url.length-1:domain_i;parsed_url.domain=remaining_url.substr(0,domain_i);parsed_url.path=domain_i==-1||domain_i+1==remaining_url.length?null:remaining_url.substr(domain_i+1,remaining_url.length);domain_parts=parsed_url.domain.split(".");switch(domain_parts.length){case 2:parsed_url.subdomain=null;parsed_url.host=domain_parts[0];parsed_url.tld=domain_parts[1];break;case 3:parsed_url.subdomain=domain_parts[0];parsed_url.host=domain_parts[1];parsed_url.tld=domain_parts[2];break;case 4:parsed_url.subdomain=domain_parts[0];parsed_url.host=domain_parts[1];parsed_url.tld=domain_parts[2]+"."+domain_parts[3]}return parsed_url.parent_domain=parsed_url.host+"."+parsed_url.tld,parsed_url}}function TimelineMetadata(n,t,i){var r,f,e,u;this._nativeApi=n;this._cmpModel=t;this._eventDispatcher=document.getElementById(i);this._instanceId=i;this._lastFiredTemporalMetadataIndex=-1;r=1;f=.02;this.durationTimers;e={};e.delay=45;this.constant=e;this.restartTimer=!1;this.temporalValueCollection;this.temporalKeyCollection;this._injector=getCMPInstanceByInstanceId(i)._injector;this._mediaManager=this._injector.getInstance("mediaManager");u=this;TimelineMetadata.prototype.ResetLastFiredIndexAndClearTimers=function(){if(this._lastFiredTemporalMetadataIndex=-1,clearInterval(this.timeLineMetaDataTimer),this.durationTimers!=undefined)for(var n in this.durationTimers)clearInterval(this.durationTimers[n]),delete this.durationTimers[n]};TimelineMetadata.prototype.AddMarker=function(n){this.AddMarker(n)};TimelineMetadata.prototype.OnIntervalChange=function(){u.CheckForTemporalMetadata()};TimelineMetadata.prototype.CheckForTemporalMetadata=function(){if(this.temporalValueCollection!=null||this.temporalValueCollection!=undefined){var n=this._mediaManager.getCurrentTime(),t=this.FindTemporalMetadataByCurrentTime(n);t>-1&&this.CheckTemporalMetadata(t,n)}};TimelineMetadata.prototype.FindTemporalMetadataByCurrentTime=function(n){for(var i,u,r=-1,t=0;t<this.temporalValueCollection.length;t++)i=this.temporalValueCollection[t],u=i.time+i.duration,i.time<=n+f&&n-f<u&&(r=t);return r};TimelineMetadata.prototype.FindTemporalMetadata=function(n,t,i){if(n<=t){var r=parseInt((n+t)/2);return i==this.temporalKeyCollection[r]?r:i<this.temporalKeyCollection[r]?this.FindTemporalMetadata(n,r-1,i):this.FindTemporalMetadata(r+1,t,i)}return-n};TimelineMetadata.prototype.CheckTemporalMetadata=function(n,t){var u;if(!this.temporalValueCollection||!this.temporalValueCollection.length)return!1;if(u=!1,n!=this._lastFiredTemporalMetadataIndex){this._lastFiredTemporalMetadataIndex=n;this.DispatchTemporalEvents(n);var f=this.temporalKeyCollection[n],e=this.calcNextTime(n),i=(e-f)*250;i=i>r?i:r;f==e?(this.StartTimer(!1),this.restartTimer=!1):i!=this.constant.delay&&(this.resetInterval(),this.constant.delay=i,this.StartTimer());u=!0}else this.constant.delay!=r&&t+this.constant.delay/1e3>this.calcNextTime(n)&&(this.resetInterval(),this.constant.delay=r,this.StartTimer());return u};TimelineMetadata.prototype.DispatchTemporalEvents=function(n){var t=this.temporalValueCollection[n],i,u;this._eventDispatcher.dispatchEvent(new CustomEvent(TimelineMetadataEvent.MARKER_TIME_REACHED,{detail:{marker:t}}));t.duration>0&&(i=t.time+t.duration,this.durationTimers==null&&(this.durationTimers={}),u=this.durationTimers[t.time],CMPUtils.IsNullOrEmpty(u)||(clearInterval(this.durationTimers[t.time]),delete this.durationTimers[t.time]),this.durationTimers[t.time]=window.setInterval(function(n,t,i){return function(){n._mediaManager.getCurrentTime()>i&&(clearInterval(n.durationTimers[t.time]),delete n.durationTimers[t.time],n._eventDispatcher.dispatchEvent(new CustomEvent(TimelineMetadataEvent.MARKER_DURATION_REACHED,{detail:{marker:t}})))}}(this,t,i),r))};TimelineMetadata.prototype.AddMarker=function(n){n==null;this.AddValue(""+n.time,n)};TimelineMetadata.prototype.AddValue=function(n,t){var r=parseFloat(n),u=t,i;n==null||isNaN(r)||r<0||u==null;this.temporalValueCollection==null?(this.temporalKeyCollection=[],this.temporalKeyCollection.push(r),this.temporalValueCollection=[],this.temporalValueCollection.push(t)):(i=this.FindTemporalMetadata(0,this.temporalValueCollection.length-1,r),i<0?(i*=-1,this.temporalKeyCollection.splice(i,0,r),this.temporalValueCollection.splice(i,0,u)):i==0&&r!=this.temporalKeyCollection[0]?(this.temporalKeyCollection.splice(i,0,r),this.temporalValueCollection.splice(i,0,u)):(this.temporalKeyCollection[i]=r,this.temporalValueCollection[i]=u));this.enabled=!0};TimelineMetadata.prototype.RemoveValue=function(){this.reset(!1);this.temporalKeyCollection=null;this.temporalValueCollection=null};TimelineMetadata.prototype.calcNextTime=function(n){return this.temporalValueCollection[n+1<this.temporalKeyCollection.length?n+1:this.temporalKeyCollection.length-1].time};TimelineMetadata.prototype.StartTimer=function(n){n==undefined&&(n=!0);n?this.temporalValueCollection!=null&&this.temporalValueCollection.length>0&&this.restartTimer&&this.getEnabled()&&this._eventDispatcher.dispatchEvent(new CustomEvent(TimerEvent.TIMER,{detail:{currentTime:this._mediaManager.getCurrentTime()}})):clearInterval(this.timeLineMetaDataTimer)};TimelineMetadata.prototype.reset=function(n){this._lastFiredTemporalMetadataIndex=-1;this.restartTimer=!0;this.resetInterval();u.constant.delay=r;n&&this.StartTimer()};TimelineMetadata.prototype.resetInterval=function(){clearInterval(this.timeLineMetaDataTimer)};TimelineMetadata.prototype.resetTimelineMetadata=function(){this.clearTimedText();this._cmpModel.lastFiredTemporalMetadataIndex=-1};TimelineMetadata.prototype.RemoveMarker=function(n){return n==null,this.removeMarker(""+n.time)};TimelineMetadata.prototype.removeMarker=function(n){n==null;var r=Number(n),i=null,t=this.temporalValueCollection?this.FindTemporalMetadata(0,this.temporalValueCollection.length-1,r):-1;return t>=0&&(this.temporalKeyCollection.splice(t,1),i=this.temporalValueCollection.splice(t,1)[0],this.temporalValueCollection.length==0&&(this.reset(!1),this.temporalValueCollection=null,this.temporalKeyCollection=null)),i};this.enabled=!1;this.getEnabled=function(){return this.enabled==undefined&&(this.enabled=!1),this.enabled};this.setEnabled=function(n){this.enabled=n;this.reset(n)};this.setEnabled(!0);this._eventDispatcher.addEventListener(TimerEvent.TIMER,u.OnIntervalChange)}function PlaylistMetadata(n,t,i){var r=this;this._nativeApi=n;this._cmpModel=t;this._instanceId=i;this.markerCollection;this._eventDispatcher=document.getElementById(i);this.lastFiredIndex=-1;this._injector=getCMPInstanceByInstanceId(i)._injector;this._mediaManager=this._injector.getInstance("mediaManager");PlaylistMetadata.prototype.addMarker=function(n){this.markerCollection==null&&(this.markerCollection=[]);this.markerCollection.push(n)};PlaylistMetadata.prototype.onIntervalChange=function(){r.checkMarkerCollection()};PlaylistMetadata.prototype.isPlayingInForwardDirection=function(){return r._cmpModel.playbackSpeedRange[r._cmpModel.currentPlaybackSpeedIndex]>0};PlaylistMetadata.prototype.checkMarkerCollection=function(){var i=this._mediaManager.getCurrentTime(),u=this._mediaManager.getFrameRateBasedOnMode(),f=CMPUtils.RoundOffToNearestFrame(parseFloat(i),u);if(this.markerCollection!=null){var n=this.markerCollection[this.lastFiredIndex+1],t=r._cmpModel.playbackSpeedRange[r._cmpModel.currentPlaybackSpeedIndex]>0?"forward":"reverse",o=t=="forward"?n.time+n.duration:n.time,e=CMPUtils.RoundOffToNearestFrame(parseFloat(o),u);n!=null&&(f>=e&&i!=0&&t=="forward"||this.hasMarkerReachedMediaEnd()||f<=e&&t=="reverse")&&(t=="reverse"?this.lastFiredIndex=this.lastFiredIndex-1:this.lastFiredIndex+=1,this._eventDispatcher.dispatchEvent(new CustomEvent(PlaylistMetadataEvent.PLAYLIST_MARKER_DURATION_REACHED,{detail:{marker:n}})))}};PlaylistMetadata.prototype.resetIndex=function(n){for(var t=0;t<this.markerCollection.length;t++){var i=this.markerCollection[t],r=this._mediaManager.getFrameRateBasedOnMode(),u=CMPUtils.RoundOffToNearestFrame(i.time+i.duration,r);n=CMPUtils.RoundOffToNearestFrame(parseFloat(n),r);n>=i.time&&n<u&&(this.lastFiredIndex=t-1)}};PlaylistMetadata.prototype.reset=function(){this.lastFiredIndex=-1};PlaylistMetadata.prototype.removeValue=function(){this.markerCollection=null;this._eventDispatcher.removeEventListener(TimerEvent.TIMER,r.onIntervalChange)};PlaylistMetadata.prototype.removeEvent=function(){this._eventDispatcher.removeEventListener(TimerEvent.TIMER,this.onIntervalChange)};PlaylistMetadata.prototype.addEvent=function(){this._eventDispatcher.addEventListener(TimerEvent.TIMER,this.onIntervalChange)};PlaylistMetadata.prototype.hasMarkerReachedMediaEnd=function(){return this._cmpModel.isMediaDurationReached&&(this._nativeApi.GetCurrentState().toUpperCase()=="PAUSED"&&this._cmpModel.oldState=="PLAYING"||this._cmpModel.currentSegment.position==this.markerCollection.length)?!0:!1};this._eventDispatcher.addEventListener(TimerEvent.TIMER,this.onIntervalChange)}function Shortcut(){this.all_shortcuts={};this.func="";Shortcut.prototype.add=function(n,t,i){var f={type:"keydown",propagate:!1,disable_in_input:!0,target:document,keycode:!1},u,r,e;if(i)for(u in f)typeof i[u]=="undefined"&&(i[u]=f[u]);else i=f;r=i.target;typeof i.target=="string"&&(r=document.getElementById(i.target));e=this;n=n.toLowerCase();this.func=function(r){var o,e,s;if(r=r||window.event,!i.disable_in_input||(r.target?o=r.target:r.srcElement&&(o=r.srcElement),o.nodeType==3&&(o=o.parentNode),o.tagName!="INPUT"&&o.tagName!="TEXTAREA")){r.keyCode?code=r.keyCode:r.which&&(code=r.which);e=String.fromCharCode(code).toLowerCase();code==188&&(e=",");code==190&&(e=".");var h=n.split("+"),f=0,c={"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},l={esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},u={shift:{wanted:!1,pressed:!1},ctrl:{wanted:!1,pressed:!1},alt:{wanted:!1,pressed:!1},meta:{wanted:!1,pressed:!1}};for(r.ctrlKey&&(u.ctrl.pressed=!0),r.shiftKey&&(u.shift.pressed=!0),r.altKey&&(u.alt.pressed=!0),r.metaKey&&(u.meta.pressed=!0),s=0;k=h[s],s<h.length;s++)k=="ctrl"||k=="control"?(f++,u.ctrl.wanted=!0):k=="shift"?(f++,u.shift.wanted=!0):k=="alt"?(f++,u.alt.wanted=!0):k=="meta"?(f++,u.meta.wanted=!0):k.length>1?l[k]==code&&f++:i.keycode?i.keycode==code&&f++:e==k?f++:c[e]&&r.shiftKey&&(e=c[e],e==k&&f++);if(f==h.length&&u.ctrl.pressed==u.ctrl.wanted&&u.shift.pressed==u.shift.wanted&&u.alt.pressed==u.alt.wanted&&u.meta.pressed==u.meta.wanted&&(t(r),!i.propagate))return r.cancelBubble=!0,r.returnValue=!1,r.stopPropagation&&(r.stopPropagation(),r.preventDefault()),!1}};this.all_shortcuts[n]==undefined&&(this.all_shortcuts[n]={callback:this.func,target:r,event:i.type},r.addEventListener?r.addEventListener(i.type,this.func,!1):r.attachEvent?r.attachEvent("on"+i.type,this.func):r["on"+i.type]=this.func)};Shortcut.prototype.remove=function(n){var t;if(n=n.toLowerCase(),t=this.all_shortcuts[n],delete this.all_shortcuts[n],t){var r=t.event,i=t.target,u=t.callback;i.detachEvent?i.detachEvent("on"+r,u):i.removeEventListener?i.removeEventListener(r,u,!1):i["on"+r]=!1}};Shortcut.prototype.removeAll=function(){for(var n in this.all_shortcuts)this.remove(n)}}function ClearMediaPlayer(n,t,i,r){this._injector=null;this._nativeApi=null;this._cmpModel=null;this._nativeHandler=null;this._stateMachine=null;this._uiEventHandler=null;this._cmpEventHandler=null;this._playerType=n;this._playerInfoObj=JSON.parse(decodeURIComponent(escape(atob(t))));this._instanceId=i;this._secureInfoObj=r;this._sequenceManager=null;this._sequenceClipManager=null;this._annotationManager=null;this._nonAVManager=null;ClearMediaPlayer.prototype.initialiseInjector=function(){this._injector=new Injector};ClearMediaPlayer.prototype.initialiseNative=function(){var t=this._playerInfoObj,n="";CMPUtils.IsNullOrEmpty(t.MediaInfo)||(n=t.MediaInfo.AssetClass);switch(this._playerType){case"OSMF":this._nativeApi=n.toUpperCase()=="DOCUMENT"||n.toUpperCase()=="IMAGE"?new OSMFNonAvNativeAPI(this._instanceId):new OSMFNativePlayerAPI(this._instanceId);break;case"QT":this._nativeApi=new QtNativePlayerAPI(this._instanceId);break;case"HTML5":this._nativeApi=new HTML5NativePlayerAPI(this._instanceId);break;case"HTML5_v2":case"HTML5_v2_DASH":case"HTML5_v2_HLS":this._nativeApi=new VideoJSNativePlayerAPI(this._instanceId);break;default:throw"Exception";}this._injector.bindInstance("nativeApi",this._nativeApi)};ClearMediaPlayer.prototype.initialiseDataModel=function(){var t,i,n;if(this._cmpModel=new CMPModel,this._injector.bindInstance("cmpModel",this._cmpModel),this._cmpModel.playerInfo=this._playerInfoObj,this._cmpModel.supportedFeatures=this._nativeApi.GetSupportedFeatures(),this._cmpModel.preferenceSetting=new PreferenceSetting,!this._cmpModel.playerInfo.IsloadBlankPlayer&&!CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.MediaInfo.AssetClass))if(t=this._cmpModel.playerInfo.MediaInfo.AssetClass,playlistSubType=this._cmpModel.playerInfo.MediaInfo.PlaylistSubType,CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.sequenceInfo.SequenceXml)&&t.toUpperCase()!="PLAYLIST")if(CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.MediaInfo.SeekStart)||CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.MediaInfo.SeekEnd))switch(t){case"DOCUMENT":this._cmpModel.playerMode=PlayerMode.NON_AV_DOCUMENT;break;case"IMAGE":this._cmpModel.playerMode=PlayerMode.NON_AV_IMAGE;break;case"VIDEO":this._cmpModel.playerMode=PlayerMode.VIDEO;break;case"AUDIO":this._cmpModel.playerMode=PlayerMode.AUDIO;break;default:this._cmpModel.playerMode=PlayerMode.VIDEO}else this._cmpModel.playerMode=PlayerMode.STRATA;else{i=this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.SequenceDefaultMode;switch(i.toUpperCase()){case"SEQUENCEPREVIEW":this._cmpModel.playerMode=!CMPUtils.IsNullOrEmpty(playlistSubType)&&playlistSubType.toUpperCase()=="IMF"||this._cmpModel.playerInfo.sequenceInfo.IsSequencePlayBackOptimized?PlayerMode.SEQUENCE_CPL_PREVIEW:PlayerMode.SEQUENCE_PREVIEW;break;case"SEQUENCESEGMENTEDIT":this._cmpModel.playerMode=PlayerMode.SEQUENCE_SEGMENT_EDIT;break;case"SEQUENCECLIP":this._cmpModel.playerMode=PlayerMode.SEQUENCE_CLIP;break;default:this._cmpModel.playerMode=PlayerMode.SEQUENCE_CLIP}}this._cmpModel.playerMode==PlayerMode.STRATA&&(this._cmpModel._playerInfo.MediaInfo.IslastPlayBackTimeEnabled=!1);this._cmpModel.playbackSpeedRange=this.getSupportedPlaybackRateRange();this._cmpModel.currentPlaybackSpeedIndex=CMPUtils.getDefaultSpeedIndex(this._cmpModel.playbackSpeedRange);this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.EnableTimelineThumbnail&&this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.EnableTimelineThumbnail.toUpperCase()==="TRUE"&&(n={},n.sequenceHandle=this._instanceId+"_ClearMediaPlayer",n.sliderId=CMPUtils.getSliderElement(this._instanceId),n.viewportId=CMPUtils.getViewPortElement(this._instanceId),n.isFramePreviewEnabled=!0,n.secureInfo=MasterVar.secureInfo,n.enableTimecodeDisplay=!0,this._cmpModel.timelinethumbnail=new TimelineThumbnailController(n));this._cmpModel._playerInfo.UserPreferredSetting.rememberViewerSettings&&this.setViewerSetting()};ClearMediaPlayer.prototype.getSupportedPlaybackRateRange=function(){for(var i,r=this._cmpModel.supportedFeatures,t,n=0;n<r.length;n++)if(supportedFeature=r[n],supportedFeature.indexOf("SetPlaybackSpeed:")>-1){if(i=supportedFeature.split(":")[1],!CMPUtils.IsNullOrEmpty(i)){for(t=i.split(","),n=0;n<t.length;n++)t[n]=parseFloat(t[n]);return t}break}return[-4,-3,-2,.5,1,2,3,4]};ClearMediaPlayer.prototype.initialiseStateMachine=function(){this._stateTransitionHandler=new StateTransitionHandler(this._injector,this._instanceId,this._secureInfoObj);this._stateMachine=new StateMachine(this._stateTransitionHandler,this._instanceId,this._cmpModel);this._injector.bindInstance("stateMachine",this._stateMachine);this._loadTimeManager=new LoadTimeManager(this._injector,this._instanceId);this._injector.bindInstance("loadTimeManager",this._loadTimeManager)};ClearMediaPlayer.prototype.initialiseManagers=function(){this._timelineManager=new TimelineManager(this._nativeApi,this._cmpModel,this._instanceId);this._injector.bindInstance("timelineManager",this._timelineManager);this._mediaManager=new MediaManager(this._nativeApi,this._cmpModel,this._instanceId,this._injector);this._injector.bindInstance("mediaManager",this._mediaManager);this._audioManager=new AudioManager(this._injector,this._instanceId);this._injector.bindInstance("audioManager",this._audioManager);this._sequenceManager=new SequenceManager(this._cmpModel,this._instanceId,this._nativeApi);this._injector.bindInstance("sequenceManager",this._sequenceManager);this._sequenceClipManager=new SequenceClipManager(this._nativeApi,this._cmpModel,this._instanceId);this._injector.bindInstance("sequenceClipManager",this._sequenceClipManager);this.initialiseDataManager();this._injector.bindInstance("transportManager",this._transportManager);this._errorManager=new ErrorManager(this._injector,this._cmpModel,this._instanceId);var t=new NonAVManager(this._injector,this._instanceId),n="";CMPUtils.IsNullOrEmpty(this._cmpModel._mediaInfo)||(n=this._cmpModel.playerInfo.MediaInfo.AssetClass.toUpperCase());n=="DOCUMENT"?(DocumentManager.prototype=t,this._nonAVManager=new DocumentManager(this._injector)):n=="IMAGE"&&(ImageManager.prototype=t,this._nonAVManager=new ImageManager(this._injector));this._injector.bindInstance("nonAVManager",this._nonAVManager);this._injector.bindInstance("errorManager",this._errorManager);this._annotationManager=new AnnotationManager(this._injector,this._nativeApi,this._cmpModel,this._instanceId);this._injector.bindInstance("annotationManager",this._annotationManager)};ClearMediaPlayer.prototype.initialiseEventHandlers=function(){this._uiEventHandler=new UIEventHandler(this._injector,this._instanceId);this._cmpEventHandler=new CMPEventHandler(this._injector,this._instanceId);this._nativeHandler=new NativeHandler(this._stateMachine);this._injector.bindInstance("nativeHandler",this._nativeHandler)};ClearMediaPlayer.prototype.loadUI=function(){if(this.updateTransportBarUi(),!CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.MediaInfo)&&!CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.MediaInfo.AssetClass)&&!CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.sequenceInfo.SequenceXml)){var n=CMPUtils.getClearEditorProjectObject(this._cmpModel.playerInfo.sequenceInfo.SequenceXml,this._cmpModel);if(this._cmpModel.ceProject=n[0],this._cmpModel.sequenceClipInfo=n[1],this._cmpModel.playerMode!=PlayerMode.SEQUENCE_CPL_PREVIEW||CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.sequenceInfo.VideoSequenceXml)||(n=CMPUtils.getClearEditorProjectObject(this._cmpModel.playerInfo.sequenceInfo.VideoSequenceXml,this._cmpModel),this._cmpModel.ceProjectForVideo=n[0],this._cmpModel.sequenceClipInfoForVideo=n[1]),this._sequenceManager.checkIfMixedFramerate(this._cmpModel.ceProject.bin.clips))if(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.EnableMixedFrameRateSupport=="true")this._sequenceManager.setAndDispatchOnFrameRateChanged(this._cmpModel.ceProject.bin.clips);else{showErrorDetails("Mixed framerate support is disabled","0");return}CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.sequenceInfo.IsSequencePlayBackOptimized)||(this._cmpModel.isSequencePlayBackOptimized=this._cmpModel.playerInfo.sequenceInfo.IsSequencePlayBackOptimized,this._cmpModel.optimizedSequenceUrl=this._cmpModel.playerInfo.sequenceInfo.OptimizedSequenceUrl);document.getElementById(this._instanceId)!=null&&document.getElementById(this._instanceId).dispatchEvent(new CustomEvent(SequenceEvent.CEPROJECT_LOADED,{detail:{ceProjectObject:this._cmpModel.ceProject,sequenceClipInfo:this._cmpModel.sequenceClipInfo,currentClipOrderId:this._cmpModel.currentClipOrderId,isMixedFrameRate:this._cmpModel.isMixedFrameRate}}))}CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.MediaInfo)||(CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.MediaInfo.AssetClass)||this._cmpModel.playerInfo.MediaInfo.AssetClass.toUpperCase()!="DOCUMENT")&&this._cmpModel.playerInfo.MediaInfo.AssetClass.toUpperCase()!="IMAGE"||(this._cmpModel.nonAVMediaInfo=this._nonAVManager.getNonAvInfo(this._cmpModel.playerInfo.NonAvInfo))};this.getInjector=function(){return this._injector};this.getNativeInstanceId=function(){return this._instanceId+"_ClearMediaPlayer"};this.getNativeHandler=function(){return this._nativeHandler};ClearMediaPlayer.prototype.init=function(){this.initialiseInjector();this.changeUrlsProtocol();this.checkAndGetLiveUrlForPftdemoCatalog();this.initialiseNative();this.initialiseDataModel();this.initialiseManagers();this.initialiseStateMachine();this.initialiseEventHandlers();this.loadUI()};ClearMediaPlayer.prototype.disposeCMPEvents=function(){var n,t;if(this.clearTimer(),this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableGlobalShortcut"]=="true")for(n=0;n<this._shortcutManager.globalArrOfShortcutObject.length;n++)t=this._shortcutManager.globalArrOfShortcutObject[n],t.removeAll();typeof this._nativeApi.DisposePlayerInstace!="undefined"&&this._nativeApi.DisposePlayerInstace()};ClearMediaPlayer.prototype.clearTimer=function(){document.getElementById(this._instanceId).dispatchEvent(new CustomEvent(TimerEvent.CLEAR_TIMER));clearInterval(this._cmpModel.clearMediaPlayerTimer);clearInterval(this._cmpModel.transportBarSliderUpdationTimer);clearInterval(this._cmpModel.liveDurtionUpdationTimer);this!=undefined&&this!=null&&this._cmpModel!=undefined&&this._cmpModel!=null&&(this.clearData(),this._cmpModel._segmentTimelineMetadata!=null&&this._cmpModel._segmentTimelineMetadata.ResetLastFiredIndexAndClearTimers(),this._cmpModel.bufferingTimer&&clearInterval(this._cmpModel.bufferingTimer))};ClearMediaPlayer.prototype.changeUrlsProtocol=function(){var e=this._playerInfoObj.MediaInfo,i=this._playerInfoObj.TimedTextCollection,r=this._playerInfoObj.AudioCollection,u=this._playerInfoObj.NonAvInfo,n,f,t;if(CMPUtils.IsNullOrEmpty(e)||(n=CMPUtils.parseURL(e.MediaUrl),e.MediaUrl=window.location.protocol==n.protocol?n.href:n.href.replace(n.protocol,window.location.protocol)),i!=null&&i.length>0)for(f=0;f<i.length;f++)n=CMPUtils.parseURL(i[f].Url),i[f].Url=window.location.protocol==n.protocol?n.href:n.href.replace(n.protocol,window.location.protocol);if(r!=null&&r.length>0)for(t=0;t<r.length;t++)n=CMPUtils.parseURL(r[t].Url),r[t].Url=window.location.protocol==n.protocol?n.href:n.href.replace(n.protocol,window.location.protocol);if(u!=null&&u.length>0)for(t=0;t<u.length;t++)n=CMPUtils.parseURL(u[t].MediaUrl),u[t].MediaUrl=window.location.protocol==n.protocol?n.href:n.href.replace(n.protocol,window.location.protocol);this._playerInfoObj.MediaInfo=e;this._playerInfoObj.TimedTextCollection=i;this._playerInfoObj.AudioCollection=r;this._playerInfoObj.NonAvInfo=u};ClearMediaPlayer.prototype.checkAndGetLiveUrlForPftdemoCatalog=function(){var i,n,t;try{document.getElementById("hdnTenantName")&&(i=this._instanceId.replace("CMP_",""),n=$(this._instanceId+"_hdnDmGuid").value,document.getElementById("hdnTenantName").value.toUpperCase()=="PFTDEMO"&&i.toUpperCase()=="CATALOGPLAYERV2CONTAINER"&&(n=="3737647"||n=="3679370"||n=="6983552"||n=="6983576")&&document.getElementById("pftdemoMappingUrl")&&(CMPUtils.IsNullOrEmpty(document.getElementById("pftdemoMappingUrl").value)||(t=CMPUtils.parseURL(document.getElementById("pftdemoMappingUrl").value),this._playerInfoObj.MediaInfo.MediaUrl=window.location.protocol==t.protocol?t.href:t.href.replace(t.protocol,window.location.protocol))))}catch(r){}};ClearMediaPlayer.prototype.setViewerSetting=function(){var n=this._cmpModel._preferenceSetting,t;n.rememberViewerSettings=this._cmpModel._playerInfo.UserPreferredSetting.rememberViewerSettings;CMPUtils.IsNullOrEmpty(this._cmpModel._playerInfo.UserPreferredSetting.viewerSettings)||(n.viewerSettings=JSON.parse(this._cmpModel._playerInfo.UserPreferredSetting.viewerSettings));t=this._cmpModel.playerMode;switch(t){case PlayerMode.NON_AV_DOCUMENT:break;case PlayerMode.NON_AV_IMAGE:break;default:this._cmpModel.volume=CMPUtils.getPropertyValue(n.viewerSettings.playerPreferencesSettings.avViewer.common.volumeLevel,this._cmpModel.volume)}};ClearMediaPlayer.prototype.initialiseDataManager=function(){this._transportManager=new TransportManager(this._injector,this._instanceId);this._dataManager=new DataManager(this._injector,this._instanceId);this._configManager=new ConfigurationManager(this._cmpModel);this._shortcutManager=new ShortcutManager(this._cmpModel,this._instanceId);this._tagPointerManager=new TagPointerManager(this._injector,this._instanceId)};ClearMediaPlayer.prototype.clearData=function(){this._cmpModel._annotationTimelineMetadata!=null&&this._cmpModel._annotationTimelineMetadata.ResetLastFiredIndexAndClearTimers();this._cmpModel._timedTextTrackTimelineMetadata!=null&&this._cmpModel._timedTextTrackTimelineMetadata.ResetLastFiredIndexAndClearTimers();this._cmpModel.audioTracksCollection!=null&&(this._cmpModel.audioTracksCollection=null);this._cmpModel.markerCollection!=null&&(this._cmpModel.markerCollection=[]);document.getElementById(this._instanceId).dispatchEvent(new CustomEvent(ShortCutEvent.REMOVE_ALL_SHORTCUT))};ClearMediaPlayer.prototype.updateTransportBarUi=function(){this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.markerCanvasJson!=""&&this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.markerCanvasJson!=undefined&&document.getElementById(this._instanceId).dispatchEvent(new CustomEvent(MarkerEvent.ADD_MARKERVALUES,{detail:{markerCanvasJson:this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.markerCanvasJson}}));this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.defaultSequenceSom!=""&&this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.defaultSequenceSom!=undefined&&(this._cmpModel.defaultSequenceSom=this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.defaultSequenceSom);document.getElementById(this._instanceId).dispatchEvent(new CustomEvent(ConfigurationEvent.SET_CONFIGURATION,{detail:{displayUiElements:this._cmpModel.playerInfo.CMPConfig,supportedFeatures:this._cmpModel.supportedFeatures,mediaInfo:this._cmpModel.mediaInfo,playerMode:this._cmpModel.playerMode,preferenceSetting:this._cmpModel._preferenceSetting}}))};ClearMediaPlayer.prototype.resetPlayerInfoAndUi=function(n){var t=JSON.parse(decodeURIComponent(escape(atob(n))));this.clearData();this._cmpModel.playerInfo.CMPConfig=t.CMPConfig;this._cmpModel.playerInfo.AnnotationCollection=t.AnnotationCollection;this._cmpModel.playerInfo.AudioCollection=t.AudioCollection;this._cmpModel.playerInfo.MarkerCanvasCollection=t.MarkerCanvasCollection;this._cmpModel.playerInfo.TimedTextCollection=t.TimedTextCollection;document.getElementById(this._instanceId).dispatchEvent(new CustomEvent(ConfigurationEvent.RESET_UI_CONTROLS,{detail:{CMPConfig:this._cmpModel.playerInfo.CMPConfig}}));this.initialiseDataManager();this.updateTransportBarUi();this.updateEmbeddedAudioTracks();document.getElementById(this._instanceId).dispatchEvent(new CustomEvent(LoadEvent.CMP_READY));this._cmpModel.autoPlay==!0&&(document.getElementById(this._instanceId).dispatchEvent(new CustomEvent(TransportEvent.PLAY)),this._cmpModel.autoPlay=!1)};ClearMediaPlayer.prototype.updateEmbeddedAudioTracks=function(){var n=this._nativeApi.GetEmbeddedAudioTracks(),t=JSON.parse(atob(n)).AudioTracks;this._audioManager.addEmbeddedAudioTracks(t);this._audioManager.switchAudioTracks(-1)}}function Injector(){this.instances={}}function AnnotationManager(n,t,i,r){this._stateMachine=n;this._cmpModel=t;this._instanceId=r;this._nativeApi=i;this._eventDispatcher=document.getElementById(r);this._injector=getCMPInstanceByInstanceId(r)._injector;this._mediaManager=this._injector.getInstance("mediaManager");var u=this;AnnotationManager.prototype.addAnnotationsToTimeline=function(){u._cmpModel.annotationTimelineMetadata=new TimelineMetadata(u._nativeApi,u._cmpModel,u._instanceId);u._cmpModel.annotationCollection.length>0&&u._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.SHOW_ANNOTATION_MENU));for(var n=0;n<u._cmpModel.annotationCollection.length;n++)u._cmpModel.annotationTimelineMetadata.AddMarker(u._cmpModel.annotationCollection[n])};AnnotationManager.prototype.onShowAnnotation=function(n){var t,i,r;if(u._cmpModel.annotationCollection!=null&&n!=null){for(t="",i=0;i<u._cmpModel.annotationCollection.length;i++)n.time==u._cmpModel.annotationCollection[i].time&&(t=t+"COMMENT: "+u._cmpModel.annotationCollection[i].annotationComments+"\n");t!=""&&u._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.SHOW_ANNOTATION,{detail:{remark:t}}));r={};r.time=n.time;r.remarks=n.annotationComments;u._cmpModel.currentAnnotationDetails=r}};AnnotationManager.prototype.onHideAnnotation=function(n){if(u._cmpModel.annotationCollection!=null&&n!=null)for(var t=0;t<u._cmpModel.annotationCollection.length;t++)n.time==u._cmpModel.annotationCollection[t].time&&u._cmpModel.annotationCollection[t].time==u._cmpModel.currentAnnotationDetails.time&&u._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.HIDE_ANNOTATION))};AnnotationManager.prototype.onPointAnnotation=function(){u._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:AnnotationEvent.POINT_ANNOTATION}}))};AnnotationManager.prototype.onMarkIn=function(){CMPUtils.getPlaybackDirection(u._cmpModel.playbackSpeedRange,u._cmpModel.currentPlaybackSpeedIndex)!="reverse"&&u._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:AnnotationEvent.MARK_IN}}))};AnnotationManager.prototype.onMarkOut=function(){CMPUtils.getPlaybackDirection(u._cmpModel.playbackSpeedRange,u._cmpModel.currentPlaybackSpeedIndex)!="reverse"&&u._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:AnnotationEvent.MARK_OUT}}))};AnnotationManager.prototype.onRemoveMarker=function(){u._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.Enable"]=="true"&&(u._cmpModel.marker=null,u._cmpModel.isFineTuningInProgress=!1,u._cmpModel.markInPosition=null,u._cmpModel.isMarkOutDone=!1,u._cmpModel.isPlayerInEditMode=!1,u._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.RESET_MARKER_BUTTONS)),u._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.REMOVE_MARKER)))};AnnotationManager.prototype.saveAnnotation=function(n){var t=this.createCustomMarker(n),i=new MarkerManager(u._cmpModel).createMarker(null,null,n);u._cmpModel.isFineTuningInProgress=!1;u._cmpModel.markInPosition=null;u._cmpModel.isMarkOutDone=!1;u._cmpModel.isPlayerInEditMode=!1;u._cmpModel.playerInfo.CMPConfig.CMPConfigValue.EnableAnnotationDisplay=="true"&&u.addAnnotation(t)};AnnotationManager.prototype.createCustomMarker=function(n){var t={};return t.markIn=this._cmpModel.marker._markIn,t.markOut=this._cmpModel.marker._markOut,t.message=n,t.id=this._cmpModel.marker.id,t};AnnotationManager.prototype.addAnnotation=function(n){var n=n,t,r,i;this._cmpModel.annotationTimelineMetadata==null&&(this._cmpModel.annotationTimelineMetadata=new TimelineMetadata(this._nativeApi,this._cmpModel,this._instanceId));t=[];this._cmpModel.annotationCollection!=null&&(t=this._cmpModel.annotationCollection);r=parseInt(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.AnnotationDisplaySeconds);i=new Annotation(n.markIn,n.markOut,n.message,n.markIn,r);t.push(i);this._cmpModel.annotationCollection=t;this._cmpModel.annotationTimelineMetadata.AddMarker(i)};AnnotationManager.prototype.editAnnotation=function(n,t,i){for(var f=u._mediaManager.getFrameRateBasedOnMode(),e=parseInt(u._cmpModel.playerInfo.CMPConfig.CMPConfigValue.AnnotationDisplaySeconds),r=0;r<u._cmpModel.annotationCollection.length;r++)CMPUtils.RoundOffToNearestFrame(u._cmpModel.annotationCollection[r].startTimeCode,f)==CMPUtils.RoundOffToNearestFrame(n,f)&&CMPUtils.RoundOffToNearestFrame(u._cmpModel.annotationCollection[r].endTimeCode,f)==CMPUtils.RoundOffToNearestFrame(t,f)&&(u._cmpModel.annotationCollection[r].annotationComments=i)};AnnotationManager.prototype.removeAnnotation=function(n,t){for(var s,h,e=0,f=-1,o=null,r=u._mediaManager.getFrameRateBasedOnMode(),i=0;i<u._cmpModel.annotationCollection.length;i++)s=CMPUtils.RoundOffToNearestFrame(u._cmpModel.annotationCollection[i].startTimeCode,r),h=CMPUtils.RoundOffToNearestFrame(u._cmpModel.annotationCollection[i].endTimeCode,r),s==CMPUtils.RoundOffToNearestFrame(n,r)&&(e++,h==CMPUtils.RoundOffToNearestFrame(t,r)&&(f=i,o=u._cmpModel.annotationCollection[i]));f>-1&&u._cmpModel.annotationCollection.splice(f,1);e==1&&(u._cmpModel.annotationTimelineMetadata.RemoveMarker(o),u._cmpModel.timedTextTrackTimelineMetadata.ResetLastFiredIndexAndClearTimers(),u._cmpModel.timedTextTrackTimelineMetadata.reset(!0),u._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.HIDE_ANNOTATION)))};AnnotationManager.prototype.fineTuneSave=function(){u._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:AnnotationEvent.FINETUNE_SAVE}}))};AnnotationManager.prototype.resetAnnotationTimelineMetadata=function(){u._cmpModel.annotationTimelineMetadata!=null&&(u._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.HIDE_ANNOTATION)),u._cmpModel.annotationTimelineMetadata.ResetLastFiredIndexAndClearTimers(),u._cmpModel.annotationTimelineMetadata.reset(!0))};AnnotationManager.prototype.enableMarkerEditMode=function(n){(n.detail.isContiguous!=null||n.detail.isContiguous!=undefined)&&(u._cmpmodel.isContiguous=n.detail.isContiguous);u._cmpModel.isPlayerInEditMode=!0};AnnotationManager.prototype.setPlayerEditMode=function(){u._cmpModel.isPlayerInEditMode=!0};AnnotationManager.prototype.setMarkInPosition=function(n){u._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:AnnotationEvent.SET_MARK_IN_POSITION,markInTime:n.detail.markInTime,markOutTime:n.detail.markOutTime}}))};AnnotationManager.prototype.setMarkOutPosition=function(n){u._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:AnnotationEvent.SET_MARK_OUT_POSITION,markInTime:n.detail.markInTime,markOutTime:n.detail.markOutTime}}))};AnnotationManager.prototype.seekToAccumulatedTimeOnFrameSeek=function(){u._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:AnnotationEvent.SEEK_TO_ACCUMULATED_TIME_ON_FRAME_SEEK}}))};AnnotationManager.prototype.createScte35Segment=function(n){var t=this._mediaManager.getFrameRateBasedOnMode(),i=this._cmpModel.mediaInfo,o=n.detail.scteDuration,s=n.detail.type,f=this._mediaManager.getCurrentTime(),r=f,u=f+1/t;new MarkerManager(this._cmpModel).createMarker(r,u);this._cmpModel.isMarkOutDone=!0;var e=CMPUtils.ConvertTimeCodeToSecs(i.som,t,i.timecodeDisplayFormat),h=CMPUtils.ConvertSecondsToTimeCode(r+e,t,i.timecodeDisplayFormat),c=CMPUtils.ConvertSecondsToTimeCode(r,t,i.timecodeDisplayFormat),l=CMPUtils.ConvertSecondsToTimeCode(u+e,t,i.timecodeDisplayFormat),a=CMPUtils.ConvertSecondsToTimeCode(u,t,i.timecodeDisplayFormat);this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.CREATE_SCTE35_SEGMENT,{detail:{scte35StartTimeInSecs:r,scte35EndTimeInSecs:u,scte35StartTimeTCWithSOM:h,scte35EndTimeTCWithSOM:l,scte35StartTimeTCWithoutSOM:c,scte35EndTimeTCWithoutSOM:a,scte35duration:o,scte35Type:s}}))}}function AudioManager(n,t){this._nativeApi=n.getInstance("nativeApi");this._cmpModel=n.getInstance("cmpModel");this._timelineManager=n.getInstance("timelineManager");this._mediaManager=n.getInstance("mediaManager");this._eventDispatcher=document.getElementById(t);this._instanceId=t;var i=this;AudioManager.prototype.switchAudioTracks=function(n){for(var u,f,e,t,r=0;r<i._cmpModel.audioTracksCollection.length;r++)i._cmpModel.audioTracksCollection[r].index.toString()==n&&(t=i._cmpModel.audioTracksCollection[r]);if(i._cmpModel.externalAudioTrackIndex!=undefined&&i._cmpModel.externalAudioTrackIndex.toString()!="-1"){for(r=0;r<i._cmpModel.audioTracksCollection.length;r++)i._cmpModel.audioTracksCollection[r].index.toString()==i._cmpModel.externalAudioTrackIndex&&(u=i._cmpModel.audioTracksCollection[r]);i._nativeApi.RemoveAudioEssenceSource(u);i._cmpModel.externalAudioTrackIndex=-1;i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SHOW_HIDE_SPEED_CONTROLS,{detail:{display:!0}}))}n==-1?(this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&this._cmpModel.audioTimeline!=null&&this._cmpModel.audioTimeline.removeValue(),i._cmpModel.lastPlayedAudioTrackType="Embedded",i._nativeApi.SelectEmbeddedAudioTrack(-1),i._nativeApi.SetVolume(i._cmpModel.volume)):t.type=="External"?(i._cmpModel.lastPlayedAudioTrackType=="Embedded"&&i._nativeApi.SetVolume(0),this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&(this._cmpModel.ceProjectForAudio=t.audioCEProject,this._cmpModel.sequenceClipInfoForAudio=t.sequenceClipInfoForAudio,this._cmpModel.audioTimeline!=null?this._cmpModel.audioTimeline.removeValue():this._cmpModel.audioTimeline=new PlaylistMetadata(this._nativeApi,this._cmpModel,this._instanceId),this._timelineManager.addMarkersToTimeline(this._cmpModel.ceProjectForAudio.sequence,this._cmpModel.audioTimeline,TimelineType.AUDIO)),i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SHOW_HIDE_SPEED_CONTROLS,{detail:{display:!1}})),i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.RESET_PLAYBACK_SPEED)),i._cmpModel.externalAudioTrackIndex=i._nativeApi.AddAudioEssenceSource(t),i._nativeApi.SetVolume(i._cmpModel.volume),i._cmpModel.lastPlayedAudioTrackType="External",this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&(f=this._mediaManager.getCurrentTime(),e=CMPUtils.RoundOffToNearestFrame(f,this._mediaManager.getFrameRateBasedOnMode())*1e3,this._mediaManager.seek(e))):(this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&this._cmpModel.audioTimeline!=null&&this._cmpModel.audioTimeline.removeValue(),i._cmpModel.lastPlayedAudioTrackType="Embedded",i._nativeApi.SelectEmbeddedAudioTrack(n),i._nativeApi.SetVolume(i._cmpModel.volume));typeof t!="undefined"&&i._eventDispatcher.dispatchEvent(new CustomEvent(AudioEvent.AUDIO_TRACK_SWITCHED,{detail:{audioEssenceId:t.audioEssenceId,audioTrackId:t.audioTrackId,index:t.index}}))};AudioManager.prototype.setVolume=function(n){i._cmpModel.volume=n;i._cmpModel._preferenceSetting.rememberViewerSettings&&(i._cmpModel._preferenceSetting.viewerSettings.playerPreferencesSettings.avViewer.common.volumeLevel=n);i._nativeApi.SetVolume(i._cmpModel.volume)};AudioManager.prototype.muteVolume=function(){i._nativeApi.SetVolume(0)};AudioManager.prototype.unMuteVolume=function(){i._nativeApi.SetVolume(i._cmpModel.volume)};AudioManager.prototype.LoadExternalAudioTracks=function(){var n=0;CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.CMPConfig)||CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.DefaultExtAudioTrackNumber"])||(n=this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.DefaultExtAudioTrackNumber"]);this._eventDispatcher.dispatchEvent(new CustomEvent(AudioEvent.BIND_EXTERNAL_AUDIO_TRACKS,{detail:{audioObject:this._cmpModel.audioTracksCollection,defaultTrackIndex:n}}))};AudioManager.prototype.loadAudioTracks=function(n){for(var r,e,o,u=0,f=[],s=!1,t=0;t<n.length;t++)n[t].language||(n[t].language="Track "+(t+1)),s=n[t].url==null&&n[t].type=="External",f.push(n[t]);if(s)this._cmpModel.audioTracksCollection=[];else if(this._cmpModel.audioTracksCollection)for(r=0;r<this._cmpModel.audioTracksCollection.length;r++)this._cmpModel.audioTracksCollection[r].type=="External"&&(this._cmpModel.externalAudioTrackIndex&&this._cmpModel.externalAudioTrackIndex.toString()!="-1"&&(this._cmpModel.externalAudioTrackIndex=String(n.length-1+r)),this._cmpModel.audioTracksCollection[r].index=String(n.length-1+r),f.push(this._cmpModel.audioTracksCollection[r]));for(this._cmpModel.audioTracksCollection=f,CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.CMPConfig)||CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.DefaultExtAudioTrackNumber"])||(u=this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.DefaultExtAudioTrackNumber"]),this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&(u=1),e=i._cmpModel.playerInfo.CMPConfig.CMPConfigValue.EnableEmbeddedAudioTracks.toLowerCase()=="true",o=i._cmpModel.playerInfo.CMPConfig.CMPConfigValue.EnableExternalAudioTracks.toLowerCase()=="true",t=0;t<this._cmpModel.audioTracksCollection.length;t++)(e||this._cmpModel.audioTracksCollection[t].type!="Embedded")&&(o||this._cmpModel.audioTracksCollection[t].type!="External")||this._cmpModel.audioTracksCollection[t].index.toString()=="-1"||(this._cmpModel.audioTracksCollection.splice(t,1),t--);this._eventDispatcher.dispatchEvent(new CustomEvent(AudioEvent.BIND_AUDIO_TRACKS,{detail:{audioObject:this._cmpModel.audioTracksCollection,isEmbeddedAudioTracksEnabled:e,isExternalAudioTracksEnabled:o,selectedIndex:u}}))};AudioManager.prototype.loadConfiguredAudioTrack=function(){var n=0,t,i;if(CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.CMPConfig)||CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.DefaultExtAudioTrackNumber"])||(n=this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.DefaultExtAudioTrackNumber"]),this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&(n=1),t=-1,!CMPUtils.IsNullOrEmpty(this._cmpModel.audioTracksCollection)&&n>0){for(i=0;i<this._cmpModel.audioTracksCollection.length;i++)if(this._cmpModel.audioTracksCollection[i].type=="External"&&(t++,t==n-1))break;this.switchAudioTracks(t)}};AudioManager.prototype.changeAudioTrack=function(n,t){for(var u=i._cmpModel.audioTracksCollection,f=u.length,r=0;r<f;r++)if(n==u[r].audioEssenceId&&t==u[r].audioTrackId){i.switchAudioTracks(u[r].index);break}};AudioManager.prototype.addEmbeddedAudioTracks=function(n){for(var u,r=[],t=0;t<n.length;t++)u=new AudioTrack("","",n[t].Language,n[t].Language,n[t].Url,n[t].Index,n[t].SourceType),r.push(u);i.loadAudioTracks(r)}}function ConfigurationManager(n){var t={};t.OnSaveAnnotation=n.playerInfo.CMPConfig.CMPConfigValue["Callbacks.OnSaveAnnotation"];t.OnSaveClips=n.playerInfo.CMPConfig.CMPConfigValue["Callbacks.OnSaveClips"];t.OnGetAutoMarkIn=n.playerInfo.CMPConfig.CMPConfigValue["Callbacks.OnGetAutoMarkIn"];n.callbacks=t;n.enableContiguousSegments=n.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableContiguousSegments"]}function DataManager(n,t){var f,i,v,e,s,r,h,u,c,l,a,y,o,p;if(this._cmpModel=n.getInstance("cmpModel"),this._eventDispatcher=document.getElementById(t),this._instanceId=t,this._timelineMetadata=null,this._nativeApi=n.getInstance("nativeApi"),this._audioManager=n.getInstance("audioManager"),this._mediaManager=n.getInstance("mediaManager"),this._timelineManager=n.getInstance("timelineManager"),f=this,DataManager.prototype.BuildAnnotationCollection=function(){for(var t=[],n=0;n<this._cmpModel.playerInfo.AnnotationCollection.length;n++){var i=CMPUtils.ConvertTimeCodeToSecs(this._cmpModel.playerInfo.AnnotationCollection[n].StartTimeCode,this._mediaManager.getFrameRateBasedOnMode(),this._cmpModel.mediaInfo.timecodeDisplayFormat),r=CMPUtils.ConvertTimeCodeToSecs(this._cmpModel.playerInfo.AnnotationCollection[n].EndTimeCode,this._mediaManager.getFrameRateBasedOnMode(),this._cmpModel.mediaInfo.timecodeDisplayFormat),u=i,f=r>0?parseInt(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.AnnotationDisplaySeconds):NaN,e=new Annotation(i,r,this._cmpModel.playerInfo.AnnotationCollection[n].AnnotationComments,u,f);t.push(e)}return t},DataManager.prototype.getStreamBitRates=function(){var t=document.getElementById(f._instanceId+"_nativePlayerType").value,n;t.toUpperCase()!="QT"&&f._cmpModel.supportedFeatures.contains("GetStreamBitrates")&&(n=JSON.parse(atob(f._nativeApi.GetStreamBitrates())),f._eventDispatcher.dispatchEvent(new CustomEvent(StreamEvent.BIND_BIT_RATES,{detail:{streamBitRates:n,assetClass:f._cmpModel.mediaInfo.assetClass}})))},DataManager.prototype.setStreamBitrate=function(n){var t=f._nativeApi.SetStreamBitrate(n.detail.index)},this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.EnableAutoPlay!=null&&this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.EnableAutoPlay.toLowerCase()=="true"&&(this._cmpModel.autoPlay=!0),this._cmpModel.playerInfo.MediaInfo!=null&&(mediaInfo=new MediaInfo(this._cmpModel.playerInfo.MediaInfo),this._cmpModel.mediaInfo=mediaInfo),this._cmpModel.playerInfo.AnnotationCollection!=null&&(this._cmpModel.annotationCollection=this.BuildAnnotationCollection()),this._cmpModel.supportedFeatures.contains("DisplayTimedText")&&(i=this._cmpModel.playerInfo.TimedTextCollection,v=this._cmpModel.playerInfo.CMPConfig,i!=null&&i.length>0)){for(this._cmpModel.timedTextTrackTimelineMetadata==null&&(this._cmpModel.timedTextTrackTimelineMetadata=new TimelineMetadata(this._nativeApi,this._cmpModel,this._instanceId)),v!=null&&(e=v.CMPConfigValue["VideoPanelConfig.DefaultTTTNumber"],this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&playlistSubType.toUpperCase()=="IMF"&&(e=1),e==undefined&&(e=0)),s=[],r=0;r<i.length;r++)extension=i[r].Extension,frameRate=i[r].FrameRate,language=i[r].Language,offsettime=i[r].OffsetTime,timedTextType=i[r].TimedTextType,url=i[r].Url,version=i[r].Version,s.push(new TimedTextTrack(timedTextType,language,url,offsettime,frameRate,extension,null,version));this._cmpModel.timedTextTrackCollection=s;this._cmpModel._formattingObject=new FormattingObject;this._eventDispatcher.dispatchEvent(new CustomEvent(TTTEvent.BIND_TIMED_TEXT_TRACKS,{detail:{timedTextTrackCollection:s,defaultTTTNumber:e}}))}if(this._cmpModel.supportedFeatures.contains("AddAudioEssenceSource")&&this._cmpModel.playerInfo.AudioCollection!=null&&this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.EnableExternalAudioTracks=="true"){for(h=[],u=0;u<this._cmpModel.playerInfo.AudioCollection.length;u++)l=null,a=null,this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW?(y=CMPUtils.getClearEditorProjectObject(this._cmpModel.playerInfo.AudioCollection[u].PlaybackCloudXml,this._cmpModel),c=y[0],l=y[1],o=CMPUtils.getClipObjectWithClipUiId(this._timelineManager.getNextSegmentOfCeProject(1,c).clipOrderId,c._bin._clips,l),a=document.getElementById("hdnIsTokenIdRequired").value.toLowerCase()=="false"?o.url:o.url.toLowerCase().contains("?id=")?o.url:o.url+"?id="+this._cmpModel.playerInfo.TokenId):a=this._cmpModel.playerInfo.AudioCollection[u].Url,p=new AudioTrack(this._cmpModel.playerInfo.AudioCollection[u].AudioEssenceId,this._cmpModel.playerInfo.AudioCollection[u].AudioTrackId,this._cmpModel.playerInfo.AudioCollection[u].AudioEssenceTitle,this._cmpModel.playerInfo.AudioCollection[u].Language,a,u,"External",c,l),h.push(p);h.length>0&&this._audioManager.loadAudioTracks(h)}this._eventDispatcher.addEventListener(StreamEvent.SET_STREAM_BIT_RATE,this.setStreamBitrate);this._eventDispatcher.addEventListener(StreamEvent.GET_STREAM_BIT_RATES,this.getStreamBitRates)}function LoadTimeManager(n,t){var i=this;this._nativeApi=n.getInstance("nativeApi");this._cmpModel=n.getInstance("cmpModel");this._stateMachine=n.getInstance("stateMachine");this._eventDispatcher=document.getElementById(t);this._instanceId=t;this._mediaManager=n.getInstance("mediaManager");this._sequenceManager=n.getInstance("sequenceManager");LoadTimeManager.prototype.setMediaResource=function(n,t){CMPUtils.IsNullOrEmpty(t)||(i._cmpModel.autoPlay=t);this._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:LoadEvent.SET_MEDIA_SOURCE,url:n}}))};LoadTimeManager.prototype.removeMediaSource=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:LoadEvent.UNLOAD_MEDIA_URL}}))};LoadTimeManager.prototype.setSegmentInfo=function(){this._cmpModel.mediaDuration=this._mediaManager.getMediaDuration();this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.SET_MEDIA_DURATION,{detail:{duration:this._cmpModel.mediaDuration}}));this.updateMediaInfo();document.getElementById(this._instanceId).dispatchEvent(new CustomEvent(SeekBarEvent.LOAD_SEEKBAR,{detail:{mediaInfo:this._cmpModel.mediaInfo,currentSegment:this._cmpModel.currentSegment}}))};LoadTimeManager.prototype.loadSegmentForCPL=function(n){var r=n.detail.segment,u=n.detail.positionToSeek,p=n.detail.timelineType,o=0,h=0,f,c,l,s,e,a,v,t,y;u=CMPUtils.RoundOffToNearestFrameWithMilliSecs(u,this._mediaManager.getFrameRateBasedOnMode());f=CMPUtils.RoundOffToNearestFrame(u/1e3,this._mediaManager.getFrameRateBasedOnMode());CMPUtils.IsNullOrEmpty(i._cmpModel._ceProjectForVideo)||(c=CMPUtils.RoundOffToNearestFrame(i._sequenceManager.getClipTimeBasedOnSequenceTimeInCeProject(f,i._cmpModel._ceProjectForVideo),this._mediaManager.getFrameRateBasedOnMode()),o=CMPUtils.RoundOffToNearestFrame(c-f,this._mediaManager.getFrameRateBasedOnMode()));CMPUtils.IsNullOrEmpty(i._cmpModel._ceProjectForAudio)||(l=CMPUtils.RoundOffToNearestFrame(i._sequenceManager.getClipTimeBasedOnSequenceTimeInCeProject(f,i._cmpModel._ceProjectForAudio),this._mediaManager.getFrameRateBasedOnMode()),h=CMPUtils.RoundOffToNearestFrame(l-f,this._mediaManager.getFrameRateBasedOnMode()));t=CMPUtils.getClipObjectWithClipUiId(r.clipOrderId,this._cmpModel.ceProject._bin._clips,this._cmpModel.sequenceClipInfo);this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.SET_MEDIA_DURATION,{detail:{duration:t.duration}}));this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.ACTIVE_SEGMENT_CHANGED,{detail:{segment:r}}));s=!1;CMPUtils.IsNullOrEmpty(this._cmpModel.currentSegment)||(e=CMPUtils.getClipObjectOnSequenceTime(this._cmpModel.currentSegment.startTimeInSequence,this._cmpModel._ceProjectForVideo,this._cmpModel.sequenceClipInfoForVideo),a=CMPUtils.getClipObjectOnSequenceTime(u/1e3,this._cmpModel._ceProjectForVideo,this._cmpModel.sequenceClipInfoForVideo),CMPUtils.IsNullOrEmpty(e)||CMPUtils.IsNullOrEmpty(e)||e.url.toLowerCase()==a.url.toLowerCase()&&(s=!0));s?(this._cmpModel.currentClipOrderId=r.clipOrderId,this._cmpModel.currentSegment=r,this.setSegmentInfo(),this._stateMachine.EventQueue.enqueue(LoadEvent.LOAD_SEGMENT),i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.SEEK,positionToSeek:u,cumulativeOffsetForVideo:o*1e3,cumulativeOffsetForAudio:h*1e3}}))):p==TimelineType.VIDEO&&(this._cmpModel.segmentSeekPosition=u,v=n.detail.timelineTypeSegment,this._cmpModel.videoSyncOffsetValue=o,this._cmpModel.currentSegment=r,this._cmpModel.currentClipOrderId=r.clipOrderId,this.setSegmentInfo(),this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.DISABLE_SEEKBAR_UPDATE)),this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.LOADING_CLIP,{detail:{clipOrderId:this._cmpModel.currentSegment.clipOrderId}})),t=CMPUtils.getClipObjectWithClipUiId(v.clipOrderId,this._cmpModel.ceProjectForVideo._bin._clips,this._cmpModel.sequenceClipInfoForVideo),y=document.getElementById("hdnIsTokenIdRequired").value.toLowerCase()=="false"?t.url:t.url.toLowerCase().contains("?id=")?t.url:t.url+"?id="+this._cmpModel.playerInfo.TokenId+"&pid="+t.id,this._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_Event,{detail:{type:LoadEvent.LOAD_SEGMENT,segmentUrl:y,clipStartTime:n.detail.positionToSeek/1e3}})))};LoadTimeManager.prototype.loadSegmentBasedOnClipTime=function(n,t,i){var r,o;this._cmpModel.segmentSeekPosition=t;r=CMPUtils.getClipObjectWithClipUiId(n.clipOrderId,this._cmpModel._ceProject._bin._clips,this._cmpModel._sequenceClipInfo);this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.SET_MEDIA_DURATION,{detail:{duration:r.duration}}));(this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT)&&this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.ACTIVE_SEGMENT_CHANGED,{detail:{segment:n}}));var u=!1,f=CMPUtils.getClipObjectWithClipUiId(this._cmpModel.currentClipOrderId,this._cmpModel._ceProject._bin._clips,this._cmpModel._sequenceClipInfo),e=CMPUtils.getClipObjectWithClipUiId(n.clipOrderId,this._cmpModel._ceProject._bin._clips,this._cmpModel._sequenceClipInfo);CMPUtils.IsNullOrEmpty(f)||CMPUtils.IsNullOrEmpty(e)||f.url.toLowerCase()==e.url.toLowerCase()&&(u=!0);(CMPUtils.IsNullOrEmpty(this._cmpModel.currentSegment)||this._cmpModel.currentSegment.clipOrderId!=n.clipOrderId)&&(CMPUtils.IsNullOrEmpty(this._cmpModel.currentClipOrderId)||this._cmpModel.currentClipOrderId!=n.clipOrderId)&&!u?(this._cmpModel.currentSegment=n,this._cmpModel.currentClipOrderId=n.clipOrderId,this.setSegmentInfo(),this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.DISABLE_SEEKBAR_UPDATE)),this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.LOADING_CLIP,{detail:{clipOrderId:this._cmpModel.currentSegment.clipOrderId}})),r=CMPUtils.getClipObjectWithClipUiId(n.clipOrderId,this._cmpModel._ceProject._bin._clips,this._cmpModel._sequenceClipInfo),o=document.getElementById("hdnIsTokenIdRequired").value.toLowerCase()=="false"?r.url:r.url.toLowerCase().contains("?id=")?r.url:r.url+"?id="+this._cmpModel.playerInfo.TokenId,this._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_Event,{detail:{type:LoadEvent.LOAD_SEGMENT,segmentUrl:o,clipStartTime:t/1e3}})),this._cmpModel.currentPlaybackSpeedIndex!=CMPUtils.getDefaultSpeedIndex(this._cmpModel.playbackSpeedRange)&&this._stateMachine.EventQueue.enqueue(TransportEvent.PLAYBACK_SPEED_CHANGE)):(this._cmpModel.currentClipOrderId=n.clipOrderId,this._cmpModel.currentSegment=n,this.setSegmentInfo(),this._stateMachine.EventQueue.enqueue(LoadEvent.LOAD_SEGMENT),this._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:TransportEvent.SEEK,positionToSeek:this._cmpModel.segmentSeekPosition}})));this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT&&(this._cmpModel.autoPlay=i!=!0?!1:!0,new TimelineManager(this._nativeApi,this._cmpModel,this._instanceId).loadSegmentToTimelineMetadata());this._cmpModel.isMediaDurationReached&&(this._cmpModel.isMediaDurationReached=!1)};LoadTimeManager.prototype.updateMediaInfo=function(){if(this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT){var n=CMPUtils.getClipObjectWithClipUiId(this._cmpModel.currentSegment.clipOrderId,this._cmpModel.ceProject.bin.clips,this._cmpModel.sequenceClipInfo);CMPUtils.IsNullOrEmpty(this._cmpModel.mediaInfo)&&(this._cmpModel.mediaInfo=new MediaInfo);this._cmpModel.mediaInfo.startSeek=CMPUtils.RoundOffToNearestFrameWithMilliSecs(n.startTime*1e3,this._mediaManager.getFrameRateBasedOnMode());this._cmpModel.mediaInfo.endSeek=CMPUtils.RoundOffToNearestFrameWithMilliSecs(n.endTime*1e3,this._mediaManager.getFrameRateBasedOnMode());this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW?this.updateMediaInfoSom():this._cmpModel.mediaInfo.som="00:00:00:00";this._cmpModel.mediaInfo.frameRate=parseFloat(n._frameRate)}else this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&(CMPUtils.IsNullOrEmpty(this._cmpModel.mediaInfo)||this.updateMediaInfoSom())};LoadTimeManager.prototype.updateMediaInfoSom=function(){this._cmpModel.mediaInfo.som=CMPUtils.IsNullOrEmpty(this._cmpModel._ceProject._sequence._sequenceSom)?CMPUtils.IsNullOrEmpty(this._cmpModel._defaultSequenceSom)?"00:00:00:00":this._cmpModel._defaultSequenceSom:this._cmpModel._ceProject._sequence._sequenceSom};LoadTimeManager.prototype.loadSegment=function(n){i._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW?i.loadSegmentForCPL(n):i.loadSegmentBasedOnClipTime(n.detail.segment,n.detail.positionToSeek,n.detail.autoPlay!=!0?!1:!0)}}function MarkerManager(n){this._cmpModel=n;MarkerManager.prototype.createMarkerLayer=function(n,t,i){var r=new MarkerLayer;r.id=n;r.name=t;i.toString()=="true"&&this.selectMarkerLayer(n,t);r.isSelected=i;this._cmpModel.markerCollection.splice(this._cmpModel.markerCollection.length,0,r)};MarkerManager.prototype.selectMarkerLayer=function(n,t){for(var i=0;i<this._cmpModel.markerCollection.length;i++)this._cmpModel.markerCollection[i].isSelected=this._cmpModel.markerCollection[i].id.toString().trim()==n.toString().trim()&&this._cmpModel.markerCollection[i].name.toString().trim()==t.toString().trim()?!0:!1};MarkerManager.prototype.createMarker=function(n,t,i,r,u,f,e,o){n!=null&&t!=null&&i!=null?(this._cmpModel.marker=new Marker,this._cmpModel.marker.id=r,this._cmpModel.marker.name=u,this._cmpModel.marker.markIn=n,this._cmpModel.marker.markOut=t,this._cmpModel.marker.cssClassName=o,this.saveMarkerIntoCollection(i,f,e)):n!=null&&t!=null?n==t?(this._cmpModel.marker=new Marker,this._cmpModel.marker.id=r,this._cmpModel.marker.markIn=n,this._cmpModel.marker.markOut=t):(this._cmpModel.marker=new Marker,this._cmpModel.marker.id=r,this._cmpModel.marker.markIn=n,this._cmpModel.marker.markOut=t):n!=null||t!=null?t==null?(this._cmpModel.marker=new Marker,this._cmpModel.marker.id=r,this._cmpModel.marker.markIn=n):n==null&&(this._cmpModel.marker.markOut=t):n==null&&t==null&&this.saveMarkerIntoCollection(i,f,e)};MarkerManager.prototype.saveMarkerIntoCollection=function(n,t,i){var r;for(this._cmpModel.markerCollection.length==0&&this.createMarkerLayer(1,"MarkerLayer",!0),r=0;r<this._cmpModel.markerCollection.length;r++)this._cmpModel.markerCollection[r].id==t&&this._cmpModel.markerCollection[r].name.toString()==i&&(t=r);if(t==null||t==undefined)for(r=0;r<this._cmpModel.markerCollection.length;r++)this._cmpModel.markerCollection[r].isSelected.toString()=="true"&&(t=r);(n!=null||n!=undefined)&&(this._cmpModel.marker.formattedDisplayInfo=n);CMPUtils.setDictionaryData(this._cmpModel.markerCollection[t].markers,this._cmpModel.marker.id,this._cmpModel.marker);this._cmpModel.marker=null};MarkerManager.prototype.updateMarker=function(n,t,i,r,u){for(var e,f=0;f<this._cmpModel.markerCollection.length;f++)this._cmpModel.markerCollection[f].isSelected.toString()=="true"&&(e=f);this._cmpModel.marker=CMPUtils.getDictionaryData(this._cmpModel.markerCollection[e].markers,r);CMPUtils.IsNullOrEmpty(u)||(this._cmpModel.marker.name=u);CMPUtils.IsNullOrEmpty(n)||(this._cmpModel.marker.markIn=n);CMPUtils.IsNullOrEmpty(t)||(this._cmpModel.marker.markOut=t);(i!=null||i!=undefined)&&(this._cmpModel.marker.formattedDisplayInfo=i);CMPUtils.setDictionaryData(this._cmpModel.markerCollection[e].markers,r,this._cmpModel.marker)};MarkerManager.prototype.removeMarker=function(n){for(var t=0;t<this._cmpModel.markerCollection.length;t++)this._cmpModel.markerCollection[t].isSelected.toString()=="true"&&delete this._cmpModel.markerCollection[t].markers[n]};MarkerManager.prototype.clearMarkers=function(){this._cmpModel.markerCollection=[]};MarkerManager.prototype.createMarkerWithCollections=function(n){n!=null&&(this._cmpModel.markerCollection=n)};MarkerManager.prototype.addMarkerLayerToCollections=function(n){n!=null&&this._cmpModel.markerCollection.push(n)};MarkerManager.prototype.getCurrentMarker=function(){return this._cmpModel.marker};MarkerManager.prototype.getCurrentMarkerLayer=function(){for(var n=0;n<this._cmpModel.markerCollection.length;n++)if(this._cmpModel.markerCollection[n].isSelected.toString()=="true")return this._cmpModel.markerCollection[n]};MarkerManager.prototype.changeCurrentMarkerLayerById=function(n){for(var t=0;t<this._cmpModel.markerCollection.length;t++)this._cmpModel.markerCollection[t].isSelected=this._cmpModel.markerCollection[t].id==n?!0:!1};MarkerManager.prototype.changeCurrentMarkerLayerByName=function(n){for(var t=0;t<this._cmpModel.markerCollection.length;t++)this._cmpModel.markerCollection[t].isSelected=this._cmpModel.markerCollection[t].name.toUpperCase()==n.toUpperCase()?!0:!1};MarkerManager.prototype.getMarkerById=function(n,t){for(var i=0;i<this._cmpModel.markerCollection.length;i++)if(this._cmpModel.markerCollection[i].id==n)return CMPUtils.getDictionaryData(this._cmpModel.markerCollection[i].markers,t)};MarkerManager.prototype.addOrUpdateMarker=function(n,t,i){for(var r=0;r<this._cmpModel.markerCollection.length;r++)if(this._cmpModel.markerCollection[r].id==n){CMPUtils.setDictionaryData(this._cmpModel.markerCollection[r].markers,i.id,i);break}};MarkerManager.prototype.deleteMarkerFromLayer=function(n,t,i){if(Array.isArray(i)&&i.length){this.deleteMarkersFromLayer(n,i);return}for(var r=0;r<this._cmpModel.markerCollection.length;r++)if(this._cmpModel.markerCollection[r].id==n){delete this._cmpModel.markerCollection[r].markers[i];break}};MarkerManager.prototype.deleteMarkersFromLayer=function(n,t){for(var i=0;i<_this._cmpModel.markerCollection.length;i++)if(_this._cmpModel.markerCollection[i].id==n){t.forEach(function(n){delete _this._cmpModel.markerCollection[i].markers[n]});break}}}function MediaManager(n,t,i,r){this._cmpModel=t;this._nativeApi=n;this._instanceId=i;this._eventDispatcher=document.getElementById(i);this._injector=r;this._sequenceManager=new SequenceManager(t,i,n);this._sequenceClipManager=new SequenceClipManager(n,t,i);var u=this;MediaManager.prototype.loadUrl=function(){var n=this._cmpModel.autoPlay;this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW?this._sequenceManager.initialisePreviewMode(n):this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT?this._sequenceManager.initialiseSegmentEditMode(1):this._cmpModel.playerMode==PlayerMode.SEQUENCE_CLIP?this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.INITIALISE_SEQUENCE_CLIP_MODE)):this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW?this._sequenceManager.initialiseCplPreviewMode(n):this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.SET_MEDIA_SOURCE,{detail:{url:this._cmpModel.mediaInfo._mediaUrl,autoPlay:this._cmpModel.autoPlay}}));this._cmpModel.timedTextTrackCollection!=undefined&&this._cmpModel.timedTextTrackCollection.length>0&&this._eventDispatcher.dispatchEvent(new CustomEvent(TTTEvent.SELECT_DEFAULT_TIMEDTEXT_TRACK))};MediaManager.prototype.getMediaDuration=function(){var n=this._nativeApi.GetMediaDuration(),t=n==null?this._cmpModel.mediaInfo.duration/1e3:n/1e3;return this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW?this._sequenceManager.calculateSequenceDuration():this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT?this._sequenceClipManager.calculateClipDuration():this._cmpModel.playerMode==PlayerMode.SEQUENCE_CLIP?this._sequenceClipManager.calculateClipDuration():CMPUtils.RoundOffToNearestFrame(t,this.getFrameRateBasedOnMode())};MediaManager.prototype.seek=function(n){if(this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW){var t=n/1e3,i=this._sequenceManager.getClipTimeBasedOnSequenceTime(t),r=this._sequenceManager.getSegmentBasedOnSequenceTime(this._cmpModel.ceProject.sequence,t);this._cmpModel.timelineMetadata.resetIndex(t);CMPUtils.IsNullOrEmpty(u._cmpModel.videoTimeline)||u._cmpModel.videoTimeline.resetIndex(t);CMPUtils.IsNullOrEmpty(u._cmpModel.audioTimeline)||u._cmpModel.audioTimeline.resetIndex(t);this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:r,positionToSeek:this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW?CMPUtils.RoundOffToNearestFrameWithMilliSecs(n,this.getFrameRateBasedOnMode()):CMPUtils.RoundOffToNearestFrameWithMilliSecs(i*1e3,this.getFrameRateBasedOnMode())}}))}else this._nativeApi.Seek(CMPUtils.RoundOffToNearestFrameWithMilliSecs(n,this.getFrameRateBasedOnMode()));this._cmpModel.mediaInfo.isLive&&(this._cmpModel.isSeekToLiveRequested=!1)};MediaManager.prototype.setClearMediaPlayerTimer=function(){var n=this.getCMPTimerDuration();this._cmpModel.clearMediaPlayerTimer=setInterval(this.cmpTimer,n,this);this._cmpModel.transportBarSliderUpdationTimer=setInterval(function(n){n.updateSlider()},1e3,this)};MediaManager.prototype.getCMPTimerDuration=function(){var n=document.getElementById("hdnTenantName")?document.getElementById("hdnTenantName").value.toUpperCase():"",t=navigator.userAgent.indexOf(".NET CLR")>-1;return t&&n=="EXCHANGE"?400:34};MediaManager.prototype.updateSlider=function(){var n=u.getCurrentTime(),t=0;u._cmpModel.playerMode==PlayerMode.VIDEO||u._cmpModel.playerMode==PlayerMode.AUDIO?t=u.buffer:u._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&(t=u._sequenceManager.calculateSequenceBufferTimeForMergedPlaylist(u.buffer,n));u._eventDispatcher.dispatchEvent(new CustomEvent(TimerEvent.SLIDER_TIMER,{detail:{currentTime:n,duration:u._cmpModel._mediaDuration}}))};MediaManager.prototype.cmpTimer=function(n){var t=n.getCurrentTime(),i=t,r=0,f="";n._cmpModel.playerMode!=PlayerMode.SEQUENCE_PREVIEW&&n._cmpModel.playerMode!=PlayerMode.SEQUENCE_SEGMENT_EDIT&&n._cmpModel.playerMode!=PlayerMode.SEQUENCE_CLIP&&n._cmpModel.playerMode!=PlayerMode.SEQUENCE_CPL_PREVIEW||CMPUtils.IsNullOrEmpty(n._cmpModel.currentSegment)||(i=parseFloat(n._cmpModel.currentSegment.endTime)-parseFloat(n._cmpModel.currentSegment.startTime),r=n._cmpModel.currentSegment,f=n._cmpModel.playerMode);t+u.buffer>u._cmpModel._mediaDuration&&(u.buffer=u._cmpModel._mediaDuration-t);n._eventDispatcher.dispatchEvent(new CustomEvent(TimerEvent.TIMER,{detail:{currentTime:t,segmentElapsedDuration:i,currentSegment:r,sequenceMode:f,bufferTime:u.buffer,backBufferTime:this.backBuffer}}))};MediaManager.prototype.getCurrentTime=function(){var n=this._nativeApi.GetCurrentTime(),t=n.currentTime/1e3,i;return this.buffer=n.bufferInSeconds,this.backBuffer=n.backBufferInSeconds,(this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW)&&this._cmpModel.ceProject.sequence!=undefined?(i=this._sequenceManager.calculateSequenceTime(t),CMPUtils.RoundOffToNearestFrame(i,this.getFrameRateBasedOnMode())):CMPUtils.RoundOffToNearestFrame(t,this.getFrameRateBasedOnMode())};MediaManager.prototype.checkAndDispatchEventOnLivePlayHeadChange=function(n){var r=this._cmpModel.mediaInfo.livePlayheadPosition,t=n.currentTime/1e3,i=n.actualLivePosition/1e3;this._cmpModel.mediaInfo.livePlayheadPosition=t==i?LivePlayHeadPosition.LIVE:LivePlayHeadPosition.HISTORICAL;r!=this._cmpModel.mediaInfo.livePlayheadPosition&&this._eventDispatcher.dispatchEvent(new CustomEvent(LiveEvent.PLAYHEAD_POSITION_CHANGE,{detail:{livePlayheadPosition:this._cmpModel.mediaInfo.livePlayheadPosition,actualLivePosition:i,currentTime:t}}))};MediaManager.prototype.resetCmpOnMediaUnload=function(){this._cmpModel.playerMode==PlayerMode.SEQUENCE_CLIP&&this._sequenceClipManager.loadClip()};MediaManager.prototype.checkLastPlayBackTimeThreshold=function(){var n;if(this._cmpModel.mediaInfo.islastPlayBackTimeEnabled&&(n=this._cmpModel.mediaInfo.lastPlayBackTime,!CMPUtils.IsNullOrEmpty(n))){var i=CMPUtils.RoundOffToNearestFrame(n-this._cmpModel.mediaInfo.startSeek,this.getFrameRateBasedOnMode()),r=CMPUtils.RoundOffToNearestFrame(this.getMediaDuration()-n,this.getFrameRateBasedOnMode()),t=this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.LastPlayBackTimeThresholdValue"].split("|");(i<CMPUtils.RoundOffToNearestFrame(t[0],this.getFrameRateBasedOnMode())||r<CMPUtils.RoundOffToNearestFrame(t[1],this.getFrameRateBasedOnMode()))&&(this._cmpModel.mediaInfo.lastPlayBackTime=CMPUtils.RoundOffToNearestFrame(this._cmpModel.mediaInfo.startSeek,this.getFrameRateBasedOnMode()))}};MediaManager.prototype.validateAndChangeMediaInfo=function(n,t){return CMPUtils.IsNullOrEmpty(n.frameRate)||CMPUtils.IsNullOrEmpty(n.som)||CMPUtils.IsNullOrEmpty(n.mediaUrl)||CMPUtils.IsNullOrEmpty(t)?!1:(this._cmpModel.mediaInfo=n,this._cmpModel.playerMode=t,this._cmpModel.currentSegment=null,this._cmpModel.currentClipOrderId=null,CMPUtils.IsNullOrEmpty(n.pauseAtLastFrame)||(this._cmpModel.pauseAtLastFrame=n.pauseAtLastFrame),this._eventDispatcher.dispatchEvent(new CustomEvent(ConfigurationEvent.SET_CONFIGURATION,{detail:{displayUiElements:this._cmpModel.playerInfo.CMPConfig,supportedFeatures:this._cmpModel.supportedFeatures,mediaInfo:this._cmpModel.mediaInfo,preferenceSetting:u._cmpModel.preferenceSetting}})),this.setPlayerMediaInfo(n),!0)};MediaManager.prototype.setPlayerMediaInfo=function(n){var t=new MediaInfo;t.AssetClass=n.assetClass;t.Duration=n.Duration;t.FrameRate=n.frameRate;t.IslastPlayBackTimeEnabled=n.IslastPlayBackTimeEnabled;t.LastPlayBackTime=n.LastPlayBackTime;t.MediaUrl=n.mediaUrl;t.SeekEnd=n.endSeek;t.SeekStart=n.startSeek;t.Som=n.som;t.StreamType=n.streamType;t.TimecodeDisplayFormat=n.timecodeDisplayFormat;t._assetClass=n.assetClass;t._duration=n.Duration;t._frameRate=n.frameRate;t._islastPlayBackTimeEnabled=n.IslastPlayBackTimeEnabled;t._lastPlayBackTime=n.LastPlayBackTime;t._mediaUrl=n.mediaUrl;t._startSeek=n.startSeek;t._endSeek=n.endSeek;t._som=n.som;t._streamType=n.streamType;t._timecodeDisplayFormat=n.timecodeDisplayFormat;this._cmpModel._playerInfo.MediaInfo=t;this._cmpModel._mediaInfo=t};MediaManager.prototype.getFrameRateBasedOnMode=function(){var n;return this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT||this._cmpModel.playerMode==PlayerMode.SEQUENCE_CLIP?(n=CMPUtils.getClipObjectWithClipUiId(this._cmpModel.currentClipOrderId,this._cmpModel.ceProject.bin.clips,this._cmpModel.sequenceClipInfo),CMPUtils.IsNullOrEmpty(n)?this._cmpModel.ceProject.sequence.frameRate:n.frameRate):this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW?this._cmpModel.isMixedFrameRate==!0?(n=CMPUtils.getClipObjectWithClipUiId(this._cmpModel.currentClipOrderId,this._cmpModel.ceProject.bin.clips,this._cmpModel.sequenceClipInfo),CMPUtils.IsNullOrEmpty(n)?this._cmpModel.ceProject.sequence.frameRate:n.frameRate):this._cmpModel.ceProject.sequence.frameRate:this._cmpModel.mediaInfo.frameRate};MediaManager.prototype.isLive=function(){return this._nativeApi.isLive()};MediaManager.prototype.hideMediaInfo=function(){this._cmpModel.isMediaInfoModeEnabled=!1;this._nativeApi.HideMediaInfo()};MediaManager.prototype.getMediaInfo=function(){var t,n;this._cmpModel.isMediaInfoModeEnabled=!0;t=this._nativeApi.GetMediaInfo();CMPUtils.IsNullOrEmpty(t)||(n=JSON.parse(atob(t)),n.MediaInfo||(n=function(){MediaInfo=[]},n.MediaInfo=[]),n.MediaInfo.push(CMPUtils.addMediaInfo("FrameRate","Frame rate",this.getFrameRateBasedOnMode()+" fps",1)),n.MediaInfo.push(CMPUtils.addMediaInfo("Duration","Duration",Number(this.getMediaDuration()).toFixed(2)+" seconds",3)),n.MediaInfo.push(CMPUtils.addMediaInfo("Stream","VOD/LIVE",this._nativeApi.isLive()?"LIVE":"VOD",6)),n.MediaInfo.push(CMPUtils.addMediaInfo("PlayerType","Player Type",this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["Portal.PlayerType"],7)),n.MediaInfo.push(CMPUtils.addMediaInfo("PlayerDefinition","HD/SD",CMPUtils.getPlayerDefinition(n),8)),n.MediaInfo.sort(objComparator),document.getElementById(this._instanceId).dispatchEvent(new CustomEvent(UIEvent.SHOW_MEDIA_INFO,{detail:{mediaInfo:n,isVariable:!1}})))}}function NativeHandler(n){this._stateMachine=n;NativeHandler.prototype.onSeekCompleted=function(){this._stateMachine.triggerNativePlayerEvent(new CustomEvent(CMPEvent.NP_EVENT,{detail:{arg:NativeEvent.ON_SEEK_COMPLETED}}))};NativeHandler.prototype.onPlayerStateChange=function(n,t,i,r){(r==undefined||r==null)&&(r="");this._stateMachine.triggerNativePlayerEvent(new CustomEvent(CMPEvent.NP_EVENT,{detail:{type:NativeEvent.ON_PLAYER_STATE_CHANGE,arg:t,err:r,oldState:n},bubbles:!0,cancelable:!1}))};NativeHandler.prototype.onError=function(){this._stateMachine.triggerNativePlayerEvent(new CustomEvent(CMPEvent.NP_EVENT,{detail:{type:NativeEvent.ON_ERROR,arg:npNewState}}))};NativeHandler.prototype.onNonAvPreLoadReady=function(n){this._stateMachine.triggerNativePlayerEvent(new CustomEvent(CMPEvent.NP_EVENT,{detail:{type:NativeEvent.ON_NONAV_PRE_LOAD_READY,arg:NativeEvent.ON_NONAV_PRE_LOAD_READY,params:n}}))};NativeHandler.prototype.onNonAvReady=function(n){this._stateMachine.triggerNativePlayerEvent(new CustomEvent(CMPEvent.NP_EVENT,{detail:{type:NativeEvent.ON_NONAV_READY,arg:NativeEvent.ON_NONAV_READY,params:n}}))}}function SequenceManager(n,t,i){this._cmpModel=n;this._eventDispatcher=document.getElementById(t);this._instanceId=t;this._nativeApi=i;this.objSequenceClipInfo=[];this.objClipDictionary={};this._injector=getCMPInstanceByInstanceId(t)._injector;this._mediaManager=this._injector.getInstance("mediaManager");this._audioManager=this._injector.getInstance("audioManager");this._timelineManager=new TimelineManager(this._nativeApi,this._cmpModel,this._instanceId,this.ceProject);var r=this;SequenceManager.prototype.getSequenceObject=function(){return this._cmpModel.ceProject.sequence};SequenceManager.prototype.getSegmentBasedOnSequenceTime=function(n,t){var u=new MediaManager(this._nativeApi,this._cmpModel,this._instanceId),i=u.getFrameRateBasedOnMode(),r;for(segmentIndex=0;segmentIndex<n.segments.length;segmentIndex++)if(r=n.segments[segmentIndex],CMPUtils.RoundOffToNearestFrame(t,i)>=CMPUtils.RoundOffToNearestFrame(r.startTimeInSequence,i)&&CMPUtils.RoundOffToNearestFrame(t,i)<CMPUtils.RoundOffToNearestFrame(r.endTimeInSequence,i))return r};SequenceManager.prototype.getClipTimeBasedOnSequenceTime=function(n){var r=new MediaManager(this._nativeApi,this._cmpModel,this._instanceId),t=r.getFrameRateBasedOnMode(),i;for(segmentIndex=0;segmentIndex<this._cmpModel.ceProject.sequence.segments.length;segmentIndex++)if(i=this._cmpModel.ceProject.sequence.segments[segmentIndex],CMPUtils.RoundOffToNearestFrame(n,t)>=CMPUtils.RoundOffToNearestFrame(i.startTimeInSequence,t)&&CMPUtils.RoundOffToNearestFrame(n,t)<CMPUtils.RoundOffToNearestFrame(i.endTimeInSequence,t))return CMPUtils.RoundOffToNearestFrame(parseFloat(i.startTime)+(n-i.startTimeInSequence.toFixed(3)),t)};SequenceManager.prototype.calculateSequenceDuration=function(){if(this._cmpModel.ceProject.sequence.segments.length>0){var n=new MediaManager(this._nativeApi,this._cmpModel,this._instanceId),t=n.getFrameRateBasedOnMode();return CMPUtils.RoundOffToNearestFrame(this._cmpModel.ceProject.sequence.segments[this._cmpModel.ceProject.sequence.segments.length-1].endTimeInSequence,t)}return 0};SequenceManager.prototype.calculateSequenceTime=function(n){var r=new MediaManager(this._nativeApi,this._cmpModel,this._instanceId),t=r.getFrameRateBasedOnMode(),i;return CMPUtils.IsNullOrEmpty(this._cmpModel.currentSegment)?0:this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW?CMPUtils.RoundOffToNearestFrame(n,t):CMPUtils.RoundOffToNearestFrame(n,t)>=CMPUtils.RoundOffToNearestFrame(this._cmpModel.currentSegment.startTime,t)?CMPUtils.RoundOffToNearestFrame(this._cmpModel.currentSegment.startTimeInSequence+(CMPUtils.RoundOffToNearestFrame(n,t)-CMPUtils.RoundOffToNearestFrame(this._cmpModel.currentSegment.startTime,t)),t):(i=CMPUtils.RoundOffToNearestFrame(this._cmpModel._segmentSeekPosition/1e3-(this._cmpModel.currentSegment._startTime-this._cmpModel.currentSegment._startTimeInSequence),r.getFrameRateBasedOnMode()),isNaN(i)?CMPUtils.RoundOffToNearestFrame(this._cmpModel.currentSegment.startTimeInSequence,t):CMPUtils.RoundOffToNearestFrame(i,t))};SequenceManager.prototype.setClipPosition=function(n,t){for(clipIndex=0;clipIndex<n.length;clipIndex++)n[clipIndex].position>=t&&(n[clipIndex].position+=1);for(segmentIndex=0;segmentIndex<this._cmpModel.ceProject.sequence.segments.length;segmentIndex++){var i=CMPUtils.getSequenceClipInfoObjectWithClipUiId(this._cmpModel.ceProject.sequence.segments[segmentIndex].clipOrderId,this._cmpModel.sequenceClipInfo);i.position>=t&&(i.position+=1)}};SequenceManager.prototype.addOrUpdateClip=function(n){CMPUtils.IsNullOrEmpty(r._cmpModel.ceProject)&&(r._cmpModel.ceProject=new ClearEditorProject,r._cmpModel.ceProject.sequence=r.createSequenceObject(n.detail.clipObject.frameRate),r._cmpModel.ceProject.sequence.segments=[],r._cmpModel.ceProject.sequence.screenshots=[],r._cmpModel.ceProject.bin=new Bin,r._cmpModel.ceProject.bin.clips=[],r._cmpModel.sequenceClipInfo=[]);r.createClip(n.detail.clipObject);r.createSegment(n.detail.clipObject,n.detail.isImplicitSegment);r.setAndDispatchOnFrameRateChanged(r._cmpModel.ceProject.bin.clips)};SequenceManager.prototype.createSegment=function(n,t){var i=new Segment;i.clipOrderId=n.clipUiId;i.id=n.segmentId;i.uiId=n.segmentUiId;i.thumbnailUrl=n.clipThumbnail;i.startTime=n.tcrin/1e3;i.endTime=n.tcrout/1e3;i.title=n.title;i.comments=n.comments;i.editType=n.editType;i.trackType=n.trackType;(t==null||t==undefined)&&(t=!0);i.implictSegment=t;this.setClipPosition(this._cmpModel.sequenceClipInfo,n.position);this._cmpModel.ceProject.sequence.segments.push(i);CMPUtils.setSegmentPosition(this._cmpModel.ceProject.sequence.segments,this._cmpModel.ceProject.bin.clips,this._cmpModel.sequenceClipInfo);CMPUtils.calculateSegmentTimeInSequence(this._cmpModel.ceProject.sequence.segments);this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.ADD_SEGMENT,{detail:{segment:i,ceProject:this._cmpModel.ceProject}}))};SequenceManager.prototype.createClip=function(n){var t,i;CMPUtils.IsNullOrEmpty(CMPUtils.getClipObjectWithClipId(n.clipId,this._cmpModel.ceProject.bin.clips))&&(t=new Clip,t.id=n.clipId,t.title=n.title,t.reelId=n.reelId,t.highResFileName=n.clipHighResFileName,t.url=document.getElementById("hdnIsTokenIdRequired").value.toLowerCase()=="false"?n.clipSrc:n.clipSrc.toLowerCase().contains("?id=")?n.clipSrc:n.clipSrc+"?id="+this._cmpModel._playerInfo.TokenId,t.thumbnailUrl=n.clipThumbnail,t.startTime="0",t.endTime=n.duration/1e3,t.duration=n.duration/1e3,t.startOfMedia=n.som,t.frameRate=n.frameRate,this._cmpModel.ceProject.bin.clips.push(t));i=new SequenceClipInfo;i.clipId=n.clipId;i.clipUiId=n.clipUiId;i.position=n.position;this._cmpModel.sequenceClipInfo.push(i)};SequenceManager.prototype.createSequenceObject=function(n){var t=new Sequence;return t.id="1",t.title="",this._cmpModel.sequenceOperation="",this._cmpModel.sequenceAction="",this._cmpModel.sequenceTarget="",this._cmpModel.sequenceStatus="",this._cmpModel.sequenceOfflineSave=0,t.frameRate=n,t.mode=this._cmpModel.playerMode,t};SequenceManager.prototype.updateSegment=function(n,t,i){r._eventDispatcher.dispatchEvent(new CustomEvent(TimelineEvent.TIMELINE_EDITED));var e=this._cmpModel.currentSegment,u=this._cmpModel.ceProject.sequence.segments,f=null;for(segmentIndex=0;segmentIndex<u.length;segmentIndex++)e.uiId==u[segmentIndex].uiId&&(!CMPUtils.IsNullOrEmpty(n)&&parseFloat(n)>=0&&(u[segmentIndex].startTime=n),!CMPUtils.IsNullOrEmpty(t)&&parseFloat(t)>=0&&(u[segmentIndex].endTime=t),CMPUtils.IsNullOrEmpty(i)||(u[segmentIndex].title=i),f=u[segmentIndex]);this._cmpModel.ceProject.sequence.segments=u;CMPUtils.setSegmentPosition(this._cmpModel.ceProject.sequence.segments,this._cmpModel.ceProject.bin.clips,this._cmpModel.sequenceClipInfo);CMPUtils.calculateSegmentTimeInSequence(this._cmpModel.ceProject.sequence.segments);this.reInitialiseTimelineMetadata();r._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.ADD_SEGMENT,{detail:{segment:f,ceProject:r._cmpModel.ceProject}}))};SequenceManager.prototype.updateSegmentById=function(n){var s;r._eventDispatcher.dispatchEvent(new CustomEvent(TimelineEvent.TIMELINE_EDITED));var i=n.detail.segment,u=i.startTime,f=i.endTime,e=i.title,t=r._cmpModel.ceProject.sequence.segments,o=null;for(segmentIndex=0;segmentIndex<t.length;segmentIndex++)i.uiId==t[segmentIndex].uiId&&(!CMPUtils.IsNullOrEmpty(u)&&parseFloat(u)>=0&&(t[segmentIndex].startTime=u),!CMPUtils.IsNullOrEmpty(f)&&parseFloat(f)>=0&&(t[segmentIndex].endTime=f),CMPUtils.IsNullOrEmpty(e)||(t[segmentIndex].title=e),o=t[segmentIndex]);s=r.getClipTimeBasedOnSequenceTime(r._mediaManager.getCurrentTime());r._cmpModel.ceProject.sequence.segments=t;CMPUtils.setSegmentPosition(r._cmpModel.ceProject.sequence.segments,r._cmpModel.ceProject.bin.clips,r._cmpModel.sequenceClipInfo);CMPUtils.calculateSegmentTimeInSequence(r._cmpModel.ceProject.sequence.segments);r.reInitialiseTimelineMetadata(i,s);r._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.ADD_SEGMENT,{detail:{segment:o,ceProject:r._cmpModel.ceProject}}))};SequenceManager.prototype.reInitialiseTimelineMetadata=function(n,t){if(this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW&&(new TimelineManager(this._nativeApi,this._cmpModel,this._instanceId).updateTimelineMarkers(),n.uiId==this._cmpModel.currentSegment.uiId&&!(Number(n.startTime)<=Number(t)&&Number(n.endTime)>=Number(t)))){var i=new TimelineManager(this._nativeApi,this._cmpModel,this._instanceId).getNextSegment(this._cmpModel.currentSegment.position);this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:i,positionToSeek:parseFloat(i.startTime)*1e3}}))}};SequenceManager.prototype.deleteClipAndSegment=function(n){var f,e,u;this._eventDispatcher.dispatchEvent(new CustomEvent(TimelineEvent.TIMELINE_EDITED));var o=this._cmpModel.ceProject.sequence,t=o.segments,i=null,r=0;for(segmentIndex=0;segmentIndex<t.length;segmentIndex++)t[segmentIndex].uiId==n&&(f=CMPUtils.getSequenceClipInfoObjectWithClipUiId(t[segmentIndex].clipOrderId,this._cmpModel.sequenceClipInfo),r=f.position,i=t[segmentIndex].uiId,t.splice(segmentIndex,1));for(this._cmpModel.ceProject.sequence.segments=t,e=this._cmpModel.sequenceClipInfo,clipIndex=0;clipIndex<e.length;clipIndex++)this._cmpModel.sequenceClipInfo[clipIndex].position==r&&this._cmpModel.sequenceClipInfo.splice(clipIndex,1);this._cmpModel.length=="0"&&(this._cmpModel.ceProject.sequence.frameRate=null);this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SEGMENT_DELETED,{detail:{segmentUiId:i,ceProject:this._cmpModel.ceProject}}));t.length==0&&(this._cmpModel.ceProject.bin.clips=[]);CMPUtils.IsNullOrEmpty(this._cmpModel.segmentsToSkipPreview)||(u=this._cmpModel.segmentsToSkipPreview.indexOf(n),u!=-1&&this._cmpModel.segmentsToSkipPreview.splice(u,1));this.resetAfterSegmentDeleted(i,r);this.setAndDispatchOnFrameRateChanged(this._cmpModel.ceProject.bin.clips)};SequenceManager.prototype.resetAfterSegmentDeleted=function(n,t){var i=this._mediaManager.getFrameRateBasedOnMode();if(CMPUtils.setSegmentPosition(this._cmpModel.ceProject.sequence.segments,this._cmpModel.ceProject.bin.clips,this._cmpModel.sequenceClipInfo),CMPUtils.calculateSegmentTimeInSequence(this._cmpModel.ceProject.sequence.segments),this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW){if(this._cmpModel.timelineMetadata.reset(),this._cmpModel.timelineMetadata.removeValue(),this.initialisePreviewMode(!0),CMPUtils.IsNullOrEmpty(this._cmpModel.ceProject.sequence.segments)){this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SEQUENCE_DELETED));this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.UNLOAD_MEDIA_URL));this._eventDispatcher.dispatchEvent(new CustomEvent(CMPEvent.SET_CMP_STATE_EVENT,{detail:{newState:"WAITINGFORMEDIASOURCE"}}));this._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.SHOW_HIDE_GENERICS_ICON,{detail:{value:!0}}));return}}else if(this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT&&this._cmpModel.currentSegment.uiId==n){if(CMPUtils.IsNullOrEmpty(this._cmpModel.ceProject.sequence.segments)){this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.UNLOAD_MEDIA_URL));this._eventDispatcher.dispatchEvent(new CustomEvent(CMPEvent.SET_CMP_STATE_EVENT,{detail:{newState:"WAITINGFORMEDIASOURCE"}}));this._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.SHOW_HIDE_GENERICS_ICON,{detail:{value:!0}}));return}this._cmpModel.ceProject.sequence.segments.length<t?this.initialiseSegmentEditMode(t-1):this.initialiseSegmentEditMode(t)}};SequenceManager.prototype.fnDeleteSegmentClip=function(n,t){for(clipIndex=0;clipIndex<t.length;clipIndex++)t[clipIndex].position==n&&r._cmpModel.ceProject.bin.clips.splice(clipIndex,1)};SequenceManager.prototype.GetSequenceObjectAsXml=function(n){var t=CMPUtils.StringToXML(t),u=n.sequence,i=t.createElement("Sequence"),r,e,f,o;for(i.appendChild(CMPUtils.addNodeToXmlDoc(t,"SequenceId",u.id)),i.appendChild(CMPUtils.addNodeToXmlDoc(t,"SequenceTitle",u.title)),i.appendChild(CMPUtils.addNodeToXmlDoc(t,"SequenceFrameRate",u.frameRate)),i.appendChild(CMPUtils.addNodeToXmlDoc(t,"SequenceSom",u.sequenceSom)),i.appendChild(CMPUtils.addNodeToXmlDoc(t,"Operation",this._cmpModel.sequenceOperation)),i.appendChild(CMPUtils.addNodeToXmlDoc(t,"Action",this._cmpModel.sequenceAction)),i.appendChild(CMPUtils.addNodeToXmlDoc(t,"Target",this._cmpModel.sequenceTarget)),i.appendChild(CMPUtils.addNodeToXmlDoc(t,"Status",this._cmpModel.sequenceStatus)),i.appendChild(CMPUtils.addNodeToXmlDoc(t,"OfflineSave",this._cmpModel.sequenceOfflineSave)),r=this._cmpModel.sequenceClipInfo,r=r.sort(function(n,t){return n._position-t._position}),e=t.createElement("Clips"),f=0;f<r.length;f++)o=CMPUtils.getClipObjectWithClipUiId(r[f].clipUiId,this._cmpModel.ceProject.bin.clips,r),e.appendChild(this.GetClipsAsXml(t,u.segments,o,r[f],this._cmpModel.ceProject.sequence.screenshots)),i.appendChild(e);return CMPUtils.convertStringToXml(i)};SequenceManager.prototype.GetClipsAsXml=function(n,t,i,u,f){var o=i,e=n.createElement("Clip"),a,v,y,l,w,p,h,b,s,c;if(e.appendChild(CMPUtils.addNodeToXmlDoc(n,"ClipId",o.id)),e.appendChild(CMPUtils.addNodeToXmlDoc(n,"ClipReelId",o.reelId)),e.appendChild(CMPUtils.addNodeToXmlDoc(n,"ClipUIId",u.clipUiId)),e.appendChild(CMPUtils.addNodeToXmlDoc(n,"ClipFrameRate",o.frameRate)),e.appendChild(CMPUtils.addNodeToXmlDoc(n,"ClipPos",u.position)),e.appendChild(CMPUtils.addNodeToXmlDoc(n,"ClipTitle",o.title,!0)),e.appendChild(CMPUtils.addNodeToXmlDoc(n,"ClipHighResFileName",o.highResFileName)),e.appendChild(CMPUtils.addNodeToXmlDoc(n,"ClipSrc",this.GetClipUrl(o.url))),e.appendChild(CMPUtils.addNodeToXmlDoc(n,"ClipThumbnail",o.thumbnailUrl)),e.appendChild(CMPUtils.addNodeToXmlDoc(n,"ClipStartTime",o.startTime)),e.appendChild(CMPUtils.addNodeToXmlDoc(n,"ClipEndTime",o.endTime)),e.appendChild(CMPUtils.addNodeToXmlDoc(n,"ClipDuration",o.duration)),a=n.createElement("Segments"),v=0,t.length>0)for(y=CMPUtils.getAllSegmentsObjectsWithClipUiId(u.clipUiId,t),s=0;s<y.length;s++)l=y[s],l.implictSegment!=!0&&(w=this.GetSegmentAsXml(n,l,o.startOfMedia,o.frameRate),v+=l.endTime-l.startTime,a.appendChild(w));if(p=n.createElement("Screenshots"),!CMPUtils.IsNullOrEmpty(f))for(h=CMPUtils.getAllScreenshotsWithClipUiId(u.clipUiId,f),b=h.length,s=0;s<b;s++)c=n.createElement("Screenshot"),c.appendChild(CMPUtils.addNodeToXmlDoc(n,"ScreenshotId",h[s].id)),c.appendChild(CMPUtils.addNodeToXmlDoc(n,"ScreenshotCaptureTime",CMPUtils.ConvertSecondsToTimeCode(h[s].captureTimeSecs,o.frameRate))),c.appendChild(CMPUtils.addNodeToXmlDoc(n,"ScreenshotCaptureTimeSecs",h[s].captureTimeSecs)),c.appendChild(CMPUtils.addNodeToXmlDoc(n,"ScreenshotSelected",h[s].selected)),r._cmpModel._playerInfo.CMPConfig.CMPConfigValue.DynamicThumbnailPersistence.toString().toUpperCase()=="CLOUDEDITOR"&&c.appendChild(CMPUtils.addNodeToXmlDoc(n,"ScreenshotDataUri",h[s].dataUri)),p.appendChild(c);return e.appendChild(CMPUtils.addNodeToXmlDoc(n,"ClipModDuration",v)),e.appendChild(CMPUtils.addNodeToXmlDoc(n,"ClipStartOfMedia",o.startOfMedia)),e.appendChild(a),e.appendChild(p),e};SequenceManager.prototype.GetClipUrl=function(n){if(!(typeof n=="undefined")&&!CMPUtils.IsNullOrEmpty(n)){var t=CMPUtils.parseQueryString(n,!0);return t.ss=="2"?n:n.split("?")[0]}return""};SequenceManager.prototype.GetSegmentAsXml=function(n,t,i,r){var u=n.createElement("Segment"),f,e;return u.appendChild(CMPUtils.addNodeToXmlDoc(n,"SegmentUIId",t.uiId)),u.appendChild(CMPUtils.addNodeToXmlDoc(n,"SegmentId",t.id)),u.appendChild(CMPUtils.addNodeToXmlDoc(n,"SegmentStartTime",t.startTime)),f=CMPUtils.ConvertSecondsToTimeCode(t.startTime,r),u.appendChild(CMPUtils.addNodeToXmlDoc(n,"SegmentStartTimeFrame",f)),u.appendChild(CMPUtils.addNodeToXmlDoc(n,"SegmentStartTimeFrameBurntIn",CMPUtils.AddTimeCodes(i,f,r))),u.appendChild(CMPUtils.addNodeToXmlDoc(n,"SegmentEndTime",t.endTime)),e=CMPUtils.ConvertSecondsToTimeCode(t.endTime,r),u.appendChild(CMPUtils.addNodeToXmlDoc(n,"SegmentEndTimeFrame",e)),u.appendChild(CMPUtils.addNodeToXmlDoc(n,"SegmentEndTimeFrameBurntIn",CMPUtils.AddTimeCodes(i,e,r))),u.appendChild(CMPUtils.addNodeToXmlDoc(n,"SegmentEditType",t.editType)),u.appendChild(CMPUtils.addNodeToXmlDoc(n,"SegmentTrackType",t.trackType)),u.appendChild(CMPUtils.addNodeToXmlDoc(n,"SegmentComments",t.comments)),u.appendChild(CMPUtils.addNodeToXmlDoc(n,"SegmentTitle",t.title)),u};SequenceManager.prototype.GetPlaylistDuration=function(n){var f=0,u,t,i,e,r,o,s;if(n.length>0){for(u=0,t=0;t<n.length;t++)for(i=n[t],e=CMPUtils.getSequenceClipInfoObjectWithClipUiId(i.clipOrderId,this._cmpModel.sequenceClipInfo),r=0;r<n.length;r++)o=CMPUtils.getSequenceClipInfoObjectWithClipUiId(n[r].clipOrderId,this._cmpModel.sequenceClipInfo),e.position==o.position&&(u+=i.endTime-i.startTime);f+=u}return s=new MediaManager(this._nativeApi,this._cmpModel,this._instanceId),CMPUtils.RoundOffToNearestFrame(f,s.getFrameRateBasedOnMode())};SequenceManager.prototype.getPlaylistDurationListener=function(n){var t=r.GetPlaylistDuration(n.detail.cmpSeqObject);r._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.PLAYLIST_DURATION,{detail:{totalduration:t}}))};SequenceManager.prototype.updateTimelineSegmentPosition=function(n){var i;this._eventDispatcher.dispatchEvent(new CustomEvent(TimelineEvent.TIMELINE_EDITED));var r=this._cmpModel.ceProject.sequence,t=r.segments,u=this._cmpModel.ceProject.bin.clips;for(uniqueIndex=0;uniqueIndex<n.length;uniqueIndex++)for(segmentIndex=0;segmentIndex<t.length;segmentIndex++)t[segmentIndex].uiId==n[uniqueIndex].segmentUiId&&(i=CMPUtils.getSequenceClipInfoObjectWithClipUiId(t[segmentIndex].clipOrderId,this._cmpModel.sequenceClipInfo),this.updateTimelineClipPosition(n[uniqueIndex].position,i.uiId,this._cmpModel.ceProject.bin.clips),i.position=n[uniqueIndex].position);this._cmpModel.ceProject.sequence.segments=t;CMPUtils.setSegmentPosition(this._cmpModel.ceProject.sequence.segments,this._cmpModel.ceProject.bin.clips,this._cmpModel.sequenceClipInfo);CMPUtils.calculateSegmentTimeInSequence(this._cmpModel.ceProject.sequence.segments)};SequenceManager.prototype.updateTimelineClipPosition=function(n,t,i){for(clipIndex=0;clipIndex<i.length;clipIndex++)i[clipIndex].uiId==t&&(i[clipIndex].position=n)};SequenceManager.prototype.getCurrentSequenceMode=function(){return r._cmpModel.playerMode};SequenceManager.prototype.initialiseSegmentEditMode=function(n,t){this._cmpModel.autoPlay=t!=!0?!1:!0;this._cmpModel.playerMode=PlayerMode.SEQUENCE_SEGMENT_EDIT;this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SWITCH_SEQUENCE_MODE,{detail:{mode:PlayerMode.SEQUENCE_SEGMENT_EDIT}}));var i=CMPUtils.getSegmentBasedOnPosition(this._cmpModel.ceProject.sequence,n);this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:i,positionToSeek:i.startTime*1e3,autoPlay:this._cmpModel.autoPlay}}));new TimelineManager(this._nativeApi,this._cmpModel,this._instanceId).loadSegmentToTimelineMetadata()};SequenceManager.prototype.initialisePreviewMode=function(n,t){var u,i,f,o,e;this._cmpModel.isMixedFrameRate!=!0||this._cmpModel._playerInfo.CMPConfig.CMPConfigValue.EnableSequencePreviewForMixedFrameRate.toString().toUpperCase()=="TRUE"?(u=0,this._cmpModel.playerMode=PlayerMode.SEQUENCE_PREVIEW,this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SWITCH_SEQUENCE_MODE,{detail:{mode:PlayerMode.SEQUENCE_PREVIEW}})),this._cmpModel._ceProject._sequence.segments.length>0&&(i=null,f=new MediaManager(this._nativeApi,this._cmpModel,this._instanceId),f.checkLastPlayBackTimeThreshold(),this._cmpModel.mediaInfo.islastPlayBackTimeEnabled&&this._cmpModel.mediaInfo.lastPlayBackTime!=0?(o=f.getMediaDuration(),this._cmpModel.mediaInfo.lastPlayBackTime==o?(i=this._cmpModel.ceProject.sequence.segments[0],u=i.startTime):(e=this._cmpModel.mediaInfo.lastPlayBackTime,i=this.getSegmentBasedOnSequenceTime(this._cmpModel.ceProject.sequence,e),u=this.getClipTimeBasedOnSequenceTime(e))):(i=CMPUtils.IsNullOrEmpty(t)?new TimelineManager(this._nativeApi,this._cmpModel,this._instanceId).getNextSegment(1):this.getSegmentBasedOnSequenceTime(this._cmpModel.ceProject.sequence,t),this._cmpModel.autoPlay=n,u=i.startTime),this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:i,positionToSeek:parseFloat(u)*1e3}}))),new TimelineManager(this._nativeApi,this._cmpModel,this._instanceId).loadSequenceTimelineMetadata(),this._cmpModel.mediaInfo.islastPlayBackTimeEnabled&&this._cmpModel.mediaInfo.lastPlayBackTime!=0&&this._cmpModel.timelineMetadata.resetIndex(this._cmpModel.mediaInfo.lastPlayBackTime),this._cmpModel.segmentTimelineMetadata!=null&&(this._cmpModel.segmentTimelineMetadata.ResetLastFiredIndexAndClearTimers(),this._cmpModel.segmentTimelineMetadata.RemoveValue())):showErrorDetails("Preview not supported for mixed frame rates","0");r.enableOrDisablePlayRateFeatureForPlaylist(!1)};SequenceManager.prototype.updateThumbExtractionOnLoad=function(n){r._cmpModel.thumbExtractionOnLoad=n.detail.thumbExtractionOnLoad};SequenceManager.prototype.convertAllImplicitToExplicitSegments=function(){for(var n=this._cmpModel.ceProject.sequence.segments,t=0;t<n.length;t++)n[t].implictSegment=!1;return this._cmpModel.ceProject.sequence.segments=n,this._cmpModel.ceProject};SequenceManager.prototype.convertAllImplicitToExplicitSegmentsHandler=function(){r.convertAllImplicitToExplicitSegments();r._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.UPDATED_CEPROJECT,{detail:{ceProject:r._cmpModel.ceProject,sequenceClipInfo:r._cmpModel.sequenceClipInfo}}))};SequenceManager.prototype.updatePreviewableSegmentList=function(n){var t=n.detail.segments,i,u,f;for(i in t)t.hasOwnProperty(i)&&(u=r._cmpModel.segmentsToSkipPreview.indexOf(t[i].position),t[i].enabled?u!=-1&&r._cmpModel.segmentsToSkipPreview.splice(u,1):u==-1&&r._cmpModel.segmentsToSkipPreview.push(t[i].position));r._cmpModel.segmentsToSkipPreview.length==r._cmpModel.ceProject.sequence.segments.length&&(r._cmpModel.segmentsToSkipPreview=[]);new TimelineManager(r._nativeApi,r._cmpModel,r._instanceId).loadSequenceTimelineMetadata();r._cmpModel.timelineMetadata.resetIndex(r._cmpModel.currentSegment.startTimeInSequence);CMPUtils.IsNullOrEmpty(r._cmpModel.videoTimeline)||r._cmpModel.videoTimeline.resetIndex(r._cmpModel.currentSegment.startTimeInSequence);CMPUtils.IsNullOrEmpty(r._cmpModel.audioTimeline)||r._cmpModel.audioTimeline.resetIndex(r._cmpModel.currentSegment.startTimeInSequence);r._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW&&r._cmpModel.segmentsToSkipPreview.indexOf(r._cmpModel.currentSegment.position)!=-1&&r._cmpModel.timelineMetadata!=null&&(f=new TimelineManager(r._nativeApi,r._cmpModel,r._instanceId).getNextSegment(r._cmpModel.currentSegment.position+1),r._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:f,positionToSeek:f.startTime*1e3}})),r._cmpModel.timelineMetadata.resetIndex(f.startTimeInSequence))};SequenceManager.prototype.updateSegmentsPosition=function(n){var i,t;r._eventDispatcher.dispatchEvent(new CustomEvent(TimelineEvent.TIMELINE_EDITED));i=n.detail.segments;new TimelineManager(r._nativeApi,r._cmpModel,r._instanceId).loadSequenceTimelineMetadata();r._cmpModel.timelineMetadata.resetIndex(r._cmpModel.currentSegment.startTimeInSequence);r._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW&&r._cmpModel.segmentsToSkipPreview.indexOf(r._cmpModel.currentSegment.position)!=-1&&r._cmpModel.timelineMetadata!=null&&(t=new TimelineManager(r._nativeApi,r._cmpModel,r._instanceId).getNextSegment(r._cmpModel.currentSegment.position+1),r._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:t,positionToSeek:t.startTime*1e3}})))};SequenceManager.prototype.checkIfMixedFramerate=function(n){var i,t,r;if(n.length>0)for(i=CMPUtils.getClipObjectWithClipUiId(this._cmpModel.sequenceClipInfo[0]._clipUiId,n,this._cmpModel.sequenceClipInfo),t=1;t<this._cmpModel.sequenceClipInfo.length;t++)if(r=CMPUtils.getClipObjectWithClipUiId(this._cmpModel.sequenceClipInfo[t]._clipUiId,n,this._cmpModel.sequenceClipInfo),i.frameRate!=r.frameRate)return!0;return!1};SequenceManager.prototype.deleteSequence=function(){this._cmpModel.sequenceClipInfo=null;this._cmpModel.ceProject=null;this._cmpModel.segmentSeekPosition=-1;this._cmpModel.currentSegment=null;this._cmpModel.currentClipOrderId=null;this._cmpModel.isMixedFrameRate=!1;CMPUtils.IsNullOrEmpty(this._cmpModel.timelineMetadata)||(this._cmpModel.timelineMetadata.reset(),this._cmpModel.timelineMetadata.removeValue());CMPUtils.IsNullOrEmpty(this._cmpModel.videoTimeline)||(this._cmpModel.sequenceClipInfoForVideo=null,this._cmpModel.ceProjectForVideo=null,this._cmpModel.videoTimeline.reset(),this._cmpModel.videoTimeline.removeValue());CMPUtils.IsNullOrEmpty(this._cmpModel.audioTimeline)||(this._cmpModel.sequenceClipInfoForAudio=null,this._cmpModel.ceProjectForAudio=null,this._cmpModel.audioTimeline.reset(),this._cmpModel.audioTimeline.removeValue());(this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT||this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW)&&(this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.UNLOAD_MEDIA_URL)),this._eventDispatcher.dispatchEvent(new CustomEvent(CMPEvent.SET_CMP_STATE_EVENT,{detail:{newState:"WAITINGFORMEDIASOURCE"}})),this._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_REPORT)),this._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.SHOW_HIDE_GENERICS_ICON,{detail:{value:!0}})));this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SEQUENCE_DELETED))};SequenceManager.prototype.createClearEditorProjectObject=function(n){var u,a,h,o,i,c,f,v,s,l,e,t;if(r.objSequenceClipInfo=[],r.objClipDictionary={},r._cmpModel.currentSegment=null,r._cmpModel.currentClipOrderId=null,r._cmpModel.segmentSeekPosition=-1,r._cmpModel.isMixedFrameRate=!1,CMPUtils.IsNullOrEmpty(n.detail.playerMode)||(r._cmpModel.playerMode=n.detail.playerMode),u=CMPUtils.getClearEditorProjectObject(n.detail.sequenceXml,r._cmpModel),r._cmpModel.ceProject=u[0],r._cmpModel.sequenceClipInfo=u[1],CMPUtils.IsNullOrEmpty(n.detail.videoSequenceXml)||(u=CMPUtils.getClearEditorProjectObject(n.detail.videoSequenceXml,r._cmpModel),r._cmpModel.ceProjectForVideo=u[0],r._cmpModel.sequenceClipInfoForVideo=u[1]),r._cmpModel.audioTracksCollection=[],r._cmpModel.externalAudioTrackIndex=-1,r._cmpModel.timedTextTrackCollection=[],!CMPUtils.IsNullOrEmpty(n.detail.audioEssenceCollection)){for(r._cmpModel.playerInfo.AudioCollection=n.detail.audioEssenceCollection,o=[],i=0;i<r._cmpModel.playerInfo.AudioCollection.length;i++)c=CMPUtils.getClearEditorProjectObject(r._cmpModel.playerInfo.AudioCollection[i].PlaybackCloudXml,r._cmpModel),ceProjectForAudio=c[0],h=c[1],f=CMPUtils.getClipObjectWithClipUiId(r._timelineManager.getNextSegmentOfCeProject(1,ceProjectForAudio).clipOrderId,ceProjectForAudio._bin._clips,h),a=document.getElementById("hdnIsTokenIdRequired").value.toLowerCase()=="false"?f.url:f.url.toLowerCase().contains("?id=")?f.url:f.url+"?id="+r._cmpModel.playerInfo.TokenId,v=new AudioTrack(r._cmpModel.playerInfo.AudioCollection[i].AudioEssenceId,r._cmpModel.playerInfo.AudioCollection[i].AudioTrackId,r._cmpModel.playerInfo.AudioCollection[i].AudioEssenceTitle,r._cmpModel.playerInfo.AudioCollection[i].Language,a,i,"External",ceProjectForAudio,h),o.push(v);o.length>0&&r._audioManager.loadAudioTracks(o)}if(!CMPUtils.IsNullOrEmpty(n.detail.timedTextTrackCollection)){for(r._cmpModel.playerInfo.TimedTextCollection=n.detail.timedTextTrackCollection,s=[],l=r._cmpModel.playerInfo.CMPConfig,l!=null&&(e=l.CMPConfigValue["VideoPanelConfig.DefaultTTTNumber"],e==undefined&&(e=0),r._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&(e=1)),t=0;t<r._cmpModel.playerInfo.TimedTextCollection.length;t++){var y=r._cmpModel.playerInfo.TimedTextCollection[t].Extension,p=r._cmpModel.playerInfo.TimedTextCollection[t].FrameRate,w=r._cmpModel.playerInfo.TimedTextCollection[t].Language,b=r._cmpModel.playerInfo.TimedTextCollection[t].OffsetTime,k=r._cmpModel.playerInfo.TimedTextCollection[t].TimedTextType,d=r._cmpModel.playerInfo.TimedTextCollection[t].Url,g=r._cmpModel.playerInfo.TimedTextCollection[t].Version;s.push(new TimedTextTrack(k,w,d,b,p,y,null,g))}r._cmpModel.timedTextTrackCollection=s;r._cmpModel._formattingObject=new FormattingObject;r._eventDispatcher.dispatchEvent(new CustomEvent(TTTEvent.BIND_TIMED_TEXT_TRACKS,{detail:{timedTextTrackCollection:s,defaultTTTNumber:e}}))}r._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.CEPROJECT_LOADED,{detail:{ceProjectObject:r._cmpModel.ceProject,sequenceClipInfo:r._cmpModel.sequenceClipInfo}}))};SequenceManager.prototype.setAndDispatchOnFrameRateChanged=function(n){var r=this.checkIfMixedFramerate(n),t,i;this._cmpModel.isMixedFrameRate!=r&&(this._cmpModel.isMixedFrameRate=r,this._cmpModel.isMixedFrameRate==!0?(t="Variable_FrameRate",i=CMPUtils.getAllClipsFramerate(n,this._cmpModel.sequenceClipInfo)):(t="Constant_Framerate",i=new MediaManager(this._nativeApi,this._cmpModel,this._instanceId).getFrameRateBasedOnMode()),this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.FRAMERATE_CHANGED,{detail:{type:t,framerate:i}})))};SequenceManager.prototype.initialiseCplPreviewMode=function(n){(this._cmpModel.isMixedFrameRate!=!0||this._cmpModel._playerInfo.CMPConfig.CMPConfigValue.EnableSequencePreviewForMixedFrameRate.toString().toUpperCase()=="TRUE")&&(this._cmpModel.isSequencePlayBackOptimized?this.requestOptimizedPlaybackCExml(n):this.loadCPLTimeline(0,n))};SequenceManager.prototype.loadCPLTimeline=function(n,t){var f,e,u,i;this._cmpModel.playerMode=PlayerMode.SEQUENCE_CPL_PREVIEW;this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SWITCH_SEQUENCE_MODE,{detail:{mode:PlayerMode.SEQUENCE_CPL_PREVIEW}}));this._cmpModel._ceProjectForVideo._sequence.segments.length>0&&(this._cmpModel.mediaInfo.islastPlayBackTimeEnabled&&this._cmpModel.mediaInfo.lastPlayBackTime!=0&&(e=r._mediaManager.getMediaDuration(),n=this._cmpModel.mediaInfo.lastPlayBackTime==e?0:this._cmpModel.mediaInfo.lastPlayBackTime),CMPUtils.IsNullOrEmpty(n)||(u=this.getSegmentBasedOnSequenceTime(this._cmpModel.ceProject.sequence,n),i=this.getSegmentBasedOnSequenceTime(this._cmpModel._ceProjectForVideo.sequence,n),f=n),(CMPUtils.IsNullOrEmpty(u)||CMPUtils.IsNullOrEmpty(i))&&(u=new TimelineManager(this._nativeApi,this._cmpModel,this._instanceId).getNextSegmentOfCeProject(1,this._cmpModel._ceProject),i=new TimelineManager(this._nativeApi,this._cmpModel,this._instanceId).getNextSegmentOfCeProject(1,this._cmpModel._ceProjectForVideo),f=i.startTimeInSequence),this._cmpModel.autoPlay=t,this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:u,positionToSeek:parseFloat(f)*1e3,timelineType:TimelineType.VIDEO,timelineTypeSegment:i}})));new TimelineManager(this._nativeApi,this._cmpModel,this._instanceId).loadSequenceTimelineMetadata();this._cmpModel.mediaInfo.islastPlayBackTimeEnabled&&this._cmpModel.mediaInfo.lastPlayBackTime!=0&&(this._cmpModel.timelineMetadata.resetIndex(this._cmpModel.mediaInfo.lastPlayBackTime),CMPUtils.IsNullOrEmpty(this._cmpModel.videoTimeline)||this._cmpModel.videoTimeline.resetIndex(this._cmpModel.mediaInfo.lastPlayBackTime),CMPUtils.IsNullOrEmpty(this._cmpModel.audioTimeline)||this._cmpModel.audioTimeline.resetIndex(this._cmpModel.mediaInfo.lastPlayBackTime))};SequenceManager.prototype.requestOptimizedPlaybackCExml=function(n){for(var e,h,t,o,i,s=CMPUtils.StringToXML(r._cmpModel.playerInfo.sequenceInfo.SequenceXml),f=s.getElementsByTagName("Clip"),u=0;u<f.length;u++)f[u].getElementsByTagName("Screenshots").length>0&&(f[u].getElementsByTagName("Screenshots")[0].innerHTML=" ");e=CMPUtils.XmlToString(s);document.getElementById(this._instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{message:"Loading Media",display:!0}}));h=/constructor/i.test(window.HTMLElement)||function(n){return n.toString()==="[object SafariRemoteNotification]"}(!window.safari||typeof safari!="undefined"&&safari.pushNotification);r._cmpModel._playerInfo.CMPConfig.CMPConfigValue["Portal.PlayerType"].toUpperCase()=="HTML5_V2"&&h!=!0?(t=new XMLHttpRequest,t.open("POST",this._cmpModel.optimizedSequenceUrl,!0),t.setRequestHeader("Content-Type","text/plain"),t.withCredentials=!0,t.send(e),o=!1,t.onerror=function(){r.initialisePreviewMode(!0)},t.onloadend=function(){var i,u;t.status==200?CMPUtils.IsNullOrEmpty(t.responseText)||(i=JSON.parse(t.responseText),i.status.toUpperCase()=="SUCCESS"?(o=!0,r._cmpModel.playerInfo.sequenceInfo.VideoSequenceXml=atob(i.optimisedPlaylist),u=CMPUtils.getClearEditorProjectObject(r._cmpModel.playerInfo.sequenceInfo.VideoSequenceXml,r._cmpModel),r._cmpModel.ceProjectForVideo=u[0],r._cmpModel.sequenceClipInfoForVideo=u[1],r._cmpModel.currentSegment=null,r._cmpModel.currentClipOrderId=null,r.loadCPLTimeline("",n)):r.initialisePreviewMode(!0)):r.initialisePreviewMode(!0);r.enableOrDisablePlayRateFeatureForPlaylist(o)}):(i=new XMLHttpRequest,i.onreadystatechange=function(){var t,u,f;i.readyState==4&&(t=!1,i.status==200?CMPUtils.IsNullOrEmpty(i.responseText)||(u=JSON.parse(i.responseText),u.status.toUpperCase()=="SUCCESS"?(t=!0,r._cmpModel.playerInfo.sequenceInfo.VideoSequenceXml=atob(u.optimisedPlaylist),f=CMPUtils.getClearEditorProjectObject(r._cmpModel.playerInfo.sequenceInfo.VideoSequenceXml,r._cmpModel),r._cmpModel.ceProjectForVideo=f[0],r._cmpModel.sequenceClipInfoForVideo=f[1],r._cmpModel.currentSegment=null,r._cmpModel.currentClipOrderId=null,r.loadCPLTimeline("",n)):r.initialisePreviewMode(!0)):r.initialisePreviewMode(!0),r.enableOrDisablePlayRateFeatureForPlaylist(t))},i.open("POST",this._cmpModel.optimizedSequenceUrl,!0),i.setRequestHeader("Content-Type","text/plain"),i.send(e))};SequenceManager.prototype.enableOrDisablePlayRateFeatureForPlaylist=function(n){r._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.TOGGLE_UI_CONTROL_VISIBILITY,{detail:{controlKeyName:"enableplayratebuttons",isEnable:n,isDisplay:n}}))};SequenceManager.prototype.getClipTimeBasedOnSequenceTimeInCeProject=function(n,t){var r=new MediaManager(this._nativeApi,this._cmpModel,this._instanceId),i;for(n=CMPUtils.RoundOffToNearestFrame(n,r.getFrameRateBasedOnMode()),segmentIndex=0;segmentIndex<t.sequence.segments.length;segmentIndex++)if(i=t.sequence.segments[segmentIndex],n>=CMPUtils.RoundOffToNearestFrame(i.startTimeInSequence,r.getFrameRateBasedOnMode())&&n<CMPUtils.RoundOffToNearestFrame(i.endTimeInSequence,r.getFrameRateBasedOnMode()))return parseFloat(i.startTime)+(n-i.startTimeInSequence)};SequenceManager.prototype.timelineEditDetected=function(){r._cmpModel.isSequencePlayBackOptimized&&(r._cmpModel.isSequencePlayBackOptimized=!1,r._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&r.initialisePreviewMode(!0,r._mediaManager.getCurrentTime()))};SequenceManager.prototype.spliceClip=function(n){for(var o,f,l=n.detail.segmentUiId,s=r.getClipTimeBasedOnSequenceTime(n.detail.sequenceTimeToSpilce),c=r.getSegmentBasedOnSequenceTime(r._cmpModel.ceProject.sequence,n.detail.sequenceTimeToSpilce),t=r._cmpModel.ceProject.sequence.segments,a=r._cmpModel.ceProject.bin.clips,e=0,i,h,u=0;u<t.length;u++)if(t[u].uiId==c.uiId){o=CMPUtils.getSequenceClipInfoObjectWithClipUiId(t[u].clipOrderId,r._cmpModel.sequenceClipInfo);e=o.position;f=new SequenceClipInfo;f.clipId=o.clipId;f.clipUiId=CMPUtils.generateRandomGuidId();f.position=e+1;r._cmpModel.sequenceClipInfo.splice(e,0,f);i=new Segment;i.clipOrderId=f.clipUiId;i.uiId=CMPUtils.generateRandomGuidId();i.startTime=s;i.endTime=t[u].endTime;i.title=t[u].title;i.comments=t[u].comments;i.editType=t[u].editType;i.trackType=t[u].trackType;i.implictSegment=!1;t[u].endTime=s;h=t[u];t.push(i);break}r._cmpModel.sequenceClipInfo=CMPUtils.setClipPosition(r._cmpModel.sequenceClipInfo);r._cmpModel.ceProject.sequence.segments=t;CMPUtils.setSegmentPosition(r._cmpModel.ceProject.sequence.segments,r._cmpModel.ceProject.bin.clips,r._cmpModel.sequenceClipInfo);CMPUtils.calculateSegmentTimeInSequence(r._cmpModel.ceProject.sequence.segments);new TimelineManager(r._nativeApi,r._cmpModel,r._instanceId).loadSequenceTimelineMetadata();r._cmpModel.timelineMetadata.resetIndex(r._mediaManager.getCurrentTime());r._eventDispatcher.dispatchEvent(new CustomEvent(TimelineEvent.TIMELINE_EDITED));r._eventDispatcher.dispatchEvent(new CustomEvent(TimelineBarEvent.SPLICED_CLIPS,{detail:{oldSegment:h,newSegment:i,sequenceDuration:r._mediaManager.getMediaDuration()}}))};SequenceManager.prototype.calculateSequenceBufferTimeForMergedPlaylist=function(n,t){for(var r=this._cmpModel.ceProjectForVideo.sequence.segments,u=0,f=this.getClipTimeBasedOnSequenceTimeInCeProject(t,this._cmpModel.ceProjectForVideo),e=f+n,i=this._cmpModel.currentSegment.position-1;i<=r.length;i++){if(e<=r[i].endTime)return e-f-u;if(CMPUtils.IsNullOrEmpty(r[i+1])||e<=r[i+1].startTime)return r[i].endTime-f-u;u+=r[i+1].startTime-r[i].endTime}}}function TimelineManager(n,t,i){this._sequence;this._cmpModel=t;this._instanceId=i;this._nativeApi=n;this._eventDispatcher=document.getElementById(this._instanceId);var r=this;TimelineManager.prototype.loadSequenceTimelineMetadata=function(){this._sequence=this._cmpModel.ceProject.sequence;(this._cmpModel.timelineMetadata!=null||this._cmpModel.videoTimeline!=null||this._cmpModel.audioTimeline!=null)&&this.removeTimelineMetaDataEventListener();this._cmpModel.timelineMetadata!=null&&(this._cmpModel.timelineMetadata.removeValue(),this._cmpModel.timelineMetadata=null);this._cmpModel.videoTimeline!=null&&(this._cmpModel.videoTimeline.removeValue(),this._cmpModel.videoTimeline=null);this._cmpModel.audioTimeline!=null&&(this._cmpModel.audioTimeline.removeValue(),this._cmpModel.audioTimeline=null);this._sequence!=null&&this.addSequenceTimelineMarkers()};TimelineManager.prototype.loadSegmentToTimelineMetadata=function(){this._sequence=this._cmpModel.ceProject.sequence;this._cmpModel.timelineMetadata!=null&&this.removeTimelineMetaDataEventListener();this._cmpModel.timelineMetadata!=null&&this._cmpModel.timelineMetadata.removeValue();this._sequence!=null&&this.addSequenceTimelineMarkers()};TimelineManager.prototype.loadStrataMarkersToTimelineMetadata=function(){this._cmpModel.strataTimelineMetadata!=null&&this.removeTimelineMetaDataEventListener();this._cmpModel.strataTimelineMetadata!=null&&this._cmpModel.strataTimelineMetadata.removeValue();this.addStrataTimelineMarker()};TimelineManager.prototype.addStrataTimelineMarker=function(){this._cmpModel.strataTimelineMetadata=new PlaylistMetadata(this._nativeApi,this._cmpModel,this._instanceId);var n=new SequenceTimelineMetadata;n.time=parseFloat(this._cmpModel.mediaInfo.startSeek/1e3);n.duration=parseFloat((this._cmpModel.mediaInfo.endSeek-this._cmpModel.mediaInfo.startSeek)/1e3);this._cmpModel.strataTimelineMetadata.addMarker(n)};TimelineManager.prototype.addSequenceTimelineMarkers=function(){var r,i,n,t;this._cmpModel.timelineMetadata=new PlaylistMetadata(this._nativeApi,this._cmpModel,this._instanceId);this._sequence!=null&&(r=new MediaManager(this._nativeApi,this._cmpModel,this._instanceId),i=r.getFrameRateBasedOnMode(),this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT?(n=this._cmpModel.currentSegment,t=new SequenceTimelineMetadata,t.time=parseFloat(n.startTime),t.duration=CMPUtils.IsNullOrEmpty(n.endTimeInSequence)?CMPUtils.RoundOffToNearestFrame(n.endTime-n.startTime,i):parseFloat(n.endTimeInSequence>0?CMPUtils.RoundOffToNearestFrame(n.endTime-n.startTime,i):NaN),t.segment=n,this._cmpModel.timelineMetadata.addMarker(t)):this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW?this.addMarkersToTimeline(this._sequence,this._cmpModel.timelineMetadata):this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&(this._cmpModel.videoTimeline=new PlaylistMetadata(this._nativeApi,this._cmpModel,this._instanceId),this.addMarkersToTimeline(this._sequence,this._cmpModel.timelineMetadata),this.addMarkersToTimeline(this._cmpModel.ceProjectForVideo.sequence,this._cmpModel.videoTimeline,TimelineType.VIDEO)))};TimelineManager.prototype.addMarkersToTimeline=function(n,t,i){for(var r,u,o=new MediaManager(this._nativeApi,this._cmpModel,this._instanceId),e=o.getFrameRateBasedOnMode(),f=1;f<=n.segments.length;f++)for(r=0;r<n.segments.length;r++)n.segments[r].position==f&&this._cmpModel.segmentsToSkipPreview.indexOf(n.segments[r].position)==-1&&(u=new SequenceTimelineMetadata,u.time=CMPUtils.RoundOffToNearestFrame(n.segments[r].startTimeInSequence,e),u.duration=parseFloat(n.segments[r].endTimeInSequence>0?CMPUtils.RoundOffToNearestFrame(n.segments[r].endTimeInSequence-n.segments[r].startTimeInSequence,e):NaN),u.timelineType=i,u.segment=n.segments[r],t.addMarker(u))};TimelineManager.prototype.updateTimelineMarkers=function(){var u=new MediaManager(this._nativeApi,this._cmpModel,this._instanceId),r=u.getFrameRateBasedOnMode(),i,n,t;for(this._sequence=this._cmpModel.ceProject.sequence,this._cmpModel.timelineMetadata.markerCollection=null,i=1;i<=this._sequence.segments.length;i++)for(n=0;n<this._sequence.segments.length;n++)this._sequence.segments[n].position==i&&this._cmpModel.segmentsToSkipPreview.indexOf(this._sequence.segments[n].position)==-1&&(t=new SequenceTimelineMetadata,t.time=CMPUtils.RoundOffToNearestFrame(this._sequence.segments[n].startTimeInSequence,r),t.duration=parseFloat(this._sequence.segments[n].endTimeInSequence>0?CMPUtils.RoundOffToNearestFrame(this._sequence.segments[n].endTimeInSequence-this._sequence.segments[n].startTimeInSequence,r):NaN),t.segment=this._sequence.segments[n],this._cmpModel.timelineMetadata.addMarker(t))};TimelineManager.prototype.addTimelineMetaDataEventListener=function(){this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW&&(this._cmpModel.timelineMetadata=new PlaylistMetadata(this._nativeApi,this._cmpModel,this._instanceId));this._eventDispatcher.addEventListener(PlaylistMetadataEvent.PLAYLIST_MARKER_TIME_REACHED,this.segmentTimeReached);this._eventDispatcher.addEventListener(PlaylistMetadataEvent.PLAYLIST_MARKER_DURATION_REACHED,this.segmentDurationReached)};TimelineManager.prototype.addTimelineMetaDataEventListenerEditMode=function(){this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT&&(this._cmpModel.timelineMetadata=new PlaylistMetadata(this._nativeApi,this._cmpModel,this._instanceId));this._eventDispatcher.addEventListener(PlaylistMetadataEvent.PLAYLIST_MARKER_TIME_REACHED,this.segmentTimeReached);this._eventDispatcher.addEventListener(PlaylistMetadataEvent.PLAYLIST_MARKER_DURATION_REACHED,this.segmentDurationReached)};TimelineManager.prototype.removeTimelineMetaDataEventListener=function(){this._eventDispatcher.removeEventListener(PlaylistMetadataEvent.PLAYLIST_MARKER_TIME_REACHED,this.segmentTimeReached,!1);this._eventDispatcher.removeEventListener(PlaylistMetadataEvent.PLAYLIST_MARKER_DURATION_REACHED,this.segmentDurationReached,!1)};TimelineManager.prototype.strataSegmentStartReached=function(){};TimelineManager.prototype.strataSegmentDurationReached=function(){};TimelineManager.prototype.segmentTimeReached=function(){};TimelineManager.prototype.segmentDurationReached=function(n){var e=!1,s=n.detail.marker,h=getCMPInstanceByNativeInstanceId(r._instanceId+"_ClearMediaPlayer"),t=r._cmpModel.playbackSpeedRange[r._cmpModel.currentPlaybackSpeedIndex]>0?"forward":"reverse",o,u,i,c,f;if(r._stateMachine=h.getInjector().getInstance("stateMachine"),r._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||r._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT){if(s!=null)if(r._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT)r._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PAUSE)),r._cmpModel.pauseAtLastFrame==!0?r._cmpModel.segmentDurationReached=!0:(o=r._cmpModel.currentSegment,r._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SEEK,{detail:{positionInMsec:o.startTime*1e3}})),r._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.REMOVE_MARKERS)),r._cmpModel.timelineMetadata.reset());else{if(r._cmpModel.autoPlay=r._stateMachine.currentState==r._stateMachine.stateCollection.PLAYING||r._stateMachine.currentState==r._stateMachine.stateCollection.BUFFERING&&r._cmpModel.oldState.toUpperCase()=="PLAYING"||r._cmpModel.oldState.toUpperCase()=="PLAYING"&&r._cmpModel.isMediaDurationReached?!0:!1,r._cmpModel.isMediaDurationReached&&(r._cmpModel.isMediaDurationReached=!1),r._cmpModel.pauseOnSegmentDurationReached){r._cmpModel.pauseOnSegmentDurationReached=!1;r._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PAUSE));return}n.detail.marker.segment.position==r._cmpModel.ceProject.sequence.segments.length?(r._cmpModel.autoPlay=!1,nextSegment=r.getNextSegment(1),r._cmpModel.timelineMetadata.reset(),r._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.RESET_PLAYBACK_SPEED)),r._cmpModel.mediaInfo.islastPlayBackTimeEnabled&&(e=!0,r._cmpModel.isMediaFullyWatched=!0,r._eventDispatcher.dispatchEvent(new CustomEvent(LastPlayBackTimeEvent.ADD_OR_UPDATE_LPT,{detail:{playerContainerId:r._instanceId}}))),r._eventDispatcher.dispatchEvent(new CustomEvent(TimelineEvent.LAST_FRAME_REACHED))):nextSegment=r.getNextSegment(n.detail.marker.segment.position+1);i=parseFloat(nextSegment.startTime)*1e3;r._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:nextSegment,positionToSeek:i}}))}}else r._cmpModel.playerMode==PlayerMode.STRATA?r._cmpModel.pauseAtLastFrame==!0?(r._cmpModel.segmentDurationReached=!0,r._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PAUSE))):(r._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SEEK,{detail:{positionInMsec:r._cmpModel.mediaInfo.startSeek,stateAfterSeek:"pause"}})),r._cmpModel.strataTimelineMetadata.resetIndex(parseFloat(r._cmpModel.mediaInfo.endSeek)/1e3)):r._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&(r._stateMachine.currentState==r._stateMachine.stateCollection.PLAYING||r._stateMachine.currentState==r._stateMachine.stateCollection.BUFFERING&&r._cmpModel.oldState.toUpperCase()=="PLAYING"||r._cmpModel.isMediaDurationReached&&r._cmpModel.oldState.toUpperCase()=="PLAYING"&&n.detail.marker.timelineType!=null?(r._cmpModel.autoPlay=!0,r._cmpModel.isMediaDurationReached=!1):r._cmpModel.autoPlay=!1,n.detail.marker.timelineType==null?(r.isFirstOrLastSegment(n)?(nextSegment=r.getNextSegment(1),r._cmpModel.timelineMetadata.reset()):(u=t=="forward"?n.detail.marker.segment.position+1:n.detail.marker.segment.position-1,nextSegment=r.getNextSegment(u)),r._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.ACTIVE_SEGMENT_CHANGED,{detail:{segment:nextSegment}}))):n.detail.marker.timelineType==TimelineType.VIDEO?(f=n.detail.marker.segment,r.isFirstOrLastSegment(n)?(r._cmpModel.autoPlay=!1,nextSegment=r.getNextSegmentOfCeProject(1,r._cmpModel.ceProjectForVideo),r._cmpModel.videoTimeline.reset(),r._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.RESET_PLAYBACK_SPEED)),r._cmpModel.mediaInfo.islastPlayBackTimeEnabled&&(r._cmpModel.isMediaFullyWatched=!0,r._eventDispatcher.dispatchEvent(new CustomEvent(LastPlayBackTimeEvent.ADD_OR_UPDATE_LPT,{detail:{playerContainerId:r._instanceId}}))),r._eventDispatcher.dispatchEvent(new CustomEvent(TimelineEvent.LAST_FRAME_REACHED)),r._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:nextSegment,positionToSeek:nextSegment.startTimeInSequence*1e3}}))):(u=t=="forward"?n.detail.marker.segment.position+1:n.detail.marker.segment.position-1,t=="forward"?(nextSegment=r.getNextSegmentOfCeProject(u,r._cmpModel.ceProjectForVideo),i=parseFloat(nextSegment.startTimeInSequence)*1e3):t=="reverse"&&(nextSegment=r.getPrevSegmentOfCeProject(u,r._cmpModel.ceProjectForVideo),i=parseFloat(nextSegment.endTimeInSequence)*1e3),r._cmpModel.timelineMetadata.resetIndex(nextSegment.startTimeInSequence),CMPUtils.IsNullOrEmpty(r._cmpModel.videoTimeline)||r._cmpModel.videoTimeline.resetIndex(nextSegment.startTimeInSequence),CMPUtils.IsNullOrEmpty(r._cmpModel.audioTimeline)||r._cmpModel.audioTimeline.resetIndex(nextSegment.startTimeInSequence),r._cmpModel.currentSegment=nextSegment,r.setSegmentInfo(),c=t=="reverse"?f.startTime-nextSegment.endTime:nextSegment.startTime-f.endTime,r._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:nextSegment,positionToSeek:i}})))):n.detail.marker.timelineType==TimelineType.AUDIO&&(f=n.detail.marker.segment,n.detail.marker.segment.position==r._cmpModel.ceProjectForAudio.sequence.segments.length?r._cmpModel.audioTimeline.reset():(nextSegment=r.getNextSegmentOfCeProject(n.detail.marker.segment.position+1,r._cmpModel.ceProjectForAudio),r._nativeApi.syncWithOffset(0,nextSegment.startTime-f.endTime))));e&&!r._cmpModel.isMediaFullyWatched&&(r._cmpModel.isMediaFullyWatched=!0)};TimelineManager.prototype.setSegmentInfo=function(){var n=new MediaManager(this._nativeApi,this._cmpModel,this._instanceId);this._cmpModel.mediaDuration=n.getMediaDuration();this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.SET_MEDIA_DURATION,{detail:{duration:this._cmpModel.mediaDuration}}));this.updateMediaInfo();document.getElementById(this._instanceId).dispatchEvent(new CustomEvent(SeekBarEvent.LOAD_SEEKBAR,{detail:{mediaInfo:this._cmpModel.mediaInfo,currentSegment:this._cmpModel.currentSegment}}))};TimelineManager.prototype.updateMediaInfo=function(){if(this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT){var n=CMPUtils.getClipObjectWithClipUiId(this._cmpModel.currentSegment.clipOrderId,this._cmpModel.ceProject.bin.clips,this._cmpModel.sequenceClipInfo);CMPUtils.IsNullOrEmpty(this._cmpModel.mediaInfo)&&(this._cmpModel.mediaInfo=new MediaInfo);this._cmpModel.mediaInfo.startSeek=CMPUtils.RoundOffToNearestFrameWithMilliSecs(n.startTime*1e3,this._mediaManager.getFrameRateBasedOnMode());this._cmpModel.mediaInfo.endSeek=CMPUtils.RoundOffToNearestFrameWithMilliSecs(n.endTime*1e3,this._mediaManager.getFrameRateBasedOnMode());this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW?this.updateMediaInfoSom():this._cmpModel.mediaInfo.som="00:00:00:00";this._cmpModel.mediaInfo.frameRate=parseFloat(n._frameRate)}else this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW&&(CMPUtils.IsNullOrEmpty(this._cmpModel.mediaInfo)||this.updateMediaInfoSom())};TimelineManager.prototype.updateMediaInfoSom=function(){this._cmpModel.mediaInfo.som=CMPUtils.IsNullOrEmpty(this._cmpModel._ceProject._sequence._sequenceSom)?CMPUtils.IsNullOrEmpty(this._cmpModel._defaultSequenceSom)?"00:00:00:00":this._cmpModel._defaultSequenceSom:this._cmpModel._ceProject._sequence._sequenceSom};TimelineManager.prototype.isFirstOrLastSegment=function(n){return n.detail.marker.segment.position==r._cmpModel.ceProject.sequence.segments.length&&r._cmpModel.playbackSpeedRange[r._cmpModel.currentPlaybackSpeedIndex]>0||n.detail.marker.segment.position==1&&r._cmpModel.playbackSpeedRange[r._cmpModel.currentPlaybackSpeedIndex]<0?!0:!1};TimelineManager.prototype.getNextSegment=function(n){var t;return n<=this._cmpModel.ceProject.sequence.segments.length?t=CMPUtils.getSegmentBasedOnPosition(this._cmpModel.ceProject.sequence,n):(n=1,t=CMPUtils.getSegmentBasedOnPosition(this._cmpModel.ceProject.sequence,n),r._cmpModel.timelineMetadata.reset()),this._cmpModel.segmentsToSkipPreview.indexOf(t.position)!=-1?this.getNextSegment(n+1):t};TimelineManager.prototype.getNextSegmentOfCeProject=function(n,t){var i;return n<=t.sequence.segments.length?i=CMPUtils.getSegmentBasedOnPosition(t.sequence,n):(n=1,i=CMPUtils.getSegmentBasedOnPosition(t.sequence,n),this._cmpModel.videoTimeline!=null&&this._cmpModel.videoTimeline.reset()),this._cmpModel.segmentsToSkipPreview.indexOf(i.position)!=-1?this.getNextSegmentOfCeProject(n+1,t):i};TimelineManager.prototype.getPrevSegment=function(n){var t;return n<=0?(n=this._cmpModel.ceProject.sequence.segments.length,t=CMPUtils.getSegmentBasedOnPosition(this._cmpModel.ceProject.sequence,n),r._cmpModel.timelineMetadata.reset()):t=CMPUtils.getSegmentBasedOnPosition(this._cmpModel.ceProject.sequence,n),this._cmpModel.segmentsToSkipPreview.indexOf(t.position)!=-1?this.getPrevSegment(n-1):t};TimelineManager.prototype.getPrevSegmentOfCeProject=function(n,t){var i;return n<=0?(n=this._cmpModel.ceProject.sequence.segments.length,i=CMPUtils.getSegmentBasedOnPosition(t.sequence,n),r._cmpModel.timelineMetadata.reset()):i=CMPUtils.getSegmentBasedOnPosition(t.sequence,n),this._cmpModel.segmentsToSkipPreview.indexOf(i.position)!=-1?this.getPrevSegmentOfCeProject(n-1,t):i};TimelineManager.prototype.loadRangeMarkers=function(n){var e,t;r._cmpModel.playerMode==PlayerMode.SEQUENCE_CLIP?r._cmpModel.currentSegment=n.segment:n.isPlayerInEditMode!=undefined&&(r._cmpModel.isPlayerInEditMode=n.isPlayerInEditMode);r._cmpModel.segmentTimelineMetadata!=null&&(r._cmpModel.segmentTimelineMetadata.ResetLastFiredIndexAndClearTimers(),r._cmpModel.segmentTimelineMetadata.RemoveValue());n.loopToSegStartOnSegEnd!=undefined&&(r._cmpModel.loopToSegStartOnSegEnd=n.loopToSegStartOnSegEnd);var o=new MediaManager(r._nativeApi,r._cmpModel,r._instanceId),i=o.getFrameRateBasedOnMode(),u=CMPUtils.RoundOffToNearestFrame(n.startTimeInMsec/1e3,i),f=CMPUtils.RoundOffToNearestFrame(n.endTimeInMsec/1e3,i);new MarkerManager(r._cmpModel).createMarker(u,f,null,n.segmentId);r._cmpModel.segmentTimelineMetadata=new TimelineMetadata(r._nativeApi,r._cmpModel,r._instanceId);e=(parseInt(n.endTimeInMsec)-parseInt(n.startTimeInMsec))/1e3;t={};t.time=u;t.duration=e;t.markout=f;t.type="SEGMENT";t.autoPlay=n.autoPlay;r._cmpModel.segmentTimelineMetadata.AddMarker(t);r._eventDispatcher.addEventListener(TimelineMetadataEvent.MARKER_DURATION_REACHED,r.onSegmentDurationReached);n.autoPlay.toLowerCase()!="true"?r._nativeApi.Pause():n.autoPlay.toLowerCase()=="true"&&r._nativeApi.Play();n.isRetainCurrentPos||r._nativeApi.Seek(CMPUtils.RoundOffToNearestFrameWithMilliSecs(n.startTimeInMsec,i));this._cmpModel.mediaInfo.isLive&&(this._cmpModel.isSeekToLiveRequested=!1);r._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.CREATE_MARKER,{detail:{markIn:u,markOut:f}}));r._cmpModel.isPlayerInEditMode&&r._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.ENABLE_MARKOUT,{detail:{markOutClassName:"MarkOutContiguous setLeft"}}))};TimelineManager.prototype.onSegmentDurationReached=function(){var n=event.detail.marker,t;n.hasOwnProperty("type")&&n.type=="SEGMENT"&&(r._cmpModel.playerMode==PlayerMode.SEQUENCE_CLIP?r._nativeApi.Pause():r._cmpModel.loopToSegStartOnSegEnd&&r._cmpModel.loopToSegStartOnSegEnd!=undefined?(r._cmpModel.loopToSegStartOnSegEnd=undefined,r._nativeApi.Seek(n.time*1e3),t={},t.startTimeInMsec=n.time*1e3,t.endTimeInMsec=n.markout*1e3,t.autoPlay="true",t.loopToSegStartOnSegEnd="true",r._eventDispatcher.removeEventListener(TimelineMetadataEvent.MARKER_DURATION_REACHED,r.onSegmentDurationReached),r.loadRangeMarkers(t)):(r._cmpModel.playerInfo.CMPConfig.CMPConfigValue.PauseOnSegmentDurationReached.toLowerCase()=="true"&&r._nativeApi.Pause(),r._nativeApi.Seek(n.markout*1e3)))}}function ShortcutManager(n,t){this._eventDispatcher=document.getElementById(t);this._globalEventDispatcher=document.querySelector("body");this._cmpModel=n;this.arrOfShortcutOptions=[];this.arrOfShortcutObject=[];this.globalArrOfShortcutOptions=[];this.globalArrOfShortcutObject=[];var i=this;ShortcutManager.prototype.initialiseShortcut=function(){var t=[],i,n;if(t.push(this._eventDispatcher.parentNode),this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.ShortcutEnableContainerIds&&this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.ShortcutEnableContainerIds!="")for(i=this._cmpModel.playerInfo.CMPConfig.CMPConfigValue.ShortcutEnableContainerIds.split(","),n=0;n<i.length;n++)document.getElementById(i[n])&&t.push(document.getElementById(i[n]));for(n=0;n<t.length;n++)this.shortcut=new Shortcut,this.arrOfShortcutObject.push(this.shortcut),this.arrOfShortcutOptions.push({type:"keydown",propagate:!1,disable_in_input:!0,target:t[n],keycode:!1}),t[n].onhelp=function(){return!1};this.addShortCutBasedOnAssetClass()};ShortcutManager.prototype.initialiseGlobalShortcut=function(){var n,t;if(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableGlobalShortcut"]=="true"){for(n=[],n.push(this._globalEventDispatcher),t=0;t<n.length;t++)this.shortcut=new Shortcut,this.globalArrOfShortcutObject.push(this.shortcut),this.globalArrOfShortcutOptions.push({type:"keydown",propagate:!1,disable_in_input:!1,target:n[t],keycode:!1}),n[t].onhelp=function(){return!1};this.addShortCutBasedOnAssetClass()}};ShortcutManager.prototype.addShortCutBasedOnAssetClass=function(){CMPUtils.IsNullOrEmpty(this._cmpModel._mediaInfo)||((this._cmpModel._mediaInfo._assetClass.toUpperCase()=="VIDEO"||this._cmpModel._mediaInfo._assetClass.toUpperCase()=="PLAYLIST")&&(this.ValidateAndAddShortCut("EnableFrameNavigation"),this.ValidateAndAddShortCut("EnableSecondsNavigation"),this.ValidateAndAddShortCut("EnableMinuteNavigation"),this.ValidateAndAddShortCut("EnableMarkInOut"),this.ValidateAndAddShortCut("EnablePlayRateButtons"),this.ValidateAndAddShortCut("EnableMarkerNavigation"),this.ValidateAndAddShortCut("EnableMediaInfoView"),this.ValidateAndAddShortCut("EnableDebuggerMode"),this.ValidateAndAddShortCut("EnablePrevNextSegment"),this.ValidateAndAddShortCut("EnableGoToStartOrEndSequence"),this.ValidateAndAddShortCut("EnableNavigationInPreviewpanel"),this.ValidateAndAddShortCut("EnableScte35MarkInOut"),this.ValidateAndAddShortCut("EnableMarkInOutAbortShortcut"),this.ValidateAndAddShortCut("EnableSegmentDelete")),this._cmpModel._mediaInfo._assetClass!="AUDIO"&&this.ValidateAndAddShortCut("EnableFullScreenToggle"),(this._cmpModel._mediaInfo._assetClass=="DOCUMENT"||this._cmpModel._mediaInfo._assetClass=="IMAGE")&&this.ValidateAndAddShortCut("EnableFrameNavigation"),this.addShortCut("F1"),this.addShortCut("space"),this.addGlobalShortCut("Alt+P"),this.addGlobalShortCut("Shift+space"),this.addGlobalShortCut("P"))};ShortcutManager.prototype.removeAllShortCutAndAddBasedOnAssetClass=function(n){for(var r,t=0;t<i.arrOfShortcutObject.length;t++)r=i.arrOfShortcutObject[t],r.removeAll();i.arrOfShortcutOptions=[];i.arrOfShortcutObject=[];i.initialiseShortcut();i.globalRemoveAllShortCutAndAddBasedOnAssetClass(n)};ShortcutManager.prototype.globalRemoveAllShortCutAndAddBasedOnAssetClass=function(){for(var t,n=0;n<i.globalArrOfShortcutObject.length;n++)t=i.globalArrOfShortcutObject[n],t.removeAll();i.globalArrOfShortcutOptions=[];i.globalArrOfShortcutObject=[];i.initialiseGlobalShortcut()};ShortcutManager.prototype.removeAllShortCut=function(){for(var t,n=0;n<i.arrOfShortcutObject.length;n++)t=i.arrOfShortcutObject[n],t.removeAll();i.arrOfShortcutOptions=[];i.arrOfShortcutObject=[];i.removeAllGlobalShortCut()};ShortcutManager.prototype.removeAllGlobalShortCut=function(){var n,t;if(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableGlobalShortcut"]=="true"){for(n=0;n<i.globalArrOfShortcutObject.length;n++)t=i.globalArrOfShortcutObject[n],t.removeAll();i.globalArrOfShortcutOptions=[];i.globalArrOfShortcutObject=[]}};ShortcutManager.prototype.addShortCut=function(n){for(var r,t=0;t<this.arrOfShortcutObject.length;t++){this.shortcut=this.arrOfShortcutObject[t];switch(n.toLowerCase()){case"left":this.shortcut.all_shortcuts.left==null&&this.shortcut.add("left",function(){i._cmpModel._mediaInfo._assetClass=="DOCUMENT"?(i._eventDispatcher.dispatchEvent(new CustomEvent(NonAvViewerEvent.NAVIGATE_PREVIOUSITEM)),i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))):(i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.FRAME_BACKWARD)),i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS)))},this.arrOfShortcutOptions[t]);break;case"right":this.shortcut.all_shortcuts.right==null&&this.shortcut.add("right",function(){i._cmpModel._mediaInfo._assetClass=="DOCUMENT"?(i._eventDispatcher.dispatchEvent(new CustomEvent(NonAvViewerEvent.NAVIGATE_NEXTITEM)),i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))):(i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.FRAME_FORWARD)),i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS)))},this.arrOfShortcutOptions[t]);break;case"l":this.shortcut.all_shortcuts.L==null&&this.shortcut.add("L",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SECOND_FORWARD));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.arrOfShortcutOptions[t]);break;case"j":this.shortcut.all_shortcuts.J==null&&this.shortcut.add("J",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SECOND_BACKWARD));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.arrOfShortcutOptions[t]);break;case"shift+left":this.shortcut.all_shortcuts["Shift+left"]==null&&this.shortcut.add("Shift+left",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SECOND_BACKWARD));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.arrOfShortcutOptions[t]);break;case"ctrl+left":r="Ctrl+left";CMPUtils.isMAC.Mac()&&(r="meta+left");this.shortcut.all_shortcuts[r]==null&&this.shortcut.add(r,function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.MINUTE_BACKWARD));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.arrOfShortcutOptions[t]);break;case"shift+right":this.shortcut.all_shortcuts["Shift+right"]==null&&this.shortcut.add("Shift+right",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SECOND_FORWARD));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.arrOfShortcutOptions[t]);break;case"ctrl+right":r="Ctrl+right";CMPUtils.isMAC.Mac()&&(r="meta+right");this.shortcut.all_shortcuts[r]==null&&this.shortcut.add(r,function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.MINUTE_FORWARD));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.arrOfShortcutOptions[t]);break;case"i":this.shortcut.all_shortcuts.I==null&&this.shortcut.add("I",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.MARK_IN));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.arrOfShortcutOptions[t]);break;case"shift+i":this.shortcut.all_shortcuts["Shift+I"]==null&&this.shortcut.add("Shift+I",function(){i._cmpModel.marker!=null&&(i._eventDispatcher.dispatchEvent(new CustomEvent(SeekBarEvent.SEEK_TO_MARKPOSITION,{detail:{seekToTime:i._cmpModel.marker.markIn,marker:i._cmpModel.marker}})),i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS)))},this.arrOfShortcutOptions[t]);break;case"o":this.shortcut.all_shortcuts.O==null&&this.shortcut.add("O",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.MARK_OUT));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.arrOfShortcutOptions[t]);break;case"shift+o":this.shortcut.all_shortcuts["Shift+O"]==null&&this.shortcut.add("Shift+O",function(){i._cmpModel.marker!=null&&(i._eventDispatcher.dispatchEvent(new CustomEvent(SeekBarEvent.SEEK_TO_MARKPOSITION,{detail:{seekToTime:i._cmpModel.marker.markOut,marker:i._cmpModel.marker}})),i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS)))},this.arrOfShortcutOptions[t]);break;case"x":this.shortcut.all_shortcuts.X==null&&this.shortcut.add("X",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.FINETUNE_SAVE));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.arrOfShortcutOptions[t]);break;case"up":this.shortcut.all_shortcuts.up==null&&this.shortcut.add("up",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAY_FORWARD,{detail:{direction:"forward"}}));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.arrOfShortcutOptions[t]);break;case"down":this.shortcut.all_shortcuts.down==null&&this.shortcut.add("down",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAY_BACKWARD,{detail:{direction:"reverse"}}));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.arrOfShortcutOptions[t]);break;case"f1":this.shortcut.add("F1",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.HELPSCREEN))},this.arrOfShortcutOptions[t]);break;case"space":this.shortcut.add("space",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAYPAUSE));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.arrOfShortcutOptions[t]);break;case"ctrl+shift+f":this.shortcut.add("Ctrl+Shift+F",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.FULLSCREEN));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.arrOfShortcutOptions[t]);break;case"f":this.shortcut.add("F",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.FULLSCREEN));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.arrOfShortcutOptions[t]);break;case"ctrl+shift+right":this.shortcut.all_shortcuts["Ctrl+Shift+right"]==null&&this.shortcut.add("Ctrl+Shift+right",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(SeekEvent.NAVIGATE_TO_NEXT_TCIN))},this.arrOfShortcutOptions[t]);break;case"ctrl+shift+left":this.shortcut.all_shortcuts["Ctrl+Shift+left"]==null&&this.shortcut.add("Ctrl+Shift+left",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(SeekEvent.NAVIGATE_TO_PREVIOUS_TCIN))},this.arrOfShortcutOptions[t]);break;case"ctrl+shift+alt+m":this.shortcut.all_shortcuts["Ctrl+Shift+Alt+m"]==null&&this.shortcut.add("Ctrl+Shift+Alt+m",function(){i._cmpModel.isMediaInfoModeEnabled?i._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.HIDE_MEDIA_INFO)):i._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.GET_MEDIAINFO))},this.arrOfShortcutOptions[t]);break;case"ctrl+shift+alt+d":this.shortcut.all_shortcuts["Ctrl+Shift+Alt+d"]==null&&this.shortcut.add("Ctrl+Shift+Alt+d",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.ENABLE_DEBUGGER_MODE))},this.arrOfShortcutOptions[t]);break;case"home":this.shortcut.all_shortcuts.home==null&&this.shortcut.add("home",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.NAVIGATE_TO_START))},this.arrOfShortcutOptions[t]);break;case"end":this.shortcut.all_shortcuts.end==null&&this.shortcut.add("end",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.NAVIGATE_TO_END))},this.arrOfShortcutOptions[t]);break;case"ctrl+alt+a":this.shortcut.all_shortcuts["ctrl+alt+a"]==null&&this.shortcut.add("ctrl+alt+a",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(PreviewpanelEvent.NAVIGATE_TO_FIRST_SCENE))},this.arrOfShortcutOptions[t]);break;case"ctrl+alt+z":this.shortcut.all_shortcuts["ctrl+alt+z"]==null&&this.shortcut.add("ctrl+alt+z",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(PreviewpanelEvent.NAVIGATE_TO_LAST_SCENE))},this.arrOfShortcutOptions[t]);break;case"ctrl+alt+n":this.shortcut.all_shortcuts["ctrl+alt+n"]==null&&this.shortcut.add("ctrl+alt+n",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(PreviewpanelEvent.NAVIGATE_TO_NEXT_SCENE))},this.arrOfShortcutOptions[t]);break;case"ctrl+alt+p":this.shortcut.all_shortcuts["ctrl+alt+p"]==null&&this.shortcut.add("ctrl+alt+p",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(PreviewpanelEvent.NAVIGATE_TO_PREVIOUS_SCENE))},this.arrOfShortcutOptions[t]);break;case"1":this.shortcut.all_shortcuts["1"]==null&&this.shortcut.add("1",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.INITIATE_SCTE35_SEGMENT,{detail:{scteDuration:10,type:"SCTE-IN"}}))},this.arrOfShortcutOptions[t]);break;case"2":this.shortcut.all_shortcuts["2"]==null&&this.shortcut.add("2",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.INITIATE_SCTE35_SEGMENT,{detail:{scteDuration:20,type:"SCTE-IN"}}))},this.arrOfShortcutOptions[t]);break;case"3":this.shortcut.all_shortcuts["3"]==null&&this.shortcut.add("3",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.INITIATE_SCTE35_SEGMENT,{detail:{scteDuration:30,type:"SCTE-IN"}}))},this.arrOfShortcutOptions[t]);break;case"0":this.shortcut.all_shortcuts["0"]==null&&this.shortcut.add("0",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.INITIATE_SCTE35_SEGMENT,{detail:{scteDuration:null,type:"SCTE-OUT"}}))},this.arrOfShortcutOptions[t]);break;case"ctrl+shift+x":this.shortcut.all_shortcuts["ctrl+shift+x"]==null&&this.shortcut.add("ctrl+shift+x",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.REMOVE_MARKERS))},this.arrOfShortcutOptions[t]);break;case"delete":r="backspace";CMPUtils.isMAC.Mac()&&(r="delete");this.shortcut.all_shortcuts[r]==null&&this.shortcut.add(r,function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TimelineBarEvent.SEGMENT_DELETE))},this.arrOfShortcutOptions[t])}}};ShortcutManager.prototype.addGlobalShortCut=function(n){for(var t=0;t<this.globalArrOfShortcutObject.length;t++){this.shortcut=this.globalArrOfShortcutObject[t];switch(n.toLowerCase()){case"alt+left":this.shortcut.all_shortcuts["Alt+Left"]==null&&this.shortcut.add("Alt+Left",function(){i._cmpModel._mediaInfo._assetClass=="DOCUMENT"?(i._eventDispatcher.dispatchEvent(new CustomEvent(NonAvViewerEvent.NAVIGATE_PREVIOUSITEM)),i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))):(i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.FRAME_BACKWARD)),i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS)))},this.globalArrOfShortcutOptions[t]);break;case"alt+right":this.shortcut.all_shortcuts["Alt+Right"]==null&&this.shortcut.add("Alt+Right",function(){i._cmpModel._mediaInfo._assetClass=="DOCUMENT"?(i._eventDispatcher.dispatchEvent(new CustomEvent(NonAvViewerEvent.NAVIGATE_NEXTITEM)),i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))):(i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.FRAME_FORWARD)),i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS)))},this.globalArrOfShortcutOptions[t]);break;case"alt+l":this.shortcut.all_shortcuts["Alt+L"]==null&&this.shortcut.add("Alt+L",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SECOND_FORWARD));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.globalArrOfShortcutOptions[t]);break;case"alt+j":this.shortcut.all_shortcuts["Alt+J"]==null&&this.shortcut.add("Alt+J",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SECOND_BACKWARD));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.globalArrOfShortcutOptions[t]);break;case"alt+shift+up":this.shortcut.all_shortcuts["Alt+Shift+Up"]==null&&this.shortcut.add("Alt+Shift+Up",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAY_FORWARD,{detail:{direction:"forward"}}));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.globalArrOfShortcutOptions[t]);break;case"alt+shift+down":this.shortcut.all_shortcuts["Alt+Shift+Down"]==null&&this.shortcut.add("Alt+Shift+Down",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAY_BACKWARD,{detail:{direction:"reverse"}}));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.globalArrOfShortcutOptions[t]);break;case"alt+shift+f":this.shortcut.add("Alt+Shift+f",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.FULLSCREEN));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.globalArrOfShortcutOptions[t]);break;case"alt+p":this.shortcut.add("Alt+P",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAYPAUSE));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.globalArrOfShortcutOptions[t]);break;case"shift+space":this.shortcut.add("shift+space",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAYPAUSE));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.globalArrOfShortcutOptions[t]);break;case"alt+i":this.shortcut.all_shortcuts["Alt+I"]==null&&this.shortcut.add("Alt+I",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.MARK_IN));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.globalArrOfShortcutOptions[t]);break;case"alt+o":this.shortcut.all_shortcuts["Alt+O"]==null&&this.shortcut.add("Alt+O",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.MARK_OUT));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.globalArrOfShortcutOptions[t]);break;case"p":this.shortcut.all_shortcuts.P==null&&this.shortcut.add("P",function(){i._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAYPAUSE));i._eventDispatcher.dispatchEvent(new CustomEvent(LayoutEvent.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS))},this.globalArrOfShortcutOptions[t])}}};ShortcutManager.prototype.ValidateAndAddShortCut=function(n){switch(n.toLowerCase()){case"enableframenavigation":(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.FrameNavigation.Enable"]=="true"||this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["NonAvConfig.EnableNextPreviousOverlay"]=="true")&&(this.addShortCut("left"),this.addShortCut("right"),this.addGlobalShortCut("Alt+left"),this.addGlobalShortCut("Alt+right"));break;case"enablesecondsnavigation":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.SecondsNavigation.Enable"]=="true"&&(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableNewShortcut"]=="true"?(this.addShortCut("L"),this.addShortCut("J")):(this.addShortCut("Shift+left"),this.addShortCut("Shift+right")),this.addGlobalShortCut("Alt+J"),this.addGlobalShortCut("Alt+L"));break;case"enableminutenavigation":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MinutesNavigation.Enable"]=="true"&&(this.addShortCut("Ctrl+left"),this.addShortCut("Ctrl+right"));break;case"enablemarkinout":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.Enable"]=="true"&&(this.addShortCut("I"),this.addGlobalShortCut("Alt+I"),this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableSegmentFineTune"]=="true"&&(this.addShortCut("Shift+I"),this.addShortCut("Shift+O"),this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.EnableMarkOut"]!="true"&&this.addShortCut("X")));break;case"enableplayratebuttons":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.PlayRateButtons.Enable"]=="true"&&this._cmpModel.supportedFeatures.contains("SetPlaybackSpeed")&&(this.addShortCut("up"),this.addShortCut("down"),this.addGlobalShortCut("Alt+Shift+Up"),this.addGlobalShortCut("Alt+Shift+Down"));break;case"enablefullscreentoggle":(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableFullScreenToggle"]=="true"||this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["NonAvConfig.EnableFullScreenToggle"]=="true")&&(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableNewShortcut"]=="true"?(this.shortcut.remove("F"),this.addShortCut("F")):(this.shortcut.remove("Ctrl+Shift+F"),this.addShortCut("Ctrl+Shift+F")),this.shortcut.remove("ALT+SHIFT+F"),this.addGlobalShortCut("ALT+SHIFT+F"));break;case"enablemarkernavigation":case"enableprevnextsegment":(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableMarkerNavigation"]=="true"||this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.PrevNextSegment.Enable"]=="true")&&(this.addShortCut("Ctrl+Shift+left"),this.addShortCut("Ctrl+Shift+right"));break;case"enablemarkin":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.Enable"]=="true"&&(this.addShortCut("I"),this.addGlobalShortCut("ALT+I"));break;case"enablemarkout":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.Enable"]=="true"&&(this.addShortCut("O"),this.addGlobalShortCut("ALT+O"));break;case"enablemediainfoview":this.addShortCut("Ctrl+Shift+Alt+m");break;case"enabledebuggermode":this.addShortCut("Ctrl+Shift+Alt+d");break;case"enablegotostartorendsequence":this.addShortCut("home");this.addShortCut("end");break;case"enablenavigationinpreviewpanel":this.addShortCut("Ctrl+Alt+A");this.addShortCut("Ctrl+Alt+Z");this.addShortCut("Ctrl+Alt+N");this.addShortCut("Ctrl+Alt+P");break;case"enablesctemarkinout":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableScte35MarkInOut"]=="true"&&(this.addShortCut("1"),this.addShortCut("2"),this.addShortCut("3"),this.addShortCut("0"));break;case"enablemarkinoutabortshortcut":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableMarkInOutAbortShortcut"]=="true"&&this.addShortCut("Ctrl+Shift+X");break;case"enablesegmentdelete":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableDeleteSegment"]=="true"&&this.addShortCut("Delete")}};ShortcutManager.prototype.ValidateAndRemoveShortCuts=function(n){for(var t=0;t<this.arrOfShortcutObject.length;t++){this.shortcut=this.arrOfShortcutObject[t];switch(n.toLowerCase()){case"enableframenavigation":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.FrameNavigation.Enable"]=="false"&&(this.shortcut.remove("left"),this.shortcut.remove("right"),this.shortcut.remove("Alt+Left"),this.shortcut.remove("Alt+Right"));break;case"enablesecondsnavigation":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.SecondsNavigation.Enable"]=="false"&&(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableNewShortcut"]=="true"?(this.shortcut.remove("L"),this.shortcut.remove("J")):(this.shortcut.remove("Shift+left"),this.shortcut.remove("Shift+right")),this.shortcut.remove("Alt+J"),this.shortcut.remove("Alt+L"));break;case"enableminutenavigation":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MinutesNavigation.Enable"]=="false"&&(this.shortcut.remove("Ctrl+left"),this.shortcut.remove("Ctrl+right"));break;case"enablemarkinout":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.Enable"]=="false"&&(this.shortcut.remove("I"),this.shortcut.remove("Alt+I"),this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableSegmentFineTune"]=="false"&&(this.shortcut.remove("Shift+I"),this.shortcut.remove("Shift+O"),this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.EnableMarkOut"]!="true"&&this.shortcut.remove("X")));break;case"enableplayratebuttons":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.PlayRateButtons.Enable"]=="false"&&(this.shortcut.remove("up"),this.shortcut.remove("down"),this.shortcut.remove("Alt+Shift+Up"),this.shortcut.remove("Alt+Shift+Down"));break;case"enablefullscreentoggle":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableFullScreenToggle"]=="false"&&(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableNewShortcut"]=="true"?this.shortcut.remove("F"):this.shortcut.remove("Ctrl+Shift+F"),this.shortcut.remove("ALT+SHIFT+F"));break;case"enablemarkernavigation":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableMarkerNavigation"]=="false"&&(this.shortcut.remove("Ctrl+Shift+left"),this.shortcut.remove("Ctrl+Shift+right"));break;case"enablemarkin":this.shortcut.remove("I");this.shortcut.remove("Alt+I");break;case"enablemarkout":this.shortcut.remove("O");this.shortcut.remove("Alt+O");break;case"enablemarkinoutabortshortcut":this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableMarkInOutAbortShortcut"]=="false"&&this.shortcut.remove("Ctrl+Shift+X")}}};ShortcutManager.prototype.addOrRemoveShortCut=function(n){var t=n.detail.isEnable;t?i.ValidateAndAddShortCut(n.detail.controlKeyName):i.ValidateAndRemoveShortCuts(n.detail.controlKeyName)};i.initialiseShortcut();i.initialiseGlobalShortcut();this._eventDispatcher.addEventListener(ShortCutEvent.ADD_OR_REMOVE_SHORTCUT,this.addOrRemoveShortCut);this._eventDispatcher.addEventListener(ShortCutEvent.UPDATE_SHORTCUT,this.removeAllShortCutAndAddBasedOnAssetClass);this._eventDispatcher.addEventListener(ShortCutEvent.REMOVE_ALL_SHORTCUT,this.removeAllShortCut);this._globalEventDispatcher.addEventListener(ShortCutEvent.ADD_OR_REMOVE_SHORTCUT,this.addOrRemoveShortCut);this._globalEventDispatcher.addEventListener(ShortCutEvent.UPDATE_SHORTCUT,this.removeAllShortCutAndAddBasedOnAssetClass);this._globalEventDispatcher.addEventListener(ShortCutEvent.REMOVE_ALL_SHORTCUT,this.removeAllShortCut)}function TransportManager(n,t){this._cmpModel=n.getInstance("cmpModel");this._instanceId=t;this._nativeApi=n.getInstance("nativeApi");this._eventDispatcher=document.getElementById(t);var i=this;TransportManager.prototype.pause=function(){this._nativeApi.Pause()};TransportManager.prototype.play=function(){this._nativeApi.Play()};TransportManager.prototype.stop=function(){i._cmpModel.segmentTimelineMetadata!=null&&(i._cmpModel.segmentTimelineMetadata.ResetLastFiredIndexAndClearTimers(),i._cmpModel.segmentTimelineMetadata.RemoveValue());this._nativeApi.Stop()}}function TTTManager(n,t){this._instanceId=t;this._nativeApi=n.getInstance("nativeApi");this._cmpModel=n.getInstance("cmpModel");this._mediaManager=n.getInstance("mediaManager");this._eventDispatcher=document.getElementById(t);var i=this;TTTManager.prototype.showTimedText=function(n){var f,o,s,e,u,t,r;if(i._cmpModel.timedTextTrackCollection!=null&&(f=i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex],f.timedTextDataObject!=null))if(o=n.detail.marker,i._cmpModel.isCustomTimedTextTrackModeEnabled)i.showCustomTimedText(o,"show");else if(o!=null)for(s={},e=0;e<f.timedTextDataObject.length;e++)if(u=[],o.time==f.timedTextDataObject[e].time){for(i.clearTimedText(0,2),t=f.timedTextDataObject[e].TimedTextDocument,r=0;r<t.length;r++)t[r].Text=JSON.parse(JSON.stringify(t[r].Text).replace(/\\r/g,"")),t[r].Formatting.XPos!=null&&t[r].Formatting.XPos.toLowerCase()=="default"&&(t[r].Formatting.XPos=null,t[r].Formatting.YPos.toLowerCase()=="default"&&(t[r].Formatting.YPos=null),t[r].Formatting.Color=null,t[r].Formatting.ARGB=null,t[r].Formatting.FontStyle=null,t[r].Formatting.FontFamily=null,t[r].Formatting.OffsetX=null,t[r].Formatting.OffsetY=null),t[r].BackGroundColor=null;u=JSON.parse(JSON.stringify(t));u=i.applyUserPreferredTimedTextSetting(u);i.validateTimedTextPosition(u);i._nativeApi.DisplayTimedText(u);i._cmpModel.timedTextDataObject=t}};TTTManager.prototype.showCustomTimedText=function(n,t){var r,u,e,f;n!=null&&(r=n.index,r!=null&&(timedTextDataObjects=i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject,timedTextDataObjects.forEach(function(n){n.index==r+1&&(u=n);n.index==r-1&&(e=n)}),t=="show"?f={prevTimedText:e,currentTimedText:n,nextTimedText:u}:t=="hide"&&(f={prevTimedText:n,currentTimedText:null,nextTimedText:u}),this._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.SHOW_CUSTOM_TIMED_TEXT,{detail:{timedTextObject:f,isTimedTextVisibile:!0}}))))};TTTManager.prototype.hideCustomTimedText=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.SHOW_CUSTOM_TIMED_TEXT,{detail:{timedTextObject:null,isTimedTextVisibile:n}}))};TTTManager.prototype.hideTimedText=function(n){var t,u,f,e,r;if(i._cmpModel.timedTextTrackCollection!=null&&(t=i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex],t.timedTextDataObject!=null)&&(u=n.detail.marker,u!=null&&(f=i._cmpModel.timedTextTrackTimelineMetadata._lastFiredTemporalMetadataIndex,f>-1)))for(e=t.timedTextDataObject[f],r=0;r<t.timedTextDataObject.length;r++)t.timedTextDataObject[r].time==u.time&&e.time==t.timedTextDataObject[r].time&&(i._cmpModel.isCustomTimedTextTrackModeEnabled?i.hideCustomTimedText(!1,u):i.clearTimedText(0,2))};TTTManager.prototype.clearTimedText=function(n,t){for(var u,r,e=[],f=n;f<=t;f++)u={},u.Text="",u.LineNumber=f+1,r={},r.XPos=null,r.YPos=null,r.Color=null,r.ARGB=null,r.FontStyle=null,r.FontFamily=null,u.Formatting=r,u.BackGroundColor="false",e[f]=u;i._nativeApi.DisplayTimedText(e)};TTTManager.prototype.getTimedTextTrackDataObjectFromJson=function(n,t,i){var r=[],u=function(n){return{XPos:n.XPos,YPos:n.YPos,Color:n.Color,ARGB:n.ARGB,FontStyle:n.FontStyle,Justification:n.Justification==undefined?2:n.Justification,HorizontalAlign:n.HorizontalAlign==undefined?"center":n.HorizontalAlign=="middle"?"center":n.HorizontalAlign}},f=function(n){var t=[];return n.forEach(function(n){var i={Text:n.Text,LineNumber:n.LineNumber,Formatting:u(n.Formatting)};t.push(i)}),t};return n.TimedTextLineInfoElements.forEach(function(n){var u=CMPUtils.ConvertTimeCodeToSecs(n.TcIn,t,i),e=CMPUtils.ConvertTimeCodeToSecs(n.TcOut,t,i);r.push(new TimedTextDocument(n.Index,u,e>0?e-u:NaN,n.TcIn,n.TcOut,n.SccOriginalTcIn,n.SccOriginalTcOut,CMPUtils.IsNullOrEmpty(n.Notes)?"":n.Notes,f(n.TimedTextLineElements)))}),r};TTTManager.prototype.getTimedTextTrackDataObject=function(n,t,i){try{if(window.DOMParser?(parser=new DOMParser,xmlDoc=parser.parseFromString(n,"text/xml")):(xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async=!1,xmlDoc.loadXML(n)),xmlDoc.getElementsByTagName("TimedTextLineInfoElement").length>0){var r=[];return r=xmlDoc.getElementsByTagName("TimedTextLineInfoElement"),this.getTTTObjectFromConverterOutput(r,t,i)}}catch(u){}};TTTManager.prototype.getTTTObjectFromConverterOutput=function(n,t,i){for(var e=[],r=function(n,t){return n.getElementsByTagName(t)[0].textContent},h=function(n){return{XPos:r(n,"XPos"),YPos:r(n,"YPos"),Color:r(n,"Color"),ARGB:r(n,"ARGB"),FontStyle:r(n,"FontStyle"),Justification:2,HorizontalAlign:"center"}},c=function(n){for(var t,f,u=[],i=0;i<n.length;i++)t=n[i],f={Text:r(t,"Text"),LineNumber:r(t,"LineNumber"),Formatting:h(t.getElementsByTagName("Formatting")[0])},u.push(f);return u},f=0;f<n.length;f++){var u=n[f],o=CMPUtils.ConvertTimeCodeToSecs(r(u,"TcIn"),t,i),s=CMPUtils.ConvertTimeCodeToSecs(r(u,"TcOut"),t,i),l=u.getElementsByTagName("TimedTextLineElements")[0].getElementsByTagName("TimedTextLineElement");e.push(new TimedTextDocument(r(u,"Index"),o,s>0?s-o:NaN,"",r(u,"TcIn"),r(u,"TcOut"),"","",c(l)))}return e};TTTManager.prototype.addTimeLineMarkers=function(){var n,r,t,u;for(this._cmpModel.timedTextTrackTimelineMetadata!=null&&(n=this._cmpModel.timedTextTrackTimelineMetadata),n==null&&(n=new TimelineMetadata(i._nativeApi,i._cmpModel,i._instanceId)),r=this.numTimedText(),t=0;t<r;t++)u=this.getTimedTextAt(t),n.AddMarker(u)};TTTManager.prototype.numTimedText=function(){var n=0;return this._cmpModel.timedTextTrackCollection[this._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject!=null&&(n=this._cmpModel.timedTextTrackCollection[this._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject.length),n};TTTManager.prototype.getTimedTextAt=function(n){return this._cmpModel.timedTextTrackCollection[this._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject==null||n>=this._cmpModel.timedTextTrackCollection[this._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject[n].length,this._cmpModel.timedTextTrackCollection[this._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject[n]};TTTManager.prototype.addTimelineMetaDataEventListener=function(){this._cmpModel.timedTextTrackTimelineMetadata==null&&(this._cmpModel.timedTextTrackTimelineMetadata=new TimelineMetadata(i._nativeApi,i._cmpModel,i._instanceId));this._eventDispatcher.addEventListener(TimelineMetadataEvent.MARKER_TIME_REACHED,this.showTimedText,!1);this._eventDispatcher.addEventListener(TimelineMetadataEvent.MARKER_DURATION_REACHED,this.hideTimedText,!1)};TTTManager.prototype.removeTimelineMetaDataEventListener=function(){this._eventDispatcher.removeEventListener(TimelineMetadataEvent.MARKER_TIME_REACHED,this.showTimedText,!1);this._eventDispatcher.removeEventListener(TimelineMetadataEvent.MARKER_DURATION_REACHED,this.hideTimedText,!1);this.clearTimedText()};TTTManager.prototype.onTrackChanged=function(n){var t=jQuery.extend(!0,{},n.detail.timedTextTrack),f,r,e,u,o;if(i.setDefaultOffsetPosition(t.type),i._cmpModel.timedTextTrackTimelineMetadata!=null&&(i._cmpModel.isCustomTimedTextTrackModeEnabled&&i.hideCustomTimedText(!1),i.removeTimelineMetaDataEventListener(),i.clearTimedText(0,2),i._cmpModel.timedTextTrackTimelineMetadata.RemoveValue()),i.addTimedTrack(t),t.isDraftedTrack==!0)i.onDraftTrackSelected(t.version,t.language,t.timedTextDataObject);else if(t.url!=""&&t.url!=null){if(i._cmpModel.timedTextTrackCollection!=null)for(f=!1,r=0;r<i._cmpModel.timedTextTrackCollection.length;r++)if(e=i._cmpModel.timedTextTrackCollection[r],e.url==t.url&&e.timedTextDataObject!=null){f=!0;i._cmpModel.selectedTimedTextTrackIndex=r;break}i.addTimelineMetaDataEventListener();f?(u=document.createEvent("Event"),u.initEvent("TimedTextTrackContentAvailable",!0,!0),u.status="Success",o=i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject,u.timedTextTrackJson=i.convertTimedTextTrackDataObjectToCtttDto(o),i._eventDispatcher.dispatchEvent(u),i.addTimeLineMarkers()):i.getTimedTextDataObjectFromEssence(t.url)}};TTTManager.prototype.getTimedTextDataObjectFromEssence=function(n){var t=i._cmpModel,r=i._mediaManager.getFrameRateBasedOnMode(),u=t.mediaInfo,f=function(){var f=[],e=document.getElementById(i._instanceId+"_hdnTenantId").value;return f.push("action=ClearMediaPlayer"),f.push("actionType=GetTimedTextDataFromFileUrl"),f.push("framerate="+r),f.push("som="+u.som),f.push("tenant_id="+e),f.push("timedTextTrackFileUrl="+n),t._playerInfo.extendedSubtitleSupport?f.push("extendedSubtitleSupport=true"):f.push("extendedSubtitleSupport=false"),f.join("&")},e=function(f,e){var o=[],h=decodeURIComponent(escape(window.atob(decodeURIComponent(f)))),s;if(o=t._playerInfo.extendedSubtitleSupport?i.getTimedTextTrackDataObjectFromJson(JSON.parse(h),r,u.timecodeDisplayFormat):i.getTimedTextTrackDataObject(h,r,u.timecodeDisplayFormat),o.length>0){for(o=i.reindexTimedTextDataObject(o),s=0;s<t.timedTextTrackCollection.length;s++)if(t.timedTextTrackCollection[s].url==n){t.selectedTimedTextTrackIndex=s;t.timedTextTrackCollection[s].timedTextDataObject=o;break}i.addTimeLineMarkers();e.status="Success";e.timedTextTrack=decodeURIComponent(f);e.timedTextTrackJson=i.convertTimedTextTrackDataObjectToCtttDto(o);i._eventDispatcher.dispatchEvent(e)}},o=function(n,t){var r=i.errorMessageBasedOnStatusCode(n);parent.showErrorDetailsNG(r,0,{alertInterval:8e3});t.status="Failure";t.timedTextTrack="";i._eventDispatcher.dispatchEvent(t)};(new parent.PFTAjaxWrapper).RequestNoCheck("/BC/Product/Actions/ClearActionHandler.aspx",{method:"POST",postBody:f(),onComplete:function(n){var i=document.createEvent("Event"),t;i.initEvent("TimedTextTrackContentAvailable",!0,!0);t=JSON.parse(n.responseText);t.StatusCode=="OK"&&t.ResultText!="Conversion failed"?e(t.ResultText,i):o(t.StatusCode,i)}})};TTTManager.prototype.errorMessageBasedOnStatusCode=function(n){var t="";switch(n){case"OK":t="Invalid content error (50200): The subtitle/caption file you tried to view, was found to be in a non-supported format. Please contact support.";break;case"NotFound":t="File unavailable (Error code: 50404): The subtitle/caption file you tried to view is currently unavailable at the streaming server. The file could either be in transit or in processing or could be a failed ingest. Please check after sometime. If the issue persists, contact support.";break;case"Forbidden":t="Security error (Error code: 50403): A permission check is preventing access to this content. Please contact support.";break;case"InternalServerError":case"BadGateway":case"ServiceUnavailable":case"GatewayTimeout":t="Internal server error (Error code: 50500): The system is unable to serve the requested content due to an error while processing the request. Please contact support.";break;default:t="Unknown error: The system is unable to serve the subtitle/caption file you tried to view. Please contact support."}return t};TTTManager.prototype.onDraftTrackSelected=function(n,t,r){if(n!=null&&t!=null&&r!=null&&i._cmpModel._playerInfo.CMPConfig.CMPConfigValue.enableImportTimedTextTrack=="true")for(var u=0;u<i._cmpModel.timedTextTrackCollection.length;u++)if(i._cmpModel.timedTextTrackCollection[u].version==n&&i._cmpModel.timedTextTrackCollection[u].language==t){i._cmpModel.selectedTimedTextTrackIndex=u;i.addTimelineMetaDataEventListener();i._cmpModel.timedTextTrackCollection[u].timedTextDataObject=i.reindexTimedTextDataObject(i.getTimedTextTrackDataObjectFromJson(r,i._mediaManager.getFrameRateBasedOnMode(),i._cmpModel.mediaInfo.timecodeDisplayFormat));i.addTimeLineMarkers();break}};TTTManager.prototype.addTimedTrack=function(n){var e=n.version,f=n.language,r,u,t;if(f!=null)if(i._cmpModel.timedTextTrackCollection==null)r=[],r.push(n),i._cmpModel.timedTextTrackCollection=r;else{for(u=!1,t=0;t<i._cmpModel.timedTextTrackCollection.length;t++)i._cmpModel.timedTextTrackCollection[t].version==e&&i._cmpModel.timedTextTrackCollection[t].language==f&&(u=!0);u==!1&&i._cmpModel.timedTextTrackCollection.push(n)}};TTTManager.prototype.resetTTTTimelineMetadata=function(){i._cmpModel.timedTextTrackTimelineMetadata!=null&&(i.clearTimedText(0,2),i._cmpModel.isCustomTimedTextTrackModeEnabled&&i.hideCustomTimedText(!1),i._cmpModel.timedTextTrackTimelineMetadata.ResetLastFiredIndexAndClearTimers(),i._cmpModel.timedTextTrackTimelineMetadata.reset(!0))};TTTManager.prototype.getTTTTimelineMetadataCurrentIndex=function(){var r=this._mediaManager.getCurrentTime(),t,n,u;if(!CMPUtils.IsNullOrEmpty(i._cmpModel.timedTextTrackTimelineMetadata)&&!CMPUtils.IsNullOrEmpty(i._cmpModel.timedTextTrackTimelineMetadata.temporalValueCollection))for(t=0;t<i._cmpModel.timedTextTrackTimelineMetadata.temporalValueCollection.length;t++)if(n=i._cmpModel.timedTextTrackTimelineMetadata.temporalValueCollection[t],u=n.time+n.duration,n.time<=r&&r<=u)return parseInt(n.index);return-1};TTTManager.prototype.setSubtitleSettingProperty=function(n){var t=i.initializeTimedTextLineInfoObject();t=i.getTimedTextLineInfoObject(n,t);i._nativeApi.DisplayTimedText(t)};TTTManager.prototype.validateNextMove=function(n,t){var r=n+t,u,f,e;return t>0?(e=r+1<15?!0:!1,u="_moveSubtitleDown",f="_moveSubtitleUp",isCurrentMoveAllowed=r<15?!0:!1):(e=r-1>0?!0:!1,u="_moveSubtitleUp",f="_moveSubtitleDown",isCurrentMoveAllowed=r>0?!0:!1),i._eventDispatcher.dispatchEvent(new CustomEvent(TTTEvent.SET_SUBTITLE_BUTTON_VISIBILITY,{detail:{changeInContainerPosition:t,isNextMoveAllowed:e,enableButtonId:u,disableButtonId:f}})),isCurrentMoveAllowed};TTTManager.prototype.initializeTimedTextLineInfoObject=function(){for(var t,n,f=i._cmpModel.timedTextDataObject.length,u=[],r=0;r<f;r++)t={},n={},t.LineNumber=(r+1).toString(),t.Text=null,t.BackGroundColor=i._cmpModel._playerInfo.CMPConfig.CMPConfigValue.EnableTTTBackgroundColor,n.ARGB=null,n.Color=null,n.FontStyle=null,n.XPos=null,n.YPos=null,n.FontSize=null,n.Justification=null,n.HorizontalAlign=null,n.OffsetX=i._cmpModel._formattingObject._XPos,n.OffsetY=i._cmpModel._formattingObject._YPos,t.Formatting=n,u[r]=t;return u};TTTManager.prototype.getTimedTextLineInfoObject=function(n,t){for(var i=0;i<t.length;i++)n.YPos!=null&&(t[i].Formatting.YPos=n.YPos),n.ARGB!=null&&(t[i].Formatting.ARGB=n.ARGB),n.FontSize!=null&&(t[i].Formatting.FontSize=n.FontSize),CMPUtils.IsNullOrEmpty(n.Justification)||(t[i].Formatting.Justification=n.Justification),CMPUtils.IsNullOrEmpty(n.HorizontalAlign)||(t[i].Formatting.HorizontalAlign=n.HorizontalAlign);return t};TTTManager.prototype.getFontSizeCount=function(n){return fontSizeCount=n=="subtitle"?i._cmpModel._fontSizeCount:i._cmpModel._annotFontSizeCount};TTTManager.prototype.updateFontSize=function(n,t,r){var u=t>0?!0:!1;if(u){if(n>=0&&n<5)return r=="subtitle"?i._cmpModel._fontSizeCount+=1:i._cmpModel._annotFontSizeCount+=1}else if(n>1&&n<=5)return r=="annotation"?i._cmpModel._annotFontSizeCount-=1:i._cmpModel._fontSizeCount-=1;return null};TTTManager.prototype.changeSubtitleContainerPosition=function(n){var t=[],r,u;t.YPos=n.detail.moveSubtitleSettingUptoYposition;r=i._nativeApi.GetTimeTextContainerPosition();u=i.validateNextMove(r,t.YPos);u&&i.setSubtitleSettingProperty(t)};TTTManager.prototype.changeTextColor=function(n){var t,r;n.detail.setting=="subtitles"?(t=JSON.parse(JSON.stringify(i._cmpModel.timedTextDataObject)),i._cmpModel._formattingObject._Color=n.detail.colorCodeValue,t=i.applyUserPreferredTimedTextSetting(t),i._nativeApi.DisplayTimedText(t)):(r=n.detail.annotationDivDetails,r.style.color=n.detail.colorCodeValue)};TTTManager.prototype.changeFontSize=function(n){var f,t=n.detail.settingType,e=n.detail.changeFontSizePercent,o,r,u,s;f=i.getFontSizeCount(t);o=i.validateFontSize(f,e,t);o&&(t=="subtitle"?(r={},r.FontSize=e,i.setSubtitleSettingProperty(r)):(u=n.detail.annotationDivDetails,s=parseInt(window.getComputedStyle(u,null).fontSize.replace("px","")),u.style.fontSize=s+parseInt(n.detail.changeFontSizePercent)+"px"))};TTTManager.prototype.validateFontSize=function(n,t,r){var f=t>0?!0:!1,u;if(r=="subtitle"?(increaseButtonId="_increaseFontSize",decreaseButtonId="_decreaseFontSize"):(increaseButtonId="_increaseAnnotationFontSize",decreaseButtonId="_decreaseAnnotationFontSize"),u=i.updateFontSize(n,t,r),u!=null)if(f){if(u==2)return i.setFontTextBottonVisibility(!0,increaseButtonId,decreaseButtonId,t),!0;if(u>5)return!1;if(u==5)return i.setFontTextBottonVisibility(!1,increaseButtonId,decreaseButtonId,t),!0}else{if(u==4)return i.setFontTextBottonVisibility(!0,decreaseButtonId,increaseButtonId,t),!0;if(u<1)return!1;if(u==1)return i.setFontTextBottonVisibility(!1,decreaseButtonId,increaseButtonId,t),!0}else return!1;return!0};TTTManager.prototype.setFontTextBottonVisibility=function(n,t,r,u){i._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.SET_FONT_TEXT_BUTTON_VISIBILITY,{detail:{isNextMoveAllowed:n,enableButtonId:r,disableButtonId:t,increaseFontSizePercent:u}}))};TTTManager.prototype.calculateFontSize=function(n){var t=n.detail.parentNode,r=parseInt(window.getComputedStyle(t,null).height.replace("px","")),u=i._cmpModel._annotFontSizeCount-3,f=parseInt(r/30)+u*2+"px";i._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.SET_ANNOTATION_FONT_SIZE,{detail:{annotationFontSize:f}}))};TTTManager.prototype.applyUserPreferredTimedTextSetting=function(n){for(var r=i._cmpModel._formattingObject._XPos==undefined?0:parseInt(i._cmpModel._formattingObject._XPos),u=i._cmpModel._formattingObject._YPos==undefined?0:parseInt(i._cmpModel._formattingObject._YPos),f=i._cmpModel._formattingObject._AdditionalOffsetXInPx==undefined?0:parseInt(i._cmpModel._formattingObject._AdditionalOffsetXInPx),e=i._cmpModel._formattingObject._AdditionalOffsetYInPx==undefined?0:parseInt(i._cmpModel._formattingObject._AdditionalOffsetYInPx),t=0;t<n.length;t++)n[t].Formatting.OffsetX=r.toString(),n[t].Formatting.OffsetY=u.toString(),n[t].Formatting.ARGB=i._cmpModel._formattingObject._Color!=null?i._cmpModel._formattingObject._Color:n[t].Formatting.ARGB,n[t].BackGroundColor=i._cmpModel._playerInfo.CMPConfig.CMPConfigValue.EnableTTTBackgroundColor,n[t].Formatting.FontFamily=n[t].Formatting.XPos!=null?i._cmpModel._playerInfo.CMPConfig.CMPConfigValue.CCFontFamily:i._cmpModel._playerInfo.CMPConfig.CMPConfigValue.SubtitleFontFamily,n[t].Formatting.additionalOffsetXInPx=f.toString(),n[t].Formatting.additionalOffsetYInPx=e.toString();return n};TTTManager.prototype.validateTimedTextPosition=function(n){i.validateTTTVerticalPosition(n);i.validateTTTHorizontalPosition(n)};TTTManager.prototype.validateTTTHorizontalPosition=function(n){var t=i.getMaximumXPos(n),u=i._cmpModel._formattingObject._XPos==null?0:parseInt(i._cmpModel._formattingObject._XPos),r;t=parseInt(t)+u;r=u;n[0].Formatting.XPos!=null?t<=-10?i.updateTTTPositionBtns("remove","_moveTextLeft",null):t>=33&&i.updateTTTPositionBtns("remove","_moveTextRight",null):r<=-6?i.updateTTTPositionBtns("remove","_moveTextLeft",null):r>=6&&i.updateTTTPositionBtns("remove","_moveTextRight",null)};TTTManager.prototype.validateTTTVerticalPosition=function(n){var r=n.length,o=parseInt(n[0].Formatting.YPos),c=parseInt(n[0].Formatting.OffsetY),e,s,h,l,u,f,y,t;if(o=o==null||isNaN(o)?0:o,c=c==null?0:c,e=o+c,n[0].Formatting.XPos!=null)r==1&&(e>=16?i.updateTTTPositionBtns("remove","_moveTextDown",null):e<=-1&&i.updateTTTPositionBtns("remove","_moveTextUp",null)),r>1&&(s=parseInt(n[r-1].Formatting.YPos),h=parseInt(n[r-1].Formatting.OffsetY),s=s==undefined?0:s,h=h==undefined?0:h,l=s+h,e>=16?i.updateTTTPositionBtns("remove","_moveTextDown",null):l<=-1&&i.updateTTTPositionBtns("remove","_moveTextUp",null));else if(n[0].Formatting.YPos!=null){i.updateTTTPositionBtns("add","_moveTextUp",null);i.updateTTTPositionBtns("add","_moveTextDown",null);u=parseInt(n[r-1].Formatting.YPos);f=parseInt(n[r-1].Formatting.OffsetY);u=u==undefined?0:u;f=f==undefined?0:f;var p=u+f,a=parseInt(n[0].Formatting.YPos),v=parseInt(n[0].Formatting.OffsetY);if(a=u==undefined?0:u,v=f==undefined?0:f,y=a+v,p>=16)for(i.updateTTTPositionBtns("remove","_moveTextDown",null),t=0;t<n.length;t++)n[t].Formatting.OffsetY=16-n[r-1].Formatting.YPos;else if(y<=0)for(i.updateTTTPositionBtns("remove","_moveTextUp",null),t=0;t<n.length;t++)n[t].Formatting.OffsetY=0-n[0].Formatting.YPos}else e<=-15?i.updateTTTPositionBtns("remove","_moveTextUp",null):e>=1&&i.updateTTTPositionBtns("remove","_moveTextDown",null)};TTTManager.prototype.getMaximumXPos=function(n){for(var i=n[0].Formatting.XPos,t=1;t<n.length;t++)n[t].Formatting.XPos>i&&(i=n[t].Formatting.XPos);return i};TTTManager.prototype.toggleMoveButtons=function(n,t,r){i._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.TOGGLE_MOVE_BUTTONS,{detail:{mode:n,firstButtonId:t,secondButtonId:r}}))};TTTManager.prototype.updateTTTPosition=function(n){var r=n.detail.changeInXPosition!=null?parseInt(n.detail.changeInXPosition):0,u=n.detail.changeInYPosition!=null?parseInt(n.detail.changeInYPosition):0,f,t;(i._cmpModel.timedTextDataObject!=undefined||i._cmpModel.timedTextDataObject!=null)&&(i.setUserPreferredTTTOffsetPosition(r,u),i.updateTTTPositionBtnsOnPositionChange(r,u),f=JSON.parse(JSON.stringify(i._cmpModel.timedTextDataObject)),t=i.applyUserPreferredTimedTextSetting(f),r!=0?i.validateTTTHorizontalPosition(t):u!=0&&i.validateTTTVerticalPosition(t),i._nativeApi.DisplayTimedText(t))};TTTManager.prototype.updateTTTPositionBtnsOnPositionChange=function(n,t){t!=0&&(i._cmpModel._formattingObject._YPos<0?i.updateTTTPositionBtns("toggle","_moveTextUp","_moveTextDown"):i._cmpModel._formattingObject._YPos==0?(i.updateTTTPositionBtns("add","_moveTextUp",null),i.updateTTTPositionBtns("add","_moveTextDown",null)):i.updateTTTPositionBtns("toggle","_moveTextDown","_moveTextUp"));n!=0&&(i._cmpModel._formattingObject._XPos<0?i.updateTTTPositionBtns("toggle","_moveTextLeft","_moveTextRight"):i._cmpModel._formattingObject._XPos==0?(i.updateTTTPositionBtns("add","_moveTextLeft",null),i.updateTTTPositionBtns("add","_moveTextRight",null)):i.updateTTTPositionBtns("toggle","_moveTextRight","_moveTextLeft"))};TTTManager.prototype.setUserPreferredTTTOffsetPosition=function(n,t){if(n==null&&t==null)i._cmpModel._formattingObject._YPos=0,i._cmpModel._formattingObject._XPos=0;else{var r=i._cmpModel._formattingObject._XPos==undefined?0:parseInt(i._cmpModel._formattingObject._XPos),u=i._cmpModel._formattingObject._YPos==undefined?0:parseInt(i._cmpModel._formattingObject._YPos);i._cmpModel._formattingObject._YPos=u+t;i._cmpModel._formattingObject._XPos=r+n}};TTTManager.prototype.setUserPreferredTTTAdditionalOffsetPositionInPx=function(n,t){n==null&&t==null?(i._cmpModel._formattingObject._AdditionalOffsetXInPx=0,i._cmpModel._formattingObject._AdditionalOffsetYInPx=0):(i._cmpModel._formattingObject._AdditionalOffsetXInPx=n,i._cmpModel._formattingObject._AdditionalOffsetYInPx=t)};TTTManager.prototype.setTTTOffsetPosition=function(n,t){i._cmpModel._formattingObject==null&&(this._cmpModel._formattingObject=new FormattingObject);i._cmpModel._formattingObject._YPos=t;i._cmpModel._formattingObject._XPos=n};TTTManager.prototype.updateTTTPositionBtns=function(n,t,r){i._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.UPDATE_TTT_POSITION_BTNS,{detail:{mode:n,buttonId1:t,buttonId2:r}}))};TTTManager.prototype.resetTTTInfo=function(){formattingObjectArray=JSON.parse(JSON.stringify(i._cmpModel.timedTextDataObject));i.setUserPreferredTTTOffsetPosition(null,null);var n=i.applyUserPreferredTimedTextSetting(formattingObjectArray);i._nativeApi.DisplayTimedText(formattingObjectArray)};TTTManager.prototype.setTTTInfoOnToggleFullscreen=function(){if(!CMPUtils.IsNullOrEmpty(i._cmpModel.timedTextDataObject)){i.setTTTInfoOnToggleTransportBar(event);formattingObjectArray=JSON.parse(JSON.stringify(i._cmpModel.timedTextDataObject));var n=i.applyUserPreferredTimedTextSetting(formattingObjectArray);i._nativeApi.DisplayTimedText(formattingObjectArray)}};TTTManager.prototype.setTTTInfoOnToggleTransportBar=function(){var n=0;event.detail.isInFullscreen==!0&&event.detail.isHideControlBar==!1&&(n=event.detail.transportHeight);i.setUserPreferredTTTAdditionalOffsetPositionInPx(0,n)};TTTManager.prototype.setDefaultOffsetPosition=function(n){var r;if(n=="SUB"){r="0,0";i._cmpModel._playerInfo.CMPConfig.CMPConfigValue.DefaultSubtitleXYCoordinate!=null&&(r=i._cmpModel._playerInfo.CMPConfig.CMPConfigValue.DefaultSubtitleXYCoordinate.toString());var t=r.split(","),u=t[0]=="0"?"0":t[0],f=t[1]=="0"?"0":t[1];u=parseInt(u)-6;f=parseInt(f)-15;i.setTTTOffsetPosition(u,f);i._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.ENABLE_FONT_SIZE_BUTTON))}else i._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.DISABLE_FONT_SIZE_BUTTON)),i.setTTTOffsetPosition(0,0)};TTTManager.prototype.getTimedTextDataObject=function(n){var r,t;if(n.detail.time!=null)for(r=i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject,t=0;t<r.length;t++)if(r[t].time==n.detail.time)return r[t]};TTTManager.prototype.addTimedTextDataObject=function(n){var t,u,f,r,e,o;if(n.detail.timedTextDataObjectArray!=null&&i._cmpModel.isTimedTextTrackEditModeEnabled==!0&&(t=[],t=i.getTimedTextTrackDataObjectFromJson(n.detail.timedTextDataObjectArray,i._mediaManager.getFrameRateBasedOnMode(),i._cmpModel.mediaInfo.timecodeDisplayFormat),i._cmpModel.timedTextTrackCollection!=null&&i._cmpModel.selectedTimedTextTrackIndex!=null)){if(u=i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject,u==null||u.length==0)for(r=0;r<t.length;r++)u.push(t[r]);else for(f=u[u.length-1].index,r=0;r<t.length;r++)t[r].index=f+1,f+=1,u.push(t[r]);i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject=i.reindexTimedTextDataObject(u);i._cmpModel.timedTextTrackTimelineMetadata.temporalValueCollection=[];i._cmpModel.timedTextTrackTimelineMetadata.temporalValueCollection=jQuery.extend(!0,[],i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject);i.addToTemporalKeyCollection(i._cmpModel.timedTextTrackTimelineMetadata.temporalValueCollection);e=i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject.find(function(n){if(n.tcIn==t[0].tcIn&&n.tcOut==t[0].tcOut)return n});o={action:"add",currentTimedText:e,index:e.index,currentTime:i._mediaManager.getCurrentTime()};i.refreshCurrentTimedText(o)}};TTTManager.prototype.updateTimedTextDataObject=function(n){var t,r,u,f,e,o;if(n.detail.timedTextDataObjectArray!=null&&i._cmpModel.timedTextTrackCollection!=null&&i._cmpModel.selectedTimedTextTrackIndex!=null&&i._cmpModel.isTimedTextTrackEditModeEnabled==!0){for(t=i.getTimedTextTrackDataObjectFromJson(n.detail.timedTextDataObjectArray,i._mediaManager.getFrameRateBasedOnMode(),i._cmpModel.mediaInfo.timecodeDisplayFormat),r=i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject,u=0;u<t.length;u++)for(f=0;f<r.length;f++)r[f].index==t[u].index&&(r[f]=t[u]);n.detail.updateType!="textChange"&&(i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject=i.reindexTimedTextDataObject(r));i._cmpModel.timedTextTrackTimelineMetadata.temporalValueCollection=[];i._cmpModel.timedTextTrackTimelineMetadata.temporalValueCollection=jQuery.extend(!0,[],i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject);i.addToTemporalKeyCollection(i._cmpModel.timedTextTrackTimelineMetadata.temporalValueCollection);e=i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject.find(function(n){if(n.tcIn==t[0].tcIn&&n.tcOut==t[0].tcOut)return n});o={action:"update",currentTimedText:e,index:e.index};i.refreshCurrentTimedText(o)}};TTTManager.prototype.deleteTimedTextDataObject=function(n){var t,r;n.detail.index!=null&&i._cmpModel.timedTextTrackCollection!=null&&i._cmpModel.selectedTimedTextTrackIndex!=null&&i._cmpModel.isTimedTextTrackEditModeEnabled==!0&&(t=i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject,t.splice(n.detail.index,1),r={action:"delete",index:n.detail.index},i.refreshCurrentTimedText(r),i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject=i.reindexTimedTextDataObject(t),i._cmpModel.timedTextTrackTimelineMetadata.temporalValueCollection=[],i._cmpModel.timedTextTrackTimelineMetadata.temporalValueCollection=jQuery.extend(!0,[],i._cmpModel.timedTextTrackCollection[i._cmpModel.selectedTimedTextTrackIndex].timedTextDataObject),i.addToTemporalKeyCollection(i._cmpModel.timedTextTrackTimelineMetadata.temporalValueCollection))};TTTManager.prototype.addToTemporalKeyCollection=function(n){i._cmpModel.timedTextTrackTimelineMetadata.temporalKeyCollection=[];for(var t=0;t<n.length;t++)i._cmpModel.timedTextTrackTimelineMetadata.temporalKeyCollection.push(n[t].time)};TTTManager.prototype.reindexTimedTextDataObject=function(n){n.sort(i.compare);for(var t=0;t<n.length;t++)n[t].index=t;return n};TTTManager.prototype.compare=function(n,t){return n.time<t.time?-1:n.time>t.time?1:0};TTTManager.prototype.convertTimedTextTrackDataObjectToCtttDto=function(n){var t=[];return n.forEach(function(n){var i={Index:n.index,TcIn:n.tcIn,TcOut:n.tcOut,Duration:n.duration.toString(),SccOriginalTcIn:n.sccOriginalTcIn,SccOriginalTcOut:n.sccOriginalTcOut,Notes:CMPUtils.IsNullOrEmpty(n.Notes)?"":n.Notes,TimedTextLineElements:n.TimedTextDocument};t.push(i)}),{TimedTextLineInfoElements:t}};TTTManager.prototype.toggleCustomTimedTextTrackMode=function(n){if(i._cmpModel.isCustomTimedTextTrackModeEnabled=n.detail.isEnabled,i._cmpModel.isCustomTimedTextTrackModeEnabled){if(i._cmpModel.timedTextTrackTimelineMetadata==null)return;if(i._cmpModel.timedTextTrackTimelineMetadata.temporalValueCollection==null)return;i.clearTimedText(0,2);i.showCustomTimedText(i._cmpModel.timedTextTrackTimelineMetadata.temporalValueCollection[i.getTTTTimelineMetadataCurrentIndex()],"show")}else i.hideCustomTimedText(!1)};TTTManager.prototype.toggleTimedTextTrackEditMode=function(n){i._cmpModel.isTimedTextTrackEditModeEnabled=n.detail.isEnabled};TTTManager.prototype.refreshCurrentTimedText=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.REFRESH_CURRENT_TIMEDTEXT,{detail:{refreshObject:n}}))}}function ErrorManager(n,t,i){var u,r;this._injector=n;this._instanceId=i;this._cmpModel=t;this._eventDispatcher=document.getElementById(this._instanceId);this._developerErrorStats=[];this._isDebuggerMode=!1;u=this._injector.getInstance("stateMachine");this._stateMachine=u;this.playAfterClose;r=this;document.getElementById(r._instanceId).dispatchEvent(new CustomEvent(ShortCutEvent.ADD_OR_REMOVE_SHORTCUT,{detail:{isEnable:!0,controlKeyName:"enableDebuggerMode"}}));ErrorManager.prototype.handlePlayerError=function(n){this.handleError(this.getError(this.getPlayerErrorCode(n)))};ErrorManager.prototype.handleMediaError=function(n){r.handleError(r.getError(r.getMediaErrorCode(n.detail.code)))};ErrorManager.prototype.getPlayerErrorCode=function(n){var t;switch(n){case 1:t=11321;break;case 2:t=11322;break;case 3:t=11312;break;case 21:t=11201}return t};ErrorManager.prototype.getMediaErrorCode=function(n){var t;switch(n){case 1:t=11301;break;case 2:t=11302;break;case 3:t=11303;break;case 4:t=11304;break;case 5:t=11305;break;case 6:t=11306;break;case 7:t=11307;break;case 8:t=11308;break;case 9:t=11309;break;case 10:t=11310;break;case 11:t=11311;break;case 21:t=12101;break;case 22:t=12102;break;case 23:t=12301;break;case 31:t=13301;break;case 32:t=13302;break;case 33:t=13303;break;case 34:t=13304;break;case 35:t=13305;break;case 36:t=13306;break;case 37:t=13307;break;case 38:t=13308;break;case 41:t=11202}return t};ErrorManager.prototype.handleError=function(n){this._developerErrorStats.push(n);n.errorCode==11311?this.nonConformingMediaDetectionHandler():this.showError(n)};ErrorManager.prototype.showError=function(n){this.hidePlayerStateDisplay();this.showUserError(n);this._isDebuggerMode&&this.showDevErrorInBrowserConsole(n)};ErrorManager.prototype.enableDebuggerMode=function(){if(r._isDebuggerMode=!0,r._developerErrorStats.length!=0)for(var n=0;n<r._developerErrorStats.length;n++)r.showDevErrorInBrowserConsole(r._developerErrorStats[n])};ErrorManager.prototype.showDevErrorInBrowserConsole=function(n){console.debug("Time: "+n.errorTimeStamp+"  ||  Error Code: "+n.errorCode+"  ||  Error: "+n.error)};ErrorManager.prototype.hidePlayerStateDisplay=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{display:!1}}))};ErrorManager.prototype.showUserError=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.SHOW_ERROR_REPORT,{detail:{message:n.message,isSevere:n.isSevere,errorCode:n.errorCode}}))};ErrorManager.prototype.nonConformingMediaDetectionHandler=function(){var n=this._cmpModel.playerInfo.CMPConfig,t=n.CMPConfigValue["NonConformingMediaDetected.PauseOnDetection"],i=n.CMPConfigValue["NonConformingMediaDetected.AlertMessage"],r=n.CMPConfigValue["NonConformingMediaDetected.CallbackUrl"];CMPUtils.IsNullOrEmpty(t)||CMPUtils.IsNullOrEmpty(i)||CMPUtils.IsNullOrEmpty(r)||(this.playAfterClose=!1,t.toString().toUpperCase()=="TRUE"&&(this._injector.getInstance("stateMachine").currentState!=this._injector.getInstance("stateMachine").stateCollection.PAUSED&&(this.playAfterClose=!0),this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PAUSE))),this.NCMDCallbackUrl=r.toString(),this._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.NON_CONFORMING_MEDIA_DETECTED,{detail:{message:i,closeCallback:this.NCMDCloseBtnClick,okCallback:this.NCMDOkBtnClick}})))};ErrorManager.prototype.NCMDCloseBtnClick=function(){r.onPopupClose()};ErrorManager.prototype.NCMDOkBtnClick=function(){var e=MasterVar.tenant_id,o=MasterVar.userId,i,t,n;if(r._cmpModel.mediaInfo.assetClass.toUpperCase()=="VIDEO")i=r._cmpModel.mediaInfo.dmguid;else if(r._cmpModel.mediaInfo.assetClass.toUpperCase()=="PLAYLIST"){for(t=0;t<r._cmpModel.sequenceClipInfo.length;t++)if(r._cmpModel.sequenceClipInfo[t].position==r._cmpModel.currentSegment.position){i=r._cmpModel.sequenceClipInfo[t].clipId;break}}else return;var s=r._cmpModel.playerInfo.TokenId,u="tenantId="+e+"&dmguid="+i+"&instanceId="+r._instanceId+"&sessionId="+s+"&userId="+o,f=r.NCMDCallbackUrl;f+=r.NCMDCallbackUrl.includes("?")?"&"+u:"?"+u;n=new XMLHttpRequest;n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&(n.status==200?showErrorDetails("Request submitted successfully","1"):n.status==400&&showErrorDetails("Failed to submit the request.","0"))};n.open("GET",f,!0);n.send();r.onPopupClose()};ErrorManager.prototype.onPopupClose=function(){this.playAfterClose&&this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAY))};ErrorManager.prototype.getError=function(n){var t={};return t.errorCode=n,t.isSevere=ErrorHashTable[n][0],t.message=ErrorHashTable[n][1],t.error=ErrorHashTable[n][2],t.currentTime=new Date,t.errorTimeStamp=t.currentTime.getHours()+":"+t.currentTime.getMinutes()+":"+t.currentTime.getSeconds()+":"+t.currentTime.getMilliseconds(),t};ErrorManager.prototype.handleNativePlayerError=function(n){switch(n.detail.code){case 1:r._injector.getInstance("stateMachine").onError(21)}};document.getElementById(r._instanceId).addEventListener(NativeEvent.ON_MEDIA_ERROR,r.handleMediaError);document.getElementById(r._instanceId).addEventListener(ErrorEvent.ENABLE_DEBUGGER_MODE,r.enableDebuggerMode);document.getElementById(r._instanceId).addEventListener(NativeEvent.ON_PLAYER_ERROR,r.handleNativePlayerError)}function LayoutManager(n,t){function r(n){n.keyCode==27&&i.browserToggleFullscreen(!0)}this._isFullscreen=!1;this.isHideControlBar;this._cmpModel;this._playerinstanceIdentifier=n;this._controlType=t;this._stylingInfo;var i=this;this.boolAutoHideControlBarOnFullScreen=!1;this.controlbarTimer=null;this.autoHideControlBarInMilliSecs;this.isMouseOverControlbar=!1;this.lastMousePosX=0;this.lastMousePosY=0;this.isMarkerRibbonEnabled=!1;this._parentNode=document.getElementById(n);this.boolAutoHideControlBar=!1;this.isPinControlEnabled=!1;LayoutManager.prototype.toggleFullScreen=function(){this._isFullscreen?this.browserToggleFullscreen(!0):this.handleOlderVersionOfIE()&&(this.registerFullscreenChangeEventHandler(!0),this.browserToggleFullscreen(!1));document.getElementById(this._playerinstanceIdentifier).dispatchEvent(new CustomEvent(SequenceEvent.FULL_SCREEN_HANDLE))};LayoutManager.prototype.setAutoHidePropertyOnFullScreen=function(n){this.boolAutoHideControlBarOnFullScreen=n};LayoutManager.prototype.setAutoHideControlBarTime=function(n){this.autoHideControlBarInMilliSecs=n};LayoutManager.prototype.setPinControlProperty=function(n){this.isPinControlEnabled=n};LayoutManager.prototype.goToFullScreen=function(){if(this._parentNodeDivId=document.getElementById(this._playerinstanceIdentifier).parentNode.id,document.getElementById(this._parentNodeDivId)){this.prepareToGoFullScreen(this._parentNodeDivId);this.addControlbarShowHideHandling();this._parentNode.dispatchEvent(new CustomEvent(AnnotationEvent.CHECK_ANNOTATION_FONT_SIZE));this._parentNode.dispatchEvent(new CustomEvent(TransportEvent.WATERMARKING_FONTSIZE_HANDLING_ON_FULLSCREEN_TOGGLE));var n=document.getElementById(this._playerinstanceIdentifier+"_dvControls"),t=n.style.display=="none"?"0":window.getComputedStyle(n).height.replace("px","");this._parentNode.dispatchEvent(new CustomEvent(TTTEvent.SET_TTT_INFO_ON_TOGGLE_FULLSCREEN,{detail:{isInFullscreen:!0,isHideControlBar:n.style.display=="none"?!0:!1,transportHeight:t}}));this._parentNode.dispatchEvent(new CustomEvent(UIEvent.RESIZE_MARKER_INFO))}};LayoutManager.prototype.addControlbarShowHideHandling=function(){this.boolAutoHideControlBarOnFullScreen||this.boolAutoHideControlBar?(this.resetControlbarTimer(),document.getElementById(this._playerinstanceIdentifier+"_ClearMediaPlayer").parentNode.addEventListener("mousemove",this.showControlbarOnMouseMoveAndShortCut),document.getElementById(this._playerinstanceIdentifier+"_dvControls").addEventListener("mouseover",function(){i.isMouseOverControlbar=!0}),document.getElementById(this._playerinstanceIdentifier+"_dvControls").addEventListener("mouseout",function(){i.isMouseOverControlbar=!1})):(document.getElementById(this._playerinstanceIdentifier+"_ClearMediaPlayer").parentNode.addEventListener("mousedown",this.handleControlBarOnClick),this.handleMouseDownEvent());this.fnCheckForMarkerRibbon()};LayoutManager.prototype.handleMouseDownEvent=function(){CMPUtils.IsNullOrEmpty(document.getElementById(this._playerinstanceIdentifier+"_SaveSegmentpopup"))||CMPUtils.stopPropagation(document.getElementById(this._playerinstanceIdentifier+"_SaveSegmentpopup"),"mousedown");CMPUtils.IsNullOrEmpty(document.getElementById(this._playerinstanceIdentifier+"_genericAlert"))||CMPUtils.stopPropagation(document.getElementById(this._playerinstanceIdentifier+"_genericAlert"),"mousedown");CMPUtils.IsNullOrEmpty(document.getElementById(this._playerinstanceIdentifier+"_genericConfirmAlert"))||CMPUtils.stopPropagation(document.getElementById(this._playerinstanceIdentifier+"_genericConfirmAlert"),"mousedown")};LayoutManager.prototype.fnCheckForMarkerRibbon=function(){var n=document.getElementById(this._playerinstanceIdentifier+"_markerRibbonPlaceholder"),t;n!=null?(t=window.getComputedStyle(n,null),this.isMarkerRibbonEnabled=t.display=="none"?!1:!0):this.isMarkerRibbonEnabled=!1};LayoutManager.prototype.showControlbarOnMouseMoveAndShortCut=function(n){var t=!0;(i.boolAutoHideControlBarOnFullScreen||i.boolAutoHideControlBar)&&(n!=null&&(n.type=="mousemove"&&i.lastMousePosX==n.clientX&&i.lastMousePosY==n.clientY&&(t=!1),i.lastMousePosX=n.clientX,i.lastMousePosY=n.clientY),t&&(i.handleShowHideControlBar(!1),i.resetControlbarTimer()))};LayoutManager.prototype.handleControlBarOnClick=function(){var n=document.getElementById(i._playerinstanceIdentifier+"_dvControls");n!=null&&(n.style.display=="block"||n.style.display==""?i.handleShowHideControlBar(!0):i.handleShowHideControlBar(!1))};LayoutManager.prototype.resetControlbarTimer=function(){this.clearControlbarTimer();this.controlbarTimer=setTimeout(function(){i.hideControlbarOnTimeOut()},this.autoHideControlBarInMilliSecs)};LayoutManager.prototype.clearControlbarTimer=function(){this.controlbarTimer!=null&&clearTimeout(this.controlbarTimer)};LayoutManager.prototype.hideControlbarOnTimeOut=function(){var n=document.getElementById(this._playerinstanceIdentifier+"_dvControls");n&&(n.style.display=="block"||n.style.display=="")&&(this.isMouseOverControlbar||this.handleShowHideControlBar(!0))};LayoutManager.prototype.handleShowHideControlBar=function(n){var t=document.getElementById(this._playerinstanceIdentifier+"_dvControls"),f=document.getElementById(this._playerinstanceIdentifier+"_dvHelp"),r=document.getElementById(this._playerinstanceIdentifier+"_markerInfoContainer"),u=document.getElementById(i._playerinstanceIdentifier+"_nativePlayerType").value,e=r?r.style.display=="none":!0;t!=null&&i.isHideControlBar!=n&&(n&&f.style.display=="none"&&e&&!this.isPinControlEnabled?(u.toUpperCase()=="QT"&&(jQuery("#"+this._playerinstanceIdentifier+"_Div").removeClass("qtContainerDiv"),jQuery("#"+this._playerinstanceIdentifier+"_Div").addClass("cmpContainerDiv")),i.isHideControlBar=n,t.style.display="none",this.isMarkerRibbonEnabled&&(document.getElementById(this._playerinstanceIdentifier+"_markerRibbonPlaceholder").style.display="none"),this._parentNode.dispatchEvent(new CustomEvent(UIEvent.HIDE_TRANSPORTBAR,{detail:{isHideControlBar:!0,isInFullscreen:i._isFullscreen,transportHeight:"0"}}))):(u.toUpperCase()=="QT"&&(jQuery("#"+this._playerinstanceIdentifier+"_Div").removeClass("cmpContainerDiv"),jQuery("#"+this._playerinstanceIdentifier+"_Div").addClass("qtContainerDiv")),i.isHideControlBar=n,t.style.display="block",this.isMarkerRibbonEnabled&&(document.getElementById(this._playerinstanceIdentifier+"_markerRibbonPlaceholder").style.display="block"),this._parentNode.dispatchEvent(new CustomEvent(UIEvent.HIDE_TRANSPORTBAR,{detail:{isHideControlBar:!1,isInFullscreen:i._isFullscreen,transportHeight:window.getComputedStyle(t).height.replace("px","")}}))))};LayoutManager.prototype.handlePinControlProperty=function(){this.isPinControlEnabled&&(document.getElementById(this._playerinstanceIdentifier+"_dvControls").style.display="block")};LayoutManager.prototype.exitFullScreen=function(){if(this._parentNodeDivId=document.getElementById(this._playerinstanceIdentifier).parentNode.id,document.getElementById(this._parentNodeDivId)){this.prepareToRestoreFromFullScreen(this._parentNodeDivId);this.removeControlbarShowHideHandling();this.handleQTOnRestoreFromFullScreen();this._parentNode.dispatchEvent(new CustomEvent(AnnotationEvent.CHECK_ANNOTATION_FONT_SIZE));this._parentNode.dispatchEvent(new CustomEvent(TransportEvent.WATERMARKING_FONTSIZE_HANDLING_ON_FULLSCREEN_TOGGLE));var n=document.getElementById(this._playerinstanceIdentifier+"_dvControls"),t=n.style.display=="none"?"0":window.getComputedStyle(n).height.replace("px","");this._parentNode.dispatchEvent(new CustomEvent(TTTEvent.SET_TTT_INFO_ON_TOGGLE_FULLSCREEN,{detail:{isInFullscreen:!1,isHideControlBar:n.style.display=="none"?!0:!1,transportHeight:t}}));this._parentNode.dispatchEvent(new CustomEvent(UIEvent.RESIZE_MARKER_INFO));this._parentNode.dispatchEvent(new CustomEvent(UIEvent.ON_FULLSCREENEXIT))}};LayoutManager.prototype.handleQTOnRestoreFromFullScreen=function(){var n=document.getElementById(i._playerinstanceIdentifier+"_nativePlayerType").value;n.toUpperCase()=="QT"&&(jQuery("#"+this._playerinstanceIdentifier+"_Div").removeClass("cmpContainerDiv"),jQuery("#"+this._playerinstanceIdentifier+"_Div").removeClass("qtContainerDiv"))};LayoutManager.prototype.removeControlbarShowHideHandling=function(){this.boolAutoHideControlBarOnFullScreen&&!this.boolAutoHideControlBar?(document.getElementById(this._playerinstanceIdentifier+"_ClearMediaPlayer").parentNode.removeEventListener("mousemove",this.showControlbarOnMouseMoveAndShortCut),document.getElementById(this._playerinstanceIdentifier+"_dvControls").removeEventListener("mouseover",function(){i.isMouseOverControlbar=!0}),document.getElementById(this._playerinstanceIdentifier+"_dvControls").removeEventListener("mouseout",function(){i.isMouseOverControlbar=!1}),this.isMouseOverControlbar=!1,this.clearControlbarTimer()):document.getElementById(this._playerinstanceIdentifier+"_ClearMediaPlayer").parentNode.removeEventListener("mousedown",this.handleControlBarOnClick);this.handleShowHideControlBar(!1)};LayoutManager.prototype.prepareToGoFullScreen=function(t){var r=document.getElementById(i._playerinstanceIdentifier+"_nativePlayerType").value;this.activatePopupEscapeKeyPress(!1);document.getElementById(n+"_btnZoom")&&(document.getElementById(n+"_btnZoom").className="Portable");document.getElementById(n+"btnNonAvFullScreen")&&(document.getElementById(n+"btnNonAvFullScreen").className="nonAvFullScreenExit",document.getElementById(n+"btnNonAvFullScreen").title="Switch to normal mode",this.updateNonAvControlWrapper());document.getElementsByTagName("html")[0].style.overflow="hidden";this._stylingInfo==undefined&&(this._stylingInfo={});this._stylingInfo!=null&&(this._stylingInfo.cmpPlayerDiv=document.getElementById(n+"_Div").className);document.getElementById(n+"_Div")&&(r.toUpperCase()=="QT"?(document.getElementById(n+"_Div").className="qtContainerDiv",jQuery("#"+this._playerinstanceIdentifier+"_dvControls").removeClass("normalMode"),jQuery("#"+this._playerinstanceIdentifier+"_dvControls").addClass("qtNormalMode")):document.getElementById(n+"_Div").className="cmpContainerDiv");jQuery("#"+t).addClass("cmpFullscreen");this._controlType.toUpperCase()=="STANDARD"?(document.getElementById(this._playerinstanceIdentifier+"_ClearMediaPlayer").parentNode.className="nativePlayerFS",document.getElementById(this._playerinstanceIdentifier+"_playerStyle").parentNode.className+=" fullScreenMode",document.getElementById(this._playerinstanceIdentifier+"_dvHelp").className="dvHelpFS",document.getElementById(this._playerinstanceIdentifier+"_dvHelp").style.bottom=window.getComputedStyle(jQuery("#"+this._playerinstanceIdentifier+"_Div .userControls")[0]).height,document.getElementById(this._playerinstanceIdentifier+"_mediaInfoOverlay")&&(document.getElementById(this._playerinstanceIdentifier+"_mediaInfoOverlay").className="mediaInfoOverlayFS nonSelectable"),jQuery("#"+this._playerinstanceIdentifier+"_settingsMenu").removeClass("settingsMenu"),jQuery("#"+this._playerinstanceIdentifier+"_settingsMenu").addClass("settingsMenuFS")):this._controlType.toUpperCase()=="NONAV"?(document.getElementById(t).className="nonAvViewerFS",this._parentNode.dispatchEvent(new CustomEvent(NonAvViewerEvent.RESIZE_NONAV))):document.getElementById(t).className="nativePlayerFS"};LayoutManager.prototype.prepareToRestoreFromFullScreen=function(t){this.activatePopupEscapeKeyPress(!0);document.getElementsByTagName("html")[0].style.overflow="";document.getElementById(n+"_Div")&&(document.getElementById(n+"_Div").className="assetDetailPlayerContextDiv");document.getElementById(n+"_btnZoom")&&(document.getElementById(n+"_btnZoom").className="fullScreen");document.getElementById(n+"btnNonAvFullScreen")&&(document.getElementById(n+"btnNonAvFullScreen").className="nonAvFullScreen",document.getElementById(n+"btnNonAvFullScreen").title="Switch to full-screen mode",this.updateNonAvControlWrapper());this._stylingInfo!=null&&(document.getElementById(n+"_Div").className=this._stylingInfo.cmpPlayerDiv);jQuery("#"+t).removeClass("cmpFullscreen");this._controlType.toUpperCase()=="STANDARD"?(document.getElementById(this._playerinstanceIdentifier+"_ClearMediaPlayer").parentNode.className="nativePlayer",document.getElementById(this._playerinstanceIdentifier+"_playerStyle").parentNode.className="userControls",document.getElementById(this._playerinstanceIdentifier+"_dvHelp").className="dvHelp",document.getElementById(this._playerinstanceIdentifier+"_dvHelp").style.bottom="",document.getElementById(this._playerinstanceIdentifier+"_mediaInfoOverlay")&&(document.getElementById(this._playerinstanceIdentifier+"_mediaInfoOverlay").className="mediaInfoOverlay nonSelectable"),jQuery("#"+this._playerinstanceIdentifier+"_settingsMenu").removeClass("settingsMenuFS"),jQuery("#"+this._playerinstanceIdentifier+"_settingsMenu").addClass("settingsMenu")):this._controlType.toUpperCase()=="NONAV"?(document.getElementById(t).className="nonAvViewer",this._parentNode.dispatchEvent(new CustomEvent(NonAvViewerEvent.RESIZE_NONAV))):document.getElementById(t).className="nativePlayerFS";var r=document.getElementById(i._playerinstanceIdentifier+"_nativePlayerType").value;r.toUpperCase()=="QT"&&(jQuery("#"+this._playerinstanceIdentifier+"_dvControls").removeClass("qtNormalMode"),jQuery("#"+this._playerinstanceIdentifier+"_dvControls").addClass("normalMode"),jQuery("#"+n+"_Div").removeClass("qtContainerDiv"))};LayoutManager.prototype.handleFullscreen=function(){window.addEventListener("keyup",r,!1)};LayoutManager.prototype.activatePopupEscapeKeyPress=function(n){(document.getElementById("popUpBox")==null||document.getElementById("popUpBox")==undefined)&&(n?enablePopupCloseOnEscapeKeyPress(!0):enablePopupCloseOnEscapeKeyPress(!1))};LayoutManager.prototype.handleExitFullscreen=function(){window.removeEventListener("keyup",r,!1)};LayoutManager.prototype.handleOlderVersionOfIE=function(){if(this.isOlderVersionOfIE())try{wscriptActiveX=new ActiveXObject("Wscript.shell")}catch(n){return showErrorDetails("Enable ActiveX control for fullscreen mode","0"),!1}return!0};LayoutManager.prototype.isOlderVersionOfIE=function(){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var n=new Number(RegExp.$1);return n<=10?!0:!1}return!1};LayoutManager.prototype.toggleFullscreen=function(){this._isFullscreen=this._isFullscreen==!0?!1:!0};LayoutManager.prototype.browserToggleFullscreen=function(n){var t,r;if(n==!0){if(t=parent.document,t)if(t.cancelFullScreen)t.cancelFullScreen();else if(t.msExitFullscreen)t.msExitFullscreen();else if(t.mozCancelFullScreen)t.mozCancelFullScreen();else if(t.webkitCancelFullScreen)document.getElementById(i._playerinstanceIdentifier+"_nativePlayerType").value.toUpperCase()=="QT"?(t.addEventListener(UIEvent.QT_FULL_SCREEN_TOGGLE,this.fullscreenchangeHandler),t.dispatchEvent(new CustomEvent(UIEvent.QT_FULL_SCREEN_TOGGLE)),t.removeEventListener(new CustomEvent(UIEvent.QT_FULL_SCREEN_TOGGLE))):t.webkitCancelFullScreen();else try{wscriptActiveX.SendKeys("{F11}");this.toggleFullscreen();this.handleExitFullscreen();this.exitFullScreen()}catch(u){}}else if(r=this.getParentNode(),r.requestFullscreen)r.requestFullscreen();else if(r.msRequestFullscreen)r.msRequestFullscreen();else if(r.mozRequestFullScreen)r.mozRequestFullScreen();else if(r.webkitRequestFullscreen)document.getElementById(i._playerinstanceIdentifier+"_nativePlayerType").value.toUpperCase()=="QT"?(r.addEventListener(UIEvent.QT_FULL_SCREEN_TOGGLE,this.fullscreenchangeHandler),r.dispatchEvent(new CustomEvent(UIEvent.QT_FULL_SCREEN_TOGGLE)),r.removeEventListener(new CustomEvent(UIEvent.QT_FULL_SCREEN_TOGGLE))):r.webkitRequestFullscreen();else try{this.isBrowserInFullScreen()||wscriptActiveX.SendKeys("{F11}");this.toggleFullscreen();this.handleFullscreen();this.goToFullScreen()}catch(u){}};LayoutManager.prototype.getParentNode=function(){var n;return document.getElementById(this._playerinstanceIdentifier+"nonAvContainer")&&(n=document.getElementById(this._playerinstanceIdentifier+"nonAvContainer").parentNode.parentNode),parent.parent.document.getElementById("previewPlayer")&&(n=parent.parent.document.getElementById("previewPlayer")),parent.document.getElementById("assetViewerPlayer")&&(n=parent.document.getElementById("assetViewerPlayer")),parent.document.getElementById("ReviewPlayerContainer")&&(n=parent.document.getElementById("ReviewPlayerContainer")),parent.document.getElementById("breakStructurePlayer")&&(n=parent.document.getElementById("breakStructurePlayer")),parent.document.getElementById("popUpAjaxUpdater")&&(n=parent.document.getElementById("popUpAjaxUpdater")),parent.document.getElementById("EditorViewPlayer")&&(n=parent.document.getElementById("EditorViewPlayer")),parent.document.getElementById("smartPlayer")&&(n=parent.document.getElementById("smartPlayer")),parent.parent.document.getElementById("stOuterPanel")&&(n=parent.parent.document.getElementById("stOuterPanel")),parent.document.getElementById("prTemplateBuilderBodyCtr")&&(n=parent.document.getElementById("prTemplateBuilderBodyCtr")),parent.document.getElementById("CatalogUCPlayer")&&(n=parent.document.getElementById("CatalogUCPlayer")),parent.document.getElementById("ComplianceReviewPlayer")&&(n=parent.document.getElementById("ComplianceReviewPlayer")),parent.document.getElementById("standardPlayer")&&(n=parent.document.getElementById("standardPlayer")),n};LayoutManager.prototype.fullscreenchangeHandler=function(){i.toggleFullscreen();i._isFullscreen?i.goToFullScreen():(i.registerFullscreenChangeEventHandler(!1),i.exitFullScreen())};LayoutManager.prototype.isPlayerInFullScreenMode=function(){return parent.document.fullscreenElement&&parent.document.fullscreenElement!==null||parent.document.mozFullScreen||parent.document.webkitIsFullScreen||parent.document.msFullscreenElement};LayoutManager.prototype.isBrowserInFullScreen=function(){return window.innerWidth==screen.width&&window.innerHeight==screen.height};LayoutManager.prototype.registerFullscreenChangeEventHandler=function(n){var t=parent.document;n?(t.addEventListener("fullscreenchange",this.fullscreenchangeHandler,!1),t.addEventListener("webkitfullscreenchange",this.fullscreenchangeHandler,!1),t.addEventListener("mozfullscreenchange",this.fullscreenchangeHandler,!1),t.addEventListener("MSFullscreenChange",this.fullscreenchangeHandler,!1)):(t.removeEventListener("fullscreenchange",this.fullscreenchangeHandler,!1),t.removeEventListener("webkitfullscreenchange",this.fullscreenchangeHandler,!1),t.removeEventListener("mozfullscreenchange",this.fullscreenchangeHandler,!1),t.removeEventListener("MSFullscreenChange",this.fullscreenchangeHandler,!1))};LayoutManager.prototype.updateNonAvControlWrapper=function(){this._isFullscreen?(document.getElementById("rightBar").className="nonAvRightBarFS",document.getElementById(n+"nonViewerHeader").className="cntrlWrapperFS",document.getElementById(n+"nonAVPageCount").className="nonAvPageCountFS"):(document.getElementById("rightBar").className="nonAvRightBar",document.getElementById(n+"nonViewerHeader").className="cntrlWrapper",document.getElementById(n+"nonAVPageCount").className="nonAvPageCount")};LayoutManager.prototype.setAutoHideForToolbar=function(n){this.boolAutoHideControlBar=n}}function SequenceClipManager(n,t,i){this._cmpModel=t;this._nativeApi=n;this._instanceId=i;this._eventDispatcher=document.getElementById(i);this._sequenceManager=new SequenceManager(t,i,n);this._injector=getCMPInstanceByInstanceId(i)._injector;this._mediaManager=this._injector.getInstance("mediaManager");var r=this;SequenceClipManager.prototype.loadClip=function(n){if(this.initialiseSequenceClipMode(),CMPUtils.IsNullOrEmpty(n)){if(this._cmpModel._ceProject.sequence.segments.length==0){this._eventDispatcher.dispatchEvent(new CustomEvent(CMPEvent.SET_CMP_STATE_EVENT,{detail:{newState:"WAITINGFORMEDIASOURCE"}}));this._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.SHOW_HIDE_GENERICS_ICON,{detail:{value:!0}}));return}n=this._cmpModel._ceProject.sequence.segments[0].clipOrderId}var t=CMPUtils.getClipObjectWithClipUiId(n,this._cmpModel.ceProject.bin.clips,this._cmpModel.sequenceClipInfo);this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.BIND_SCREENSHOTS,{detail:{clipOrderId:n,ceProject:this._cmpModel.ceProject}}));this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.LOADING_CLIP,{detail:{clipOrderId:n}}));this._cmpModel.currentClipOrderId!=n&&(CMPUtils.IsNullOrEmpty(this._cmpModel.currentSegment)||this._cmpModel.currentSegment.clipOrderId!=n)?(this._cmpModel.currentClipOrderId=n,this._cmpModel.currentSegment=null,this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.SET_MEDIA_SOURCE,{detail:{url:t.url,autoPlay:this._cmpModel.autoPlay}}))):(this._cmpModel.currentClipOrderId=n,this._cmpModel.currentSegment=null,this._nativeApi.Seek(CMPUtils.RoundOffToNearestFrameWithMilliSecs(t.startTime*1e3,this._mediaManager.getFrameRateBasedOnMode())),this._cmpModel.mediaInfo.isLive&&(this._cmpModel.isSeekToLiveRequested=!1));this._cmpModel.currentClipOrderId!=t.clipOrderId&&this.setClipInfo(t)};SequenceClipManager.prototype.initialiseSequenceClipMode=function(){this._cmpModel.playerMode=PlayerMode.SEQUENCE_CLIP;this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SWITCH_SEQUENCE_MODE,{detail:{mode:PlayerMode.SEQUENCE_CLIP}}));this._cmpModel.timelineMetadata!=null&&this._cmpModel.timelineMetadata.reset();this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.UNHIGHLIGHT_SEGMENT));this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.TOGGLE_UI_CONTROL_VISIBILITY,{detail:{controlKeyName:"enablemarkinout",isEnable:!0}}));this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.REMOVE_MARKER));this._cmpModel.autoPlay=!1};SequenceClipManager.prototype.setClipInfo=function(n){this._cmpModel.mediaDuration=this._mediaManager.getMediaDuration();this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.SET_MEDIA_DURATION,{detail:{duration:this._cmpModel.mediaDuration}}));this.updateClipMediaInfo(n);this._eventDispatcher.dispatchEvent(new CustomEvent(SeekBarEvent.LOAD_SEEKBAR,{detail:{mediaInfo:this._cmpModel.mediaInfo}}))};SequenceClipManager.prototype.updateClipMediaInfo=function(n){this._cmpModel.mediaInfo.startSeek=n.startTime*1e3;this._cmpModel.mediaInfo.endSeek=n.endTime*1e3;this._cmpModel.mediaInfo.som=n.startOfMedia};SequenceClipManager.prototype.calculateClipDuration=function(){var n=CMPUtils.getClipObjectWithClipUiId(r._cmpModel.currentClipOrderId,r._cmpModel.ceProject.bin.clips,r._cmpModel.sequenceClipInfo);return CMPUtils.RoundOffToNearestFrame(n.duration,r._mediaManager.getFrameRateBasedOnMode())};SequenceClipManager.prototype.loadSegment=function(n){n.clipOrderId!=this._cmpModel.currentClipOrderId?r._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.LOAD_CLIP,{detail:{clipOrderId:n.clipOrderId}})):(r._cmpModel.playerInfo.CMPConfig.CMPConfigValue.PauseOnSegmentDurationReached="true",r._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_RANGE_MARKER,{detail:{startTimeInMsec:n.startTime*1e3,endTimeInMsec:n.endTime*1e3,autoPlay:"false",showMarkerIcons:!0}})))};SequenceClipManager.prototype.previousSegment=function(n){var t=new MarkerManager(this._cmpModel).getCurrentMarker(),n;this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.CREATE_MARKER,{detail:{markIn:t.markIn,markOut:t.markOut}}));n=CMPUtils.getSegmentByTcInTcOut(t.markIn,t.markOut);r._cmpModel.currentSegment.implictSegment==!1?(n=CMPUtils.getSegmentBasedOnPosition(r._cmpModel.ceProject.sequence,r._cmpModel.currentSegment.position-1),n.clipOrderId==r._cmpModel.currentSegment.clipOrderId&&(previousSegment=n)):previousSegment=CMPUtils.getFirstSegmentForClip(r._cmpModel.ceProject.sequence,r._cmpModel.currentSegment.clipOrderId)};SequenceClipManager.prototype.createCaptureFrame=function(n){var h=this._mediaManager.getFrameRateBasedOnMode(),f,o,a,e,y,i,c,u,v,s;n=CMPUtils.RoundOffToNearestFrame(n,h);var p=CMPUtils.ConvertSecondsToTimeCode(n,h),l=!1,t=this._cmpModel.ceProject._sequence._screenshots;for(f=0;f<t.length;f++)if(t[f].clipOrderId==this._cmpModel.currentClipOrderId&&t[f].captureTimeSecs==n){l=!0;break}if(l)this._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.SHOW_ERROR_MESSAGE,{detail:{message:"A screenshot is already created for the same timecode",closeFunctionCall:function(){r._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_MESSAGE))},okFunctionCall:function(){r._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_MESSAGE))}}}));else{for(o=this._cmpModel.sequenceClipInfo,a=o.length,e=0;e<a;e++)if(o[e]._clipUiId==this._cmpModel.currentClipOrderId){s=CMPUtils.getClipObjectWithClipUiId(o[e]._clipUiId,this._cmpModel.ceProject.bin.clips,this._cmpModel.sequenceClipInfo);y=s._thumbnailUrl;break}for(i=new ScreenShot,i.id=CMPUtils.generateRandomGuidId(),i.captureTimeSecs=n,i.selected="false",i.clipOrderId=this._cmpModel.currentClipOrderId,c=[],c.push(i),u=0;u<t.length;u++)if(t[u].clipOrderId==this._cmpModel.currentClipOrderId&&t[u].captureTimeSecs>n)break;t==undefined||t==null||t.length==0?t.push(i):u==t.length?t.push(i):t.splice(u,0,i);this._cmpModel.ceProject._sequence._screenshots=t;this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.BIND_SCREENSHOTS,{detail:{clipOrderId:i.clipOrderId,ceProject:this._cmpModel.ceProject}}));v=this._cmpModel.thumbExtractionOnLoad;this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SWITCH_TAB));s=CMPUtils.getClipObjectWithClipUiId(i.clipOrderId,this._cmpModel.ceProject.bin.clips,this._cmpModel.sequenceClipInfo);this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.STILL_CAPTURE,{detail:{clipScreenshot:i,clipObj:s,frameRate:h}}));v||this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SEND_THUMB_EXTRACTION_REQUEST,{detail:{screenshots:c}}))}};SequenceClipManager.prototype.deleteCapturedFrame=function(n){for(var t=this._cmpModel.ceProject.sequence.screenshots,u=t.length,r,i=0;i<u;i++)if(t[i].clipOrderId==this._cmpModel.currentClipOrderId&&t[i].id==n){r=t[i];t.splice(i,1);break}this._cmpModel.ceProject._sequence._screenshots=t;this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.BIND_SCREENSHOTS,{detail:{clipOrderId:r.clipOrderId,ceProject:this._cmpModel.ceProject}}));this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.DELETE_STILL_CAPTURE,{detail:{screenshotId:n,screenshotArray:this._cmpModel.ceProject.sequence.screenshots}}))};SequenceClipManager.prototype.deleteClip=function(n){var f,i,e,u;r._eventDispatcher.dispatchEvent(new CustomEvent(TimelineEvent.TIMELINE_EDITED));var t=r._cmpModel.sequenceClipInfo.sort(function(n,t){return n._position-t._position}),o,s=CMPUtils.getClipObjectWithClipUiId(n,r._cmpModel.ceProject._bin._clips,t),h=this._mediaManager.getFrameRateBasedOnMode();for(f=0;f<t.length;f++)n==t[f].clipUiId&&t.splice(f,1);for(i=0;i<r._cmpModel.ceProject.sequence.segments.length;i++)n==r._cmpModel.ceProject.sequence.segments[i].clipOrderId&&(o=r._cmpModel.ceProject.sequence.segments[i].clipOrderId,r._cmpModel.ceProject.sequence.segments.splice(i,1),i-=1);for(e=0;e<t.length;e++)t[e].position=(e+1).toString();for(u=0;u<r._cmpModel.ceProject.sequence.screenshots.length;u++)n==r._cmpModel.ceProject.sequence.screenshots[u].clipOrderId&&(r._cmpModel.ceProject.sequence.screenshots.splice(u,1),u-=1);CMPUtils.setSegmentPosition(r._cmpModel.ceProject.sequence.segments,r._cmpModel.ceProject.bin.clips,r._cmpModel.sequenceClipInfo);CMPUtils.calculateSegmentTimeInSequence(r._cmpModel.ceProject.sequence.segments);r._sequenceManager.setAndDispatchOnFrameRateChanged(r._cmpModel.ceProject.bin.clips);r._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.CLIP_DELETED,{detail:{clipUiId:n,ceProjectObject:r._cmpModel.ceProject,sequenceClipInfo:r._cmpModel.sequenceClipInfo,currentClipOrderId:r._cmpModel.currentClipOrderId,clipId:s.id}}));r.resetMediaSource(r._cmpModel.ceProject.sequence.segments,o);r._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.RESET_DIRECTION_BUTTON_ON_DELETE,{detail:{sequenceInfoList:t}}));r._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT?r._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.BIND_SCREENSHOTS,{detail:{clipOrderId:r._cmpModel.currentClipOrderId,ceProject:r._cmpModel.ceProject}})):r._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.BIND_SCREENSHOTS_PREVIEW_MODE))};SequenceClipManager.prototype.resetMediaSource=function(n,t){n.length==0&&(r._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.RESET_UI_TIMECODE)),clearInterval(this._cmpModel.clearMediaPlayerTimer),clearInterval(this._cmpModel.transportBarSliderUpdationTimer));this._cmpModel.currentClipOrderId==t&&(this._nativeApi.Stop(),r._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.UNLOAD_MEDIA_URL)));r._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW&&(this._cmpModel.timelineMetadata.reset(),this._cmpModel.timelineMetadata.removeValue(),r._sequenceManager.initialisePreviewMode(!0))}}function PS_Buffering(n){this.StateMachine=n}function PS_Default(n){this.StateMachine=n}function PS_Error(n){this.StateMachine=n}function PS_WaitingForMediaSource(n){this.StateMachine=n}function PS_Initialised(n){this.StateMachine=n}function PS_Loading(n){this.StateMachine=n}function PS_Paused(n){this.StateMachine=n}function PS_Playing(n){this.StateMachine=n}function PS_PreInitialised(n){this.StateMachine=n}function PS_Ready(n){this.StateMachine=n}function PS_Stopped(n){this.StateMachine=n}function StateMachine(n,t,i){this.pda;this.stateCollection=[];this.currentState;this.queue;var r=this;this.stateCollection={DEFAULT:new PS_Default(this),PRE_INITIALISED:new PS_PreInitialised(this),WAITINGFORMEDIASOURCE:new PS_WaitingForMediaSource(this),INITIALISED:new PS_Initialised(this),LOADING:new PS_Loading(this),READY:new PS_Ready(this),PLAYING:new PS_Playing(this),STOPPED:new PS_Stopped(this),BUFFERING:new PS_Buffering(this),PAUSED:new PS_Paused(this),ERROR:new PS_Error(this)};Object.defineProperty(StateMachine.prototype,"CurrentState",{get:function(){return this.currentState},set:function(n){this.currentState=n},configurable:!0});Object.defineProperty(StateMachine.prototype,"PushDownAutomaton",{get:function(){return this.pushDownAutomaton},set:function(n){this.pushDownAutomaton=n},configurable:!0});Object.defineProperty(StateMachine.prototype,"EventQueue",{get:function(){return this.eventQueue},set:function(n){this.eventQueue=n},configurable:!0});this.currentState=this.stateCollection.DEFAULT;this.pushDownAutomaton=this.getPda();this.eventQueue=this.getQueue();this.stateTransitionHandler=n;this.instanceId=t;this.cmpModel=i}function PushDownAutomaton(){this.stack=[]}function EventQueue(){this.queue}function StateTransitionHandler(n,t,i){this._eventDispatcher=document.getElementById(t);this._nativeApi=n.getInstance("nativeApi");this._cmpModel=n.getInstance("cmpModel");this._instanceId=t;this._secureInfoObj=i;this._sequenceClipManager=new SequenceClipManager(this._nativeApi,this._cmpModel,this._instanceId);this._mediaManager=n.getInstance("mediaManager");this._timelineManager=n.getInstance("timelineManager");this._transportManager=n.getInstance("transportManager");this._sequenceManager=n.getInstance("sequenceManager");this._nonAVManager=n.getInstance("nonAVManager");this._errorManager=n.getInstance("errorManager");this._audioManager=n.getInstance("audioManager");var r=this;StateTransitionHandler.prototype.handleError=function(n){this._errorManager.handlePlayerError(n)};StateTransitionHandler.prototype.setClearMediaPlayerTimer=function(){this._mediaManager.setClearMediaPlayerTimer()};StateTransitionHandler.prototype.setSecureInfo=function(){this._cmpModel.secureInfo=this._secureInfoObj.split(",")[0];this._secureInfoObj.indexOf(",")!=-1&&(this._secureInfoObj=this._secureInfoObj.split(",")[1]);this._nativeApi.SetSecureInfo(this._secureInfoObj)};StateTransitionHandler.prototype.loadUrl=function(){this._cmpModel.playerMode==PlayerMode.NON_AV_DOCUMENT||this._cmpModel.playerMode==PlayerMode.NON_AV_IMAGE?this._nonAVManager.loadUrl():this._mediaManager.loadUrl()};StateTransitionHandler.prototype.setMediaSource=function(n,t){if(this._cmpModel.playerMode==PlayerMode.NON_AV_DOCUMENT||this._cmpModel.playerMode==PlayerMode.NON_AV_IMAGE){var i=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.activeContainerIds[0],r=this._cmpModel.playerInfo.NonAvInfo[i].SecureInfo;this._nonAVManager.SetNonAvMediaUrl(n,i,r)}else this._nativeApi.SetMediaSource(n,CMPUtils.RoundOffToNearestFrame(t,this._mediaManager.getFrameRateBasedOnMode())),this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.FrameNavigation.AudioCues"]=="true"&&this.setMediaSourceForAudioCue(n)};StateTransitionHandler.prototype.setMediaSourceForAudioCue=function(n){var i,u=/constructor/i.test(window.HTMLElement)||function(n){return n.toString()==="[object SafariRemoteNotification]"}(!window.safari||typeof safari!="undefined"&&safari.pushNotification),f=this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.FrameNavigation.AudioCues.WowzaAppName"],t;if(!u){t=videojs(this._instanceId+"_ClearMediaPlayer_frameLevelCue");n.contains(".m3u8")&&(n=n.split("/"),i=n[0]+"//"+n[2]+"/"+f+"/_definst_/smil:"+n[3]+"/"+n[4]+"/others/"+n[5]+"_ao.smil/manifest.mpd?"+n[7].split("?")[1]);t.src({src:i,type:"application/dash+xml"});t.on("error",function(){r._instanceId&&console.log("Error Ocuured for frame level cues")})}};StateTransitionHandler.prototype.removeMediaSource=function(){this._nativeApi.RemoveMediaSource()};StateTransitionHandler.prototype.getStreamBitrates=function(){try{this._eventDispatcher.dispatchEvent(new CustomEvent(StreamEvent.GET_STREAM_BIT_RATES))}catch(n){}};StateTransitionHandler.prototype.pause=function(){this._transportManager.pause()};StateTransitionHandler.prototype.play=function(){var n,t;this._cmpModel.isMediaDurationReached&&(this._cmpModel.isMediaDurationReached=!1);(this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT||this._cmpModel.playerMode==PlayerMode.STRATA)&&this._cmpModel.segmentDurationReached==!0?(this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT&&(t=r._cmpModel.currentSegment,n=t.startTime*1e3,this._cmpModel.timelineMetadata.reset()),this._cmpModel.playerMode==PlayerMode.STRATA&&(n=this._cmpModel.mediaInfo.SeekStart),r._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SEEK,{detail:{positionInMsec:n,stateAfterSeek:"play"}}))):(this._cmpModel.playbackSpeedRange[this._cmpModel.currentPlaybackSpeedIndex]!=1&&this.resetSpeed(),this._transportManager.play())};StateTransitionHandler.prototype.resetSpeed=function(){if(this._cmpModel.playerInfo.UserPreferredSetting.playbackMode=="Normal"||this._cmpModel.playerInfo.UserPreferredSetting.playbackMode=="Accelerated"&&this._mediaManager.getCurrentTime()==0){var n=this._cmpModel.playbackSpeedRange.indexOf(1),t=CMPUtils.getPlaybackDirection(this._cmpModel.playbackSpeedRange,n);this._cmpModel.currentPlaybackSpeedIndex=n;this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.SHOW_HIDE_MARKER_BUTTONS,{detail:{display:this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.Enable"]}}));this._nativeApi.SetPlaybackSpeed(this._cmpModel.playbackSpeedRange[n],t);this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAYBACK_SPEED_CHANGE,{detail:{playbackSpeed:this._cmpModel.playbackSpeedRange[n],playbackDirection:t}}));this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.HIDE_PLAY_BACK_OVERLAY));this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAY_SUCCESS));this._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_REPORT))}};StateTransitionHandler.prototype.stop=function(){var n,t;this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.REMOVE_MARKERS));CMPUtils.IsNullOrEmpty(this._cmpModel.ceProject)||CMPUtils.IsNullOrEmpty(this._cmpModel.ceProject.sequence)?this._cmpModel.playerMode==PlayerMode.STRATA?r._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SEEK,{detail:{positionInMsec:r._cmpModel.mediaInfo.startSeek,stateAfterSeek:"pause"}})):this._transportManager.stop():this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT||this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW?(n=CMPUtils.getSegmentBasedOnPosition(this._cmpModel.ceProject.sequence,1),this._cmpModel.autoPlay=!1,t=parseFloat(n.startTime)*1e3,this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:n,positionToSeek:this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW?n.startTimeInSequence*1e3:t}})),this._cmpModel.timelineMetadata.reset(),this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.STOP_SUCCESS)),this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.RESET_PLAYBACK_SPEED))):this._transportManager.stop();this._eventDispatcher.dispatchEvent(new CustomEvent(TimelineMetadataEvent.RESET_TIMELINE_METADATA))};StateTransitionHandler.prototype.addToAccumulatedSeekTime=function(n){var u,t,i;this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT?this._cmpModel.pauseAtLastFrame==!0&&this._cmpModel.segmentDurationReached==!0&&n>0?this._cmpModel.accumulatedSeekTimeInSec=this._cmpModel.currentSegment.startTime:(this._cmpModel.accumulatedSeekTimeInSec=CMPUtils.RoundOffToNearestFrame(this.addFramesToCurrentTime(n),this._mediaManager.getFrameRateBasedOnMode()),this._cmpModel.accumulatedSeekTimeInSec<=CMPUtils.RoundOffToNearestFrame(this._cmpModel.currentSegment.startTime,this._mediaManager.getFrameRateBasedOnMode())&&(this._cmpModel.accumulatedSeekTimeInSec=this._cmpModel.currentSegment.startTime)):this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW?n<0?(t=CMPUtils.RoundOffToNearestFrame(this.addFramesToCurrentTime(n),this._mediaManager.getFrameRateBasedOnMode()),i=this._sequenceManager.getSegmentBasedOnSequenceTime(this._cmpModel.ceProject.sequence,t),r._cmpModel.segmentsToSkipPreview.indexOf(i.position)!=-1?(u=r._timelineManager.getPrevSegmentOfCeProject(i.position,r._cmpModel.ceProjectForVideo),this._cmpModel.accumulatedSeekTimeInSec=parseFloat(u.startTimeInSequence)):this._cmpModel.accumulatedSeekTimeInSec=r._cmpModel.takeOrTotal=="TAKE"&&t<this._cmpModel.currentSegment.startTimeInSequence?this._mediaManager.getCurrentTime()==this._cmpModel.currentSegment.startTimeInSequence?i.startTimeInSequence:this._cmpModel.currentSegment.startTimeInSequence:t):(t=CMPUtils.RoundOffToNearestFrame(this.addFramesToCurrentTime(n),this._mediaManager.getFrameRateBasedOnMode()),r._cmpModel.takeOrTotal=="TAKE"&&t>this._cmpModel.currentSegment.endTimeInSequence?(i=this._sequenceManager.getSegmentBasedOnSequenceTime(this._cmpModel.ceProject.sequence,t),this._cmpModel.accumulatedSeekTimeInSec=i.startTimeInSequence):this._cmpModel.accumulatedSeekTimeInSec=CMPUtils.RoundOffToNearestFrame(this.addFramesToCurrentTime(n),this._mediaManager.getFrameRateBasedOnMode())):this._cmpModel.accumulatedSeekTimeInSec=CMPUtils.RoundOffToNearestFrame(this.addFramesToCurrentTime(n),this._mediaManager.getFrameRateBasedOnMode())};StateTransitionHandler.prototype.frameForward=function(){this.frameLevelCues(1);this.addToAccumulatedSeekTime(1);this.seekToAccumulatedTimeOnFrameSeek()};StateTransitionHandler.prototype.frameBackward=function(){var n=this._mediaManager.getCurrentTime();this.frameLevelCues(-1);this.addToAccumulatedSeekTime(-1);this.handleSeekBackwardIfPlayerInStrataMode();this._cmpModel.isPlayerInEditMode?this.ValidateMarkerPositionOnFrameSeek():this.seekToAccumulatedTimeOnFrameSeek()};StateTransitionHandler.prototype.seekToAccumulatedTimeOnFrameSeek=function(){if(this.canSeekTo(this._cmpModel.accumulatedSeekTimeInSec)){var n=this._cmpModel.accumulatedSeekTimeInSec;this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT&&this._cmpModel.pauseAtLastFrame==!0&&this._cmpModel.segmentDurationReached==!0&&(this.resetSegmentOnSeek(),this._cmpModel.accumulatedSeekTimeInSec=0);this._mediaManager.seek(n*1e3);this.resetMediaDurationReachedVariables(this._cmpModel.accumulatedSeekTimeInSec)}else this._cmpModel.accumulatedSeekTimeInSec=0,this._cmpModel.isMediaDurationReached=!1};StateTransitionHandler.prototype.frameLevelCues=function(n){var t=document.getElementById(this._instanceId+"_ClearMediaPlayer_frameLevelCue_html5_api"),i,r;t&&t.src!=null&&(i=this._mediaManager.getCurrentTime(),r=CMPUtils.RoundOffToNearestFrame(i+n*(1/this._mediaManager.getFrameRateBasedOnMode()),this._mediaManager.getFrameRateBasedOnMode()),t&&t.src!=null&&(t.currentTime=i,t.play(),setTimeout(function(){t.pause();t.currentTime=r},60)))};StateTransitionHandler.prototype.resetMediaDurationReachedVariables=function(){if(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.PauseOnMediaDurationReached"]&&this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.PauseOnMediaDurationReached"].toString()=="true"&&this._cmpModel.isMediaDurationReached==!0){if(this._cmpModel.accumulatedSeekTimeInSec>=this._mediaManager.getCurrentTime()){this._cmpModel.accumulatedSeekTimeInSec=0;return}this._cmpModel.isMediaDurationReached=!1}};StateTransitionHandler.prototype.ValidateMarkerPositionOnFrameSeek=function(n){this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.VALIDATE_MARKERS_ON_FRAME_SEEK,{detail:{currentTime:this._cmpModel.accumulatedSeekTimeInSec,markOut:n}}))};StateTransitionHandler.prototype.handleRetainStateOnJumpForPlaylist=function(){(this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW)&&this._cmpModel._playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.RetainStateForJump"]=="true"&&(this._nativeApi.GetCurrentState()=="PLAYING"||this._nativeApi.GetCurrentState()=="BUFFERING"&&r._cmpModel.oldState.toUpperCase()=="PLAYING")&&(this._cmpModel.autoPlay=!0)};StateTransitionHandler.prototype.secondForward=function(){var n=this._cmpModel._playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.SecondsNavigation.JumpToSecs"],t=this._mediaManager.getCurrentTime();this.addToAccumulatedSeekTime(n*this._mediaManager.getFrameRateBasedOnMode());this.handleRetainStateOnJumpForPlaylist();this.seekToAccumulatedTimeOnFrameSeek()};StateTransitionHandler.prototype.secondBackward=function(){var n=this._cmpModel._playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.SecondsNavigation.JumpToSecs"],t=this._mediaManager.getCurrentTime();this.addToAccumulatedSeekTime(-1*n*this._mediaManager.getFrameRateBasedOnMode());this.handleSeekBackwardIfPlayerInStrataMode();this.handleRetainStateOnJumpForPlaylist();this.seekToAccumulatedTimeOnFrameSeek()};StateTransitionHandler.prototype.handleSeekBackwardIfPlayerInStrataMode=function(){this._cmpModel.playerMode==PlayerMode.STRATA&&this._cmpModel.accumulatedSeekTimeInSec<=CMPUtils.RoundOffToNearestFrame(this._cmpModel.mediaInfo.startSeek/1e3,this._mediaManager.getFrameRateBasedOnMode())&&(this._cmpModel.accumulatedSeekTimeInSec=CMPUtils.RoundOffToNearestFrame(parseFloat(this._cmpModel.mediaInfo.startSeek)/1e3,this._mediaManager.getFrameRateBasedOnMode()))};StateTransitionHandler.prototype.minuteForward=function(){var n=this._mediaManager.getCurrentTime();this.addToAccumulatedSeekTime(60*this._mediaManager.getFrameRateBasedOnMode());this.handleRetainStateOnJumpForPlaylist();this.seekToAccumulatedTimeOnFrameSeek()};StateTransitionHandler.prototype.minuteBackward=function(){var n=this._mediaManager.getCurrentTime();this.addToAccumulatedSeekTime(-60*this._mediaManager.getFrameRateBasedOnMode());this.handleSeekBackwardIfPlayerInStrataMode();this.handleRetainStateOnJumpForPlaylist();this.seekToAccumulatedTimeOnFrameSeek()};StateTransitionHandler.prototype.playForward=function(){this.changePlaybackSpeed(!0)};StateTransitionHandler.prototype.playBackward=function(){this.changePlaybackSpeed(!1)};StateTransitionHandler.prototype.changePlaybackSpeed=function(n){var i=this._cmpModel.playbackSpeedRange,t,r;n&&this._cmpModel.currentPlaybackSpeedIndex<this._cmpModel.playbackSpeedRange.length-1?this._cmpModel.currentPlaybackSpeedIndex++:this._cmpModel.currentPlaybackSpeedIndex>0&&this._cmpModel.currentPlaybackSpeedIndex--;t=this._cmpModel.currentPlaybackSpeedIndex;i[t]==1&&this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.SHOW_HIDE_MARKER_BUTTONS,{detail:{display:this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.Enable"]}}));this._nativeApi.SetPlaybackSpeed(i[t],CMPUtils.getPlaybackDirection(i,t));this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAYBACK_SPEED_CHANGE,{detail:{playbackSpeed:i[t],playbackDirection:CMPUtils.getPlaybackDirection(i,t)}}));this._cmpModel.playerInfo.UserPreferredSetting.playbackMode=="Normal"&&(r=this._nativeApi.GetCurrentState(),i[t]==1?this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAY_SUCCESS)):r.toUpperCase()=="PLAYING"?this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PAUSE_SUCCESS)):this._transportManager.play())};StateTransitionHandler.prototype.resetSeek=function(){if(this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW){var n=this._cmpModel.ceProject.sequence.segments[0];this._cmpModel.autoPlay=!0;this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.LOAD_SEGMENT,{detail:{segment:n,positionToSeek:parseFloat(n.startTime)*1e3}}));this._cmpModel.timelineMetadata.resetIndex(n.startTime)}else this._nativeApi.Seek(0),this._cmpModel.accumulatedSeekTimeInSec=0};StateTransitionHandler.prototype.seek=function(n,t,i){t=t==undefined?0:t;i=i==undefined?0:i;var r=n/1e3;this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW&&(r=this._sequenceManager.calculateSequenceTime(n/1e3));this.canSeekTo(r)?(this.resetMediaDurationReachedVariables(n/1e3),n=CMPUtils.RoundOffToNearestFrameWithMilliSecs(n,this._mediaManager.getFrameRateBasedOnMode()),this._nativeApi.Seek(n,t,i)):(this._mediaManager.seek(0),this._cmpModel.accumulatedSeekTimeInSec=0);this.resetSegmentOnSeek();(this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW||this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW)&&this._cmpModel.timelineMetadata.removeEvent();this._cmpModel.mediaInfo.isLive&&(this._cmpModel.isSeekToLiveRequested=!1)};StateTransitionHandler.prototype.snapToNearestTime=function(){var n=this._mediaManager.getCurrentTime(),t=CMPUtils.RoundOffToNearestFrame(n,this._mediaManager.getFrameRateBasedOnMode())*1e3;this._mediaManager.seek(t)};StateTransitionHandler.prototype.canSeekTo=function(n){return isNaN(n)==!1&&Number(n.toFixed(2))>=0&&(n<=this._cmpModel.mediaDuration||n<=this._mediaManager.getCurrentTime())?!0:!1};StateTransitionHandler.prototype.seekToAccumulatedTime=function(){if(this._cmpModel.accumulatedSeekTimeInSec!=0){var n=this._mediaManager.getCurrentTime();n.toFixed(4)!=this._cmpModel.accumulatedSeekTimeInSec.toFixed(4)&&(this._cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW||this._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW?this._mediaManager.seek(this._cmpModel.accumulatedSeekTimeInSec*1e3):this.seek(this._cmpModel.accumulatedSeekTimeInSec*1e3));this._cmpModel.accumulatedSeekTimeInSec=0}};StateTransitionHandler.prototype.isSegmentSeekPositionReached=function(n){if(!CMPUtils.IsNullOrEmpty(n)&&n>=0)if(this._sequenceManager.getCurrentSequenceMode()==PlayerMode.SEQUENCE_PREVIEW){if(this._sequenceManager.getClipTimeBasedOnSequenceTime(this._mediaManager.getCurrentTime()).toFixed(4)==CMPUtils.RoundOffToNearestFrame(n/1e3,this._mediaManager.getFrameRateBasedOnMode()).toFixed(4))return!0}else if(this._sequenceManager.getCurrentSequenceMode()==PlayerMode.SEQUENCE_SEGMENT_EDIT&&this._mediaManager.getCurrentTime().toFixed(4)==CMPUtils.RoundOffToNearestFrame(n/1e3,this._mediaManager.getFrameRateBasedOnMode()).toFixed(4))return!0;return!1};StateTransitionHandler.prototype.addFramesToCurrentTime=function(n){var t=this._mediaManager.getCurrentTime();return this._cmpModel.accumulatedSeekTimeInSec!=0?this._cmpModel.accumulatedSeekTimeInSec+n*(1/this._mediaManager.getFrameRateBasedOnMode()):t+n*(1/this._mediaManager.getFrameRateBasedOnMode())};StateTransitionHandler.prototype.seekToCurrentTime=function(){var n=this._mediaManager.getCurrentTime();this.seek(n*1e3)};StateTransitionHandler.prototype.updateMediaDuration=function(){this._cmpModel.mediaDuration=this._mediaManager.getMediaDuration();this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.SET_MEDIA_DURATION,{detail:{duration:this._cmpModel.mediaDuration}}));this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.Set_MarkerPosition))};StateTransitionHandler.prototype.addAnnotationsToTimeline=function(){CMPUtils.IsNullOrEmpty(r._cmpModel.annotationCollection)||r._cmpModel.annotationCollection.length>0&&new AnnotationManager(this._stateMachine,this._cmpModel,this._nativeApi,this._instanceId).addAnnotationsToTimeline()};StateTransitionHandler.prototype.createPointAnnotation=function(){var n;this._nativeApi.Pause();n=this._mediaManager.getCurrentTime();new MarkerManager(this._cmpModel).createMarker(n,n);var t=CMPUtils.ConvertTimeCodeToSecs(this._cmpModel.mediaInfo.som,this._mediaManager.getFrameRateBasedOnMode(),this._cmpModel.mediaInfo.timecodeDisplayFormat),i=CMPUtils.ConvertSecondsToTimeCode(n+t,this._mediaManager.getFrameRateBasedOnMode(),this._cmpModel.mediaInfo.timecodeDisplayFormat),r=CMPUtils.ConvertSecondsToTimeCode(n,this._mediaManager.getFrameRateBasedOnMode(),this._cmpModel.mediaInfo.timecodeDisplayFormat);this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.POINT_ANNOTATION_CREATED,{detail:{annotationTimeInSecs:n,annotationTimeWithSom:i,annotationTimeWithoutSom:r}}));this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.HIDE_PLAY_BACK_OVERLAY))};StateTransitionHandler.prototype.setMarkInPosition=function(n){this.createMarkIn(n.markInTime,n.markOutTime)};StateTransitionHandler.prototype.setMarkOutPosition=function(n){this.createMarkOut(n.markInTime,n.markOutTime)};StateTransitionHandler.prototype.createMarkInForSegmentOrAnnotation=function(){var i=this._mediaManager.getCurrentTime(),n=CMPUtils.RoundOffToNearestFrame(i,this._mediaManager.getFrameRateBasedOnMode()),t=this._cmpModel.mediaDuration;if(this._cmpModel.playerMode==PlayerMode.SEQUENCE_CLIP)this.createMarkIn(n,t);else{if(this._cmpModel.pauseAtLastFrame==!0&&this._cmpModel.segmentDurationReached==!0){this._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.SHOW_Generic_ERROR_MESSAGE));return}this.createMarkInForAnnotation(n,t)}};StateTransitionHandler.prototype.createMarkIn=function(n,t){var i=!1,u=this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MaintainPlaybackStateOnMarkInOut"],r;(CMPUtils.IsNullOrEmpty(u)||u.toLowerCase()=="false")&&this._nativeApi.Play();this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.ENABLE_CLEARMARKER));this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.ENABLE_MARKOUT));this._cmpModel.isMarkOutDone?(r=new MarkerManager(this._cmpModel).getCurrentMarker().markOut,r>n&&(t=r),new MarkerManager(this._cmpModel).createMarker(n,t),i=!0):(this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.DISABLE_MARKIN)),new MarkerManager(this._cmpModel).createMarker(n,t),i=!1);this._cmpModel.isFineTuningInProgress=!0;this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.CREATE_MARKER,{detail:{markIn:n,markOut:t,isMarkOutDone:i}}));!CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.EnableMarkOut"])&&this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.EnableMarkOut"].toLowerCase()=="true"&&this._cmpModel.isMarkOutDone&&this.createMarkOut(n,t)};StateTransitionHandler.prototype.createMarkInForAnnotation=function(n,t){var i=new MarkerManager(this._cmpModel).getCurrentMarker(),u=t;r._cmpModel.isPlayerInEditMode?(u=i.markOut,this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.CHECK_MARKER_VALIDATION,{detail:{markIn:n,markOut:i.markOut,currentMarkerMarkIn:i.markIn,currentMarkerMarkOut:i.markOut,isMarkOutDone:"false"}}))):this.createMarkIn(n,u)};StateTransitionHandler.prototype.createMarkOutForSegmentOrAnnotation=function(){var r=this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MaintainPlaybackStateOnMarkInOut"],i,t,n;(CMPUtils.IsNullOrEmpty(r)||r.toLowerCase()=="false")&&this._nativeApi.Pause();i=this._mediaManager.getCurrentTime();this._cmpModel.isMediaDurationReached==!0&&this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.PauseOnMediaDurationReached"]&&this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.PauseOnMediaDurationReached"].toString()=="true"&&(i=this._mediaManager.getMediaDuration());t=CMPUtils.RoundOffToNearestFrame(i,this._mediaManager.getFrameRateBasedOnMode());n=0;this._cmpModel.playerMode==PlayerMode.SEQUENCE_CLIP?(n=new MarkerManager(this._cmpModel).getCurrentMarker().markIn,this._cmpModel.isPlayerInEditMode||n>=t&&(n=0),this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.DISABLE_MARKIN)),this.createMarkOut(n,t)):this.createMarkOutForAnnotation(n,t)};StateTransitionHandler.prototype.createMarkOut=function(n,t){new MarkerManager(this._cmpModel).createMarker(n,t);this._cmpModel.isMarkOutDone=!0;this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.CREATE_MARKER,{detail:{markIn:n,markOut:t,isMarkOutDone:this._cmpModel.isMarkOutDone}}));this._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.ENABLE_ADDMARKER));var i=CMPUtils.ConvertTimeCodeToSecs(this._cmpModel.mediaInfo.som,this._mediaManager.getFrameRateBasedOnMode(),this._cmpModel.mediaInfo.timecodeDisplayFormat),r=CMPUtils.ConvertSecondsToTimeCode(n+i,this._mediaManager.getFrameRateBasedOnMode(),this._cmpModel.mediaInfo.timecodeDisplayFormat),u=CMPUtils.ConvertSecondsToTimeCode(n,this._mediaManager.getFrameRateBasedOnMode(),this._cmpModel.mediaInfo.timecodeDisplayFormat),f=CMPUtils.ConvertSecondsToTimeCode(t+i,this._mediaManager.getFrameRateBasedOnMode(),this._cmpModel.mediaInfo.timecodeDisplayFormat),e=CMPUtils.ConvertSecondsToTimeCode(t,this._mediaManager.getFrameRateBasedOnMode(),this._cmpModel.mediaInfo.timecodeDisplayFormat);this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.FINE_TUNING_IN_PROGRESS));this._cmpModel.playerMode!=PlayerMode.SEQUENCE_CLIP?this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.SEGMENT_ANNOTATION_CREATED,{detail:{annotationStartTimeInSecs:n,annotationEndTimeInSecs:t,annotationStartTimeTCWithSOM:r,annotationEndTimeTCWithSOM:f,annotationStartTimeTCWithoutSOM:u,annotationEndTimeTCWithoutSOM:e}})):this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.CREATE_SEGMENT,{detail:{segmentStartTimeInSecs:n,segmentEndTimeInSecs:t,segmentStartTimeTCWithSOM:r,segmentEndTimeTCWithSOM:f,segmentStartTimeTCWithoutSOM:u,segmentEndTimeTCWithoutSOM:e}}))};StateTransitionHandler.prototype.createMarkOutForAnnotation=function(n,t){var u,i;this._cmpModel.enableContiguousSegments!="true"||this._cmpModel.isFineTuningInProgress||this._cmpModel.isPlayerInEditMode?CMPUtils.IsNullOrEmpty(this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.EnableMarkOut"])||this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.MarkInOut.EnableMarkOut"].toLowerCase()!="true"||this._cmpModel.isFineTuningInProgress||this._cmpModel.isPlayerInEditMode?(n=new MarkerManager(this._cmpModel).getCurrentMarker().markIn,this._cmpModel.isPlayerInEditMode||n>=t&&(n=0)):(this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.ENABLE_CLEARMARKER)),n=0,new MarkerManager(this._cmpModel).createMarker(n,t)):(this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.ENABLE_CLEARMARKER)),u=window[this._cmpModel.callbacks.OnGetAutoMarkIn](),n=CMPUtils.ConvertTimeCodeToSecs(u,this._mediaManager.getFrameRateBasedOnMode(),this._cmpModel.mediaInfo.timecodeDisplayFormat),n>t&&(n=0),new MarkerManager(this._cmpModel).createMarker(n,t));r._cmpModel.isPlayerInEditMode?(i=new MarkerManager(this._cmpModel).getCurrentMarker(),this._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.CHECK_MARKER_VALIDATION,{detail:{markIn:n,markOut:t,currentMarkerMarkIn:i.markIn,currentMarkerMarkOut:i.markOut,isMarkOutDone:"true"}}))):this.createMarkOut(n,t)};StateTransitionHandler.prototype.fineTuneSave=function(){if(this._cmpModel.isFineTuningInProgress&&this._cmpModel.isMarkOutDone){this._nativeApi.Pause();var t=new MarkerManager(this._cmpModel).getCurrentMarker().markOut,n=CMPUtils.RoundOffToNearestFrame(t,this._mediaManager.getFrameRateBasedOnMode());this._mediaManager.seek(n*1e3);this.createMarkOutForAnnotation(0,n)}};StateTransitionHandler.prototype.setDefaultVolume=function(){this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.EnableVolumeControl"]!="true"&&(this._cmpModel.volume=70,this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.VolumePercentage"]!=null&&(this._cmpModel.volume=this._cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.VolumePercentage"]),this._cmpModel._preferenceSetting.rememberViewerSettings&&(this._cmpModel.volume=this._cmpModel._preferenceSetting.viewerSettings.playerPreferencesSettings.avViewer.common.volumeLevel));this._nativeApi.SetVolume(this._cmpModel.volume)};StateTransitionHandler.prototype.loadClip=function(n){this._timelineManager.loadRangeMarkers(n)};StateTransitionHandler.prototype.switchSequenceMode=function(n){var t;n.mode==PlayerMode.SEQUENCE_PREVIEW?(this._sequenceManager.initialisePreviewMode(n.autoPlay),t=!1):n.mode==PlayerMode.SEQUENCE_SEGMENT_EDIT?(this._sequenceManager.initialiseSegmentEditMode(n.segPosition==undefined?null:n.segPosition,n.autoPlay!=!0?!1:!0),t=!0):n.mode==PlayerMode.SEQUENCE_CPL_PREVIEW&&(this._sequenceManager.initialiseCplPreviewMode(n.autoPlay),t=!1);this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.TOGGLE_UI_CONTROL_VISIBILITY,{detail:{controlKeyName:"enablemarkinout",isEnable:t}}));r._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.REMOVE_MARKER))};StateTransitionHandler.prototype.loadSequenceClip=function(n){this._sequenceClipManager.loadClip(n.clipOrderId)};StateTransitionHandler.prototype.captureFrame=function(){r._cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||r._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT||r._cmpModel.playerMode==PlayerMode.SEQUENCE_CLIP?this._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.CREATE_CAPTURE_FRAME,{detail:{vidCaptureTimeSecs:this._mediaManager.getCurrentTime()}})):this._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.STILL_CAPTURE_FRAME,{detail:{vidCaptureTimeSecs:this._mediaManager.getCurrentTime(),vidCaptureTimeCode:CMPUtils.ConvertSecondsToTimeCode(this._mediaManager.getCurrentTime(),this._mediaManager.getFrameRateBasedOnMode(),this._cmpModel.mediaInfo.timecodeDisplayFormat)}}))};StateTransitionHandler.prototype.setPlaybackSpeed=function(){this._nativeApi.SetPlaybackSpeed(this._cmpModel.playbackSpeedRange[this._cmpModel.currentPlaybackSpeedIndex],CMPUtils.getPlaybackDirection(this._cmpModel.playbackSpeedRange,this._cmpModel.currentPlaybackSpeedIndex))};StateTransitionHandler.prototype.resetCmpOnMediaUnload=function(){this._mediaManager.resetCmpOnMediaUnload()};StateTransitionHandler.prototype.navigateToMarkerPosition=function(n){this._cmpModel.accumulatedSeekTimeInSec=n.markInTime/1e3;this.seekToAccumulatedTimeOnFrameSeek()};StateTransitionHandler.prototype.updateNonAvContainerDisplay=function(n){this._nonAVManager.updateNonAvContainerDisplay(n)};StateTransitionHandler.prototype.preloadNextContainer=function(n){this._nonAVManager.preloadNextContainer(n)};StateTransitionHandler.prototype.handleNonAVReady=function(n){this._nonAVManager.updateNonAvContainer(n)};StateTransitionHandler.prototype.checkLastPlayBackTimeThreshold=function(){this._mediaManager.checkLastPlayBackTimeThreshold()};StateTransitionHandler.prototype.seekToLive=function(){this._nativeApi.Play();this._cmpModel.isSeekToLiveRequested=!0;this._nativeApi.SeekToLive();this.checkAndDispatchEventOnLivePlayHeadChange()};StateTransitionHandler.prototype.resetSegmentOnSeek=function(){this._cmpModel.pauseAtLastFrame==!0&&this._cmpModel.segmentDurationReached==!0&&(this._cmpModel.segmentDurationReached=!1,this._cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT&&this._cmpModel.timelineMetadata.reset(),this._cmpModel.playerMode==PlayerMode.STRATA&&r._cmpModel.strataTimelineMetadata.resetIndex(parseFloat(r._cmpModel.mediaInfo.endSeek)/1e3))};StateTransitionHandler.prototype.loadConfiguredAudioTrack=function(){this._audioManager.loadConfiguredAudioTrack()};StateTransitionHandler.prototype.isLive=function(){return this._mediaManager.isLive()};StateTransitionHandler.prototype.initiliseLiveStream=function(){document.getElementById(this._instanceId).dispatchEvent(new CustomEvent(LiveEvent.LIVE_STREAM_DETECTED));this._cmpModel.liveDurtionUpdationTimer==null&&(this._cmpModel.liveDurtionUpdationTimer=setInterval(function(n){n._cmpModel.mediaInfo.isLive?(n.updateMediaDuration(),document.getElementById(n._instanceId).dispatchEvent(new CustomEvent(SeekBarEvent.LOAD_SEEKBAR,{detail:{isMarkerSliderNeedToUpdate:!n._cmpModel.isFineTuningInProgress&&!n._cmpModel.isMarkOutDone}})),document.getElementById(n._instanceId).dispatchEvent(new CustomEvent(LiveEvent.UPADTE_POSITION_ON_LIVEDURATION_CHANGE))):clearInterval(n._cmpModel.liveDurtionUpdationTimer)},1e4,this))};StateTransitionHandler.prototype.checkAndDispatchEventOnLivePlayHeadChange=function(){var n=this._cmpModel.mediaInfo.livePlayheadPosition;this._cmpModel.mediaInfo.livePlayheadPosition=this._cmpModel.isSeekToLiveRequested?LivePlayHeadPosition.LIVE:LivePlayHeadPosition.HISTORICAL;n!=this._cmpModel.mediaInfo.livePlayheadPosition&&this._eventDispatcher.dispatchEvent(new CustomEvent(LiveEvent.PLAYHEAD_POSITION_CHANGE,{detail:{livePlayheadPosition:this._cmpModel.mediaInfo.livePlayheadPosition}}))};StateTransitionHandler.prototype.pauseOnFirstFrame=function(){this._nativeApi.pauseOnFirstFrame()}}function ViewPort(n){var t,u,i,r;this._cmpConfiguration=null;this._mediaInfo=null;this._isPaused=!1;this._playerinstanceIdentifier=n;this._eventDispatcher=document.getElementById(n);this._time=0;this._fontVariableChange=13;this._waterMarkTimer=null;this._waterMarkFontSize=20;this._loadCount=0;this._lastPlaybackTimeReachedMediaEnd=!1;this._plainText=null;this._timeFormat=null;this._dateFormat=null;this._wmInfo={};t=this;ViewPort.prototype.onStateChangeEvent=function(n){var i=n.detail.state;t._time=n.detail.lastPlayBackTime*1e3};ViewPort.prototype.setConfiguration=function(n){t._cmpConfiguration=n.detail.displayUiElements.CMPConfigValue;t._mediaInfo=n.detail.mediaInfo;CMPUtils.IsNullOrEmpty(t._mediaInfo)||t._mediaInfo._assetClass!="AUDIO"||(document.getElementById(t._playerinstanceIdentifier+"_audioOverlay").style.display="")};ViewPort.prototype.nonAvBuffering=function(n){var i=n.detail.containerId;document.getElementById(t._playerinstanceIdentifier+"_bufferingoverlay_"+i).style.display=""};ViewPort.prototype.nonAvBufferingSuccess=function(n){var i=n.detail.containerId;document.getElementById(t._playerinstanceIdentifier+"_bufferingoverlay_"+i).style.display="none"};ViewPort.prototype.playOverlay=function(n){t._cmpConfiguration["VideoPanelConfig.EnablePlayIconOverlayOnPause"].toLowerCase()=="true"&&(document.getElementById(t._playerinstanceIdentifier+"_PreviewPlayIcon").style.display="",t._cmpConfiguration["VideoPanelConfig.ShowResumePlayBackOverlay"].toLowerCase()=="true"&&t._mediaInfo.islastPlayBackTimeEnabled.toString()=="true"&&t._mediaInfo.lastPlayBackTime!="0"&&t._loadCount==1?t.play():t._loadCount==0&&(t._lastPlaybackTimeReachedMediaEnd=!CMPUtils.IsNullOrEmpty(n.detail)&&!CMPUtils.IsNullOrEmpty(n.detail.lastPlaybackTimeReachedMediaEnd)&&n.detail.lastPlaybackTimeReachedMediaEnd==!0?!0:!1,t.play()))};ViewPort.prototype.hidePlayOverLay=function(){t._cmpConfiguration["VideoPanelConfig.EnablePlayIconOverlayOnPause"].toLowerCase()=="true"&&(document.getElementById(t._playerinstanceIdentifier+"_PreviewPlayIcon").style.display="none")};ViewPort.prototype.showPauseOverlay=function(){t._cmpConfiguration["VideoPanelConfig.EnablePlayIconOverlayOnPause"].toLowerCase()=="true"&&(document.getElementById(t._playerinstanceIdentifier+"_PauseDiv").style.display="")};ViewPort.prototype.hidePauseOverlay=function(){t._cmpConfiguration["VideoPanelConfig.EnablePlayIconOverlayOnPause"].toLowerCase()=="true"&&(document.getElementById(t._playerinstanceIdentifier+"_PauseDiv").style.display="none")};ViewPort.prototype.updateOnPlay=function(){t._cmpConfiguration["VideoPanelConfig.EnablePlayIconOverlayOnPause"].toLowerCase()=="true"&&(t._isPaused=!0)};ViewPort.prototype.hidePlayBackOverLay=function(){t._cmpConfiguration["VideoPanelConfig.ShowResumePlayBackOverlay"].toLowerCase()=="true"&&(document.getElementById(t._playerinstanceIdentifier+"_ShowResumePlayBackOverlay").style.display="none")};ViewPort.prototype.showFlashPluginErrorMessage=function(){document.getElementById(t._playerinstanceIdentifier+"_errorOverlay").getElementsByClassName("errorWarning")[0].className="flashPluginErrorMessageContainer";document.getElementById(t._playerinstanceIdentifier+"_errorMessage").innerHTML=t._cmpConfiguration.FlashPluginLoadTimeErrorMessage.toString();document.getElementById(t._playerinstanceIdentifier+"_errorOverlay").style.display="block";document.getElementById(t._playerinstanceIdentifier+"_Div").getElementsByClassName("userControls")[0].style.display="none";document.getElementById(t._playerinstanceIdentifier+"_Div").getElementsByClassName("PLEditorControlContainer").length>0&&(document.getElementById(t._playerinstanceIdentifier+"_Div").getElementsByClassName("PLEditorControlContainer")[0].style.display="none");document.getElementById(t._playerinstanceIdentifier+"_Div").getElementsByClassName("nativePlayer")[0].style.height="100%"};ViewPort.prototype.showSegmentSavePopup=function(n){document.getElementById(t._playerinstanceIdentifier+"_segmentTcWarning").style.visibility="hidden";document.getElementById(t._playerinstanceIdentifier+"_ttlSegmentWarning").style.visibility="hidden";document.getElementById(t._playerinstanceIdentifier+"_SequenceEditValues_header").innerHTML=n.detail.segmentClipTitle;document.getElementById(t._playerinstanceIdentifier+"_SequenceEditValues_header").title=n.detail.segmentClipTitle;document.getElementById(t._playerinstanceIdentifier+"_txtSegmentStartTimeCode").value=n.detail.segmentStartTimeTCWithSOM;document.getElementById(t._playerinstanceIdentifier+"_txtSegmentEndTimeCode").value=n.detail.segmentEndTimeTCWithSOM;document.getElementById(t._playerinstanceIdentifier+"_SequenceEditValues").style.display="block";document.getElementById("CMP_pageOverlay").style.display="block";document.getElementById(t._playerinstanceIdentifier+"_txtSegmentTitle").focus();n.detail.segmentTitle!=null&&(document.getElementById(t._playerinstanceIdentifier+"_txtSegmentTitle").value=n.detail.segmentTitle);n.detail.segmentComment!=null&&(document.getElementById(t._playerinstanceIdentifier+"_txtsegmentComments").value=n.detail.segmentComment);n.detail.segmentTrackType!=null&&(document.getElementById(t._playerinstanceIdentifier+"_segmentTrackType").value=n.detail.segmentTrackType);document.getElementById(t._playerinstanceIdentifier+"_btnSegmentSave").setAttribute("currentClipObjectDetails",JSON.stringify(n.detail.segmentCurrentClipObjectDetails));n.detail.segmentUid!=null&&(document.getElementById(t._playerinstanceIdentifier+"_btnSegmentSave").setAttribute("currentSegmentUid",n.detail.segmentUid),document.getElementById(t._playerinstanceIdentifier+"_btnSegmentSave").setAttribute("editSegmentClipOrderId",n.detail.segmentClipOrderId))};ViewPort.prototype.hideSegmentSavePopup=function(){document.getElementById(t._playerinstanceIdentifier+"_SequenceEditValues").style.display="none";document.getElementById("CMP_pageOverlay").style.display="none";t.resetSegmentPopupEditValues()};ViewPort.prototype.resetSegmentPopupEditValues=function(){document.getElementById(t._playerinstanceIdentifier+"_segmentEditType").selectedIndex=0;document.getElementById(t._playerinstanceIdentifier+"_segmentTrackType").selectedIndex=0;document.getElementById(t._playerinstanceIdentifier+"_txtsegmentComments").value="";document.getElementById(t._playerinstanceIdentifier+"_txtSegmentTitle").value="";document.getElementById(t._playerinstanceIdentifier+"_segmentTcWarning").style.visibility="hidden";document.getElementById(t._playerinstanceIdentifier+"_ttlSegmentWarning").style.visibility="hidden"};ViewPort.prototype.showSegments=function(i){var d=n+"_editControls",l,b,r,k,u,e,a,nt,tt,v,it,y,p,rt,ut,w,f,ft,et,o,s;document.getElementById(d).innerHTML="";var ot=0,h=null,c=i.detail.sequence,g=i.detail.clips,st=i.detail.sequenceClipInfo;if(c!=null&&(l=c.title,b=n+"_playListNameTab",l===""||l==="undefined"||l==null?(document.getElementById(b).setAttribute("title","Untitled*"),document.getElementById(b).textContent="Untitled*"):(document.getElementById(b).setAttribute("title",l),document.getElementById(b).textContent=CMPUtils.getFormattedTitle(l))),i.detail.playerMode.toLowerCase()==="sequenceclip"){for(rt=null,ut=-1,r=0;r<i.detail.sequenceClipInfo.length;r++)if(i.detail.sequenceClipInfo[r]._clipUiId===i.detail.currentClipOrderId){rt=i.detail.sequenceClipInfo[r]._clipId;ut=i.detail.sequenceClipInfo[r].position;break}if(rt!=null){for(w=null,r=0;r<g.length;r++)if(g[r].id===rt){w=g[r];break}if(f=[],w!=null){for(r=0;r<c.segments.length;r++)c.segments[r]._clipOrderId===i.detail.currentClipOrderId&&f.push(c.segments[r]);if(f.length>0&&f[0].implictSegment===!1)for(k=w.title,h="div"+ut,u=document.createElement("div"),u.id=h,u.className="segGrpDiv",u.innerHTML="<table cellpadding='0' cellspacing='0' border='0' class='segmentsTable'><tr><td colspan='3' class='seg_head'>"+k+"<\/td><\/tr><tr><th class='titleColumn'>Title<\/th><th class='timecodeColumn'>Timecode<\/th><\/tr>",document.getElementById(d).appendChild(u),r=0;r<f.length;r++)a=f[r].title,nt=CMPUtils.getFormattedTitle(a),y="seg"+f[r]._uiId,p=CMPUtils.ConvertTimeCodeToSecs(w.startOfMedia,t._mediaInfo.frameRate,t._mediaInfo.timecodeDisplayFormat),it=f[r]._uiId,e="<div title='Click to seek to segment' id='"+y+"'><table cellpadding='0' cellspacing='0' border='0' class='segmentsTable'><tr><td class='titleColumn'><div title=\" "+a+' " >'+nt,e+="<\/div><\/td><td class='timecodeColumn'>"+CMPUtils.ConvertSecondsToTimeCode(parseFloat(f[r].startTime)+p,t._mediaInfo.frameRate,t._mediaInfo._timecodeDisplayFormat),e+="&nbsp;-&nbsp;"+CMPUtils.ConvertSecondsToTimeCode(parseFloat(f[r].endTime)+p,t._mediaInfo.frameRate,t._mediaInfo._timecodeDisplayFormat)+"<\/td>",e+="<\/div><\/td><\/tr><\/table><\/div><\/table>",r!==0&&(tt="",v=document.createElement("div"),v.innerHTML=tt,u.appendChild(v)),t.addSegment(it,e,h,ut,f[r],w),ot++,t.registerSegmentClickEvent(y,f[r])}}}else for(r=0;r<i.detail.sequenceClipInfo.length;r++)if(ft=CMPUtils.getClipObjectWithClipUiId(st[r].clipUiId,g,st),k=ft.title,et=st[r],o=CMPUtils.getSegmentsForClip(c,et.clipUiId),o.length>0&&o[0].implictSegment===!1)for(h="div"+et.position,u=document.createElement("div"),u.id=h,u.className="segGrpDiv",u.innerHTML=r===0?"<table cellpadding='0' cellspacing='0' border='0' class='segmentsTable'><tr><th class='fillSegment'><\/th><th class='titleColumn'>Title<\/th><th class='timecodeColumn'>TC In / Out<\/th><\/tr><tr><td colspan='3' class='seg_head'>"+k+"<\/td><\/tr>":"<table cellpadding='0' cellspacing='0' border='0' class='segmentsTable'><td colspan='3' class='seg_head'>"+k+"<\/td><\/tr>",document.getElementById(d).appendChild(u),s=0;s<o.length;s++)e="",y="seg"+o[s]._uiId,a=o[s].title,nt=CMPUtils.getFormattedTitle(a),it=o[s]._uiId,e+="<div title='Click to seek to segment' id='"+y+"'><table cellpadding='0' cellspacing='0' border='0' class='segmentsTable'><tr><td class='fillSegment'><\/td><td class='titleColumn'><div title=' "+a+" '>"+nt,p=CMPUtils.ConvertTimeCodeToSecs(ft.startOfMedia,t._mediaInfo.frameRate,t._mediaInfo.timecodeDisplayFormat),e+="<\/div><\/td><td class='timecodeColumn'>"+CMPUtils.ConvertSecondsToTimeCode(parseInt(o[s].startTime)+p,t._mediaInfo.frameRate,t._mediaInfo._timecodeDisplayFormat),e+="&nbsp;-&nbsp;"+CMPUtils.ConvertSecondsToTimeCode(parseInt(o[s].endTime)+p,t._mediaInfo.frameRate,t._mediaInfo._timecodeDisplayFormat)+"<\/td>",e+="<\/div><\/td><\/tr><\/table><\/div><\/table>",s!==0&&(tt="<div class='Segment_hr'><\/div>",v=document.createElement("div"),v.innerHTML=tt,u.appendChild(v)),t.addSegment(it,e,h,et.position,o[s],ft),ot++,t.registerSegmentClickEvent(y,o[s]);ot===0&&(document.getElementById(d).innerHTML="<br />&nbsp;&nbsp;No Segments Available....");loadScrollById(n+"_segWrap");document.getElementById(n+"_container").style.display="block"};ViewPort.prototype.addSegment=function(n,i,r,u,f,e){var o=document.createElement("div"),s,h;o.id="dv"+n;o.className="segChildDiv";o.innerHTML=i;o.onmouseover=function(){t.hideOrShowDelDiv(n,!0)};o.onmouseout=function(){t.hideOrShowDelDiv(n,!1)};s=document.createElement("div");s.id="delDiv"+n;s.onclick=function(){t.deleteSequenceConfirm(f,e)};s.style.visibility="hidden";s.innerHTML='<span class="Del_Segment" title="Delete Sequence"><\/span>';h=document.createElement("div");h.id="editDiv"+n;h.onclick=function(){t.editSegment(f,e)};h.style.visibility="hidden";h.innerHTML='<span class="Edit_Segment" title="Edit Sequence"><\/span>';o.appendChild(h);o.appendChild(s);document.getElementById(r).appendChild(o)};ViewPort.prototype.registerSegmentClickEvent=function(n,i){var r=document.getElementById(n);r.addEventListener("click",function(){t._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.LOAD_SEGMENT,{detail:{segment:i}}))})};ViewPort.prototype.editSegment=function(n,i){t._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.STOP_SUCCESS));t._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.LOAD_CLIP,{detail:{clipOrderId:n.clipOrderId}}));t._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.REMOVE_MARKER));t._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.INITIATE_SEGMENT_PANEL));var r=CMPUtils.ConvertTimeCodeToSecs(i.startOfMedia,t._mediaInfo.frameRate,t._mediaInfo.timecodeDisplayFormat),u=CMPUtils.ConvertSecondsToTimeCode(parseFloat(n.startTime)+r,t._mediaInfo.frameRate,t._mediaInfo._timecodeDisplayFormat),f=CMPUtils.ConvertSecondsToTimeCode(parseFloat(n.endTime)+r,t._mediaInfo.frameRate,t._mediaInfo._timecodeDisplayFormat);t._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SHOW_SEGMENT_POPUP,{detail:{segmentClipTitle:i.title,segmentStartTimeTCWithSOM:u,segmentEndTimeTCWithSOM:f,segmentTitle:n.title,segmentComment:n.comments,segmentUid:n.uiId,segmentClipOrderId:n.clipOrderId,segmentCurrentClipObjectDetails:i,segmentTrackType:n.trackType,segmentEditType:n.editType}}));t._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.INITIATE_SEGMENT_PANEL))};ViewPort.prototype.hideOrShowDelDiv=function(n,t){t?(document.getElementById("delDiv"+n).style.visibility="visible",document.getElementById("editDiv"+n).style.visibility="visible"):(document.getElementById("delDiv"+n).style.visibility="hidden",document.getElementById("editDiv"+n).style.visibility="hidden")};ViewPort.prototype.deleteSequenceConfirm=function(n){t._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SHOW_CONFIRM_ALERT_MESSAGE,{detail:{message:"Are you sure you want to delete this segment?",closeFunctionCall:function(){t._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.HIDE_CONFIRM_ALERT_MESSAGE,{detail:{}}))},confirmFuncCall:function(){t._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.INITIATE_SEGMENT_DELETE,{detail:{segObj:n}}));t._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.REMOVE_MARKER))},cancelFuncCall:function(){t._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.HIDE_CONFIRM_ALERT_MESSAGE,{detail:{}}))}}}))};u=function(){document.getElementById(n+"_PreviewPlayIcon").onclick=function(){t.play()};document.getElementById(n+"_StartOverBtn").onclick=function(){document.getElementById(t._playerinstanceIdentifier+"_ShowResumePlayBackOverlay").style.display="none";t._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SET_LAST_PLAYBACK_TIME,{detail:{time:t._mediaInfo.startSeek}}))};document.getElementById(n+"_resumeBtn").onclick=function(){document.getElementById(t._playerinstanceIdentifier+"_ShowResumePlayBackOverlay").style.display="none";t._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAY))};document.getElementById(n+"_PauseDiv").onclick=function(){t._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PAUSE));Ispaused=!0};document.getElementById(t._playerinstanceIdentifier+"_closeSegmentpopup").onclick=function(){t._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.HIDE_SEGMENT_POPUP));t.setFocus()};document.getElementById(t._playerinstanceIdentifier+"_txtSegmentStartTimeCode").onkeydown=function(n){return CMPUtils.timeCodeKeyDownValidate(n)};document.getElementById(t._playerinstanceIdentifier+"_txtSegmentEndTimeCode").onkeydown=function(n){return CMPUtils.timeCodeKeyDownValidate(n)};document.getElementById(t._playerinstanceIdentifier+"_txtSegmentTitle").onkeypress=function(n){return k=document.all?n.keycode:n.which,k==60||k==63||k==62||k==34||k==92||k==58||k==124||k==42||k==47?!1:void 0};document.getElementById(t._playerinstanceIdentifier+"_btnSegmentSave").onclick=function(){var n=JSON.parse(document.getElementById(t._playerinstanceIdentifier+"_btnSegmentSave").getAttribute("currentClipObjectDetails")),e=document.getElementById(t._playerinstanceIdentifier+"_btnSegmentSave").getAttribute("currentSegmentUid"),o=document.getElementById(t._playerinstanceIdentifier+"_btnSegmentSave").getAttribute("editSegmentClipOrderId"),i=CMPUtils.ConvertTimeCodeToSecs(t._mediaInfo.som,t._mediaInfo.frameRate,t._mediaInfo.timecodeDisplayFormat),s=CMPUtils.ConvertTimeCodeToSecs(document.getElementById(t._playerinstanceIdentifier+"_txtSegmentStartTimeCode").value,t._mediaInfo.frameRate,t._mediaInfo.timecodeDisplayFormat),h=CMPUtils.ConvertTimeCodeToSecs(document.getElementById(t._playerinstanceIdentifier+"_txtSegmentEndTimeCode").value,t._mediaInfo.frameRate,t._mediaInfo.timecodeDisplayFormat),r=CMPUtils.ConvertSecondsToTimeCode(CMPUtils.getTimeWithoutSomInSec(s,i),t._mediaInfo.frameRate,t._mediaInfo.timecodeDisplayFormat),u=CMPUtils.ConvertSecondsToTimeCode(CMPUtils.getTimeWithoutSomInSec(h,i),t._mediaInfo.frameRate,t._mediaInfo.timecodeDisplayFormat),f=CMPUtils.ValidateSegmentTimeCode(n._startTime,n._endTime,r,u,t._mediaInfo.frameRate,t._mediaInfo.timecodeDisplayFormat);document.getElementById(t._playerinstanceIdentifier+"_segmentTcWarning").style.visibility="hidden";document.getElementById(t._playerinstanceIdentifier+"_ttlSegmentWarning").style.visibility="hidden";CMPUtils.IsNullOrEmpty(f)?document.getElementById(t._playerinstanceIdentifier+"_txtSegmentTitle").value.replace(/\s+/g,"")==""?(document.getElementById(t._playerinstanceIdentifier+"_ttlSegmentWarning").title="Enter segment title",document.getElementById(t._playerinstanceIdentifier+"_ttlSegmentWarning").style.visibility="visible"):(t._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SAVE_SEGMENT,{detail:{segmentStartTimeInSecs:r,segmentEndTimeInSecs:u,segmentEditType:document.getElementById(t._playerinstanceIdentifier+"_segmentEditType").value,segmentTrackType:document.getElementById(t._playerinstanceIdentifier+"_segmentTrackType").value,segmentComments:document.getElementById(t._playerinstanceIdentifier+"_txtsegmentComments").value,segmentTitle:document.getElementById(t._playerinstanceIdentifier+"_txtSegmentTitle").value,currentSegmentUid:e,editSegmentClipOrderId:o}})),t.setFocus()):(document.getElementById(t._playerinstanceIdentifier+"_segmentTcWarning").style.visibility="visible",document.getElementById(t._playerinstanceIdentifier+"_segmentTcWarning").title=f);document.getElementById(t._playerinstanceIdentifier+"_btnSegmentSave").removeAttribute("currentSegmentUid");document.getElementById(t._playerinstanceIdentifier+"_btnSegmentSave").removeAttribute("editSegmentClipOrderId")};document.getElementById(t._playerinstanceIdentifier+"_btnSegmentCancle").onclick=function(){t._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.HIDE_SEGMENT_POPUP));t.setFocus()};document.getElementById(n+"_exportButton")!=null&&(document.getElementById(n+"_exportButton").onclick=function(){t.fnHandleExportClips()});document.getElementById(n+"_exportClipIcon")!=null&&(document.getElementById(n+"_exportClipIcon").onclick=function(){t.fnShowExportWizardPopup()});document.getElementById(n+"_exportBlankOverlay")!=null&&(document.getElementById(n+"_exportBlankOverlay").onclick=function(){t.fnHideExportWizardPopup()})};ViewPort.prototype.showAlertMsg=function(n){document.getElementById(t._playerinstanceIdentifier+"_alertMessage").innerHTML=n.detail.message;document.getElementById(t._playerinstanceIdentifier+"_btnAlertClose").onclick=n.detail.closeFunctionCall;document.getElementById(t._playerinstanceIdentifier+"_btnAlertOk").onclick=n.detail.okFunctionCall;document.getElementById(t._playerinstanceIdentifier+"_genericAlert").style.visibility="visible";document.getElementById("CMP_pageOverlay").style.display="block"};ViewPort.prototype.hideAlertMsg=function(){document.getElementById(t._playerinstanceIdentifier+"_genericAlert").style.visibility="hidden";document.getElementById(t._playerinstanceIdentifier+"_alertMessage").innerHTML="";document.getElementById(t._playerinstanceIdentifier+"_btnAlertClose").onclick="";document.getElementById(t._playerinstanceIdentifier+"_btnAlertOk").onclick="";document.getElementById("CMP_pageOverlay").style.display="none"};ViewPort.prototype.showConfirmAlertMsg=function(n){document.getElementById(t._playerinstanceIdentifier+"_alertConfirmMessage").innerHTML=n.detail.message;document.getElementById(t._playerinstanceIdentifier+"_btnConfirmClose").onclick=n.detail.closeFunctionCall;document.getElementById(t._playerinstanceIdentifier+"_btnAlertContinue").onclick=n.detail.confirmFuncCall;document.getElementById(t._playerinstanceIdentifier+"_btnAlertCancel").onclick=n.detail.cancelFuncCall;document.getElementById(t._playerinstanceIdentifier+"_genericConfirmAlert").style.visibility="visible";document.getElementById("CMP_pageOverlay").style.display="block"};ViewPort.prototype.hideConfirmAlertMsg=function(){document.getElementById(t._playerinstanceIdentifier+"_genericConfirmAlert").style.visibility="hidden";document.getElementById(t._playerinstanceIdentifier+"_alertConfirmMessage").innerHTML="";document.getElementById(t._playerinstanceIdentifier+"_btnConfirmClose").onclick="";document.getElementById(t._playerinstanceIdentifier+"_btnAlertContinue").onclick="";document.getElementById(t._playerinstanceIdentifier+"_btnAlertCancel").onclick="";document.getElementById("CMP_pageOverlay").style.display="none"};ViewPort.prototype.updateMediaInfo=function(n){CMPUtils.IsNullOrEmpty(n.detail)||(t._mediaInfo=n.detail.mediaInfo)};ViewPort.prototype.fnHandleExportClips=function(){this.fnValidateExportType()?t._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.HANDLE_EXPORT_CLIPS)):t._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.SHOW_ERROR_MESSAGE,{detail:{message:"Please select atleast one format to download",closeFunctionCall:function(){t._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_MESSAGE))},okFunctionCall:function(){t._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_MESSAGE))}}}))};ViewPort.prototype.fnShowExportWizardPopup=function(){document.getElementById(n+"_ExportPanel").style.display="";document.getElementById(n+"_exportBlankOverlay").style.display=""};ViewPort.prototype.fnHideExportWizardPopup=function(){document.getElementById(n+"_ExportPanel").style.display="none";document.getElementById(n+"_exportBlankOverlay").style.display="none"};ViewPort.prototype.fnValidateExportType=function(){return document.getElementsByName("EDL")[0].checked||document.getElementsByName("FCP")[0].checked?!0:!1};ViewPort.prototype.fnInitialiseWatermarking=function(n){t._wmInfo=n.detail;t._wmInfo.IsEnabled.toLowerCase()=="true"?(n.detail.IsTimeStampEnabled.toLowerCase()=="true"&&t.loadTimer(),t.setDateAndTimeFormat(),t.setWmText(),t.setWaterMarkFontSize(n.detail.FontSize)):document.getElementById(t._playerinstanceIdentifier+"_userProf").style.display="none"};ViewPort.prototype.setWmText=function(){t._wmInfo.Text=t._wmInfo.plainText.replace("\r","");document.getElementById(t._playerinstanceIdentifier+"_userProf").style.display="none";document.getElementById(t._playerinstanceIdentifier+"_userProf").style.backgroundColor=t._wmInfo.BackgroundColour.replace("0x","#");document.getElementById(t._playerinstanceIdentifier+"_userProf").style.opacity=t._wmInfo.BackgroundOpacity;document.getElementById(t._playerinstanceIdentifier+"_userProf").style.color=t._wmInfo.ForegroundColour.replace("0x","#");t._dateFormat==null&&t._timeFormat==null||(document.getElementById(t._playerinstanceIdentifier+"_currentTime").innerHTML=t.getFormattedDateAndTime(t._dateFormat,t._timeFormat));document.getElementById(t._playerinstanceIdentifier+"_currentUser").innerHTML=t._wmInfo.Text};ViewPort.prototype.setDateAndTimeFormat=function(){t._wmInfo.plainText!=null&&t._wmInfo.plainText!=""&&(t._wmInfo.plainText.indexOf("#DATEMMDDYYYY")>=0?(t._dateFormat="MM/DD/YYYY",t._wmInfo.plainText=t._wmInfo.plainText.replace("#DATEMMDDYYYY","")):t._wmInfo.plainText.indexOf("#DATEDDMMYYYY")>=0?(t._dateFormat="DD/MM/YYYY",t._wmInfo.plainText=t._wmInfo.plainText.replace("#DATEDDMMYYYY","")):t._wmInfo.plainText.indexOf("#DATEYYYYMMDD")>=0&&(t._dateFormat="YYYY/MM/DD",t._wmInfo.plainText=t._wmInfo.plainText.replace("#DATEYYYYMMDD","")),t._wmInfo.plainText.indexOf("#TIME12")>=0?(t._timeFormat="#TIME12",t._wmInfo.plainText=t._wmInfo.plainText.replace("#TIME12","")):t._wmInfo.plainText.indexOf("#TIME24")>=0&&(t._timeFormat="hh:mm",t._wmInfo.plainText=t._wmInfo.plainText.replace("#TIME24","")))};ViewPort.prototype.getFormattedDateAndTime=function(){var n=new Date,r=n.getDate(),u=n.getMonth()+1,f=n.getFullYear();return r<10&&(r="0"+r),u<10&&(u="0"+u),t._dateFormat!=null&&t._dateFormat!=""?n.format(t._dateFormat)+" "+i():r+"/"+u+"/"+f+" "+i()};i=function(){var u=new Date,n=u.getHours(),i=u.getMinutes();return(n=n<=9?"0"+n.toString():n.toString(),i=i<=9?"0"+i.toString():i.toString(),t._timeFormat=="#TIME12"&&t._timeFormat!=null)?(n==0&&(n=12),n>12&&(n=n-12),n+":"+i+" "+r(u)):n+":"+i+" "+r(u)};r=function(n){return n.getHours()<12?"AM":"PM"};ViewPort.prototype.setWaterMarkFontSize=function(n){if(CMPUtils.IsNullOrEmpty(n))t.waterMarkFontSize=20;else switch(n.toUpperCase()){case"XSMALL":t.waterMarkFontSize=10;break;case"SMALL":t.waterMarkFontSize=15;break;case"MEDIUM":t.waterMarkFontSize=20;break;case"LARGE":t.waterMarkFontSize=25;break;case"XLARGE":t.waterMarkFontSize=30;break;default:t.waterMarkFontSize=20}};ViewPort.prototype.fnAssignStyleForWatermarking=function(n){var u=n.detail.positionX,s=n.detail.positionY,i,r,h=jQuery("#"+t._playerinstanceIdentifier+"_ClearMediaPlayer").innerWidth(),f=jQuery("#"+t._playerinstanceIdentifier+"_ClearMediaPlayer").innerHeight(),c=f*t.waterMarkFontSize/400,e,o;jQuery("#"+t._playerinstanceIdentifier+"_userProf").css("font-size",c);jQuery("#"+t._playerinstanceIdentifier+"_currentUser").css("width",h*75/100);jQuery("#"+t._playerinstanceIdentifier+"_currentUser").css("padding",f*3/100);switch(u){case"LEFT":i=0;break;case"RIGHT":i=jQuery("#"+t._playerinstanceIdentifier+"_userProf").width();break;case"CENTER":i=parseFloat(jQuery("#"+t._playerinstanceIdentifier+"_userProf").width())/2}switch(s){case"TOP":r=0;break;case"MIDDLE":r=parseFloat(jQuery("#"+t._playerinstanceIdentifier+"_userProf").height())/2;break;case"BOTTOM":r=jQuery("#"+t._playerinstanceIdentifier+"_userProf").height()}e=parseInt(i)==0?0:"-"+parseInt(i);o=parseInt(r)==0?0:"-"+parseInt(r);jQuery("#"+t._playerinstanceIdentifier+"_userProf").css("text-align",u.toLowerCase());jQuery("#"+t._playerinstanceIdentifier+"_userProf").css("left",n.detail.leftPixel+"%");jQuery("#"+t._playerinstanceIdentifier+"_userProf").css("top",n.detail.topPixel+"%");jQuery("#"+t._playerinstanceIdentifier+"_userProf").css("margin-left",e+"px");jQuery("#"+t._playerinstanceIdentifier+"_userProf").css("margin-top",o+"px");jQuery("#"+t._playerinstanceIdentifier+"_userProf").css("bottom","");jQuery("#"+t._playerinstanceIdentifier+"_userProf").css("z-index",1);document.getElementById(t._playerinstanceIdentifier+"_userProf").className="userProf";document.getElementById(t._playerinstanceIdentifier+"_userProf").style.display=t._mediaInfo.assetClass=="AUDIO"?"none":"block"};ViewPort.prototype.fnAssignStyleForDisplayTimedText=function(n){var h=!1,i=n.detail.timedTextLineInfoObject,r=i.LineNumber,v=i.Formatting.ARGB,b=i.Formatting.Color,k=i.Formatting.FontStyle,e=i.Formatting.XPos,c=i.Formatting.YPos,w=i.BackGroundColor,y=i.Formatting.FontSize,u,p,o,f,s,l,a;if(CMPUtils.IsNullOrEmpty(y)){if(jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).css("left","0%"),jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).css("top","0%"),document.getElementById(t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).innerHTML=i.Text,e!=null)e=parseInt(e)+parseInt(i.Formatting.OffsetX),c=parseInt(c)+parseInt(i.Formatting.OffsetY);else{h=!0;var e=parseInt(16)+parseInt(i.Formatting.OffsetX),c=parseInt(15)+parseInt(i.Formatting.OffsetY),u=n.detail.mediaElementHeight*t._fontVariableChange/300;jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).css("font-size",u);jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).css("line-height",u+"px");jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).css("text-align","center")}p=n.detail.offsetWidth+n.detail.mediaElementWidth/20+n.detail.mediaElementWidth/100*90*(e/32);o=n.detail.offsetHeight+n.detail.mediaElementHeight/20+n.detail.mediaElementHeight/100*90*(c/16)-10;i.Formatting.additionalOffsetYInPx!=undefined&&i.Formatting.additionalOffsetYInPx!=0&&(o=o-i.Formatting.additionalOffsetYInPx);f=p/n.detail.mediaLayoutElementWidth*100;s=o/n.detail.mediaLayoutElementHeight*100;divWidth=jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).width();divMinWidth=parseFloat(divWidth)/2;l=parseInt(divMinWidth)==0?0:"-"+parseInt(divMinWidth);a=n.detail.mediaElementWidth*f/100;parseInt(divMinWidth)>parseInt(a)&&(l="-"+a);h&&jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).css("margin-left",l+"px");f>0&&(maxPercentX=100-parseInt(divWidth)*100/n.detail.mediaElementWidth,f<maxPercentX||h?jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).css("left",f+"%"):jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).css("left",maxPercentX+"%"));jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).css("color",CMPUtils.IsNullOrEmpty(v)?"":v.replace("0x","#"));w&&jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).css("background-color","#202020");s>0&&s<100&&jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).css("top",s+"%");jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).css("z-index",1)}else t._fontVariableChange+=parseInt(y),u=n.detail.mediaElementHeight*t._fontVariableChange/300,jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).css("font-size",u),jQuery("#"+t._playerinstanceIdentifier+"_dvTTTDisplayLine"+r).css("line-height",u+"px")};ViewPort.prototype.loadTimer=function(){var n=new Date,i="",r=n.getHours(),u=n.getMinutes();i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][n.getMonth()]+" "+n.getDate()+", "+n.getFullYear();this._waterMarkTimer=setTimeout(function(){t.loadTimer()},6e4)};ViewPort.prototype.clearTimer=function(){t._waterMarkTimer!=undefined&&clearInterval(t._waterMarkTimer)};ViewPort.prototype.showHideGeneticsIcon=function(n){CMPUtils.IsNullOrEmpty(n.detail)||(document.getElementById(t._playerinstanceIdentifier+"_GenericIcon").style.display=n.detail.value?"block":"none")};ViewPort.prototype.showGenericErrorDetail=function(){showErrorDetailsNG("Cannot create markin at last frame",0)};ViewPort.prototype.updatePlayerState=function(n){t._cmpConfiguration.PlayerStateDisplay&&t._cmpConfiguration.PlayerStateDisplay!=null&&t._cmpConfiguration.PlayerStateDisplay.toLowerCase()=="true"&&(n.detail.display?(document.getElementById(t._playerinstanceIdentifier+"_playerStateDisplay").style.display="block",document.getElementById(t._playerinstanceIdentifier+"_playerStateDisplayText").innerHTML=n.detail.message):document.getElementById(t._playerinstanceIdentifier+"_playerStateDisplay").style.display="none")};ViewPort.prototype.showErrorReport=function(n){n.detail.errorCode/1e4!=2&&document.getElementById(t._playerinstanceIdentifier+"_severeErrorOverlay").style.display=="none"&&(n.detail.isSevere?(document.getElementById(t._playerinstanceIdentifier+"_severeErrorOverlay").style.display="",document.getElementById(t._playerinstanceIdentifier+"_errorHead").innerHTML="",document.getElementById(t._playerinstanceIdentifier+"_errorHead").innerHTML+="<span class='errorMessage'>"+n.detail.message+"<br><span class='errorCode'>Error "+n.detail.errorCode+"<\/span><\/span>"):(document.getElementById(t._playerinstanceIdentifier+"_flawDiv").style.display="",document.getElementById(t._playerinstanceIdentifier+"_flawDiv").className="lowSevereError",document.getElementById(t._playerinstanceIdentifier+"_flawName").innerText=n.detail.message,setTimeout(t.hideNonSevereErrorReport,3e3)))};ViewPort.prototype.hideNonSevereErrorReport=function(){document.getElementById(t._playerinstanceIdentifier+"_flawDiv").style.display="none"};ViewPort.prototype.hideErrorReport=function(){document.getElementById(t._playerinstanceIdentifier+"_severeErrorOverlay").style.display="none"};ViewPort.prototype.setFocus=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.SET_FOCUS,{detail:{playerinstanceIdentifier:this._playerinstanceIdentifier}}))};ViewPort.prototype.play=function(){this._loadCount++;this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.HIDE_PLAY_OVERLAY));this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SHOW_PAUSE_OVERLAY));this._cmpConfiguration["VideoPanelConfig.ShowResumePlayBackOverlay"].toLowerCase()!="true"||this._mediaInfo.islastPlayBackTimeEnabled.toString()!="true"||this._mediaInfo.lastPlayBackTime=="0"||t._lastPlaybackTimeReachedMediaEnd!=!1||this._isPaused?this._mediaInfo.islastPlayBackTimeEnabled.toString()!="true"||this._mediaInfo.lastPlayBackTime=="0"||this._cmpConfiguration["VideoPanelConfig.EnablePlayIconOverlayOnPause"].toLowerCase()!="true"||t._lastPlaybackTimeReachedMediaEnd!=!1||this._isPaused?this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.PLAY)):(this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SET_LAST_PLAYBACK_TIME,{detail:{time:this._time}})),this._isPaused=!1):(document.getElementById(this._playerinstanceIdentifier+"_ShowResumePlayBackOverlay").style.display="",document.getElementById(this._playerinstanceIdentifier+"_ShowResumePlayBackOverlay").style.zIndex=2,this._isPaused=!1)};ViewPort.prototype.showNonConformingMediaError=function(n){PFTConfirmNG("NCMDPopup",{overlayClassName:"NCMDOverlay",message:n.detail.message,buttons:["Cancel","Ok"],promptButtonClick:function(t){t=="Ok"&&n.detail.okCallback();t=="Cancel"&&n.detail.closeCallback()}})};u();this._eventDispatcher.addEventListener(ConfigurationEvent.SET_CONFIGURATION,this.setConfiguration);this._eventDispatcher.addEventListener(TransportEvent.HIDE_PLAY_BACK_OVERLAY,this.hidePlayBackOverLay);this._eventDispatcher.addEventListener(TransportEvent.SHOW_PLAY_OVERLAY,this.playOverlay);this._eventDispatcher.addEventListener(TransportEvent.HIDE_PLAY_OVERLAY,this.hidePlayOverLay);this._eventDispatcher.addEventListener(TransportEvent.SHOW_PAUSE_OVERLAY,this.showPauseOverlay);this._eventDispatcher.addEventListener(TransportEvent.HIDE_PAUSE_OVERLAY,this.hidePauseOverlay);this._eventDispatcher.addEventListener(TransportEvent.PLAY_SUCCESS,this.updateOnPlay);this._eventDispatcher.addEventListener(ErrorEvent.SHOW_FLASH_PLUGIN_LOAD_ERROR_MESSAGE,this.showFlashPluginErrorMessage);this._eventDispatcher.addEventListener(CMPEvent.STATE_CHANGE_EVENT,this.onStateChangeEvent);this._eventDispatcher.addEventListener(ErrorEvent.SHOW_ERROR_MESSAGE,this.showAlertMsg);this._eventDispatcher.addEventListener(ErrorEvent.HIDE_ERROR_MESSAGE,this.hideAlertMsg);this._eventDispatcher.addEventListener(ErrorEvent.SHOW_CONFIRM_ALERT_MESSAGE,this.showConfirmAlertMsg);this._eventDispatcher.addEventListener(ErrorEvent.HIDE_CONFIRM_ALERT_MESSAGE,this.hideConfirmAlertMsg);this._eventDispatcher.addEventListener(SequenceEvent.SHOW_CONFIRM_ALERT_MESSAGE,this.showConfirmAlertMsg);this._eventDispatcher.addEventListener(SequenceEvent.HIDE_CONFIRM_ALERT_MESSAGE,this.hideConfirmAlertMsg);this._eventDispatcher.addEventListener(SequenceEvent.SHOW_SEGMENT_POPUP,this.showSegmentSavePopup);this._eventDispatcher.addEventListener(SequenceEvent.HIDE_SEGMENT_POPUP,this.hideSegmentSavePopup);this._eventDispatcher.addEventListener(SeekBarEvent.LOAD_SEEKBAR,this.updateMediaInfo);this._eventDispatcher.addEventListener(SequenceEvent.SHOW_SEGMENTS_PANEL,this.showSegments);this._eventDispatcher.addEventListener(SequenceEvent.HIDE_EXPORT_POUP,this.fnHideExportWizardPopup);this._eventDispatcher.addEventListener(LayoutEvent.INITIALISE_WATERMARKING,this.fnInitialiseWatermarking);this._eventDispatcher.addEventListener(LayoutEvent.ASSIGN_STYLE_FOR_WATERMARKING,this.fnAssignStyleForWatermarking);this._eventDispatcher.addEventListener(LayoutEvent.ASSIGN_STYLE_FOR_DISPLAY_TIMED_TEXT,this.fnAssignStyleForDisplayTimedText);this._eventDispatcher.addEventListener(TimerEvent.CLEAR_TIMER,this.clearTimer);this._eventDispatcher.addEventListener(TransportEvent.NON_AV_BUFFERING,this.nonAvBuffering);this._eventDispatcher.addEventListener(TransportEvent.NON_AV_BUFFERING_SUCCESS,this.nonAvBufferingSuccess);this._eventDispatcher.addEventListener(UIEvent.SHOW_HIDE_GENERICS_ICON,this.showHideGeneticsIcon);this._eventDispatcher.addEventListener(ErrorEvent.SHOW_Generic_ERROR_MESSAGE,this.showGenericErrorDetail);this._eventDispatcher.addEventListener(UIEvent.UPDATE_PLAYER_STATE,this.updatePlayerState);this._eventDispatcher.addEventListener(ErrorEvent.SHOW_ERROR_REPORT,this.showErrorReport);this._eventDispatcher.addEventListener(ErrorEvent.HIDE_ERROR_REPORT,this.hideErrorReport);this._eventDispatcher.addEventListener(ErrorEvent.NON_CONFORMING_MEDIA_DETECTED,this.showNonConformingMediaError)}function TagPointerManager(n,t){this._stateMachine=n.getInstance("stateMachine");this._cmpModel=n.getInstance("cmpModel");this._instanceId=t;this._eventDispatcher=document.getElementById(this._instanceId);this._nativeApi=n.getInstance("nativeApi");var i=this;TagPointerManager.prototype.addMarkerInBulk=function(n){var r=JSON.parse(n.detail.markerCanvasJson),t=0;r.forEach(function(n){t==0?new MarkerManager(i._cmpModel).createMarkerLayer(n.SequenceNo,n.Name,!0):new MarkerManager(i._cmpModel).createMarkerLayer(n.SequenceNo,n.Name,!1);n.MarkerTagInstance.length>0&&(n.MarkerTagInstance.forEach(function(t){var e=i._cmpModel.mediaInfo.som,r=i._cmpModel.mediaInfo.frameRate,u=i._cmpModel.mediaInfo.timecodeDisplayFormat,f=CMPUtils.ConvertTimeCodeToMilliseconds(e,r,u),o=CMPUtils.ConvertTimeCodeToMilliseconds(t.TcIn,r,u)-f,s=CMPUtils.ConvertTimeCodeToMilliseconds(t.TcOut,r,u)-f;new MarkerManager(i._cmpModel).createMarker(o,s,t.Comments,t.ObjId,t.Name,n.SequenceNo,n.Name)}),t++)});i._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.RENDER_MARKERCANVAS,{detail:{markerCanvasJson:n.detail.markerCanvasJson}}))};TagPointerManager.prototype.updateMarker=function(n){var t=n.detail.markerCanvasJson,f=t.objId,r,s,h;if(n.detail.isDelete)new MarkerManager(i._cmpModel).removeMarker(f),i._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.UPDATE_MARKERCANVAS,{detail:{markerCanvasJson:n.detail.markerCanvasJson,isDelete:n.detail.isDelete}}));else{var l=i._cmpModel.mediaInfo.som,e=i._cmpModel.mediaInfo.frameRate,o=i._cmpModel.mediaInfo.timecodeDisplayFormat,c=CMPUtils.ConvertTimeCodeToMilliseconds(l,e,o),u=t.tcIn;CMPUtils.IsNullOrEmpty(u)||(u=CMPUtils.ConvertTimeCodeToMilliseconds(u,e,o)-c);r=t.tcOut;CMPUtils.IsNullOrEmpty(r)||(r=CMPUtils.ConvertTimeCodeToMilliseconds(r,e,o)-c);s=t.comments;h=!1;h?(new MarkerManager(i._cmpModel).updateMarker(u,r,s,f,t.tagName),i._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.UPDATE_MARKERCANVAS,{detail:{markerCanvasJson:n.detail.markerCanvasJson,isDelete:n.detail.isDelete}}))):h||(new MarkerManager(i._cmpModel).createMarker(u,r,s,f,t.tagName,null,t.strataName),i._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.UPDATE_MARKERCANVAS,{detail:{markerCanvasJson:n.detail.markerCanvasJson,isDelete:n.detail.isDelete}})))}};TagPointerManager.prototype.RenderMarkerCanvasOnPlayer=function(){var s=i._cmpModel.playerInfo.CMPConfig.CMPConfigValue.markerCanvasJson,t=document.getElementById(i._instanceId+"_markerRibbonPlaceholder"),r,n,u,f,e,o,h;t&&(t.innerHTML="",t.style.display="",document.getElementById(i._instanceId+"_btnSettings").style.display="block",document.getElementById(i._instanceId+"_settingsMenu")&&(document.getElementById(i._instanceId+"_settingsMenu").className+=" catalogV2SettingsMenu"));r=document.getElementById(i._instanceId+"_MarkerCanvasSelectorList");r&&(r.innerHTML="");n=document.createElement("table");n.className="markerSelectorListTable";n.id="markerSelectorListTable";u=document.createElement("tbody");u.id="markerSelectorListTbody";f=0;e=JSON.parse(s);e.forEach(function(n){var r,e,v,o,a,c,w,l,h,b,k,s,y,p;n.MarkerTagInstance.length>0&&(document.getElementById(i._instanceId+"_markerRibbonPlaceholder")&&(r=n.ObjectClass.replace(/\s/g,"_"),e=document.createElement("table"),e.id=r+"_Filter",e.className="markerFilterListTable",e.setAttribute("style","display:none;"),v=document.createElement("tbody"),v.id=r+"_markerFilterListTableTbody",o=document.createElement("tr"),a=document.createElement("td"),o.id=r+"_markerFilterListTableTr",c=document.createElement("div"),c.id=r+"_markerRibbon",c.className=n.CssClassName,c.setAttribute("title",n.Tooltip),n.MarkerTagInstance.forEach(function(t){var u=document.createElement("span"),s,h,l,e,f;for(u.className=t.CssClassName,u.setAttribute("style",""),u.setAttribute("dir",t.Name),u.setAttribute("ONMOUSEOVER",""),u.onclick=function(){i.onMarkerTagClick(t.TcIn,t.TcOut,t.ObjId,n.ObjectClass)},u.onmouseout=function(){i.fnHideMarkerPlayer()},s="",t.Comments!=null&&(s=t.Comments),u.setAttribute("lang",""+t.TcIn+"|"+t.TcOut+"|"+s+""),u.setAttribute("id",t.ObjId),c.appendChild(u),h=!1,l=o.getElementsByTagName("div"),e=0;e<l.length;e++)if(l[e].getAttribute("name")==t.CssClassName){h=!0;break}h||(f=document.createElement("div"),f.className=t.CssClassName,f.setAttribute("name",t.CssClassName),f.onclick=function(){i.SelectYourFilter(r+"_markerRibbon",t.CssClassName)},f.setAttribute("title",t.Name),f.className+=" markerFilter",a.appendChild(f),o.appendChild(a))}),t.appendChild(c),w=o.getElementsByTagName("div"),w.length>1?(l=document.createElement("div"),l.className="ResetFilter",l.onclick=function(){i.ResetYourFilter(r+"_markerRibbon")},l.setAttribute("title","Reset your filter"),l.className+=" markerFilter",a.appendChild(l),o.appendChild(a)):w.length==1&&o.getElementsByClassName("MarkerTag").length>0&&(o.getElementsByClassName("MarkerTag")[0].style.display="none"),v.appendChild(o),e.appendChild(v),h=document.createElement("tr"),h.setAttribute("colspan","3"),h.id=r+"_markerSelector",b=document.createElement("td"),k=document.createElement("div"),k.id=r+"_markerSelected",b.appendChild(k),h.appendChild(b),s=document.createElement("td"),s.onclick=function(){i.SelectYourMarkerCanvas(r+"_markerRibbon",r+"_markerSelector",r+"_markerSelected")},s.onmouseover=function(){i.MarkerCanvasSelectorMOver(r+"_markerSelector")},s.onmouseout=function(){i.MarkerCanvasSelectorMOut(r+"_markerSelector",r+"_markerSelected")},s.textContent=n.SelectorAcronym,s.className+="markerSelectorName",f==0&&(s.className+=" currentMarkerSelector"),s.setAttribute("Name","MarkerSelectorDispName"),h.appendChild(s),y=document.createElement("td"),y.className="tdSelectorFilterList",y.appendChild(e),h.appendChild(y),u.appendChild(h),p=document.getElementById(r+"_markerRibbon"),f==0?(jQuery(p).addClass("markerCanvasSlider"),p.style.display="none"):jQuery(p).addClass("markerCanvasSliderHide"),e.getElementsByTagName("tbody")[0].getElementsByTagName("tr")[0].getElementsByTagName("div").length>=1?e.setAttribute("style","display:;"):e.setAttribute("style","display:none;")),f++)});n.appendChild(u);r.appendChild(n);document.getElementById(i._instanceId+"_MarkerCanvasSelectorList")&&(o=document.getElementById(i._instanceId+"_MarkerCanvasSelectorList"),h=document.getElementById(i._instanceId+"_MarkerCanvasRow"),document.getElementById(i._instanceId+"_MarkerCanvasRow").style.display=o.getElementsByTagName("table")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr").length>0?"":"none")};TagPointerManager.prototype.fnSetMarkerPosition=function(){var r,u,h,f,t,e,n,l;if(i._cmpModel!=null&&i._cmpModel.mediaDuration>0&&(i.CheckSelectorList(),r=document.getElementById(i._instanceId+"_markerRibbonPlaceholder"),r!=null))for(u=r.getElementsByClassName("markerCanvasSlider"),u&&u.length>0&&(u[0].style.display=""),h=r.getElementsByTagName("div"),f=0;f<h.length;f++)for(t=h[f].getElementsByTagName("span"),e=0,n=0;n<t.length;n++){var o=t[n].getAttribute("STYLE"),s=t[n].getAttribute("lang").split("|"),c=0;s.length>2?c=s[0]:s.length==1&&(c=s[0]);e=i.CalculatePositionWithStarTimeCode(c);o==null?o="left:"+e+"%;":o+="left:"+e+"%;";t[n].setAttribute("STYLE",o);l=t[n].getAttribute("ONMOUSEOVER");l==""&&(t[n].onmouseover=function(n){i.fnShowMarkerPlayer(n)})}};TagPointerManager.prototype.CalculatePositionWithStarTimeCode=function(n){var u=i._cmpModel.mediaInfo.som,t=i._cmpModel.mediaInfo.frameRate,r=i._cmpModel.mediaInfo.timecodeDisplayFormat,f=CMPUtils.ConvertTimeCodeToMilliseconds(u,t,r),e=CMPUtils.ConvertTimeCodeToMilliseconds(n,t,r)-f;return pos=CMPUtils.CalculatePercentage(e/1e3,i._cmpModel.mediaDuration)};TagPointerManager.prototype.updateMarkerCanvas=function(n){var t=n.detail.markerCanvasJson,y=n.detail.isDelete,c=document.getElementById(i._instanceId+"_markerRibbonPlaceholder"),r,h,s,f,o,u,v;if(c!=null){var a=t.objectClass.replace(/\s/g,"_"),e=null,l=c.getElementsByTagName("div");for(u=0;u<l.length;u++)if(l[u].id==a+"_markerRibbon"){e=l[u];break}if(y){if(e){for(f=null,o=e.getElementsByTagName("span"),u=0;u<o.length;u++)if(o[u].id==t.objId){f=o[u];break}f!=null&&(v=f.getAttribute("class"),e.removeChild(f),i.UpdateSelectorAndFilter(t,v))}}else if(r=document.createElement("span"),r.setAttribute("id",t.objId),r.className=t.tagName!=""&&t.tagName!=null?t.tagName:"MarkerTag",r.setAttribute("dir",t.tagName),r.setAttribute("ONMOUSEOVER",""),r.onmouseout=function(){i.fnHideMarkerPlayer()},pos=i.CalculatePositionWithStarTimeCode(t.tcIn),r.setAttribute("style","left:"+pos+"%;"),h=r.getAttribute("ONMOUSEOVER"),e){for(f=null,o=e.getElementsByTagName("span"),u=0;u<o.length;u++)if(o[u].id==t.objId){f=o[u];break}f!=null?(t.tcIn==""&&(t.tcIn=f.getAttribute("lang").split("|")[0]),t.tcOut==""&&(t.tcOut=f.getAttribute("lang").split("|")[1]),t.comments==""&&(t.comments=f.getAttribute("lang").split("|")[2]),r.className=f.className,r.onclick=function(){i.onMarkerTagClick(t.tcIn,t.tcOut,t.objId,t.objectClass)},r.setAttribute("lang",""+t.tcIn+"|"+t.tcOut+"|"+t.comments+""),h==""&&(r.onmouseover=function(){i.fnShowMarkerPlayer(event)}),e.removeChild(f),e.appendChild(r)):(r.onclick=function(){i.onMarkerTagClickonMarkerTagClick(t.tcIn,t.tcOut,t.objId,t.objectClass)},r.setAttribute("lang",""+t.tcIn+"|"+t.tcOut+"|"+t.comments+""),h==""&&(r.onmouseover=function(){i.fnShowMarkerPlayer(event)}),e.appendChild(r),i.BindSelectorAndFilter(t,r))}else s=document.createElement("div"),s.id=a+"_markerRibbon",s.className="markerCanvasSliderHide",s.setAttribute("title",t.strataName),c.appendChild(s),r.onclick=function(){i.onMarkerTagClick(t.tcIn,t.tcOut,t.objId,t.objectClass)},r.setAttribute("lang",""+t.tcIn+"|"+t.tcOut+"|"+t.comments+""),h==""&&(r.onmouseover=function(){i.fnShowMarkerPlayer(event)}),s.appendChild(r),i.BindSelectorAndFilter(t,r)}};TagPointerManager.prototype.updateMarkerCanvasComment=function(n){var t=n.detail.markerCanvasJson,v=n.detail.isDelete,h=document.getElementById(i._instanceId+"_markerRibbonPlaceholder"),r,f,u;if(h!=null){var l=t.objectClass.replace(/\s/g,"_"),e=null,o=h.getElementsByTagName("div");for(u=0;u<o.length;u++)if(o[u].id==l+"_markerRibbon"){e=o[u];break}if(e){for(r=null,f=e.getElementsByTagName("span"),u=0;u<f.length;u++)if(f[u].id==t.objId){r=f[u];break}if(r!=null){t.tcIn=r.getAttribute("lang").split("|")[0];t.tcOut=r.getAttribute("lang").split("|")[1];r.className=t.tagName!=null&&t.tagName!=""?t.tagName:"MarkerTag";var c=r.getAttribute("ONMOUSEOVER"),a=r.getAttribute("ONCLICK"),s=r.getAttribute("lang");c="";a="";s="";r.onclick=function(){i.onMarkerTagClick(t.tcIn,t.tcOut,t.objId,t.objectClass)};c==""&&(f.onmouseover=function(){i.fnShowMarkerPlayer(event)});s+=t.tcIn+"|"+t.tcOut+"|"+t.comments;r.setAttribute("lang",s);i.BindSelectorAndFilter(t,r)}}}};TagPointerManager.prototype.BindSelectorAndFilter=function(n){var t=n.objectClass,s,c,f,l,r,d=document.getElementById(this._instanceId+"_MarkerCanvasSelectorList"),g=document.getElementById("markerSelectorListTable"),v,a,h,u,o,y,p,e,w,k,b;for(g?(s=document.getElementById("markerSelectorListTable"),c=document.getElementById("markerSelectorListTbody")):(s=document.createElement("table"),s.className="markerSelectorListTable",s.id="markerSelectorListTable",c=document.createElement("tbody"),c.id="markerSelectorListTbody",s.appendChild(c)),jQuery("#markerSelectorListTable tbody tr td #"+t+"_Filter").length==0?(f=document.createElement("table"),f.id=t+"_Filter",f.className="markerFilterListTable",f.setAttribute("style","display:none;"),l=document.createElement("tbody"),l.id=t+"_markerFilterListTableTbody",r=document.createElement("tr"),r.id=t+"_markerFilterListTableTr"):(r=document.getElementById(t+"_markerFilterListTableTr"),l=document.getElementById(t+"_markerFilterListTableTbody"),f=document.getElementById(t+"_Filter")),v=!1,h=r.getElementsByTagName("div"),a=0;a<h.length;a++)if(h[a].getAttribute("name")==n.tagName){v=!0;break}v||(u=document.createElement("div"),u.className=n.tagName,u.setAttribute("name",n.tagName),u.onclick=function(){i.SelectYourFilter(t+"_markerRibbon",n.tagName)},u.setAttribute("title",n.tagName),u.className+=" markerFilter",r.appendChild(u));h=r.getElementsByTagName("div");h.length>1&&r.getElementsByClassName("ResetFilter").length==0?(u=document.createElement("div"),u.className="ResetFilter",u.onclick=function(){i.ResetYourFilter(t+"_markerRibbon")},u.setAttribute("title","Reset your filter"),u.className+=" markerFilter",r.appendChild(u),f.setAttribute("style","display:block;"),r.getElementsByClassName("MarkerTag").length>0&&(r.getElementsByClassName("MarkerTag")[0].style.display="block")):h.length==1&&r.getElementsByClassName("MarkerTag").length>0&&(r.getElementsByClassName("MarkerTag")[0].style.display="none");l.appendChild(r);f.appendChild(l);jQuery("#markerSelectorListTable tbody tr:#"+t+"_markerSelector").length==0&&(o=document.createElement("tr"),o.setAttribute("colspan","3"),o.id=t+"_markerSelector",y=document.createElement("td"),p=document.createElement("div"),p.id=t+"_markerSelected",y.appendChild(p),o.appendChild(y),e=document.createElement("td"),e.textContent=n.strataName,e.onclick=function(){i.SelectYourMarkerCanvas(t+"_markerRibbon",t+"_markerSelector",t+"_markerSelected")},e.onmouseover=function(){i.MarkerCanvasSelectorMOver(t+"_markerSelector")},e.onmouseout=function(){i.MarkerCanvasSelectorMOut(t+"_markerSelector",t+"_markerSelected")},e.className+="markerSelectorName",e.setAttribute("Name","MarkerSelectorDispName"),o.appendChild(e),w=document.createElement("td"),w.appendChild(f),o.appendChild(w),c.appendChild(o),d.appendChild(s));document.getElementById(i._instanceId+"_MarkerCanvasSelectorList")&&(k=document.getElementById(i._instanceId+"_MarkerCanvasSelectorList"),b=document.getElementById(i._instanceId+"_MarkerCanvasRow"),k.getElementsByTagName("table")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr").length>0?this.fnShowAttribute(b):this.fnHideAttribute(b))};TagPointerManager.prototype.UpdateSelectorAndFilter=function(n,t){for(var k,s,d,a,c,g,o,u,y,l,f=n.objectClass,p,w,r,b=document.getElementById(this._instanceId+"_markerRibbonPlaceholder"),f=n.objectClass.replace(/\s/g,"_"),e=null,h=b.getElementsByTagName("div"),i=0;i<h.length;i++)if(h[i].id==f+"_markerRibbon"){e=h[i];break}if(e){if(k=null,s=e.getElementsByTagName("span"),s.length==0)e.remove(),d=document.getElementById(this._instanceId+"_MarkerCanvasSelectorList"),a=document.getElementById("markerSelectorListTable"),a&&(c=jQuery("#markerSelectorListTable tbody tr:#"+f+"_markerSelector"),c&&c.remove());else{var k=null,v=!1,s=e.getElementsByTagName("span");for(i=0;i<s.length;i++)if(s[i].className==t){v=!0;break}if(!v){for(p=document.getElementById(f+"_Filter"),w=document.getElementById(f+"_markerFilterListTableTbody"),r=document.getElementById(f+"_markerFilterListTableTr"),g=!1,u=r.getElementsByTagName("div"),o=0;o<u.length;o++)if(u[o].className==t){u[o].remove();break}u=r.getElementsByTagName("div");(u.length==1||u.length==2)&&(r.getElementsByClassName("MarkerTag").length>0&&(r.getElementsByClassName("MarkerTag")[0].style.display="none"),r.getElementsByClassName("ResetFilter").length>0&&(r.getElementsByClassName("ResetFilter")[0].style.display="none"))}}document.getElementById(this._instanceId+"_MarkerCanvasSelectorList")&&(y=document.getElementById(this._instanceId+"_MarkerCanvasSelectorList"),l=document.getElementById(this._instanceId+"_MarkerCanvasRow"),y.getElementsByTagName("table")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr").length>0?this.fnShowAttribute(l):this.fnHideAttribute(l))}};TagPointerManager.prototype.CheckSelectorList=function(){if(document.getElementById(this._instanceId+"_MarkerCanvasSelectorList")){var t=document.getElementById(this._instanceId+"_MarkerCanvasSelectorList"),n=document.getElementById(this._instanceId+"_MarkerCanvasRow");t.getElementsByTagName("table").length>0?t.getElementsByTagName("table")[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr").length>0?this.fnShowAttribute(n):this.fnHideAttribute(n):this.fnHideAttribute(n)}};TagPointerManager.prototype.MarkerCanvasSelect=function(){};TagPointerManager.prototype.fnShowMarkerPlayer=function(n){try{var t=i.SplitMarkerInfoFromAttribute(n.currentTarget.lang);markerTagTcIn=t[0];markerTagTcOut=t[1];annotationComments=t[2];_event=n;document.getElementById(i._instanceId+"_vidHvr").style.display="";document.getElementById(i._instanceId+"_vidHvr").style.top=_event.clientY-106+"px";document.getElementById(i._instanceId+"_vidHvr").style.left=parseInt(_event.currentTarget.style.left)>=80?_event.clientX-140+"px":parseInt(_event.currentTarget.style.left)<=20?_event.clientX+"px":_event.clientX-70+"px";annotationComments!=null&&annotationComments!=""&&(annotationComments=unescape(annotationComments),annotationComments.length>150&&(annotationComments=annotationComments.substring(0,150)+" ..."),document.getElementById(i._instanceId+"_vidMarkerCanvasAnnotation").innerHTML="<div class='annotationCommentsInPreview'>"+annotationComments+"<\/div>",document.getElementById(i._instanceId+"_vidMarkerCanvasAnnotation").style.display="")}catch(r){throw r;}};TagPointerManager.prototype.SplitMarkerInfoFromAttribute=function(n){var t=n.split("|"),r=0,e=0,i="";t.length>2?(r=t[0],e=t[1],i=t[2],i=escape(i)):t.length==1&&(r=t[0]);var s=this._cmpModel.mediaInfo.som,u=this._cmpModel.mediaInfo.frameRate,f=this._cmpModel.mediaInfo.timecodeDisplayFormat,o=CMPUtils.ConvertTimeCodeToMilliseconds(s,u,f),h=CMPUtils.ConvertTimeCodeToMilliseconds(r,u,f)-o,c=CMPUtils.ConvertTimeCodeToMilliseconds(e,u,f)-o;return[h,c,i]};TagPointerManager.prototype.fnHideMarkerPlayer=function(){var n=document.getElementById(this._instanceId+"_vidHvr");n!=null&&(document.getElementById(this._instanceId+"_vidMarkerCanvasAnnotation").style.display="none",document.getElementById(this._instanceId+"_vidHvr").style.display="none")};TagPointerManager.prototype.SelectYourMarkerCanvas=function(n,t,i){this.ReSetMarkerTags(n);var i=document.getElementById(i),t=document.getElementById(t);jQuery(".currentMarkerSelector").toggleClass("currentMarkerSelector");jQuery(t.getElementsByClassName("markerSelectorName")).toggleClass("currentMarkerSelector")};TagPointerManager.prototype.ReSetMarkerTags=function(n){var t,r,i;if(jQuery("#"+this._instanceId+"_markerRibbonPlaceholder div").removeClass("markerCanvasSlider"),jQuery("#"+this._instanceId+"_markerRibbonPlaceholder div").addClass("markerCanvasSliderHide"),t=document.getElementById(n),t!=null)for(r=t.getElementsByTagName("span"),jQuery(t).removeClass("markerCanvasSliderHide"),jQuery(t).addClass("markerCanvasSlider"),i=0;i<r.length;i++)r[i].style.display=""};TagPointerManager.prototype.onMarkerTagClick=function(n){this.PlayMainPlayerWithTcIn(n)};TagPointerManager.prototype.PlayMainPlayerWithTcIn=function(n){var r=this._cmpModel.mediaInfo.som,t=this._cmpModel.mediaInfo.frameRate,i=this._cmpModel.mediaInfo.timecodeDisplayFormat,u=CMPUtils.ConvertTimeCodeToMilliseconds(r,t,i),f=CMPUtils.ConvertTimeCodeToMilliseconds(n,t,i)-u;this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.SEEK,{detail:{positionInMsec:f}}))};TagPointerManager.prototype.SelectYourFilter=function(n,t){var e=n.id.split("_markerRibbon"),o=e[0]+"_markerSelector",s=e[0]+"_markerSelected",u,r,i,f;if(this.SelectYourMarkerCanvas(n,document.getElementById(o),document.getElementById(s)),u=document.getElementById(n.id),u!=null){for(jQuery(".markerFilterListTable tr div").removeClass("selectedTagFilter"),r=u.getElementsByTagName("span"),i=0;i<r.length;i++)f=r[i].getAttribute("class"),f!=null&&(r[i].style.display=f!=t?"none":"");jQuery(".markerFilterListTable tr div").addClass(function(n,i){var r;return i==t&&(r="selectedTagFilter"),r})}};TagPointerManager.prototype.MarkerCanvasSelectorMOver=function(){};TagPointerManager.prototype.MarkerCanvasSelectorMOut=function(){};TagPointerManager.prototype.ResetYourFilter=function(n){var r=document.getElementById(n.id),i,t;if(r!=null)for(i=r.getElementsByTagName("span"),t=0;t<i.length;t++)i[t].style.display="";jQuery(".markerFilterListTable tr div").removeClass("selectedTagFilter")};TagPointerManager.prototype.SelectYourMarker=function(n){i.ReSetMarkerCanvasTags(n.detail.MarkerCanvasName);var r=document.getElementById(n.detail.MarkerCanvasSelectedDiv),t=document.getElementById(n.detail.MarkerCanvasSelectedRow);jQuery(".currentMarkerSelector").toggleClass("currentMarkerSelector");CMPUtils.IsNullOrEmpty(t)||jQuery(t.getElementsByClassName("markerSelectorName")).toggleClass("currentMarkerSelector")};TagPointerManager.prototype.ReSetMarkerCanvasTags=function(n){var t,u,r;if(jQuery("#"+this._instanceId+"_markerRibbonPlaceholder div").removeClass("markerCanvasSlider"),jQuery("#"+this._instanceId+"_markerRibbonPlaceholder div").addClass("markerCanvasSliderHide"),t=document.getElementById(n),t!=null)for(u=t.getElementsByTagName("span"),new MarkerManager(i._cmpModel).changeCurrentMarkerLayerByName(t.title),jQuery(t).removeClass("markerCanvasSliderHide"),jQuery(t).addClass("markerCanvasSlider"),r=0;r<u.length;r++)u[r].style.display=""};TagPointerManager.prototype.selectMarkerCanvas=function(n){var r=n.detail.selectedMarkerCanvasName,t=r.replace(/\s/g,"_"),u=t+"_markerRibbon",f=t+"_markerSelector",e=t+"_markerSelected",i=getCMPInstanceByInstanceId(activePlayerInstance);i!=null&&new CLEARMediaPlayerAPI(i._instanceId).SelectYourMarker(u,f,e)};TagPointerManager.prototype.fnHideAttribute=function(n){n&&(n.style.display="none")};TagPointerManager.prototype.fnShowAttribute=function(n){n&&(n.style.display="")};jQuery("#"+i._instanceId+"_MarkerCanvasSelector").click(function(){i.MarkerCanvasSelect()});this._eventDispatcher.addEventListener(MarkerEvent.RENDER_MARKERCANVAS,this.RenderMarkerCanvasOnPlayer);this._eventDispatcher.addEventListener(MarkerEvent.Set_MarkerPosition,this.fnSetMarkerPosition);this._eventDispatcher.addEventListener(MarkerEvent.UPDATE_MARKERCANVAS,this.updateMarkerCanvas);this._eventDispatcher.addEventListener(MarkerEvent.UPDATE_MARKERCANVASCOMMENT,this.updateMarkerCanvasComment);this._eventDispatcher.addEventListener(MarkerEvent.FILTER_MARKERCANVAS,this.SelectYourMarker);this._eventDispatcher.addEventListener(MarkerEvent.ADD_MARKERVALUES,this.addMarkerInBulk);this._eventDispatcher.addEventListener(MarkerEvent.UPDATE_MARKERVALUES,this.updateMarker);this._eventDispatcher.addEventListener(MarkerEvent.SELECT_MARKER_CANVAS,this.selectMarkerCanvas)}function hideMarkerCanvasCallOutScreen(){}function RegisterMarkerCanvasEventListners(){}function AnnotationHandler(n,t){this._stateMachine=n.getInstance("stateMachine");this._cmpModel=n.getInstance("cmpModel");this._instanceId=t;this._nativeApi=n.getInstance("nativeApi");this._eventDispatcher=document.getElementById(t);this._annotationManager=new AnnotationManager(this._stateMachine,this._cmpModel,this._nativeApi,this._instanceId);var i=this;AnnotationHandler.prototype.onShowAnnotation=function(n){i._annotationManager.onShowAnnotation(n.detail.marker)};AnnotationHandler.prototype.onHideAnnotation=function(n){i._annotationManager.onHideAnnotation(n.detail.marker)};AnnotationHandler.prototype.saveAnnotation=function(n){i._annotationManager.saveAnnotation(n.detail.annotationMessage)};AnnotationHandler.prototype.editAnnotation=function(n){var t=n.detail.startTimeCode/1e3,r=n.detail.endTimeCode/1e3;i._annotationManager.editAnnotation(t,r,n.detail.message)};AnnotationHandler.prototype.removeAnnotation=function(n){var t=n.detail.startTimeCode/1e3,r=n.detail.endTimeCode/1e3;i._annotationManager.removeAnnotation(t,r)};AnnotationHandler.prototype.fineTuneSave=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:AnnotationEvent.FINETUNE_SAVE}}))};AnnotationHandler.prototype.resetAnnotationTimelineMetadata=function(){i._annotationManager.resetAnnotationTimelineMetadata()};AnnotationHandler.prototype.enableMarkerEditMode=function(){i._annotationManager.enableMarkerEditMode()};AnnotationHandler.prototype.setMarkInPosition=function(n){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:AnnotationEvent.SET_MARK_IN_POSITION,markInTime:n.detail.markInTime,markOutTime:n.detail.markOutTime}}))};AnnotationHandler.prototype.setMarkOutPosition=function(n){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:AnnotationEvent.SET_MARK_OUT_POSITION,markInTime:n.detail.markInTime,markOutTime:n.detail.markOutTime}}))};AnnotationHandler.prototype.seekToAccumulatedTimeOnFrameSeek=function(){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:AnnotationEvent.SEEK_TO_ACCUMULATED_TIME_ON_FRAME_SEEK}}))};AnnotationHandler.prototype.setPlayerEditMode=function(){i._annotationManager.setPlayerEditMode()};AnnotationHandler.prototype.createScte35Segment=function(n){i._annotationManager.createScte35Segment(n)}}function MediaHandler(n,t){var r=n.getInstance("cmpModel"),i;this._nativeApi=n.getInstance("nativeApi");this._eventDispatcher=document.getElementById(t);this._audioManager=n.getInstance("audioManager");this._loadTimeManager=n.getInstance("loadTimeManager");this._stateMachine=n.getInstance("stateMachine");this._mediaManager=n.getInstance("mediaManager");i=this;MediaHandler.prototype.switchAudioTracks=function(n){var t=n.detail.index;i._audioManager.switchAudioTracks(t)};MediaHandler.prototype.setVolume=function(n){i._audioManager.setVolume(n.detail.volume)};MediaHandler.prototype.muteVolume=function(){i._audioManager.muteVolume()};MediaHandler.prototype.unMuteVolume=function(){i._audioManager.unMuteVolume()};MediaHandler.prototype.setMediaResource=function(n){i._loadTimeManager.setMediaResource(n.detail.url,n.detail.autoPlay)};MediaHandler.prototype.removeMediaSource=function(){i._loadTimeManager.removeMediaSource()};MediaHandler.prototype.setCmpState=function(n){i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UIEvent,{detail:{type:CMPEvent.SET_CMP_STATE_EVENT,newState:n.detail.newState}}))};MediaHandler.prototype.getMediaInfo=function(){i._mediaManager.getMediaInfo()};MediaHandler.prototype.hideMediaInfo=function(){i._mediaManager.hideMediaInfo()};MediaHandler.prototype.resetFullyWatchedMedia=function(){r.isMediaFullyWatched==!0&&(r.isMediaFullyWatched=!1)};MediaHandler.prototype.addEmbeddedAudioTracks=function(n){i._audioManager.addEmbeddedAudioTracks(n.detail.embeddedaudioTracks)}}function SequenceHandler(n,t){this._stateMachine=n.getInstance("stateMachine");this._cmpModel=n.getInstance("cmpModel");this._instanceId=t;this._nativeApi=n.getInstance("nativeApi");this._eventDispatcher=document.getElementById(t);this._sequenceManager=n.getInstance("sequenceManager");this._arrDownloadQueue=[];var i=this;SequenceHandler.prototype.buildSegmentSavePopup=function(n){var r=i._cmpModel.currentClipOrderId,t=CMPUtils.getClipObjectWithClipUiId(r,i._cmpModel.ceProject.bin.clips,i._cmpModel.sequenceClipInfo),u=t.title;i._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SHOW_SEGMENT_POPUP,{detail:{segmentStartTimeInSecs:n.detail.segmentStartTimeInSecs,segmentEndTimeInSecs:n.detail.segmentEndTimeInSecs,segmentStartTimeTCWithSOM:n.detail.segmentStartTimeTCWithSOM,segmentEndTimeTCWithSOM:n.detail.segmentEndTimeTCWithSOM,segmentClipTitle:t.title,segmentCurrentClipObjectDetails:t}}))};SequenceHandler.prototype.createSegmentForSequence=function(n){var r,u;i._eventDispatcher.dispatchEvent(new CustomEvent(TimelineEvent.TIMELINE_EDITED));r=i._cmpModel.currentClipOrderId;n.detail.editSegmentClipOrderId!=null&&(r=n.detail.editSegmentClipOrderId);var o=CMPUtils.getClipObjectWithClipUiId(r,i._cmpModel.ceProject.bin.clips,i._cmpModel.sequenceClipInfo),f=i._cmpModel.ceProject.sequence,e=!1,t=null;if(n.detail.currentSegmentUid!=null?(t=CMPUtils.getSegmentForSegmentUidFromSequence(f,n.detail.currentSegmentUid),e=!1):(t=new Segment,t.uiId=CMPUtils.generateRandomGuidId(),e=!0),t.startTime=CMPUtils.ConvertTimeCodeToSecs(n.detail.segmentStartTimeInSecs,o.frameRate,i._cmpModel.mediaInfo.timecodeDisplayFormat),t.endTime=CMPUtils.ConvertTimeCodeToSecs(n.detail.segmentEndTimeInSecs,o.frameRate,i._cmpModel.mediaInfo.timecodeDisplayFormat),t.editType=n.detail.segmentEditType,t.trackType=n.detail.segmentTrackType,t.comments=n.detail.segmentComments,t.title=n.detail.segmentTitle,t.thumbnailUrl=o.thumbnailUrl,t.clipOrderId=r,t.implictSegment=!1,i.removeImplictSegment(r),e)i._cmpModel.ceProject.sequence.segments.push(t);else for(u=0;u<f.segments.length;u++)if(f.segments[u].uiId===n.detail.currentSegmentUid){f.segments[u]=t;break}CMPUtils.setSegmentPosition(i._cmpModel.ceProject.sequence.segments,i._cmpModel.ceProject.bin.clips,i._cmpModel.sequenceClipInfo);CMPUtils.calculateSegmentTimeInSequence(i._cmpModel.ceProject.sequence.segments);i._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.HIDE_SEGMENT_POPUP));i._eventDispatcher.dispatchEvent(new CustomEvent(AnnotationEvent.REMOVE_MARKERS));i._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.ADD_SEGMENT,{detail:{segment:t,ceProject:i._cmpModel.ceProject}}));e||i.initiateSegmentPanel()};SequenceHandler.prototype.removeImplictSegment=function(n){for(var r=i._cmpModel.ceProject.sequence.segments,u="",t=0;t<r.length;t++)if(r[t].clipOrderId==n&&r[t].implictSegment==!0){u=t;break}CMPUtils.IsNullOrEmpty(u.toString())||i._cmpModel.ceProject.sequence.segments.splice(u,1)};SequenceHandler.prototype.initiateSegmentPanel=function(){var n=i._cmpModel,t=n.ceProject.sequence,r=n.ceProject.bin.clips,u=n.sequenceClipInfo;i._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SHOW_SEGMENTS_PANEL,{detail:{sequence:t,clips:r,sequenceClipInfo:u,currentClipOrderId:n.currentClipOrderId,playerMode:n._playerMode}}))};SequenceHandler.prototype.initiateSegmentDelete=function(n){var r,e,o,s;i._eventDispatcher.dispatchEvent(new CustomEvent(TimelineEvent.TIMELINE_EDITED));var f=n.detail.segObj,h=i._cmpModel,t=h.ceProject.sequence,u=null;for(r=0;r<t.segments.length;r++)if(t.segments[r].uiId===f.uiId){e=f.uiId;u=f.clipOrderId;t.segments.splice(r,1);i._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.SEGMENT_DELETED,{detail:{segmentUiId:e}}));break}o=CMPUtils.getAllSegmentsObjectsWithClipUiId(u,t.segments);CMPUtils.IsNullOrEmpty(o)&&(s=CMPUtils.getClipObjectWithClipUiId(u,i._cmpModel.ceProject.bin.clips,i._cmpModel.sequenceClipInfo),t.segments.push(CMPUtils.setClipAsSegment(s,u)));i._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.HIDE_CONFIRM_ALERT_MESSAGE,{detail:{}}));i._sequenceManager.resetAfterSegmentDeleted();i.initiateSegmentPanel()};SequenceHandler.prototype.handleExportClips=function(){i.fnValidateOnExportClips()&&i.fnExportEditedClips()};SequenceHandler.prototype.fnValidateOnExportClips=function(){var c=i._cmpModel.ceProject.bin.clips,l=i._cmpModel.ceProject.sequence.segments,t=i._cmpModel.sequenceClipInfo,r=!0,u=!1,f="",o=t.length,n;if(o!=0){for(n=0;n<o;n++){var e=t[n],s=CMPUtils.removeImplictSegmentFromSegmentsArray(e.clipUiId,l),h=CMPUtils.getClipObjectWithClipUiId(e.clipUiId,c,t);i._cmpModel.playerMode!=PlayerMode.SEQUENCE_CLIP?s.length==0&&(u=!0,f+="<li>"+h.title+"<\/li>"):e.clipUiId==i._cmpModel.currentClipOrderId&&s.length==0&&(u=!0,f+="<li>"+h.title+"<\/li>")}u&&(r=!1,i._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.SHOW_CONFIRM_ALERT_MESSAGE,{detail:{message:'<div style="padding-bottom:10px;">Segments are not created for the Assets <ul>'+f+"<\/ul> Do you wish to continue?<\/div>",closeFunctionCall:function(){i._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.HIDE_CONFIRM_ALERT_MESSAGE))},confirmFuncCall:function(){i.fnExportEditedClips()},cancelFuncCall:function(){i._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.HIDE_CONFIRM_ALERT_MESSAGE))}}})))}else r=!1,i._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.SHOW_ERROR_MESSAGE,{detail:{message:"There are no clips in the timeline",closeFunctionCall:function(){i._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_MESSAGE))},okFunctionCall:function(){i._eventDispatcher.dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_MESSAGE))}}}));return r};SequenceHandler.prototype.fnExportEditedClips=function(){for(var r,t=document.getElementById(i._instanceId+"_ExportPanel").getElementsByTagName("input"),n=0;n<t.length;n++)if(t[n].checked==!0){r=t[n].name.toLowerCase();switch(r){case"edl":i.prepareToExport("edl");break;case"fcp":i.prepareToExport("fcp")}}i.serveDownloadRequest();i._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.HIDE_EXPORT_POUP))};SequenceHandler.prototype.serveDownloadRequest=function(){document.forms[this._arrDownloadQueue[0]].submit();i._arrDownloadQueue.splice(0,1);this._arrDownloadQueue.length>0&&setTimeout(function(){i.serveDownloadRequest()},1e3)};SequenceHandler.prototype.prepareToExport=function(n){var s=i._sequenceManager.GetSequenceObjectAsXml(this._cmpModel.ceProject),r,o;i._eventDispatcher.dispatchEvent(new CustomEvent(SequenceEvent.HIDE_CONFIRM_ALERT_MESSAGE));var f=!1,e=!1,u="",t=[];t.async="true";n=="edl"?(t.type="CMX",u="EXPORTEDLIFRAME"):(t.type=n.toUpperCase(),u="EXPORTFCPIFRAME");document.getElementById("chksom").checked==1&&(f=!0);document.getElementById("chkorgfilename").checked==1&&(e=!0);t.isUseOrgFileName=e;t.isSomNeeded=f;r=parent.document.getElementById("ConfigName").value;CMPUtils.IsNullOrEmpty(r)&&(r="Edit");t.configName=r;n=="fcp"&&(t.defaultSequenceSom=this._cmpModel._defaultSequenceSom);o=encodeURIComponent((new XMLSerializer).serializeToString(jQuery.parseXML(s)));i.fnCreateAsyncReq(t,o,u)};SequenceHandler.prototype.fnCreateAsyncReq=function(n,i,r){var c=document.getElementById(t+"_hdnTenantId").value,h=parent.document.getElementById("_RequestVerificationToken"),u,f,e,s,o;n.tenant_id=c;n.action="ClearMediaPlayer";n.actionType="HandleExportClips";document.getElementById(r+"_FORMID")&&document.getElementsByTagName("body")[0].removeChild(document.getElementById(r+"_FORMID"));u=document.createElement("form");u.name=r+"_FORM";u.id=r+"_FORMID";u.setAttribute("method","post");u.setAttribute("action","/BC/Product/Actions/ClearActionHandler.aspx");u.setAttribute("target","_blank");document.getElementsByTagName("body")[0].appendChild(u);h=document.getElementById("_RequestVerificationToken");h!=null&&(f=document.createElement("input"),f.setAttribute("type","hidden"),f.value=h.value,f.setAttribute("name","_RequestVerificationToken"),f.setAttribute("id","_RequestVerificationToken"),u.appendChild(f));e=document.createElement("input");e.setAttribute("type","hidden");e.value=i;e.setAttribute("name","clipsList");u.appendChild(e);document.getElementsByTagName("body")[0].appendChild(u);for(s in n)n.hasOwnProperty(s)&&(o=document.createElement("input"),o.setAttribute("type","hidden"),o.setAttribute("name",s),o.setAttribute("value",n[s]),u.appendChild(o));this._arrDownloadQueue.push(r+"_FORM")}}function TimelineMarkerHandler(n,t){this._stateMachine=n.getInstance("stateMachine");this._cmpModel=n.getInstance("cmpModel");this._instanceId=t;this._eventDispatcher=document.getElementById(this._instanceId);this._nativeApi=n.getInstance("nativeApi");this._mediaManager=n.getInstance("mediaManager");var i=this;TimelineMarkerHandler.prototype.addMarkerLayer=function(n){var t=n.detail.markerLayer,u,r;if(i._cmpModel.markerCollection.length>=5&&i._cmpModel.markerCollection.shift(),new MarkerManager(i._cmpModel).createMarkerLayer(t.Id,t.Name,t.IsSelected),t.Markers!=null&&t.Markers!=undefined)for(u in t.Markers)r=t.Markers[u],new MarkerManager(i._cmpModel).createMarker(r.TcIn,r.TcOut,r.FormattedDisplayInfo,r.Id,r.Name,t.Id,t.Name,r.cssClassName);t=new MarkerManager(i._cmpModel).getCurrentMarkerLayer();i._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.BUILD_MARKER_LAYER,{detail:{markerLayer:t}}))};TimelineMarkerHandler.prototype.addOrUpdateMarker=function(n){var t=n.detail.marker,r;new MarkerManager(i._cmpModel).createMarker(t.TcIn,t.TcOut,t.FormattedDisplayInfo,t.Id,t.Name,n.detail.markerLayerId,n.detail.markerLayerName);r=new MarkerManager(i._cmpModel).getCurrentMarkerLayer();t=new MarkerManager(i._cmpModel).getMarkerById(n.detail.markerLayerId,t.Id);r.id==n.detail.markerLayerId&&i._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.ON_ADD_OR_UPDATE_MARKER,{detail:{marker:t,markerLayerName:n.detail.markerLayerName}}))};TimelineMarkerHandler.prototype.deleteMarker=function(n){new MarkerManager(i._cmpModel).deleteMarkerFromLayer(n.detail.markerLayerId,n.detail.markerLayerName,n.detail.markerId);i._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.ON_DELETE_MARKER,{detail:{markerId:n.detail.markerId,markerLayerId:n.detail.markerLayerId}}))};TimelineMarkerHandler.prototype.validateMarkerLayerChange=function(n){for(var r=!1,t=0;t<i._cmpModel.markerCollection.length;t++)i._cmpModel.markerCollection[t].id==n.detail.markerLayerId&&(r=!0,new MarkerManager(i._cmpModel).selectMarkerLayer(n.detail.markerLayerId,n.detail.markerLayerName),i._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.BUILD_MARKER_LAYER,{detail:{markerLayer:i._cmpModel.markerCollection[t]}})));r||i._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.ON_MARKER_LAYER_CHANGE,{detail:{markerLayerName:n.detail.markerLayerName,markerLayerId:n.detail.markerLayerId}}))};TimelineMarkerHandler.prototype.navigateToPreviousMarkerPosition=function(){var u=i.getCurrentMarkerLayers(),n=i.getPreviousMarkerPositionTime(u),t,r;n.markerPositionArray.length>0&&(t=Math.max.apply(Math,n.markerPositionArray),i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:MarkerEvent.NAVIGATE_TO_MARKER_POSITION,markInTime:t}})),r=CMPUtils.getDictionaryData(n.markerPositionDict,t),r!=undefined&&i._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.SHOW_MARKER_INFO,{detail:{markerObject:r}})))};TimelineMarkerHandler.prototype.navigateToNextMarkerPosition=function(){var u=i.getCurrentMarkerLayers(),n=i.getNextMarkerPositionTime(u),t,r;n.markerPositionArray.length>0&&(t=Math.min.apply(Math,n.markerPositionArray),i._stateMachine.triggerCMPEvent(new CustomEvent(CMPEvent.UI_EVENT,{detail:{type:MarkerEvent.NAVIGATE_TO_MARKER_POSITION,markInTime:t}})),r=CMPUtils.getDictionaryData(n.markerPositionDict,t),r!=undefined&&i._eventDispatcher.dispatchEvent(new CustomEvent(UIEvent.SHOW_MARKER_INFO,{detail:{markerObject:r}})))};TimelineMarkerHandler.prototype.getCurrentMarkerLayers=function(){return new MarkerManager(i._cmpModel).getCurrentMarkerLayer()};TimelineMarkerHandler.prototype.getNextMarkerPositionTime=function(n){var i,t,e,r,u;i=this._cmpModel.accumulatedSeekTimeInSec==0?this._mediaManager.getCurrentTime()*1e3:this._cmpModel.accumulatedSeekTimeInSec*1e3;var o=[],s={},h=this._cmpModel.mediaInfo.som,f=this._mediaManager.getFrameRateBasedOnMode(),c=CMPUtils.ConvertTimeCodeToMilliseconds(h,f);if(i=CMPUtils.RoundOffToNearestFrameWithMilliSecs(i,f),n!=null&&(t=n.markers,t!=null))for(e in t)r=CMPUtils.ConvertTimeCodeToMilliseconds(t[e].markIn,f)-c,r>i&&(o.push(r),CMPUtils.setDictionaryData(s,r,t[e]));return u={},u.markerPositionArray=o,u.markerPositionDict=s,u};TimelineMarkerHandler.prototype.getPreviousMarkerPositionTime=function(n){var r,t,e,f,i,l,o;r=this._cmpModel.accumulatedSeekTimeInSec==0?this._mediaManager.getCurrentTime()*1e3:this._cmpModel.accumulatedSeekTimeInSec*1e3;var a=this._cmpModel.mediaInfo.som,u=this._mediaManager.getFrameRateBasedOnMode(),s=CMPUtils.ConvertTimeCodeToMilliseconds(a,u),h=[],c={};if(r=CMPUtils.RoundOffToNearestFrameWithMilliSecs(r,u),n!=null&&(t=n.markers,e="",t!=null))for(f in t)i=CMPUtils.ConvertTimeCodeToMilliseconds(t[f].markIn,u)-s,i<r&&(l=1e3/u,r-i<l*15&&(i=CMPUtils.ConvertTimeCodeToMilliseconds(t[e].markIn,u)-s,f=e),h.push(i),CMPUtils.setDictionaryData(c,i,t[f])),e=f;return o={},o.markerPositionArray=h,o.markerPositionDict=c,o};TimelineMarkerHandler.prototype.addOrUpdateMarkersToTimeline=function(n){var e=n.detail.markersLayerId,t=n.detail.markers,f,r,u;if(t!=null&&t!=undefined)for(f=i._cmpModel.markerCollection[0].name,r=0;r<t.length;r++)u=new Marker,t[r],u.id=t[r].Id,u.name=t[r].Name,u.markIn=t[r].TcIn,u.markOut=t[r].TcOut,u.cssClassName=t[r].cssClassName,u.formattedDisplayInfo=t[r].formattedDisplayInfo,new MarkerManager(i._cmpModel).addOrUpdateMarker(e,f,u),i._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.ON_ADD_OR_UPDATE_MARKER,{detail:{markerLayerName:f,marker:u}}))};TimelineMarkerHandler.prototype.deleteMarkersFromTimeline=function(n){var e=n.detail.markersLayerId,t=n.detail.markers,f,r,u;if(t!=null&&t!=undefined)for(f=i._cmpModel.markerCollection[0].name,r=0;r<t.length;r++)i._cmpModel.markerCollection.length>0&&(u=t[r],new MarkerManager(i._cmpModel).deleteMarkerFromLayer(e,f,u.Id),i._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.ON_DELETE_MARKER,{detail:{markerId:u.Id}})))};TimelineMarkerHandler.prototype.clearMarkersToTimeline=function(n){var o=n.detail.markersLayerId,u=n.detail.markers,f,t,r,e;if(u!=null&&u!=undefined&&(f=i._cmpModel.markerCollection[0].name,t=Object.getOwnPropertyNames(u),i._cmpModel.markerCollection.length>0))for(new MarkerManager(i._cmpModel).deleteMarkerFromLayer(o,f,t),r=0;r<t.length;r++)e=t[r],i._eventDispatcher.dispatchEvent(new CustomEvent(MarkerEvent.ON_DELETE_MARKER,{detail:{markerId:e}}))}}function NonAVManager(n,t){this._cmpModel=n.getInstance("cmpModel");this._eventDispatcher=document.getElementById(t);this._instanceId=t;this._nativeApi=n.getInstance("nativeApi");this._slideShowTime=null;this._slideShowSec=null;var i=this;NonAVManager.prototype.getNonAvInfo=function(){};NonAVManager.prototype.getItemUrl=function(){};NonAVManager.prototype.getItemCount=function(){};NonAVManager.prototype.setCurrentItemNumber=function(){};NonAVManager.prototype.getItemAspectRatio=function(){};NonAVManager.prototype.getCurrentItemNumber=function(){};NonAVManager.prototype.getCurrentItemTitle=function(){};NonAVManager.prototype.refreshRightSidePanel=function(){};NonAVManager.prototype.setNonAvMediaUrlOnRefershOfDisplayGrid=function(){};NonAVManager.prototype.SetNonAvMediaUrl=function(){};NonAVManager.prototype.getSecureInfoOfSelectedAssest=function(){};NonAVManager.prototype.loadUrl=function(){var o=this.getItemUrl(1),i=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[0].id,e;this._cmpModel.nonAVMediaInfo.nonAvViewInfo.activeContainerIds[0]=i;this._eventDispatcher.dispatchEvent(new CustomEvent(LoadEvent.SET_MEDIA_SOURCE,{detail:{url:o}}));this._cmpModel.noOfNonAvActiveContainer=1;var r=new NonAvHandler(n,t).getContainerWidthHeight().split(","),u=r[0],f=r[1];this.fitActiveItemsInContainers(u,f);this.updateActiveContainerAndContentPosition(u,f);e=this.getActiveContainerArray();this.isPreferenceSettingRequired()&&this.setPreferenceSetting(i);this._eventDispatcher.dispatchEvent(new CustomEvent(NonAvViewerEvent.CREATE_NOAV_UI_CONTAINER,{detail:{nonAvContainers:e,noOfActiveContainers:this._cmpModel.noOfNonAvActiveContainer}}));this._eventDispatcher.dispatchEvent(new CustomEvent(NonAvViewerEvent.DEFAULT_SELECTED_CONTAINER,{detail:{activeContainer:this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[i],isFirstLoad:!0,noOfActiveContainers:this._cmpModel.noOfNonAvActiveContainer}}));this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.NON_AV_BUFFERING,{detail:{containerId:i}}))};NonAVManager.prototype.updateNonAvContainerDisplay=function(){for(var t,n,r=[],u=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.activeContainerIds,i=0;i<u.length;i++)n=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[u[i]],n.isContainerVisible!=!1&&(t=new NonAvDisplayRequest,t.id=n.id,t.rotationOffset=n.rotationOffset,t.zoomPercentage=n.zoomPercentage,t.contentHeight=n.contentHeight,t.contentWidth=n.contentWidth,t.contentX=n.contentX,t.contentY=n.contentY,t.containerWidth=n.containerWidth,t.containerHeight=n.containerHeight,t.containerX=n.containerX,t.containerY=n.containerY,t.isContainerVisible=n.isContainerVisible,r.push(t));this._nativeApi.UpdateNonAvContainerDisplay(JSON.stringify(r))};NonAVManager.prototype.preloadNextContainer=function(){};NonAVManager.prototype.updateNonAvContainer=function(n){for(var u,e=n.listOfActionsPerformed,r=JSON.parse(n.updatedContainerDetails),f=this._cmpModel.nonAVMediaInfo,t=0;t<r.length;t++)u=f.nonAvViewInfo.containers[parseInt(r[t].id)],u.zoomPercentage=r[t].zoomPercentage,u.contentWidth=r[t].contentWidth,u.contentHeight=r[t].contentHeight,u.contentX=r[t].contentX,u.contentY=r[t].contentY,u.rotationOffset=r[t].rotationOffset,f.nonAvViewInfo.containers[parseInt(r[t].id)]=u,i.updatePreferenceSetting(u.zoomPercentage);this.updateUIDisplayControls();this._cmpModel.playerInfo.MediaInfo.AssetClass=="IMAGE"&&this.checkSlideShowEnabled();this.doCallBackBasedOnActionPerformed(e)};NonAVManager.prototype.checkSlideShowEnabled=function(){var f=this._cmpModel.currentlySelectedNonAvContainer,e=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[f],t=parseInt(e.sequenceNumber),r=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.activeContainerIds,u,n;if(this._cmpModel.nonAVMediaInfo.imageCollection.isSlideShowStarted==!0)for(u=this._slideShowSec,t=t+1,n=0;n<r.length;n++)this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[r[n]].isBuffered&&(this._slideShowTime=setTimeout(function(){i.switchNextSlide(t)},u))};NonAVManager.prototype.doCallBackBasedOnActionPerformed=function(i){var f=this._cmpModel.nonAVMediaInfo,e,a,s,r,u;for(e in i){var v=e,y=JSON.parse(i[e]),b=f.nonAvViewInfo.containers[v],h=y.shift();if(h=="ZOOM"||h=="ROTATE"){var c=[],l=new NonAvHandler(n,t).getContainerWidthHeight().split(","),p=l[0],w=l[1],o=[];for(a in i)o.push(parseInt(a));for(o.splice(o.indexOf(parseInt(e)),1),this.updateActiveContainerAndContentPosition(p,w,o),s=0;s<f.nonAvViewInfo.activeContainerIds.length;s++)r=f.nonAvViewInfo.containers[f.nonAvViewInfo.activeContainerIds[s]],r.isContainerVisible!=!1&&(u=new NonAvDisplayRequest,u.id=r.id,u.contentX=r.contentX,u.contentY=r.contentY,c.push(u));this._nativeApi.UpdateNonAvContainerDisplay(JSON.stringify(c))}}};NonAVManager.prototype.scaleView=function(i){var r=this._cmpModel.nonAVMediaInfo.nonAvViewInfo,h=r.activeContainerIds.length,c=this._cmpModel.currentlySelectedNonAvContainer,o,u,f,e;i=this.getLogScaleValue(i);var v=r.containers[c].zoomPercentage=i/100,s=new NonAvHandler(n,t).getContainerWidthHeight().split(","),l=s[0],a=s[1];for(this.updateActiveContainerAndContentPosition(l,a),o=[],u=0;u<h;u++)f=r.containers[r.activeContainerIds[u]],f.isContainerVisible!=!1&&(e=new NonAvDisplayRequest,e.id=f.id,e.zoomPercentage=f.zoomPercentage,o.push(e));this._nativeApi.UpdateNonAvContainerDisplay(JSON.stringify(o))};NonAVManager.prototype.setFitWidth=function(n,t){var i,r,u=n.split(":");i=u[0];r=u[1];t.contentWidth=t.contentOrginalWidth=t.containerWidth;t.contentHeight=t.contentOrginalHeight=r/i*t.containerWidth};NonAVManager.prototype.setFitHeight=function(n,t){var i,r,u=n.split(":");i=u[0];r=u[1];t.contentWidth=t.contentOrginalWidth=i/r*t.containerHeight;t.contentHeight=t.contentOrginalHeight=t.containerHeight};NonAVManager.prototype.getViewType=function(n){var t=n.split(":"),i=parseFloat(t[0]),r=parseFloat(t[1]);return i>r?"fitWidth":"fitHeight"};NonAVManager.prototype.jumpToPage=function(n){var f,r,t,u,i=this._cmpModel.noOfNonAvActiveContainer,s,e,o;if(f=this.getItemCount(),t=parseInt(n.detail.requestPage),u=t,1<=t&&t<=f){if(r=t,s=this.isItemActive(t,i),s==!1){if(e=(t+(i-1))%i,e!=0){for(o=e;o>0;o--)containerposition=(u+(i-1))%i,u--;r=u}this.refreshDisplayGrid(i,r,f);this.setCurrentItemNumber(r);this.isItemActive(t,i)}}else CMPUtils.IsNullOrEmpty(n.detail.requestPage)?showErrorDetailsNG("Page number should not be empty.",0):showErrorDetailsNG("There is no page numbered "+t+" in this document",0),this.updateUIDisplayControls()};NonAVManager.prototype.isItemActive=function(n,t){for(var e=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers,u=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.activeContainerIds,f=!1,r=[],i=0;i<u.length;i++)r.push(e[u[i]]);for(i=0;i<r.length;i++)r[i].sequenceNumber==n&&(this._eventDispatcher.dispatchEvent(new CustomEvent(NonAvViewerEvent.DEFAULT_SELECTED_CONTAINER,{detail:{activeContainer:r[i],noOfActiveContainers:t}})),f=!0);return f};NonAVManager.prototype.rotateItem=function(i){var e=this._cmpModel.nonAVMediaInfo,h=this._cmpModel.currentlySelectedNonAvContainer,l=e.nonAvViewInfo.containers[h],f=l.rotationOffset,s,o,r,u;i.toUpperCase()=="CLOCKWISE"?(f==360&&(f=0),f=f+90):i.toUpperCase()=="ANTICLOCKWISE"&&(f==0&&(f=360),f=f-90);var c=new NonAvHandler(n,t).getContainerWidthHeight().split(","),a=c[0],v=c[1];for(e.nonAvViewInfo.containers[h].rotationOffset=f,s=[],o=0;o<e.nonAvViewInfo.activeContainerIds.length;o++)r=new NonAvDisplayRequest,u=e.nonAvViewInfo.containers[e.nonAvViewInfo.activeContainerIds[o]],u.isContainerVisible!=!1&&(r.id=u.id,r.rotationOffset=u.rotationOffset,r.containerHeight=u.containerHeight,r.containerWidth=u.containerWidth,r.containerX=u.containerX,r.containerY=u.containerY,r.contentX=u.contentX,r.contentY=u.contentY,s.push(r));this._nativeApi.UpdateNonAvContainerDisplay(JSON.stringify(s))};NonAVManager.prototype.navigateItem=function(n){var t,r=this._cmpModel.noOfNonAvActiveContainer,u=this.getItemCount(),i=this.getFirstActivePage();n.toUpperCase()=="NEXT"?t=i+r:n.toUpperCase()=="PREVIOUS"&&(t=i-r);1<=t&&t<=u&&(i=t,this.refreshDisplayGrid(r,i,u),this.setCurrentItemNumber(i))};NonAVManager.prototype.layoutContainersOnGrid=function(i){var u=new NonAvHandler(n,t).getContainerWidthHeight().split(","),f=u[0],e=u[1],r;this.fitActiveItemsInContainers(f,e);this.updateActiveContainerAndContentPosition(f,e);r=this.getActiveContainerArray();this._eventDispatcher.dispatchEvent(new CustomEvent(NonAvViewerEvent.CREATE_NOAV_UI_CONTAINER,{detail:{nonAvContainers:r,noOfActiveContainers:i}}));this._eventDispatcher.dispatchEvent(new CustomEvent(NonAvViewerEvent.DEFAULT_SELECTED_CONTAINER,{detail:{activeContainer:r[0],noOfActiveContainers:i}}))};NonAVManager.prototype.getFirstActivePage=function(){return this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[this._cmpModel.nonAVMediaInfo.nonAvViewInfo.activeContainerIds[0]].sequenceNumber};NonAVManager.prototype.updateContainerDisplayParams=function(n,t,i){return n!=null&&(t.zoomPercentage=n.zoomPercentage),t.isContainerVisible=!0,t.sequenceNumber=i,t};NonAVManager.prototype.addOrUpdateContainer=function(n,t,i){for(var u=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers,e=null,r,f=0;f<u.length;f++)if(u[f]==n){r=u[f];break}CMPUtils.IsNullOrEmpty(u[t])||(e=u[t]);CMPUtils.IsNullOrEmpty(r)?(r=new Container,r.id=n,r=this.updateContainerDisplayParams(null,r,i),this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[n]=r):(r=this.updateContainerDisplayParams(null,r,i),this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[n]=r)};NonAVManager.prototype.resizeNonAvView=function(i){var e=new NonAvHandler(n,t).getContainerWidthHeight().split(","),r=e[0],u=e[1],f,o;this._cmpModel.nonAVMediaInfo.nonAvViewInfo.activeContainerIds.length==1&&this.isPreferenceSettingRequired()?(f=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.activeContainerIds[0],this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[f].containerHeight=u,this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[f].containerWidth=r):CMPUtils.IsNullOrEmpty(i)||i!=!0||this.fitActiveItemsInContainers(r,u);this.updateActiveContainerAndContentPosition(r,u);this.updateNonAvContainerDisplay();o=this.getActiveContainerArray();this.ShowHideTitleOnResize()};NonAVManager.prototype.onMouseDrag=function(n,t){for(var i,r,u=this._cmpModel.nonAVMediaInfo.nonAvViewInfo,s=u.activeContainerIds.length,a=u.containers.length,h=this._cmpModel.currentlySelectedNonAvContainer,o=[],f=0;f<s;f++){if(h==u.containers[u.activeContainerIds[f]].id){var e=u.containers[u.activeContainerIds[f]],c=e.contentX,l=e.contentY;e.contentX=c-n;e.contentY=l-t}i=u.containers[u.activeContainerIds[f]];i.isContainerVisible!=!1&&(r=new NonAvDisplayRequest,r.id=i.id,r.rotationOffset=i.rotationOffset,r.containerX=i.containerX,r.containerY=i.containerY,r.contentX=i.contentX,r.contentY=i.contentY,r.containerWidth=i.containerWidth,r.containerHeight=i.containerHeight,o.push(r))}this._nativeApi.UpdateNonAvContainerDisplay(JSON.stringify(o))};NonAVManager.prototype.refreshDisplayGrid=function(n,t,r){var c=this._cmpModel.currentlySelectedNonAvContainer,f,e=[],l,s,h,u,o;for(t=parseInt(t),l=[],u=0;u<n;u++)f=(t+7)%8,this.addOrUpdateContainer(f,c,t),t<=r?(s=this.getItemUrl(t),h=this.getSecureInfoOfSelectedAssest(f),window.setTimeout(function(n,t,i,r){return function(){n.setNonAvMediaUrlOnRefershOfDisplayGrid(t,i,r)}}(this,s,f,h),u*2500)):this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[f].isContainerVisible=!1,e[u]=f,t++;if(this._cmpModel.nonAVMediaInfo.nonAvViewInfo.activeContainerIds=e,this.layoutContainersOnGrid(n),n==1&&this.isPreferenceSettingRequired())for(u=0;u<i._cmpModel.nonAVMediaInfo.nonAvViewInfo.activeContainerIds.length;u++)i.setPreferenceSetting(i._cmpModel.nonAVMediaInfo.nonAvViewInfo.activeContainerIds[u]);for(u=0;u<e.length;u++)o=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[e[u]],o.isContainerVisible!=!1&&this._eventDispatcher.dispatchEvent(new CustomEvent(TransportEvent.NON_AV_BUFFERING,{detail:{containerId:o.id}}));this._cmpModel.nonAVMediaInfo.nonAvViewInfo.activeContainerIds=e};NonAVManager.prototype.fitActiveItemsInContainers=function(n,t){var h=this._cmpModel.nonAVMediaInfo,l=h.nonAvViewInfo.containers,e=h.nonAvViewInfo.activeContainerIds,c=e.length,o=1,u,i,s,f;c>1&&(o=2);var a=c/o,v=t/a,y=n/o,r;for(u=0;u<e.length;u++)i=l[e[u]],i.containerHeight=v,i.containerWidth=y,r=this.getItemAspectRatio(i.sequenceNumber),s=parseInt(i.rotationOffset),f=this.getViewType(r),i.viewType=f,f=="fitHeight"?this.setFitHeight(r,i,s):f=="fitWidth"&&this.setFitWidth(r,i,s)};NonAVManager.prototype.updateActiveContainerAndContentPosition=function(n,t,i){var f,e,r;CMPUtils.IsNullOrEmpty(i)&&(i=[]);var c=this._cmpModel.nonAVMediaInfo,a=c.nonAvViewInfo.containers,o=c.nonAvViewInfo.activeContainerIds,l=o.length,h=1;l>1&&(h=2);var v=l/h,u=null,s=null;for(f=0;f<o.length;f++)e=o[f],r=a[o[f]],r.isContainerVisible!=!1&&(r.containerHeight=t/v,r.containerWidth=n/h,i.indexOf(e)<0&&this.centerNonAvItemInViewPort(r),f==0?(i.indexOf(e)<0&&(r.containerX=0,r.containerY=0),u=s=r):CMPUtils.isEven(f+1)?(r.containerX=u.containerX+u.containerWidth,r.containerY=u.containerY,i.indexOf(e)<0&&(r.contentX=r.contentX+u.containerWidth,r.contentY=r.contentY+u.containerY),u=r):(r.containerX=s.containerX,r.containerY=s.containerY+u.containerHeight,i.indexOf(e)<0&&(r.contentY=r.contentY+u.containerHeight),u=s=r))};NonAVManager.prototype.centerNonAvItemInViewPort=function(n){var s=n.containerHeight,h=n.containerWidth,r=h/2,u=s/2,o=this.getContentHeightAndWidthBasedOnViewType(n),c=o.Height,l=o.Width,f=c/2,e=l/2,t=0,i=0;switch(n.rotationOffset){case 0:t=r-e;i=u-f;break;case 90:case-270:t=r+f;i=u-e;break;case 180:case-180:t=r+e;i=u+f;break;case 270:case-90:t=r-f;i=u+e}n.contentX=t;n.contentY=i};NonAVManager.prototype.getContentHeightAndWidthBasedOnViewType=function(n){var r={},t,i,u=this.getViewType(this.getItemAspectRatio(n.sequenceNumber));return n.viewType.toUpperCase()=="FITHEIGHT"?(u.toUpperCase()=="FITWIDTH"?(t=Math.max(n.contentHeight,n.contentWidth),i=Math.min(n.contentHeight,n.contentWidth)):(t=Math.min(n.contentHeight,n.contentWidth),i=Math.max(n.contentHeight,n.contentWidth)),r.Height=i,r.Width=t):n.viewType.toUpperCase()=="FITWIDTH"&&(u.toUpperCase()=="FITHEIGHT"?(t=Math.min(n.contentHeight,n.contentWidth),i=Math.max(n.contentHeight,n.contentWidth)):(t=Math.max(n.contentHeight,n.contentWidth),i=Math.min(n.contentHeight,n.contentWidth)),r.Height=i,r.Width=t),r};NonAVManager.prototype.updateUIDisplayControls=function(){var h=this._cmpModel.currentlySelectedNonAvContainer,c=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[h],p=parseInt(this._cmpModel.noOfNonAvActiveContainer),t=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.activeContainerIds,l=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[t[0]].sequenceNumber,a=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[t[t.length-1]].sequenceNumber,n=c,r=!1,u=!1,f=this.getItemCount(),v=parseInt(n.sequenceNumber),i=null,e=null,y=n.viewType,o,s;CMPUtils.IsNullOrEmpty(n.zoomPercentage)||(i=parseFloat(n.zoomPercentage)*100,e=this.getLinearScaleValue(i));o=f;s=1;a>=o&&(r=!0);l<=s&&(u=!0);this._eventDispatcher.dispatchEvent(new CustomEvent(NonAvViewerEvent.UPDATE_UI_CONTROLS,{detail:{currentPage:v,totalPages:f,firstPageReached:u,lastPageReached:r,scaleValueInLog:i,scaleValueInLinear:e,viewType:y}}))};NonAVManager.prototype.updateCurrentlySelectedContainer=function(n,t){if(this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[n].isContainerVisible==!0&&this._cmpModel.currentlySelectedNonAvContainer!=n){this._cmpModel.currentlySelectedNonAvContainer=n;var i=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[n];this.setCurrentItemNumber(i.sequenceNumber);this.updateUIDisplayControls();this.ShowHideTitleOnResize();t!=!0&&this.refreshRightSidePanel(i.sequenceNumber);this._eventDispatcher.dispatchEvent(new CustomEvent(NonAvViewerEvent.UPDATE_POPUP_HEADER,{detail:{createdOnDate:this._cmpModel.playerInfo.NonAvInfo[this._cmpModel.currentlySelectedNonAvContainer].CreatedOn,title:this._cmpModel.playerInfo.NonAvInfo[this._cmpModel.currentlySelectedNonAvContainer].Title}}))}};NonAVManager.prototype.changeGridLayout=function(n){var o=parseInt(n),e;this._cmpModel.noOfNonAvActiveContainer=o;var t=o,r,i=this.getCurrentItemNumber(),s=this.getItemCount(),u=i,f=i;if(r=(i+(t-1))%t,r!=0){for(e=r;e>0;e--)containerposition=(u+(t-1))%t,u--;f=u}this.refreshDisplayGrid(t,f,s);this.isItemActive(i,t);this.setCurrentItemNumber(f)};NonAVManager.prototype.getActiveContainerArray=function(){for(var r,t=this._cmpModel.nonAVMediaInfo.nonAvViewInfo.activeContainerIds,i=[],n=0;n<t.length;n++)r=t[n],i.push(this._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[r]);return i};NonAVManager.prototype.updateNoOfContainer=function(n){this._cmpModel.noOfNonAvActiveContainer=n};NonAVManager.prototype.getLogScaleValue=function(n){var r,t,u,i,e,f;return n<=33?(r=1,t=33,u=10,i=100):n<=66?(r=34,t=66,u=101,i=500):(r=67,t=100,u=501,i=1e3),f=Math.log(i/u)/(t-r),e=i/Math.exp(f*t),e*Math.exp(f*n)};NonAVManager.prototype.getLinearScaleValue=function(n){var r,t,u,i,e,f;return n<=100?(r=1,t=33,u=10,i=100):n<=500?(r=34,t=66,u=101,i=500):(r=67,t=100,u=501,i=1e3),f=Math.log(i/u)/(t-r),e=i/Math.exp(f*t),Math.log(n/e)/f};NonAVManager.prototype.slideShow=function(n){var i=n.detail.type,f=this._cmpModel.noOfActiveContainer,e=this.getItemCount(),r=this.getFirstActivePage(),u=r,t;i.toUpperCase()=="PLAY"?(t=parseInt(n.detail.seconds),t=t*1e3,this._slideShowSec=t,this._cmpModel.nonAVMediaInfo.imageCollection.isSlideShowStarted=!0,this.switchNextSlide(u)):i.toUpperCase()=="PAUSE"&&(this._slideShowTime!=null&&clearTimeout(this._slideShowTime),this._cmpModel.nonAVMediaInfo.imageCollection.isSlideShowStarted=!1)};NonAVManager.prototype.switchNextSlide=function(n){var t=this.getItemCount(),r;i._slideShowTime!=null&&clearTimeout(i._slideShowTime);n==t&&(this._cmpModel.nonAVMediaInfo.imageCollection.isSlideShowStarted=!1);n<=t?(this.refreshDisplayGrid(1,n,t),this.setCurrentItemNumber(n)):(r=this._cmpModel.currentlySelectedNonAvContainer,this._cmpModel.currentlySelectedNonAvContainer=r)};NonAVManager.prototype.ShowHideTitleOnResize=function(){this._eventDispatcher.dispatchEvent(new CustomEvent(NonAvViewerEvent.SHOW_NONAV_FILENAME_ON_FULLSCREEN,{detail:{title:this.getCurrentItemTitle()}}))};NonAVManager.prototype.fitCurrentlySelectedItemInContainer=function(i){var h,r,c,a,o=[],e=this._cmpModel.nonAVMediaInfo,y,l,s,u,f;r=e.nonAvViewInfo.containers[this._cmpModel.currentlySelectedNonAvContainer];h=this.getItemAspectRatio(r.sequenceNumber);c=r.rotationOffset;a=e.nonAvViewInfo.activeContainerIds;i=="fitWidth"?this.setFitWidth(h,r,c):i=="fitHeight"&&this.setFitHeight(h,r,c);r.viewType=i;var v=new NonAvHandler(n,t).getContainerWidthHeight().split(","),p=v[0],w=v[1];for(y in a)o.push(parseInt(y));for(o.splice(o.indexOf(parseInt(r.id)),1),this.updateActiveContainerAndContentPosition(p,w,o),r.contentHeight>r.containerHeight&&(r.contentY=r.containerY),l=[],s=0;s<e.nonAvViewInfo.activeContainerIds.length;s++)u=new NonAvDisplayRequest,f=e.nonAvViewInfo.containers[e.nonAvViewInfo.activeContainerIds[s]],f.isContainerVisible!=!1&&(u.id=f.id,u.contentX=f.contentX,u.contentY=f.contentY,u.contentWidth=f.contentWidth,u.contentHeight=f.contentHeight,l.push(u));this._nativeApi.UpdateNonAvContainerDisplay(JSON.stringify(l))};NonAVManager.prototype.formatItemBeforeDisplay=function(n){if(n.containerWidth<contentWidth)return this.zoomRightWise(n)};NonAVManager.prototype.zoomRightWise=function(n){return n.contentX=0,n.contentY=0,n};NonAVManager.prototype.isPreferenceSettingRequired=function(){return i._cmpModel.noOfNonAvActiveContainer>1||!i._cmpModel._playerInfo.UserPreferredSetting.rememberViewerSettings?!1:!0};NonAVManager.prototype.setPreferenceSetting=function(n){if(!(i._cmpModel.noOfNonAvActiveContainer>1)&&i._cmpModel._playerInfo.UserPreferredSetting.rememberViewerSettings){var t=i._cmpModel._preferenceSetting.viewerSettings.playerPreferencesSettings.nonAvViewer;switch(i._cmpModel.playerMode){case PlayerMode.NON_AV_DOCUMENT:CMPUtils.IsNullOrEmpty(t.documents.zoomLevel)||(i._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[n].zoomPercentage=t.documents.zoomLevel,i._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[n].contentWidth=null,i._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[n].contentHeight=null);break;case PlayerMode.NON_AV_IMAGE:CMPUtils.IsNullOrEmpty(t.images.zoomLevel)||(i._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[n].zoomPercentage=t.images.zoomLevel,i._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[n].contentWidth=null,i._cmpModel.nonAVMediaInfo.nonAvViewInfo.containers[n].contentHeight=null)}}};NonAVManager.prototype.updatePreferenceSetting=function(n){if(!(i._cmpModel.noOfNonAvActiveContainer>1)&&i._cmpModel._playerInfo.UserPreferredSetting.rememberViewerSettings)switch(i._cmpModel.playerMode){case PlayerMode.NON_AV_DOCUMENT:i._cmpModel._preferenceSetting.viewerSettings.playerPreferencesSettings.nonAvViewer.documents.zoomLevel=n;break;case PlayerMode.NON_AV_IMAGE:i._cmpModel._preferenceSetting.viewerSettings.playerPreferencesSettings.nonAvViewer.images.zoomLevel=n}}}function NonAvHandler(n,t){this._stateMachine=n.getInstance("stateMachine");this._cmpModel=n.getInstance("cmpModel");this._instanceId=t;this._nativeApi=n.getInstance("nativeApi");this._eventDispatcher=document.getElementById(t);this._nonAVManager=n.getInstance("nonAVManager");var i=this;NonAvHandler.prototype.handleNavigateNextItem=function(){i._nonAVManager.navigateItem("NEXT")};NonAvHandler.prototype.handleNavigatePreviousItem=function(){i._nonAVManager.navigateItem("PREVIOUS")};NonAvHandler.prototype.jumpToPage=function(n){i._nonAVManager.jumpToPage(n)};NonAvHandler.prototype.rotateClockWise=function(){i._nonAVManager.rotateItem("CLOCKWISE")};NonAvHandler.prototype.rotateAntiClockWise=function(){i._nonAVManager.rotateItem("ANTICLOCKWISE")};NonAvHandler.prototype.handleScale=function(n){i._nonAVManager.scaleView(n.detail.scaleValue)};NonAvHandler.prototype.handleMouseDrag=function(n){i._nonAVManager.onMouseDrag(n.detail.XDisplacement,n.detail.YDisplacement)};NonAvHandler.prototype.resizeNonAvView=function(n){var t=!1;CMPUtils.IsNullOrEmpty(n.detail)||CMPUtils.IsNullOrEmpty(n.detail.isContentNeedResize)||(t=n.detail.isContentNeedResize);i._nonAVManager.resizeNonAvView(t)};NonAvHandler.prototype.getContainerWidthHeight=function(){var n=CMPUtils.GetDivsComputedStyleWidth(i._instanceId+"_ClearMediaPlayer"),t=CMPUtils.GetDivsComputedStyleHeight(i._instanceId+"_ClearMediaPlayer");return n+","+t};NonAvHandler.prototype.onGridLayoutChange=function(n){var t=n.detail.selectedContainerValue;i._nonAVManager.changeGridLayout(t)};NonAvHandler.prototype.handelNonAvOverlayClicked=function(n){if(!CMPUtils.IsNullOrEmpty(n.detail)){var t=n.detail.selectedContainerId,r=CMPUtils.IsNullOrEmpty(n.detail.isFirstLoad)?!1:n.detail.isFirstLoad;i._nonAVManager.updateCurrentlySelectedContainer(t,r)}};NonAvHandler.prototype.defaultMultipleContainer=function(n){var t=n.detail.selectedContainerValue;i._nonAVManager.updateNoOfContainer(t)};NonAvHandler.prototype.playSlideShow=function(n){i._nonAVManager.slideShow(n)};NonAvHandler.prototype.pauseSlideShow=function(n){i._nonAVManager.slideShow(n)};NonAvHandler.prototype.handleChangeViewType=function(n){i._nonAVManager.fitCurrentlySelectedItemInContainer(n.detail.viewType)}}function DocumentManager(n){this._nativeApi=n.getInstance("nativeApi");var t=this;DocumentManager.prototype.getNonAvInfo=function(n){var i=new DocumentMetadata,r=n[0],e,t,u,f;return i.id=r.DmGuid,i.title=r.Title,i.size=r.Size,i.url=r.MediaUrl,i.currentPage=1,i.totalPages=r.TotalPages,i.resolution=r.Dimension.toLowerCase(),i.isPreLoadEnabled=!0,e=[],t=new Container,t.id=0,t.rotationOffset=0,t.zoomPercentage=1,t.contentX=0,t.contentY=0,t.containerX=0,t.containerY=0,t.viewType=null,t.contentWidth=null,t.contentHeight=null,t.sequenceNumber=1,e.push(t),u=new NonAvViewInfo,u.containers=e,u.activeContainerIds=[],f=new DocumentInfo,f.documentMetadata=i,f.nonAvViewInfo=u,f};DocumentManager.prototype.getItemUrl=function(n){var u={};u.PageNumber=n;var f=JSON.stringify(u),i=[],r=this._cmpModel.nonAVMediaInfo.documentMetadata.url.split("?"),t=this._cmpModel.nonAVMediaInfo.documentMetadata.url;return r.length>1&&(i.push(r[1]),t=r[0]),t=t+"?",i.push("request="+btoa(f)),t+i.join("&")};DocumentManager.prototype.getItemCount=function(){return parseInt(this._cmpModel.nonAVMediaInfo.documentMetadata.totalPages)};DocumentManager.prototype.setCurrentItemNumber=function(n){this._cmpModel.nonAVMediaInfo.documentMetadata.currentPage=n};DocumentManager.prototype.getItemAspectRatio=function(){var t=this._cmpModel.nonAVMediaInfo.documentMetadata.resolution,n=t.split("x");return CMPUtils.getAspectRatio(parseFloat(n[0]),parseFloat(n[1]))};DocumentManager.prototype.getCurrentItemNumber=function(){return this._cmpModel.nonAVMediaInfo.documentMetadata.currentPage};DocumentManager.prototype.getCurrentItemTitle=function(){return this._cmpModel.nonAVMediaInfo.documentMetadata.title};DocumentManager.prototype.refreshRightSidePanel=function(){};DocumentManager.prototype.SetNonAvMediaUrl=function(n,t){this.setDocumentMediaUrl(n,t)};DocumentManager.prototype.setDocumentMediaUrl=function(n,t){this._nativeApi.setDocumentMediaUrl(n,t)};DocumentManager.prototype.setNonAvMediaUrlOnRefershOfDisplayGrid=function(n,t){this._nativeApi.navigatePage(n,t)}}function ImageManager(n){this._nativeApi=n.getInstance("nativeApi");var t=this;ImageManager.prototype.getNonAvInfo=function(n){for(var r,i,o,t,f,s,e,h=[],u=0;u<n.length;u++)r=n[u],i=new ImageMetadata,i.id=r.DmGuid,i.title=r.Title,i.size=r.Size,i.url=r.MediaUrl,i.resolution=r.Dimension.toLowerCase(),i.isPreLoadEnabled=!0,i.currentPage=u+1,i.tenantId=r.ObjectTenantId,h.push(i);return o=[],t=new Container,t.id=0,t.rotationOffset=0,t.zoomPercentage=1,t.contentX=0,t.contentY=0,t.viewType=null,t.contentWidth=null,t.contentHeight=null,t.sequenceNumber=1,t.isBuffered=!1,o.push(t),f=new NonAvViewInfo,f.containers=o,f.activeContainerIds=[],s=new ImageInfoCollection,s.imageMetadata=h,e=new ImageInfo,e.imageCollection=s,e.nonAvViewInfo=f,e};ImageManager.prototype.setCurrentItemNumber=function(n){this._cmpModel.nonAVMediaInfo.imageCollection.currentImageNumber=n};ImageManager.prototype.getItemUrl=function(n){return this._cmpModel.nonAVMediaInfo.imageCollection.imageMetadata[n-1].url};ImageManager.prototype.getItemCount=function(){return this._cmpModel.nonAVMediaInfo.imageCollection.imageMetadata.length};ImageManager.prototype.getItemAspectRatio=function(n){if(this._cmpModel.nonAVMediaInfo.imageCollection.imageMetadata[n-1]!=null){var i=this._cmpModel.nonAVMediaInfo.imageCollection.imageMetadata[n-1].resolution,t=i.split("x");return CMPUtils.getAspectRatio(parseFloat(t[0]),parseFloat(t[1]))}return"1000x1000"};ImageManager.prototype.getCurrentItemNumber=function(){return this._cmpModel.nonAVMediaInfo.imageCollection.currentImageNumber};ImageManager.prototype.getCurrentItemTitle=function(){return this._cmpModel.nonAVMediaInfo.imageCollection.imageMetadata[this._cmpModel.currentlySelectedNonAvContainer].title};ImageManager.prototype.refreshRightSidePanel=function(n){if(this._cmpModel.nonAVMediaInfo.imageCollection.imageMetadata[n-1]!=null){var t=this._cmpModel.nonAVMediaInfo.imageCollection.imageMetadata[n-1].id,i=this._cmpModel.nonAVMediaInfo.imageCollection.imageMetadata[n-1].tenantId;this._eventDispatcher.dispatchEvent(new CustomEvent(NonAvViewerEvent.REFRESH_RIGHTSIDE_INFO,{detail:{dmGuid:t,tenantId:i}}))}};ImageManager.prototype.SetNonAvMediaUrl=function(n,t,i){this.setImageMediaUrl(n,t,i)};ImageManager.prototype.setImageMediaUrl=function(n,t,i){this._nativeApi.setImageMediaUrl(n,t,i)};ImageManager.prototype.setNonAvMediaUrlOnRefershOfDisplayGrid=function(n,t,i){this._nativeApi.setImageMediaUrl(n,t,i)};ImageManager.prototype.getSecureInfoOfSelectedAssest=function(n){var t=[];return(this._cmpModel.playerInfo!=null||this._cmpModel.playerInfo!=undefined)&&(this._cmpModel.playerInfo.NonAvInfo!=null||this._cmpModel.playerInfo.NonAvInfo!=undefined)&&(t=this._cmpModel.playerInfo.NonAvInfo[n].SecureInfo),t}}function LiveHandler(n,t){this._stateMachine=n.getInstance("stateMachine");this._cmpModel=n.getInstance("cmpModel");this._instanceId=t;this._nativeApi=n.getInstance("nativeApi");this._eventDispatcher=document.getElementById(t);var i=this;LiveHandler.prototype.onLiveFeedEnded=function(){i._cmpModel.mediaInfo.isLive=!1};LiveHandler.prototype.updatePositionOnLiveDurationChange=function(){i._cmpModel.mediaInfo.isLive}}var Annotation,AudioTrack,FrameInfo,markerIds,selectorClick,MarkerLayer,ImageInfo,ImageMetadata,ImageInfoCollection,MediaSourceInfo,ErrorHashTable,swfobject;(function(){function n(n,t){t=t||{bubbles:!1,cancelable:!1,detail:undefined};var i=document.createEvent("CustomEvent");return i.initCustomEvent(n,t.bubbles,t.cancelable,t.detail),i}n.prototype=window.Event.prototype;window.CustomEvent=n})();APIWrapper.prototype.onBrkStructureLoadComplete=function(){if($("BreakStructureContainer")){createCMPInstance("BreakStructureContainer");var n=$("close1").getAttribute("onclick"),n='savePlayerViewedStateToPreference("BreakStructureContainer");disposeCMPInstance("BreakStructureContainer");'+n;$("close1").setAttribute("onclick",n);document.getElementById($("BreakStructureContainer").value).addEventListener(AnnotationEvent.SEGMENT_ANNOTATION_CREATED,this.onBrkStructureSegmentCreated)}initializeBrkStructure()};CMPUtils.getVersionUrl=function(n,t){var r=document.getElementById(n+"_playerInitInfo").value,i=JSON.parse(decodeURIComponent(escape(atob(r)))).Version;return t.match(/[?]/)?t+"&v="+i:t+"?v="+i};CMPUtils.getNativePlayerAPIObject=function(n,t){switch(n){case"OSMF":return new OSMFNativePlayerAPI(t);default:throw"Exception";}};CMPUtils.addFramesToTime=function(n,t,i){return t+n*(1/i)};CMPUtils.stopPropagation=function(n,t){$(n).on(t,function(n){return n.stopPropagation(),!1})};CMPUtils.RoundOffToNearestFrame=function(n,t){var i=1/t,e=n*1e3,u=n*t,f=(u-parseInt(u))*i*1e3,r=n-f/1e3;return n-r>i/2?parseFloat((r+i).toFixed(6)):parseFloat(r.toFixed(6))};CMPUtils.RoundOffToNearestFrameWithMilliSecs=function(n,t){var i=1/t,r=n/1e3,f=r*t,e=(f-parseInt(f))*i*1e3,u=r-e/1e3;return r-u>i/2?parseFloat(((u+i)*1e3).toFixed(6)):parseFloat((u*1e3).toFixed(6))};CMPUtils.ConvertTimeCodeToSecs=function(n,t,i){var r=CMPUtils.ConvertTimeCodeToFrameCount(n,t,i);return CMPUtils.RoundOffToNearestFrame(r*(1/parseFloat(t)),t)};CMPUtils.ConvertTimeCodeToMilliseconds=function(n,t,i){return CMPUtils.RoundOffToNearestFrameWithMilliSecs(CMPUtils.ConvertTimeCodeToSecs(n,t,i)*1e3,t)};CMPUtils.getSegmentsForClip=function(n,t){for(var r=[],i=0;i<n.segments.length;i++)n.segments[i].clipOrderId===t&&r.push(n.segments[i]);return r};CMPUtils.getSegmentForSegmentUidFromSequence=function(n,t){for(var i=0;i<n.segments.length;i++)if(n.segments[i].uiId===t)return n.segments[i];return null};CMPUtils.getFirstSegmentForClip=function(n,t){for(var i=0;i<n.segments.length;i++)if(n.segments[i].clipOrderId===t)return n.segments[i];return null};CMPUtils.ConvertTimeCodeToFrameCount=function(n,t,i){var e=0;t=parseFloat(t);var u=n.split(new RegExp(":|;","g")),f=Math.round(t),r=Number(u[0])*3600*f;return r+=Number(u[1])*60*f,r+=Number(u[2])*f,r+=Number(u[3]),i==""||i==null||i.toUpperCase()!="DF"||(e=CMPUtils.ComputeDFOffsetFromDFframeCount(r,t)),r-e};CMPUtils.ConvertFrameCountToTimeCode=function(n,t,i){var h,o;n=Math.round(n);t=parseFloat(t);h=Math.round(t*3600);o=h*24;n<0&&(n=o+n);n=n%o;i==""||i==null||i.toUpperCase()!="DF"||(n+=CMPUtils.ComputeDFOffsetFromNDFframeCount(n,t));var r=Math.round(t),f=3600*r,c=60*r,u=Math.floor(n/f),e=Math.floor((n-u*f)/(60*r)),s=Math.floor((n-u*f-e*c)/r),l=Math.round(n-u*f-e*c-s*r);return!(i==""||i==null)&&i.toUpperCase()=="DF"?CMPUtils.zeroPad(u,2)+";"+CMPUtils.zeroPad(e,2)+";"+CMPUtils.zeroPad(s,2)+";"+CMPUtils.zeroPad(l,2):CMPUtils.zeroPad(u,2)+":"+CMPUtils.zeroPad(e,2)+":"+CMPUtils.zeroPad(s,2)+":"+CMPUtils.zeroPad(l,2)};CMPUtils.ConvertSecondsToTimeCode=function(n,t,i){var r=n*t;return CMPUtils.ConvertFrameCountToTimeCode(r,t,i)};CMPUtils.ConvertSecondsToTimeCodeHHMMSS=function(n,t,i){var u=n*t,f=CMPUtils.ConvertFrameCountToTimeCode(u,t,i),r=CMPUtils.GetTimeCodeInParts(f);return CMPUtils.zeroPad(r[0],2)+":"+CMPUtils.zeroPad(r[1],2)+":"+CMPUtils.zeroPad(r[2],2)};CMPUtils.ConvertMillisecondsToTimeCode=function(n,t,i){var r=n/1e3;return CMPUtils.ConvertSecondsToTimeCode(r,t,i)};CMPUtils.convertSecondsToFrameCount=function(n,t){return Math.round(n*Math.round(t))};CMPUtils.ConvertSecondsToTCFormat=function(n){var t=n*1e3,i=parseInt(t%1e3),n=parseInt(t/1e3%60),r=parseInt(t/6e4%60),u=parseInt(t/36e5%24);return CMPUtils.zeroPad(u,2)+":"+CMPUtils.zeroPad(r,2)+":"+CMPUtils.zeroPad(n,2)+"."+CMPUtils.zeroPad(i,3)};CMPUtils.GetTimeCodeInParts=function(n){return n.split(new RegExp(":|;","g"))};CMPUtils.StringToXML=function(n){if(typeof n=="undefined"&&(n=""),window.ActiveXObject){var t=new ActiveXObject("Microsoft.XMLDOM");return t.loadXML(n),t}return(new DOMParser).parseFromString(n,"text/xml")};CMPUtils.zeroPad=function(n,t){for(var i=""+n;i.length<t;)i="0"+i;return i};CMPUtils.AddTimeCodes=function(n,t,i,r){var u=CMPUtils.ConvertTimeCodeToFrameCount(n,i,r),f=CMPUtils.ConvertTimeCodeToFrameCount(t,i,r);return CMPUtils.ConvertFrameCountToTimeCode(u+f,i,r)};CMPUtils.ConvertSecondToMMSSFormate=function(n){var t=n*1e3,i=Math.floor(t/6e4),r=Math.floor(t%6e4/1e3);return CMPUtils.zeroPad(i,2)+":"+CMPUtils.zeroPad(r,2)};CMPUtils.CalculatePercentage=function(n,t){return parseFloat(n)*parseInt(100)/parseFloat(t)};CMPUtils.ComputeDFOffsetFromDFframeCount=function(n,t){var r=Math.round(t*.066666),t=Math.round(t),i=Math.floor(n/t/60),u=r*(i-Math.floor(i/10));return Math.round(u)};CMPUtils.ComputeDFOffsetFromNDFframeCount=function(n,t){var i=Math.round(t*.066666),r=Math.round(t*600),u=Math.round(t)*60-i;return d=Math.floor(n/r),m=n%r,m>i?i*9*d+i*Math.floor((m-i)/u):i*9*d};CMPUtils.setDictionaryData=function(n,t,i){n[t]=i};CMPUtils.getDictionaryData=function(n,t){return n[t]};CMPUtils.getSequenceClipInfoObjectWithClipUiId=function(n,t){for(var i=0;i<t.length;i++)if(t[i].clipUiId==n)return t[i]};CMPUtils.getClipObjectWithClipUiId=function(n,t,i){for(var u,r=0;r<i.length;r++)if(i[r].clipUiId==n)for(u=0;u<t.length;u++)if(i[r].clipId==t[u].id)return t[u]};CMPUtils.getAllSegmentsObjectsWithClipUiId=function(n,t){for(var r=[],i=0;i<t.length;i++)t[i].clipOrderId==n&&r.push(t[i]);return r};CMPUtils.getAllScreenshotsWithClipUiId=function(n,t){for(var r=[],i=0;i<t.length;i++)t[i].clipOrderId==n&&r.push(t[i]);return r};CMPUtils.getClipOrderIdWithClipId=function(n,t){for(var i=0;i<t.length;i++)if(t[i].clipId==n)return t[i].clipUiId};CMPUtils.getClipObjectWithClipId=function(n,t){for(var i=0;i<t.length;i++)if(n==t[i].id)return t[i]};CMPUtils.getSegmentBasedOnPosition=function(n,t){for(var i=0;i<n.segments.length;i++)if(n.segments[i].position==t)return n.segments[i]};CMPUtils.removeImplictSegmentFromSegmentsArray=function(n,t){for(var r=t,u="",i=0;i<r.length;i++)if(r[i].clipOrderId==n&&r[i].implictSegment==!0){u=i;break}return CMPUtils.IsNullOrEmpty(u.toString())||t.splice(u,1),t};CMPUtils.IsNullOrEmpty=function(n){try{return n==null||n==undefined||n===""||n.length==0}catch(t){return console.log(t),!0}};CMPUtils.GetDivsComputedStyleWidth=function(n){return parseInt(window.getComputedStyle(document.getElementById(n)).width.replace("px",""))};CMPUtils.getFormattedTitle=function(n){return n.length>15?n.substring(0,15)+"...":n};CMPUtils.GetDivsComputedStyleHeight=function(n){return parseInt(window.getComputedStyle(document.getElementById(n)).height.replace("px",""))};CMPUtils.ValidateSegmentTimeCode=function(n,t,i,r,u,f){var e=i.split(":"),o=r.split(":"),s=CMPUtils.ConvertTimeCodeToSecs(i,u,f),h=CMPUtils.ConvertTimeCodeToSecs(r,u,f);if(i==""||r=="")return"Invaild Time code";if(e[0].length==2&&e[1].length==2&&e[1]<=59&&e[2].length==2&&e[2]<=59&&e[3].length==2&&e[3]<Math.round(u))if(o[0].length==2&&o[1].length==2&&o[1]<=59&&o[2].length==2&&o[2]<=59&&o[3].length==2&&o[3]<Math.round(u)){if(s<n)return"TCR IN is lesser than video start time.";if(s>=t)return"TCR IN is greater than or equal to video end time.";if(s>=h)return"TC IN is greater than or equal to TC OUT end time.";if(h>t)return"TCR OUT is greater than video end time.";if(h<=n)return"TCR OUT is lesser than video start time."}else return"Invaild TcOut Timecode";else return"Invaild TcIn Timecode";return""};CMPUtils.timeCodeKeyDownValidate=function(n){var t,i,r=n.target;if(window.event)t=window.event.keyCode;else if(n)t=n.which;else return!0;return(i=String.fromCharCode(t),t==null||t==0||t==9||t==13||t==27)?!0:t==8?CMPUtils.fixTimeCodeFormatOnBackSpace(r):t>34&&t<41||t==46||t==9?!0:"0123456789".indexOf(i)>-1?CMPUtils.fixTimeCodeFormatWhileTyping(r):!1};CMPUtils.fixTimeCodeFormatWhileTyping=function(n){if(n.value.length==11)return!1;switch(n.value.length){case 2:n.value=n.value+":";break;case 5:n.value=n.value+":";break;case 8:n.value=n.value+":"}return!0};CMPUtils.fixTimeCodeFormatOnBackSpace=function(n){var i=n.value.length,t=n.value.slice(0,i-1);return t.lastIndexOf(":")==t.length-1&&(n.value=t),!0};CMPUtils.getElementsByAttribute=function(n,t){for(var u=[],r=document.getElementsByTagName("*"),f=r.length,i=0;i<f;i++)r[i].hasAttribute(n)&&(t?r[i].getAttribute(n)===t&&u.push(r[i]):u.push(r[i]));return u};CMPUtils.convertStringToXml=function(n){return(new XMLSerializer).serializeToString(n)};CMPUtils.XmlToString=function(n){return window.ActiveXObject?n.xml:(new XMLSerializer).serializeToString(n)};CMPUtils.getXmlNodeValue=function(n){return CMPUtils.IsNullOrEmpty(n.childNodes[0])?"":n.childNodes[0].nodeValue};CMPUtils.IsVisible=function(n){var t=document.getElementById(n);return CMPUtils.IsNullOrEmpty(t)?!1:t.style.display!="none"?!0:!1};CMPUtils.addNodeToXmlDoc=function(n,t,i,r){var f=n.createElement(t),u;return i!=""&&i!=undefined?(u="",u=CMPUtils.IsNullOrEmpty(r)||r.toString()!="true"?n.createTextNode(i):n.createCDATASection(i),f.appendChild(u)):(i=="0"||i==0)&&(u="",u=CMPUtils.IsNullOrEmpty(r)||r.toString()!="true"?n.createTextNode(i):n.createCDATASection(i),f.appendChild(u)),f};CMPUtils.generateRandomGuidId=function(){var n=(new Date).getTime();return"xxxxxxxx-xxxx-xxxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(t=="x"?i:i&3|8).toString(16)})};CMPUtils.isEmbeddedAudioTrackSelectionAllowed=function(n){return CMPUtils.isEmbeddedAudioTrackConfigured(n)&&CMPUtils.isOperatingSystemAndBrowserSupported(n)?!0:!1};CMPUtils.isEmbeddedAudioTrackConfigured=function(n){var t=n.EnableEmbeddedAudioTracks;return t!=null&&t=="true"?!0:!1};CMPUtils.isOperatingSystemAndBrowserSupported=function(n){var r=n.EmbeddedAudioTrackSupportedPlatform.split("|"),u=navigator.appVersion,t,i;if(r.length>0)for(t=0;t<r.length;t++)if(i=r[t].split(";"),i[0]!=""&&u.indexOf(i[0])!=-1&&u.indexOf(i[1])!=-1)return!0;return!1};CMPUtils.isIEBrowser=function(){return navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Edge/")>-1||navigator.userAgent.indexOf("Trident")>-1};CMPUtils.isJsFileLoaded=function(n){var t=jQuery('script[src*="'+n+'"]');return t.length==0?!1:!0};CMPUtils.getAspectRatio=function(n,t){var i=CMPUtils.getGCD(n,t);return""+n/i+":"+t/i};CMPUtils.getGCD=function(n,t){return t==0?n:CMPUtils.getGCD(t,n%t)};CMPUtils.isEven=function(n){return n%2==0?!0:!1};CMPUtils.getPlayerDefinition=function(n){for(var t=0;t<n.MediaInfo.length;t++)if(n.MediaInfo[t].Name=="FrameSize")return Number(n.MediaInfo[t].Value.split("x")[1])>=1080?"FHD":Number(n.MediaInfo[t].Value.split("x")[1])>=720?"HD":"SD"};CMPUtils.addMediaInfo=function(n,t,i,r){return{Name:n,DisplayName:t,Value:i,DisplayOrder:r}};CMPUtils.parseURL=function(n){var t=document.createElement("a");return t.href=n,t};CMPUtils.parseQueryString=function(n,t){var s=n.substring(n.indexOf("?")+1),e={},u,f,i,o,r;for(u=s.split("&"),i=0,o=u.length;i<o;i++)f=u[i].split("="),r=f[0],t&&(r=r.toLowerCase()),e[r]=f[1];return e};CMPUtils.getPlaybackDirection=function(n,t){return n[t]>0?"forward":"reverse"};CMPUtils.getDefaultSpeedIndex=function(n){for(var t=0;t<n.length;t++)if(n[t]==1)return t};CMPUtils.getAllClipObjectsAssociatedWithSequence=function(n,t){for(var r,u=[],i=0;i<n.length;i++)for(r=0;r<t.length;r++)if(n[i].id==t[r].clipId){u.push(n[i]);break}return u};CMPUtils.getAllClipsFramerate=function(n,t){for(var r=[],u=CMPUtils.getAllClipObjectsAssociatedWithSequence(n,t),i=0;i<u.length;i++)r.push(u[i].frameRate);return r.join()};CMPUtils.convertDegeesToRadians=function(n){return n/180*Math.PI};CMPUtils.convertRadiansToDegrees=function(n){return n*180/Math.PI};CMPUtils.getWidthBasedOnFontSizeAndAngle=function(n,t,i,r){var u,f,e,o;return(u=Math.abs(this.convertRadiansToDegrees(Math.atan(t/2/(i/2)))),f=180-u,e=180+u,o=360-u,n<u||n>f&&n<e||n>o)?r*(i/Math.abs(Math.cos(this.convertDegeesToRadians(n)))):n>u&&n<f||n>e&&n<o?r*(t/Math.abs(Math.sin(this.convertDegeesToRadians(n)))):0};CMPUtils.getClearEditorProjectObject=function(n,t){var w=$jq.parseXML(n),v=$jq(w),b=v.find("Sequence"),s=new ClearEditorProject,f=[],u=[],h=[],c=CMPUtils.setSequenceProperties(b,t),i=v.find("Clip"),l={},a=[],e,p,o;for(index=0;index<i.length;index++){var k=i[index],r=null,y=null;if(CMPUtils.getDictionaryData(l,i.find("ClipId").eq(index).text())==undefined&&(r=CMPUtils.setClipProperties(i.eq(index)),CMPUtils.setDictionaryData(l,r.id,r)),r==null?r=CMPUtils.getDictionaryData(l,i.find("ClipId").eq(index).text()):f.push(r),y=CMPUtils.setSequenceClipInfo(i.eq(index)),a.push(y),e=i.eq(index).find("Segment"),e.length==0)u.push(CMPUtils.setClipAsSegment(r,i.find("ClipUIId").eq(index).text()));else for(segmentIndex=0;segmentIndex<e.length;segmentIndex++)p=CMPUtils.setSegmentProperties(i.find("ClipUIId").eq(index).text(),r,e.eq(segmentIndex)),u.push(p);h=CMPUtils.setScreenshots(i.eq(index),h)}return CMPUtils.setSegmentPosition(u,f,a),CMPUtils.calculateSegmentTimeInSequence(u),c.segments=u,c.screenshots=h,f.length>0&&(s.bin=CMPUtils.setSequenceBin(f)),s.sequence=c,o=[],o.push(s),o.push(a),o};CMPUtils.calculateSegmentTimeInSequence=function(n){var i=0,t=0;for(segmentPosition=1;segmentPosition<=n.length;segmentPosition++)for(t!=undefined&&t!=0&&(i=t),segmentIndex=0;segmentIndex<n.length;segmentIndex++)n[segmentIndex].position==segmentPosition&&(t=i+(parseFloat(n[segmentIndex].endTime)-parseFloat(n[segmentIndex].startTime)),n[segmentIndex].startTimeInSequence=i,n[segmentIndex].endTimeInSequence=t)};CMPUtils.setSequenceBin=function(n){var t=new Bin;return t.clips=n,t};CMPUtils.setSegmentPosition=function(n,t,i){var o=0,r=[],f=i,u,e;for(f.sort(function(n,t){return n._position-t._position}),u=0;u<f.length;u++)e=CMPUtils.getAllSegmentsObjectsWithClipUiId(f[u].clipUiId,n),CMPUtils.IsNullOrEmpty(e)||(r=r.concat(CMPUtils.orderClipSegmentsInSequence(e,o)),o=r[r.length-1].position);n.sort(function(n,t){return n._position-t._position})};CMPUtils.orderClipSegmentsInSequence=function(n,t){for(n.sort(sort_basedOnSegmentInOut),segmentIndex=0;segmentIndex<n.length;segmentIndex++)n[segmentIndex].position=t+1,t++;return n};CMPUtils.setClipPosition=function(n){for(var t=0;t<n.length;t++)n[t].position=t+1;return n};CMPUtils.setClipAsSegment=function(n,t){var i=new Segment;return i.id="",i.uiId=CMPUtils.generateRandomGuidId(),i.startTime=n.startTime,i.endTime=n.endTime,i.editType="",i.trackType="",i.title=n.title,i.comments="",i.clipOrderId=t,i.implictSegment=!0,i};CMPUtils.setClipProperties=function(n){var t=null,i=new SequenceClipInfo;return t=new Clip,CMPUtils.IsNullOrEmpty(n.find("ClipId").text())||(t.id=n.find("ClipId").text()),CMPUtils.IsNullOrEmpty(n.find("ClipReelId").text())||(t.reelId=n.find("ClipReelId").text()),CMPUtils.IsNullOrEmpty(n.find("ClipTitle").text())||(t.title=n.find("ClipTitle").text()),CMPUtils.IsNullOrEmpty(n.find("ClipHighResFileName").text())||(t.highResFileName=n.find("ClipHighResFileName").text()),CMPUtils.IsNullOrEmpty(n.find("ClipSrc").text())||(t.url=n.find("ClipSrc").text()),CMPUtils.IsNullOrEmpty(n.find("ClipThumbnail").text())||(t.thumbnailUrl=n.find("ClipThumbnail").text()),CMPUtils.IsNullOrEmpty(n.find("ClipStartTime").text())||(t.startTime=CMPUtils.RoundOffToNearestFrame(n.find("ClipStartTime").text(),n.find("ClipFrameRate").text())),CMPUtils.IsNullOrEmpty(n.find("ClipEndTime").text())||(t.endTime=CMPUtils.RoundOffToNearestFrame(n.find("ClipEndTime").text(),n.find("ClipFrameRate").text())),CMPUtils.IsNullOrEmpty(n.find("ClipDuration").text())||(t.duration=n.find("ClipDuration").text()),CMPUtils.IsNullOrEmpty(n.find("ClipStartOfMedia").text())||(t.startOfMedia=n.find("ClipStartOfMedia").text()),CMPUtils.IsNullOrEmpty(n.find("ClipModDuration").text())||(t.totalSegmentDuration=CMPUtils.RoundOffToNearestFrame(n.find("ClipModDuration").text(),n.find("ClipFrameRate").text())),CMPUtils.IsNullOrEmpty(n.find("ClipFrameRate").text())||(t.frameRate=n.find("ClipFrameRate").text()),t};CMPUtils.setSequenceClipInfo=function(n){var t=new SequenceClipInfo;return CMPUtils.IsNullOrEmpty(n.find("ClipId").text())||(t.clipId=n.find("ClipId").text()),CMPUtils.IsNullOrEmpty(n.find("ClipUIId").text())||(t.clipUiId=n.find("ClipUIId").text()),CMPUtils.IsNullOrEmpty(n.find("ClipPos").text())||(t.position=n.find("ClipPos").text()),t};CMPUtils.setSegmentProperties=function(n,t,i){var r=new Segment;return CMPUtils.IsNullOrEmpty(i.find("SegmentUIId").text())||(r.uiId=i.find("SegmentUIId").text()),CMPUtils.IsNullOrEmpty(i.find("SegmentStartTime").text())||(r.startTime=CMPUtils.RoundOffToNearestFrame(i.find("SegmentStartTime").text(),t.frameRate)),CMPUtils.IsNullOrEmpty(i.find("SegmentEndTime").text())||(r.endTime=CMPUtils.RoundOffToNearestFrame(i.find("SegmentEndTime").text(),t.frameRate)),CMPUtils.IsNullOrEmpty(i.find("SegmentEditType").text())||(r.editType=i.find("SegmentEditType").text()),CMPUtils.IsNullOrEmpty(i.find("SegmentTrackType").text())||(r.trackType=i.find("SegmentTrackType").text()),CMPUtils.IsNullOrEmpty(i.find("SegmentComments").text())||(r.comments=i.find("SegmentComments").text()),CMPUtils.IsNullOrEmpty(i.find("SegmentTitle").text())||(r.title=i.find("SegmentTitle").text()),r.thumbnailUrl=t.thumbnailUrl,r.clipOrderId=n,r.implictSegment=!1,r};CMPUtils.setSequenceProperties=function(n,t){var i=new Sequence;return CMPUtils.IsNullOrEmpty(n.eq(0).find("SequenceId").text())||(i.id=n.eq(0).find("SequenceId").text()),CMPUtils.IsNullOrEmpty(n.eq(0).find("SequenceTitle").text())||(i.title=n.eq(0).find("SequenceTitle").text()),CMPUtils.IsNullOrEmpty(n.eq(0).find("SequenceFrameRate").text())||(i.frameRate=n.eq(0).find("SequenceFrameRate").text()),CMPUtils.IsNullOrEmpty(n.eq(0).find("SequenceSom").text())||(i.sequenceSom=n.eq(0).find("SequenceSom").text(),t.defaultSequenceSom=n.eq(0).find("SequenceSom").text()),CMPUtils.IsNullOrEmpty(n.eq(0).find("Operation").text())||(t.sequenceOperation=n.eq(0).find("Operation").text()),CMPUtils.IsNullOrEmpty(n.eq(0).find("Action").text())||(t.sequenceAction=n.eq(0).find("Action").text()),CMPUtils.IsNullOrEmpty(n.eq(0).find("Target").text())||(t.sequenceTarget=n.eq(0).find("Target").text()),CMPUtils.IsNullOrEmpty(n.eq(0).find("Status").text())||(t.sequenceStatus=n.eq(0).find("Status").text()),CMPUtils.IsNullOrEmpty(n.eq(0).find("OfflineSave").text())||(t.sequenceOfflineSave=n.eq(0).find("OfflineSave").text()),i};CMPUtils.setScreenshots=function(n,t){var u,i,r;if(n.find("Screenshots")[0]!=undefined&&n.find("Screenshots")[0].childNodes[0]!=undefined)for(u=n.find("Screenshots").eq(0).find("Screenshot"),i=0;i<u.length;i++)r=new ScreenShot,r.id=u.eq(i).find("ScreenshotId").text(),r.captureTimeSecs=CMPUtils.RoundOffToNearestFrame(u.eq(i).find("ScreenshotCaptureTimeSecs").text(),n.find("ClipFrameRate").text()),r.selected=u.eq(i).find("ScreenshotSelected").text(),r.clipOrderId=n.find("ClipUIId").text(),r.thumbnailUrl=n.find("ClipThumbnail").text(),CMPUtils.IsNullOrEmpty(u.eq(i).find("ScreenshotDataUri").text())||(r.dataUri=u.eq(i).find("ScreenshotDataUri").text()),t.push(r);return t};CMPUtils.getClipObjectOnSequenceTime=function(n,t,i){var u,r;for(segmentIndex=0;segmentIndex<t.sequence.segments.length;segmentIndex++)r=t.sequence.segments[segmentIndex],n>=r.startTimeInSequence&&n<r.endTimeInSequence&&(u=r.clipOrderId);return CMPUtils.IsNullOrEmpty(u)?null:CMPUtils.getClipObjectWithClipUiId(u,t.bin.clips,i)};CMPUtils.getTimeWithoutSomInSec=function(n,t){return t>0&&(n<t?n=n+86400-t:n-=t),n};CMPUtils.getViewPortElement=function(n){return document.getElementById(n+"_ClearMediaPlayer").parentElement};CMPUtils.getSliderElement=function(n){switch(n){case"CMP_AlbumViewerInstance":case"CMP_AlbumViewerPreviewInstance":case"CMP_SmartPlayerInstance":return n+"_sliderWrapper";default:return n+"_slider"}};CMPUtils.calculateBitRate=function(n){var t,i;return n>=1e6?(t=n/1e6,i=Math.round(t*10)/10+" Mbit/s",i):n>=1e3?(t=n/1e3,i=Math.round(t*10)/10+" kbit/s",i):n<1e3?n+" bit/s":n};CMPUtils.getPropertyValue=function(n,t){return CMPUtils.IsNullOrEmpty(n)?t:n};CMPUtils.isMAC={Mac:function(){return navigator.userAgent.match(/Macintosh/i)},any:function(){return isMAC.Mac()!=null?!0:!1}};CMPEvent=function(){var n={};return n.UI_EVENT="uiEvent",n.NP_EVENT="npEvent",n.CMP_EVENT="cmpEvent",n.STATE_CHANGE_EVENT="scEvent",n.SET_CMP_STATE_EVENT="setCmpStateEvent",n}();NativeEvent=function(){var n={};return n.ON_PLAYER_STATE_CHANGE="onPlayerStateChange",n.ON_SEEK_COMPLETED="onSeekCompleted",n.ON_MOUSE_MOVE="onStageMouseMove",n.ON_NONAV_PRE_LOAD_READY="onNonAvPreLoadReady",n.ON_NONAV_READY="onNonAvReady",n.ON_MEDIA_ERROR="onErrorOccurence",n.ON_PLAYER_ERROR="onPlayerError",n}();LoadEvent=function(){var n={};return n.SET_MEDIA_SOURCE="setMediaSource",n.SET_MEDIA_DURATION="setMediaDuration",n.LOAD_SEGMENT="loadSegment",n.LOAD_SEGMENT_BASED_ON_SEGMENTUIID="loadSegmentBasedOnSegmentUiId",n.LOAD_URL="loadUrl",n.SET_SECURE_INFO="setSecureInfo",n.LOAD_ANNOTATIONS="loadAnnotations",n.LOAD_RANGE_MARKER="loadRangeMarkers",n.LOAD_MARKER_ON_VIDEO_READY="loadMarkerOnVideoReady",n.LOAD_MARKERS="loadMarker",n.PLAYER_INITIALIZED="playerInitialized",n.CMP_INITIALISED="cmpInitialised",n.SHOW_ANNOTATION_MENU="showAnnotationMenu",n.UNLOAD_MEDIA_URL="unloadMediaUrl",n.CMP_READY="cmpReady",n.GET_MEDIAINFO="getMediaInfo",n.LOAD_CATALOG_SEGMENT="loadCatalogSegment",n}();TransportEvent=function(){var n={};return n.PLAY="play",n.PAUSE="pause",n.PLAYPAUSE="playPause",n.STOP="stop",n.SEEK="seek",n.SEEK_TO_LIVE="seekToLive",n.FRAME_FORWARD="frameForward",n.FRAME_BACKWARD="frameBackward",n.SECOND_FORWARD="secondForward",n.SECOND_BACKWARD="secondBackward",n.MINUTE_FORWARD="minuteForward",n.MINUTE_BACKWARD="minuteBackward",n.PLAY_FORWARD="playForward",n.PLAY_BACKWARD="playBackward",n.FULLSCREEN="fullScreen",n.TIME_CHANGE="timeChange",n.PLAYBACK_SPEED_CHANGE="playbackSpeedChange",n.RESET_PLAYBACK_SPEED="resetplaybackspeed",n.PAUSE_SUCCESS="pauseSuccess",n.PLAY_SUCCESS="playSuccess",n.STOP_SUCCESS="stopSuccess",n.SET_LAST_PLAYBACK_TIME="setLastPlayBackTime",n.BUFFERING="buffering",n.BUFFERING_SUCCESS="bufferingSuccess",n.HELPSCREEN="helpScreen",n.SHOW_PLAY_OVERLAY="playOverlay",n.HIDE_PLAY_OVERLAY="hidePlayOverLay",n.SHOW_PAUSE_OVERLAY="showPauseOverlay",n.HIDE_PAUSE_OVERLAY="hidePauseOverlay",n.HIDE_PLAY_BACK_OVERLAY="hidePlayBackOverlay",n.SHOW_HIDE_SPEED_CONTROLS="showHideSpeedControls",n.CAPTURE_FRAME="captureFrame",n.TOGGLE_UI_CONTROL_VISIBILITY="toggleUIControlVisibility",n.SHOW_HIDE_CONTROLS="showHideControls",n.DISABLE_SCREEN_CAPTURE="disableScreenCapture",n.ENABLE_SCREEN_CAPTURE="enableScreenCapture",n.SET_ACCUMULATE_TIME="setAccumulatedTime",n.DISABLE_SEEKBAR_UPDATE="disableSeekBarUpdate",n.ENABLE_SEEKBAR_UPDATE="enableSeekBarUpdate",n.WATERMARKING_FONTSIZE_HANDLING_ON_FULLSCREEN_TOGGLE="waterMarkingFontSizeHandlingOnFullScreenToggle",n.NON_AV_BUFFERING="nonAvBuffering",n.NON_AV_BUFFERING_SUCCESS="nonAvBufferingSuccess",n.REBUILD_HELPSCREEN="rebuildHelpScreen",n.DRAG_START="dragStart",n.DRAG_STOP="dragStop",n.SET_PIN_CONTROL_VALUE="setPinControlValue",n.SET_TAKE_OR_TOTAL_CONTROL_VALUE="setTakeOrTotalControlValue",n}();AudioEvent=function(){var n={};return n.BIND_EXTERNAL_AUDIO_TRACKS="bindExternalAudioTracks",n.BIND_AUDIO_TRACKS="bindAudioTracks",n.SWITCH_AUDIO_TRACKS="switchAudioTracks",n.SET_VOLUME="setVolume",n.SET_TRACK_VOLUME="setTrackVolume",n.MUTE_VOLUME="muteVolume",n.UNMUTE_VOLUME="unmuteVolume",n.AUDIO_TRACK_SWITCHED="audioTracksSwitched",n.CHANGE_AUDIO_TRACK="changeAudioTrack",n.ADD_EMBEDDED_AUDIO_TRACKS="addEmbeddedAudioTracks",n}();TTTEvent=function(){var n={};return n.SHOW_TIMEDTEXT="showTimedText",n.ON_TRACK_CHANGED="onTrackChanged",n.BIND_TIMED_TEXT_TRACKS="BindTimedTextTracks",n.SELECT_DEFAULT_TIMEDTEXT_TRACK="SelectDefaultTimedTextTrack",n.CHECK_FILE_TYPE="CheckFileType",n.CHANGE_FONT_SIZE="changeFontSize",n.CHANGE_SUBTITLE_SETTING_POSITION="changeSubtitleSettingUptoYPosition",n.CHANGE_TEXT_COLOR="changeFontColor",n.SET_SUBTITLE_BUTTON_VISIBILITY="setSubtitleButtonVisibility",n.CALCULATE_FONT_SIZE="calculateFontSize",n.DISPLAY_TIMED_TEXT="displayTimedText",n.UPDATE_TIMED_TEXT_POSITION="updateTimedTextPosition",n.RESET_TTT_INFO="resetTTTInfo",n.SET_TTT_INFO_ON_TOGGLE_FULLSCREEN="setTTTInfoOnToggleFullscreen",n.GET_TIMEDTEXT_DATA="getTimedTextDataObject",n.ADD_TIMEDTEXT_DATA_OBJECT="addTimedTextDataObject",n.UPDATE_TIMEDTEXT_DATA_OBJECT="updateTimedTextDataObject",n.DELETE_TIMEDTEXT_DATA_OBJECT="deleteTimedTextDataObject",n.REINDEX_TIMEDTEXT_DATA_OBJECT="reindexTimedTextDataObject",n.TOGGLE_CUSTOM_TIMEDTEXT_MODE="toggleCustomTimedTextTrackMode",n.TOGGLE_TIMEDTEXT_EDIT_MODE="toggleTimedTextTrackEditMode",n}();TimerEvent=function(){var n={};return n.TIMER="timer",n.SLIDER_TIMER="sliderTimer",n.TEMP_TIMER="tempTimer",n.CLEAR_TIMER="clearTimer",n}();TimelineMetadataEvent=function(){var n={};return n.MARKER_TIME_REACHED="markerTimeReached",n.MARKER_DURATION_REACHED="markerDurationReached",n.RESET_TIMELINE_METADATA="resetTimelinemetadata",n}();PlaylistMetadataEvent=function(){var n={};return n.PLAYLIST_MARKER_TIME_REACHED="playlistMarkerTimeReached",n.PLAYLIST_MARKER_DURATION_REACHED="playlistMarkerDurationReached",n}();SeekBarEvent=function(){var n={};return n.LOAD_SEEKBAR="loadSeekBar",n.ON_DRAG_SEEKBAR="onDargSeekBar",n.TIME_CHANGE="timeChange",n.ON_MOUSE_DOWN="onMouseDown",n.ON_MOUSE_UP="onMouseUp",n.SEEK_TO_MARKPOSITION="seekToMarkPosition",n}();SeekEvent=function(){var n={};return n.SEEK_COMPLETED="seekCompleted",n.NAVIGATE_TO_PREVIOUS_TCIN="navigateToPreviousTcIn",n.NAVIGATE_TO_NEXT_TCIN="navigateToNextTcIn",n}();MarkerEvent=function(){var n={};return n.CREATE_MARKER="createMarker",n.UPDATE_MARKER="updateMarker",n.REMOVE_MARKER="removeMarker",n.ADD_MARKERVALUES="addMarkerValues",n.RENDER_MARKERCANVAS="renderMarkerCanvas",n.FILTER_MARKERCANVAS="filterMarkerCanvas",n.Set_MarkerPosition="setMarkerPosition",n.UPDATE_MARKERVALUES="updateMarkerValues",n.UPDATE_MARKERCANVAS="updateMarkerCanvas",n.UPDATE_MARKERCANVASCOMMENT="updateMarkerCanvasComment",n.SELECT_MARKER_CANVAS="selectMarkerCanvas",n.ADD_MARKER_LAYER="addMarkerLayer",n.BUILD_MARKER_LAYER_DD="buildMarkerLayerDD",n.ON_MARKER_LAYER_CHANGE="onMarkerLayerChange",n.VALIDATE_MARKER_LAYER_CHANGE="validateMarkerLayerChange",n.NAVIGATE_TO_MARKER_POSITION="navigateToMarkerPosition",n.BUILD_MARKER_LAYER="buildMarkerLayer",n.ADD_OR_UPDATE_MARKER="addOrUpdateMarker",n.ON_ADD_OR_UPDATE_MARKER="onAddMarkerInUi",n.DELETE_MARKER="deleteMarker",n.ON_DELETE_MARKER="onDeleteMarker",n.ADD_MARKER="addMarkerEvent",n.ENABLE_ADDMARKER="enableAddMarker",n.SHOW_MARKER_ON_SEGMENT="showMarkerOnSegment",n.HIDE_MARKER_ON_SEGMENT="hideMarkerOnSegment",n.LOAD_MARKER_LAYER="loadMarkerLayer",n.ADD_OR_UPDATE_MARKERS_TO_TIMELINE="addOrUpdateMarkersToTimeline",n.DELETE_MARKERS_TO_TIMELINE="deleteMarkersFromTimeline",n.CLEAR_MARKERS_TO_TIMELINE="clearMarkersToTimeline",n}();ConfigurationEvent=function(){var n={};return n.SET_CONFIGURATION="displayUiElements",n.RESET_UI_CONTROLS="resetUiControls",n}();AnnotationEvent=function(){var n={};return n.POINT_ANNOTATION="pointAnnotation",n.POINT_ANNOTATION_CREATED="pointAnnotationCreated",n.MARK_IN="markIn",n.MARK_OUT="markOut",n.SEGMENT_ANNOTATION_CREATED="segmentAnnotationCreated",n.DISABLE_MARKIN="disableMarkIn",n.ENABLE_MARKIN="enableMarkIn",n.DISABLE_MARKOUT="disableMarkOut",n.ENABLE_MARKOUT="enableMarkOut",n.DISABLE_CLEARMARKER="disableClearMarker",n.ENABLE_CLEARMARKER="enableClearMarker",n.RESET_MARKER_BUTTONS="resetMarkerButtons",n.SHOW_ANNOTATION="showAnnotation",n.HIDE_ANNOTATION="hideAnnotation",n.REMOVE_MARKERS="removeMarkers",n.SAVE_ANNOTATION="saveAnnotation",n.EDIT_ANNOTATION="editAnnotation",n.REMOVE_ANNOTATION="removeAnnotation",n.FINETUNE_SAVE="finetuneSave",n.FINE_TUNING_IN_PROGRESS="fineTuningInProgress",n.SHOW_HIDE_MARKER_BUTTONS="showHideMarkerButtons",n.ENABLE_MARKER_EDIT_MODE="enableMarkerEditMode",n.SHOW_MARKER_ALERT="showMarkerAlert",n.CHECK_MARKER_VALIDATION="checkMarkerValidation",n.SET_MARK_IN_POSITION="setMarkInOnPlayerEdit",n.SET_MARK_OUT_POSITION="setMarkOutOnPlayerEdit",n.VALIDATE_MARKERS_ON_FRAME_SEEK="validateMarkersOnFrameSeek",n.SEEK_TO_ACCUMULATED_TIME_ON_FRAME_SEEK="seekToAccumulatedTimeOnFrameSeek",n.SHOW_ANNOTATION_MENU="showAnnotationMenu",n.CHECK_ANNOTATION_FONT_SIZE="checkAnnotationFontSize",n.SET_ANNOTATION_FONT_SIZE="setAnnotationFontSize",n.INITIATE_SCTE35_SEGMENT="initiateScte35Segment",n.CREATE_SCTE35_SEGMENT="createScte35Segment",n}();PlayerMode=function(){var n={};return n.AUDIO="audio",n.VIDEO="video",n.NON_AV_IMAGE="nonav_image",n.NON_AV_DOCUMENT="nonav_document",n.STRATA="strata",n.EDIT="enablePlayerEditMode",n.SEQUENCE_PREVIEW="sequencePreview",n.SEQUENCE_SEGMENT_EDIT="sequenceSegmentEdit",n.SEQUENCE_CLIP="sequenceClip",n.BIN_CLIP="binClip",n.SEQUENCE_CPL_PREVIEW="sequenceCplPreview",n}();NonAvViewerEvent=function(){var n={};return n.MOUSE_DRAG="mouseDrag",n.SCALE="scale",n.UPDATE_ZOOM_VALUE="updateZoomValue",n.UPDATE_VIEWTYPE_CONTROL="updateViewType",n.CHANGE_VIEW_TYPE="changeViewType",n.UPDATE_UI_CONTROLS="updateUiControls",n.NAVIGATE_NEXTITEM="handleNavigateNextItem",n.NAVIGATE_PREVIOUSITEM="handleNavigatePreviousItem",n.GO_TO_PAGE="jumpToPage",n.ROTATE_CLOCKWISE="rotateClockWise",n.ROTATE_ANTI_CLOCKWISE="rotateAntiClockWise",n.ROTATION_BAR="rotationBar",n.RESIZE_NONAV="resizeNonAv",n.CREATE_NOAV_UI_CONTAINER="createNoavUiContainer",n.NONAV_OVERLAY_CLICKED="nonavOverlayClicked",n.GRID_LAYOUT_CHANGE="onGridLayoutChange",n.DEFAULT_MULTIPLE_CONTAINER="defaultMultipleContainer",n.DEFAULT_SELECTED_CONTAINER="defaultSelectedContainer",n.PLAY_SLIDE_SHOW="playSlideShow",n.PAUSE_SLIDE_SHOW="pauseSlideShow",n.ON_NONAV_PRE_LOAD_READY="onNonAvPreLoadReady",n.SHOW_NONAV_FILENAME_ON_FULLSCREEN="showNonAvFileNameOnFullscreen",n.REFRESH_RIGHTSIDE_INFO="refreshRightSideInfo",n.SWITCH_TO_SINGLE_ITEM_VIEW="switchToSingleItemView",n.UPDATE_POPUP_HEADER="updatePopupHeader",n}();SequenceEvent=function(){var n={};return n.CEPROJECT_LOADED="ceProjectLoaded",n.CREATE_CLIP="createClip",n.GET_SEQUENCE_OBJECT_AS_XML="getSequenceObjectAsXml",n.DELETE_SEGMENT="delteSegment",n.UPDATE_SEGMENT_DURATION="fnUpdateSegmentDuration",n.UPDATE_CLIP="updateClip",n.INITIALISE_SEQUENCE_SEGMENT_EDIT_MODE="initialiseSequenceSegmentEditMode",n.INITIALISE_SEQUENCE_PREVIEW_MODE="initialiseSequencePreviewMode",n.INITIALISE_SEQUENCE_CLIP_MODE="initialiseSequenceClipMode",n.UPDATE_TIMELINE_SEGMENT_POSITION="updateTimelineSegmentPosition",n.UPDATE_TIMELINE_SEGMENT_TITLE="updateSegmentTitle",n.UPDATE_CLIP_POSITION="updateClipPosition",n.CLIP_POSITION_UPDATED="clipPositionUpdated",n.DELETE_CLIP="deleteClip",n.CLIP_DELETED="clipDeleted",n.SHOW_CONFIRM_ALERT_MESSAGE="showConfirmAlertMsg",n.HIDE_CONFIRM_ALERT_MESSAGE="hideConfirmAlertMsg",n.DELETE_CAPTURE_FRAME="deleteCaptureFrame",n.SWITCH_SEQUENCE_MODE="switchSequenceMode",n.CREATE_SEGMENT="createSegment",n.SHOW_SEGMENT_POPUP="showSegmentPopup",n.HIDE_SEGMENT_POPUP="hideSegmentPopup",n.SAVE_SEGMENT="saveSegment",n.CREATE_CAPTURE_FRAME="createCaptureFrame",n.BIND_SCREENSHOTS="bindScreenshots",n.BIND_SCREENSHOTS_PREVIEW_MODE="bindScreenshotForPreviewMode",n.STILL_CAPTURE="stillCapture",n.DELETE_STILL_CAPTURE="deleteStillCapture",n.SWITCH_TAB="switchPlayerTab",n.ADD_SEGMENT="addSegment",n.LOAD_CLIP="loadClip",n.LOAD_SEGMENT="loadClipSegment",n.DELETE_CLIP_STILL_CAPTURE="deleteClipStillCapture",n.LOADING_CLIP="loadingClip",n.ACTIVE_SEGMENT_CHANGED="activeSegmentChanged",n.UNHIGHLIGHT_SEGMENT="unHighlightSegment",n.HANDLE_EXPORT_CLIPS="handleExportClips",n.FULL_SCREEN_HANDLE="fullScreenHandle",n.SEGMENT_DELETED="segmentDeleted",n.GET_CURRENT_SEQUENCE_MODE="getCurrentSequenceMode",n.SELECT_SCREENSHOT="selectScreenshot",n.INITIATE_SEGMENT_PANEL="initiateSegmentPanel",n.SHOW_SEGMENTS_PANEL="showSegmentsPanel",n.INITIATE_SEGMENT_DELETE="initiateSegmentDelete",n.HIDE_EXPORT_POUP="hideExportPopup",n.SEND_THUMB_EXTRACTION_REQUEST="sendThumbExtractionRequest",n.UPDATE_THUMB_UI="updateThumbUI",n.SCREEN_CAPTURE="screenCapture",n.UPDATE_THUMB_EXTRACTION_ON_LOAD="thumbExtractionOnLoad",n.CONVERT_IMPLICIT_TO_EXPLICIT_SEGMENTS="convertImplicitToExplicitSegments",n.UPDATED_CEPROJECT="updatedCeproject",n.GET_PLAYLIST_DURATION="getPlaylistDuration",n.PLAYLIST_DURATION="playlistDuration",n.UPDATE_PREVIEWABLE_SEGMENTS="updatePreviewableSegments",n.UPDATE_SEGMENTS_POSITION="updateSegmentsPosition",n.DELETE_SEQUENCE="deleteSequence",n.SEQUENCE_DELETED="sequenceDeleted",n.CREATE_CEPROJECT="createceProject",n.NAVIGATE_TO_START="navigateToStart",n.NAVIGATE_TO_END="navigateToEnd",n.FRAMERATE_CHANGED="framerateChanged",n.UPDATE_SEGMENT_BY_ID="updateSegmentById",n.INITIALISE_CPL_PREVIEW_MODE="initialiseCplPreviewMode",n.SPLICE_CLIP="spliceClip",n.REINIT_TIMELINE_THUMBNAIL="reinitTimelineThumbnail",n}();NativePlayerErrorMessage=function(){var n=[];return n.CMPER1006="Security Error",n}();TimelineBarEvent=function(){var n=[];return n.BIND_TIMELINE_BAR="bindTimelineBar",n.ON_TIMELINE_BAR_CLICK="OnTimelineBarClick",n.SAVE_TIMELINE_SEQUNCE_XML="saveTimelineSequenceXml",n.BUILD_TIMELINE_BAR_SEGMENT="buildTimelineBarSegment",n.RESTART_PREVIEW="restartPreview",n.ON_TIMELINE_SEGMENT_RIGHT_DRAG="onTimelineSegmentRightDrag",n.TIMELINE_RIGHT_SCALE_MOUSE_DOWN="timelineRightScaleMouseDown",n.TIMELINE_RIGHT_SCALE_MOUSE_UP="timelineRightScaleMouseUp",n.ON_TIMELINE_SEGMENT_LEFT_DRAG="onTimelineSegmentLeftDrag",n.TIMELINE_LEFT_SCALE_MOUSE_DOWN="timelineLeftScaleMouseDown",n.TIMELINE_LEFT_SCALE_MOUSE_UP="timelineLeftScaleMouseUp",n.BIND_VALID_SEGMENTS_TO_TIMELINE="bindValidSegmentsToTimeLine",n.UPDATED_SEGMENT="UpdatedSegmentinEditor",n.UPDATE_TIMELINEBAR_TIMECODES="updateTimelineBarTimecodes",n.RESIZE_TIMELINE_SEGMENTS="resizeTimelineSegments",n.SWITCH_PLAYLIST_PREVIEW_EDITOR="switchplaylistpreviewinEditor",n.TIME_CHANGE="timeChange",n.SEGMENT_DELETE="segmentDelete",n.UN_HIGHLIGHT_BIN_ITEMS="UnhighlightBinitems",n.HIGHLIGHT_BIN_ITEMS="highlightBinitems",n.SPLICED_CLIPS="splicedClips",n.INITIATE_SAVE_PLAYLIST="initiateSavePlaylist",n.UPDATE_TIMELINE_SEGMENT_POSITION="updateTimelineSegmentPositioninEditor",n.UPDATE_SEGMENT="updateSegmentinEditor",n}();StreamEvent=function(){var n=[];return n.SET_STREAM_BIT_RATE="setStreamBitrate",n.GET_STREAM_BIT_RATES="getStreamBitrates",n.LOAD_DEFAULT_BIT_RATES="loadDefaultStreamBitRate",n.BIND_BIT_RATES="loadStreamBitRate",n.LOAD_AUTO_BIT_RATE="loadAutoBitrate",n}();LayoutEvent=function(){var n=[];return n.TOGGLE_CONTROLBAR_ON_SHORTCUT_KEYPRESS="toggleControlBarOnShortCutKeyPress",n.INITIALISE_WATERMARKING="initialiseWatermarking",n.ASSIGN_STYLE_FOR_WATERMARKING="assignStyleForWatermarking",n.ASSIGN_STYLE_FOR_DISPLAY_TIMED_TEXT="assignStyleForDisplayTimedText",n}();ErrorEvent=function(){var n=[];return n.SHOW_NP_ERROR_MESSAGE="showErrorMessage",n.SHOW_FLASH_PLUGIN_LOAD_ERROR_MESSAGE="showFlashPluginLoadErrorMessage",n.SHOW_ERROR_MESSAGE="showErrorMessageAlert",n.HIDE_ERROR_MESSAGE="hideErrorMessageAlert",n.SHOW_CONFIRM_ALERT_MESSAGE="showConfirmAlertMsg",n.HIDE_CONFIRM_ALERT_MESSAGE="hideConfirmAlertMsg",n.SHOW_Generic_ERROR_MESSAGE="showGenericErrorDetails",n.ERROR_CHECK_COMPLETE="errorCheckComplete",n.SHOW_ERROR_REPORT="showErrorReport",n.HIDE_ERROR_REPORT="hideErrorReport",n.SECURE_INFO_ERROR="onSecureInfoError",n.ENABLE_DEBUGGER_MODE="enableDebuggerMode",n}();ShortCutEvent=function(){var n=[];return n.ADD_OR_REMOVE_SHORTCUT="addOrRemoveShortCut",n.UPDATE_SHORTCUT="updateShortCut",n.REMOVE_ALL_SHORTCUT="removeAllShortCut",n}();UIEvent=function(){var n=[];return n.VALIDATE_FONT_SIZE="validateFontSize",n.SET_FONT_TEXT_BUTTON_VISIBILITY="snowHideFontSizeButton",n.UPDATE_TTT_POSITION_BTNS="updateTTTPositionBtns",n.DISABLE_FONT_SIZE_BUTTON="disableFontSizeButton",n.ENABLE_FONT_SIZE_BUTTON="enableFontSizebutton",n.RESET_UI_TIMECODE="resetUiTimecode",n.RESET_DIRECTION_BUTTON_ON_DELETE="resetDirectionButton",n.QT_FULL_SCREEN_TOGGLE="toggleFullScreenQt",n.SHOW_MARKER_INFO="showMarkerInfo",n.RESIZE_MARKER_INFO="resizeMarkerInfo",n.SHOW_HIDE_GENERICS_ICON="showHideGenericsIcon",n.UPDATE_PLAYER_STATE="updatePlayeState",n.HIDE_TRANSPORTBAR="hideTransportbar",n.SHOW_MEDIA_INFO="showMediaInfo",n.HIDE_MEDIA_INFO="hideMediaInfo",n.ON_FULLSCREENEXIT="onFullScreenExit",n.SET_FOCUS="setFocus",n.ADD_MARKER="addMarker",n.ON_MIXEDFRAMERATE_PLAYBACK="onMixedFrameratePlayback",n.SHOW_CUSTOM_TIMED_TEXT="showCustomTimedText",n.REFRESH_CURRENT_TIMEDTEXT="refreshCurrentTimedText",n.SET_TIMED_TEXT_TRACK_INFO="setTimedTextTrackInfo",n.STILL_CAPTURE_FRAME="stillCaptureFrame",n}();LiveEvent=function(){var n=[];return n.FEED_ENDED="FeedEnded",n.PLAYHEAD_POSITION_CHANGE="PlayheadPositionChange",n.LIVE_STREAM_DETECTED="liveStreamDetected",n.UPADTE_POSITION_ON_LIVEDURATION_CHANGE="updatePositionOnLiveDurationChange",n}();LivePlayHeadPosition=function(){var n=[];return n.LIVE="LIVE",n.HISTORICAL="HISTORICAL",n}();SmartPlayerEvent=function(){var n=[];return n.ADD_TO_ST_PLAYLIST="addToSTPlaylist",n.ON_PLAYLIST_ITEMCLICK="OnPlaylistItemClick",n.CHANGE_PLAYER_MODE="changePlayerMode",n.INITIALISE_PREVIEW_MODE="initialisePreviewMode",n.DELETE_PLAYLIST_SEGMENT="deletePlaylistSegment",n.GENERATE_SEGMENT_THUMBNAIL="generateSegmentThumbnail",n.LOAD_TL_MARKERS="loadTimeLineMarkers",n.FILTER_TL_MARKER_BY_ID="filterTimeLineMarkerById",n.FILTER_TL_MARKER_BY_TAGNAME="filterTimeLineMarkerByTagName",n.OPEN_EXPORT_PANEL="openExportPanel",n.RESET_PLAYLISTSEGMENT_POSITION="resetPlaylistSegmentPosition",n.UPDATED_ST_PLAYLIST_ID="updatedSTPlaylistId",n}();PreviewpanelEvent=function(){var n=[];return n.NAVIGATE_TO_FIRST_SCENE="navigateToFirstScene",n.NAVIGATE_TO_LAST_SCENE="navigateToLastScene",n.NAVIGATE_TO_NEXT_SCENE="navigateToNextScene",n.NAVIGATE_TO_PREVIOUS_SCENE="navigateToPreviousScene",n}();TimelineType=function(){var n=[];return n.MAIN="main",n.VIDEO="video",n.AUDIO="audio",n}();LastPlayBackTimeEvent=function(){var n=[];return n.ADD_OR_UPDATE_LPT="addOrUpdateLastPlayBackTime",n}();TimelineEvent=function(){var n=[];return n.TIMELINE_EDITED="TimelineEdited",n.LAST_FRAME_REACHED="lastFrameReached",n}();SubtitlePlayerEvent=function(){var n=[];return n.LOAD_STT_MARKERS="loadSubtitleMarkers",n.ADD_STT_MARKERS="AddSubtitle",n.UPDATE_STT_MARKERS="UpdateSubtitle",n.DELETE_STT_MARKERS="DeleteSubtitle",n.LOAD_SHOT_DETECTION="loadShotDetection",n.LOAD_AUDIO_GRAPH="loadAudioGraph",n.GET_SHOT_DETECTION="getShotDetection",n.GET_AUDIO_GRAPH="getAudioGraph",n.REDRAW_MARKERS="redrawSubtitleBar",n.ADD_ERR_TAG="addErrorTag",n.REMOVE_ERR_TAG="removeErrorTag",n}();Injector.prototype.bindInstance=function(n,t){this.instances[n]=t};Injector.prototype.getInstance=function(n){return this.instances[n]};Annotation=function(n,t,i,r,u){this.startTimeCode=n;this.endTimeCode=t;this.annotationComments=i;this.time=r;this.duration=u};AudioTrack=function(n,t,i,r,u,f,e,o,s){this.audioEssenceId=n;this.audioTrackId=t;this.audioEssenceTitle=i;this.language=r;this.url=u;this.index=f;this.type=e;this.audioCEProject=o;this.sequenceClipInfoForAudio=s};Clip=function(){Object.defineProperty(this,"id",{get:function(){return this._id},set:function(n){this._id=n},configurable:!0});Object.defineProperty(this,"title",{get:function(){return this._title},set:function(n){this._title=n},configurable:!0});Object.defineProperty(this,"frameRate",{get:function(){return this._frameRate},set:function(n){this._frameRate=n},configurable:!0});Object.defineProperty(this,"reelId",{get:function(){return this._reelId},set:function(n){this._reelId=n},configurable:!0});Object.defineProperty(this,"highResFileName",{get:function(){return this._highResFileName},set:function(n){this._highResFileName=n},configurable:!0});Object.defineProperty(this,"url",{get:function(){return this._url},set:function(n){this._url=n},configurable:!0});Object.defineProperty(this,"thumbnailUrl",{get:function(){return this._thumbnailUrl},set:function(n){this._thumbnailUrl=n},configurable:!0});Object.defineProperty(this,"startTime",{get:function(){return this._startTime},set:function(n){this._startTime=n},configurable:!0});Object.defineProperty(this,"endTime",{get:function(){return this._endTime},set:function(n){this._endTime=n},configurable:!0});Object.defineProperty(this,"duration",{get:function(){return this._duration},set:function(n){this._duration=n},configurable:!0});Object.defineProperty(this,"startOfMedia",{get:function(){return this._startOfMedia},set:function(n){this._startOfMedia=n},configurable:!0})};var CMPModel=function(){Object.defineProperty(CMPModel.prototype,"annotationCollection",{get:function(){return this._annotations},set:function(n){this._annotations=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"audioTracksCollection",{get:function(){return this._audioTracksCollection},set:function(n){this._audioTracksCollection=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"currentTimedTextTrackDataObject",{get:function(){return this._currentTimedTextTrackDataObject},set:function(n){this._currentTimedTextTrackDataObject=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"externalAudioTrackIndex",{get:function(){return this._externalAudioTrackIndex},set:function(n){this._externalAudioTrackIndex=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"volume",{get:function(){return this._volume},set:function(n){this._volume=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"timedTextTrackCollection",{get:function(){return this._timedTextTrackCollection},set:function(n){this._timedTextTrackCollection=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"timedTextTrackTimelineMetadata",{get:function(){return this._timedTextTrackTimelineMetadata},set:function(n){this._timedTextTrackTimelineMetadata=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"strataTimelineMetadata",{get:function(){return this._strataTimelineMetadata},set:function(n){this._strataTimelineMetadata=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"supportedFeatures",{get:function(){return this._supportedFeatures},set:function(n){this._supportedFeatures=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"accumulatedSeekTimeInSec",{get:function(){return this._accumulatedSeekTimeInSec},set:function(n){this._accumulatedSeekTimeInSec=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"mediaInfo",{get:function(){return this._mediaInfo},set:function(n){this._mediaInfo=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"ceProject",{get:function(){return this._ceProject},set:function(n){this._ceProject=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"playerMode",{get:function(){return this._playerMode},set:function(n){this._playerMode=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"ceProjectForVideo",{get:function(){return this._ceProjectForVideo},set:function(n){this._ceProjectForVideo=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"ceProjectForAudio",{get:function(){return this._ceProjectForAudio},set:function(n){this._ceProjectForAudio=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"autoPlay",{get:function(){return this._autoPlay},set:function(n){this._autoPlay=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"playerInfo",{get:function(){return this._playerInfo},set:function(n){this._playerInfo=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"callbacks",{get:function(){return this._callbacks},set:function(n){this._callbacks=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"isMarkOutDone",{get:function(){return this._isMarkOutDone},set:function(n){this._isMarkOutDone=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"isFineTuningInProgress",{get:function(){return this._isFineTuningInProgress},set:function(n){this._isFineTuningInProgress=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"enableContiguousSegments",{get:function(){return this._enableContiguousSegments},set:function(n){this._enableContiguousSegments=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"markInPosition",{get:function(){return this._markInPosition},set:function(n){this._markInPosition=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"lastPlayedAudioTrackType",{get:function(){return this._lastPlayedAudioTrackType},set:function(n){this._lastPlayedAudioTrackType=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"mediaDuration",{get:function(){return this._mediaDuration},set:function(n){this._mediaDuration=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"markerCollection",{get:function(){return this._markerCollection},set:function(n){this._markerCollection=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"marker",{get:function(){return this._marker},set:function(n){this._marker=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"segmentSeekPosition",{get:function(){return this._segmentSeekPosition},set:function(n){this._segmentSeekPosition=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"clearMediaPlayerTimer",{get:function(){return this._clearMediaPlayerTimer},set:function(n){this._clearMediaPlayerTimer=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"transportBarSliderUpdationTimer",{get:function(){return this._transportBarSliderUpdationTimer},set:function(n){this._transportBarSliderUpdationTimer=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"selectedTimedTextTrackIndex",{get:function(){return this._selectedTimedTextTrackIndex},set:function(n){this._selectedTimedTextTrackIndex=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"stateAfterSeek",{get:function(){return this._stateAfterSeek},set:function(n){this._stateAfterSeek=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"annotationTimelineMetadata",{get:function(){return this._annotationTimelineMetadata},set:function(n){this._annotationTimelineMetadata=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"currentAnnotationDetails",{get:function(){return this._currentAnnotationDetails},set:function(n){this._currentAnnotationDetails=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"segmentTimelineMetadata",{get:function(){return this._segmentTimelineMetadata},set:function(n){this._segmentTimelineMetadata=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"lastCreatedMarkerId",{get:function(){return this._lastCreatedMarkerId},set:function(n){this._lastCreatedMarkerId=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"isPlayerInEditMode",{get:function(){return this._isPlayerInEditMode},set:function(n){this._isPlayerInEditMode=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"loopToSegStartOnSegEnd",{get:function(){return this._loopToSegStartOnSegEnd},set:function(n){this._loopToSegStartOnSegEnd=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"pluginLoadTimer",{get:function(){return this._pluginLoadTimer},set:function(n){this._pluginLoadTimer=n},configurable:!0});Object.defineProperty(this,"currentSegment",{get:function(){return this._currentSegment},set:function(n){this._currentSegment=n}});Object.defineProperty(this,"timelineMetadata",{get:function(){return this._timelineMetadata},set:function(n){this._timelineMetadata=n}});Object.defineProperty(this,"pauseOnSegmentDurationReached",{get:function(){return this._pauseOnSegmentDurationReached==undefined||this._pauseOnSegmentDurationReached=="undefined"||this._pauseOnSegmentDurationReached==null?!1:this._pauseOnSegmentDurationReached},set:function(n){this._pauseOnSegmentDurationReached=n},configurable:!0});Object.defineProperty(this,"sequenceClipInfo",{get:function(){return this._sequenceClipInfo},set:function(n){this._sequenceClipInfo=n}});Object.defineProperty(this,"sequenceClipInfoForVideo",{get:function(){return this._sequenceClipInfoForVideo},set:function(n){this._sequenceClipInfoForVideo=n}});Object.defineProperty(this,"sequenceClipInfoForAudio",{get:function(){return this._sequenceClipInfoForAudio},set:function(n){this._sequenceClipInfoForAudio=n}});Object.defineProperty(this,"currentClipOrderId",{get:function(){return this._currentClipOrderId},set:function(n){this._currentClipOrderId=n}});Object.defineProperty(CMPModel.prototype,"fontSizeCount",{get:function(){return this._fontSizeCount},set:function(n){this._fontSizeCount=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"fontSizeCount",{get:function(){return this._annotFontSizeCount},set:function(n){this._annotFontSizeCount=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"isContiguous",{get:function(){return this._isContiguous},set:function(n){this._isContiguous=n},configurable:!0});Object.defineProperty(this,"sequenceOperation",{get:function(){return this._sequenceOperation},set:function(n){this._sequenceOperation=n},configurable:!0});Object.defineProperty(this,"sequenceAction",{get:function(){return this._sequenceAction},set:function(n){this._sequenceAction=n},configurable:!0});Object.defineProperty(this,"sequenceTarget",{get:function(){return this._sequenceTarget},set:function(n){this._sequenceTarget=n},configurable:!0});Object.defineProperty(this,"sequenceStatus",{get:function(){return this._sequenceStatus},set:function(n){this._sequenceStatus=n},configurable:!0});Object.defineProperty(this,"sequenceOfflineSave",{get:function(){return this._sequenceOfflineSave},set:function(n){this._sequenceOfflineSave=n},configurable:!0});Object.defineProperty(this,"defaultSequenceSom",{get:function(){return this._defaultSequenceSom},set:function(n){this._defaultSequenceSom=n},configurable:!0});Object.defineProperty(this,"timedTextDataObject",{get:function(){return this._timedTextDataObject},set:function(n){this._timedTextDataObject=n},configurable:!0});Object.defineProperty(this,"formattingObject",{get:function(){return this._formattingObject},set:function(n){this._formattingObject=n},configurable:!0});Object.defineProperty(this,"thumbExtractionOnLoad",{get:function(){return this._thumbExtractionOnLoad},set:function(n){this._thumbExtractionOnLoad=n},configurable:!0});Object.defineProperty(this,"secureInfo",{get:function(){return this._secureInfo},set:function(n){this._secureInfo=n},configurable:!0});Object.defineProperty(this,"nonAVMediaInfo",{get:function(){return this._nonAVMediaInfo},set:function(n){this._nonAVMediaInfo=n},configurable:!0});Object.defineProperty(this,"noOfNonAvActiveContainer",{get:function(){return this._noOfNonAvActiveContainer},set:function(n){this._noOfNonAvActiveContainer=n},configurable:!0});Object.defineProperty(this,"currentlySelectedNonAvContainer",{get:function(){return this._currentlySelectedNonAvContainer},set:function(n){this._currentlySelectedNonAvContainer=n},configurable:!0});Object.defineProperty(this,"isMediaDurationReached",{get:function(){return this._isMediaDurationReached},set:function(n){this._isMediaDurationReached=n},configurable:!0});Object.defineProperty(this,"segmentsToSkipPreview",{get:function(){return this._segmentsToSkipPreview},set:function(n){this._segmentsToSkipPreview=n}});Object.defineProperty(this,"isMixedFrameRate",{get:function(){return this._isMixedFrameRate},set:function(n){this._isMixedFrameRate=n},configurable:!0});Object.defineProperty(this,"frameAccuracyOffSet",{get:function(){return this._frameAccuracyOffSet},set:function(n){this._frameAccuracyOffSet=n},configurable:!0});Object.defineProperty(this,"showBufferingIcon",{get:function(){return this._showBufferingIcon},set:function(n){this._showBufferingIcon=n},configurable:!0});Object.defineProperty(this,"bufferingTimer",{get:function(){return this._bufferingTimer},set:function(n){this._bufferingTimer=n},configurable:!0});Object.defineProperty(this,"pauseAtLastFrame",{get:function(){return this._pauseAtLastFrame},set:function(n){this._pauseAtLastFrame=n},configurable:!0});Object.defineProperty(this,"segmentDurationReached",{get:function(){return this._segmentDurationReached},set:function(n){this._segmentDurationReached=n},configurable:!0});Object.defineProperty(this,"isMediaInfoModeEnabled",{get:function(){return this._isMediaInfoModeEnabled},set:function(n){this._isMediaInfoModeEnabled=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"liveDurtionUpdationTimer",{get:function(){return this._liveDurtionUpdationTimer},set:function(n){this._liveDurtionUpdationTimer=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"isSeekToLiveRequested",{get:function(){return this._isSeekToLiveRequested},set:function(n){this._isSeekToLiveRequested=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"playbackSpeedRange",{get:function(){return this._playbackSpeedRange},set:function(n){this._playbackSpeedRange=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"currentPlaybackSpeedIndex",{get:function(){return this._currentPlaybackSpeedIndex},set:function(n){this._currentPlaybackSpeedIndex=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"timelinethumbnail",{get:function(){return this._timelinethumbnail},set:function(n){this._timelinethumbnail=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"isSequencePlayBackOptimized",{get:function(){return this._isSequencePlayBackOptimized},set:function(n){this._isSequencePlayBackOptimized=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"optimizedSequenceUrl",{get:function(){return this._optimizedSequenceUrl},set:function(n){this._optimizedSequenceUrl=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"oldState",{get:function(){return this._oldState},set:function(n){this._oldState=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"dragPersistedState",{get:function(){return this._dragPersistedState},set:function(n){this._dragPersistedState=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"isMediaFullyWatched",{get:function(){return this._isMediaFullyWatched},set:function(n){this._isMediaFullyWatched=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"isCustomTimedTextTrackModeEnabled",{get:function(){return this._isCustomTimedTextTrackModeEnabled},set:function(n){this._isCustomTimedTextTrackModeEnabled=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"isTimedTextTrackEditModeEnabled",{get:function(){return this._isTimedTextTrackEditModeEnabled},set:function(n){this._isTimedTextTrackEditModeEnabled=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"preferenceSetting",{get:function(){return this._preferenceSetting},set:function(n){this._preferenceSetting=n},configurable:!0});Object.defineProperty(CMPModel.prototype,"takeOrTotal",{get:function(){return this._takeOrTotal},set:function(n){this._takeOrTotal=n},configurable:!0});this._annotations;this._timedTextTrackCollection;this._currentTimedTextTrackDataObject;this._timedTextTrackTimelineMetadata;this._strataTimelineMetadata;this._externalAudioTrackIndex=-1;this._volume=100;this._supportedFeatures=[];this._accumulatedSeekTimeInSec=0;this._playerMode="";this._ceProject;this._ceProjectForVideo;this._ceProjectForAudio;this._autoPlay=!1;this._playerInfo;this._callbacks={};this._isMarkOutDone=!1;this._isFineTuningInProgress=!1;this._enableContiguousSegments=!1;this._markInPosition;this._lastPlayedAudioTrackType="Embedded";this._mediaDuration;this._markerCollection=[];this._marker;this._segmentSeekPosition=-1;this._clearMediaPlayerTimer=null;this._transportBarSliderUpdationTimer=null;this._selectedTimedTextTrackIndex;this._stateAfterSeek=null;this._annotationTimelineMetadata;this._currentAnnotationDetails=null;this._segmentTimelineMetadata;this._lastCreatedMarkerId=0;this._isPlayerInEditMode=!1;this._loopToSegStartOnSegEnd=!1;this._pluginLoadTimer=null;this._currentSegment;this._timelineMetadata;this._pauseOnSegmentDurationReached;this._sequenceClipInfo=[];this._sequenceClipInfoForVideo=[];this._sequenceClipInfoForAudio=[];this._currentClipOrderId;this._isContiguous=!1;this._fontSizeCount=3;this._annotFontSizeCount=3;this._sequenceOperation;this._sequenceAction;this._sequenceTarget;this._sequenceStatus;this._sequenceOfflineSave;this._defaultSequenceSom;this._timedTextDataObject=null;this._formattingObject=null;this._thumbExtractionOnLoad=!0;this._secureInfo;this._nonAVMediaInfo=null;this._noOfNonAvActiveContainer=null;this._currentlySelectedNonAvContainer=null;this._isMediaDurationReached=!1;this._segmentsToSkipPreview=[];this._isMixedFrameRate=!1;this._frameAccuracyOffSet=0;this._showBufferingIcon=!1;this._bufferingTimer=null;this._pauseAtLastFrame=!1;this._segmentDurationReached=!1;this._isMediaInfoModeEnabled=!1;this._liveDurtionUpdationTimer=null;this._isSeekToLiveRequested=!1;this._currentPlaybackSpeedIndex;this._playbackSpeedRange=[];this._timelinethumbnail;this._isSequencePlayBackOptimized=!1;this._optimizedSequenceUrl;this._oldState;this._dragPersistedState;this._isMediaFullyWatched=!1;this._isCustomTimedTextTrackModeEnabled=!1;this._isTimedTextTrackEditModeEnabled=!1;this._preferenceSetting;this._takeOrTotal},Marker=function(){Object.defineProperty(Marker.prototype,"id",{get:function(){return this._id},set:function(n){this._id=n},configurable:!0});Object.defineProperty(Marker.prototype,"name",{get:function(){return this._name},set:function(n){this._name=n},configurable:!0});Object.defineProperty(Marker.prototype,"markIn",{get:function(){return this._markIn},set:function(n){this._markIn=n},configurable:!0});Object.defineProperty(Marker.prototype,"markOut",{get:function(){return this._markOut},set:function(n){this._markOut=n},configurable:!0});Object.defineProperty(Marker.prototype,"formattedDisplayInfo",{get:function(){return this._formattedDisplayInfo},set:function(n){this._formattedDisplayInfo=n},configurable:!0});Object.defineProperty(Marker.prototype,"cssClassName",{get:function(){return this._cssClassName},set:function(n){this._cssClassName=n},configurable:!0});this._id;this._name;this._markIn;this._markOut;this._cssClassName;this._formattedDisplayInfo={}},MediaInfo=function(n){n!=null&&(this._mediaUrl=n.MediaUrl!=null?n.MediaUrl:"",this._lastPlayBackTime=n.LastPlayBackTime!=null?n.LastPlayBackTime:"",this._som=n.Som!=null?n.Som:"00:00:00:00",this._frameRate=n.FrameRate!=null?n.FrameRate:"",this._timecodeDisplayFormat=n.TimecodeDisplayFormat!=null?n.TimecodeDisplayFormat:"NDF",this._streamType=n.StreamType!=null?n.StreamType:"PDF",this._assetClass=n.AssetClass!=null?n.AssetClass:"VIDEO",this._playlistSubType=n.PlaylistSubType!=null?n.PlaylistSubType:"",this._islastPlayBackTimeEnabled=n.IslastPlayBackTimeEnabled!=null?n.IslastPlayBackTimeEnabled:!1,this._startSeek=n.SeekStart!=null?n.SeekStart:0,this._dmguid=n.Dmguid!=null?n.Dmguid:0,this._endSeek=n.SeekEnd,this._duration=n.Duration,this._isLive=!1,this._livePlayheadPosition="");Object.defineProperty(MediaInfo.prototype,"mediaUrl",{get:function(){return this._mediaUrl},set:function(n){this._mediaUrl=n},configurable:!0});Object.defineProperty(MediaInfo.prototype,"lastPlayBackTime",{get:function(){return this._lastPlayBackTime},set:function(n){this._lastPlayBackTime=n},configurable:!0});Object.defineProperty(MediaInfo.prototype,"som",{get:function(){return this._som},set:function(n){this._som=n},configurable:!0});Object.defineProperty(MediaInfo.prototype,"frameRate",{get:function(){return this._frameRate},set:function(n){this._frameRate=n},configurable:!0});Object.defineProperty(MediaInfo.prototype,"timecodeDisplayFormat",{get:function(){return this._timecodeDisplayFormat},set:function(n){this._timecodeDisplayFormat=n},configurable:!0});Object.defineProperty(MediaInfo.prototype,"islastPlayBackTimeEnabled",{get:function(){return this._islastPlayBackTimeEnabled},set:function(n){this._islastPlayBackTimeEnabled=n},configurable:!0});Object.defineProperty(MediaInfo.prototype,"startSeek",{get:function(){return this._startSeek},set:function(n){this._startSeek=n},configurable:!0});Object.defineProperty(MediaInfo.prototype,"endSeek",{get:function(){return this._endSeek},set:function(n){this._endSeek=n},configurable:!0});Object.defineProperty(MediaInfo.prototype,"duration",{get:function(){return this._duration},set:function(n){this._duration=n},configurable:!0});Object.defineProperty(MediaInfo.prototype,"streamType",{get:function(){return this._streamType},set:function(n){this._streamType=n},configurable:!0});Object.defineProperty(MediaInfo.prototype,"assetClass",{get:function(){return this._assetClass},set:function(n){this._assetClass=n},configurable:!0});Object.defineProperty(MediaInfo.prototype,"playlistSubType",{get:function(){return this._playlistSubType},set:function(n){this._playlistSubType=n},configurable:!0});Object.defineProperty(MediaInfo.prototype,"isLive",{get:function(){return this._isLive},set:function(n){this._isLive=n},configurable:!0});Object.defineProperty(MediaInfo.prototype,"livePlayheadPosition",{get:function(){return this._livePlayheadPosition},set:function(n){this._livePlayheadPosition=n},configurable:!0});Object.defineProperty(MediaInfo.prototype,"dmguid",{get:function(){return this._dmguid},set:function(n){this._dmguid=n},configurable:!0})};Segment=function(){Object.defineProperty(this,"id",{get:function(){return this._id},set:function(n){this._id=n},configurable:!0});Object.defineProperty(this,"uiId",{get:function(){return this._uiId},set:function(n){this._uiId=n},configurable:!0});Object.defineProperty(this,"position",{get:function(){return this._position},set:function(n){this._position=n}});Object.defineProperty(this,"clipOrderId",{get:function(){return this._clipOrderId},set:function(n){this._clipOrderId=n},configurable:!0});Object.defineProperty(this,"thumbnailUrl",{get:function(){return this._thumbnailUrl},set:function(n){this._thumbnailUrl=n},configurable:!0});Object.defineProperty(this,"startTimeInSequence",{get:function(){return this._startTimeInSequence},set:function(n){this._startTimeInSequence=n},configurable:!0});Object.defineProperty(this,"endTimeInSequence",{get:function(){return this._endTimeInSequence},set:function(n){this._endTimeInSequence=n},configurable:!0});Object.defineProperty(this,"startTime",{get:function(){return this._startTime},set:function(n){this._startTime=n},configurable:!0});Object.defineProperty(this,"endTime",{get:function(){return this._endTime},set:function(n){this._endTime=n},configurable:!0});Object.defineProperty(this,"title",{get:function(){return this._title},set:function(n){this._title=n},configurable:!0});Object.defineProperty(this,"comments",{get:function(){return this._comments},set:function(n){this._comments=n},configurable:!0});Object.defineProperty(this,"editType",{get:function(){return this._editType},set:function(n){this._editType=n},configurable:!0});Object.defineProperty(this,"trackType",{get:function(){return this._trackType},set:function(n){this._trackType=n},configurable:!0});Object.defineProperty(this,"implictSegment",{get:function(){return this._implictSegment},set:function(n){this._implictSegment=n},configurable:!0})};Sequence=function(){Object.defineProperty(this,"title",{get:function(){return this._title},set:function(n){this._title=n},configurable:!0});Object.defineProperty(this,"id",{get:function(){return this._id},set:function(n){this._id=n},configurable:!0});Object.defineProperty(this,"frameRate",{get:function(){return this._frameRate},set:function(n){this._frameRate=n},configurable:!0});Object.defineProperty(this,"segments",{get:function(){return this._segments},set:function(n){this._segments=n},configurable:!0});Object.defineProperty(this,"mode",{get:function(){return this._mode},set:function(n){this._mode=n},configurable:!0});Object.defineProperty(this,"screenshots",{get:function(){return this._screenshots},set:function(n){this._screenshots=n},configurable:!0});Object.defineProperty(this,"sequenceSom",{get:function(){return this._sequenceSom},set:function(n){this._sequenceSom=n},configurable:!0})};var SequenceTimelineMetadata=function(){Object.defineProperty(this,"segment",{get:function(){return this._segment},set:function(n){this._segment=n}});Object.defineProperty(this,"time",{get:function(){return this._startTimeInSequence},set:function(n){this._startTimeInSequence=n}});Object.defineProperty(this,"duration",{get:function(){return this._duration},set:function(n){this._duration=n}});Object.defineProperty(this,"timelineType",{get:function(){return this._timelineType},set:function(n){this._timelineType=n}});this._segment;this._startTimeInSequence;this._duration;this._timelineType=null},TimedTextTrack=function(n,t,i,r,u,f,e,o,s){this.type=n;this.language=t;this.url=i;this.offsetTime=r;this.frameRate=u;this.fileExtension=f;this.timedTextDataObject=e;this.version=o;this.isDraftedTrack=s},TimedTextDocument=function(n,t,i,r,u,f,e,o,s){this.index=n;this.time=t;this.duration=i;this.tcIn=r;this.tcOut=u;this.sccOriginalTcIn=f;this.sccOriginalTcOut=e;this.notes=o;this.TimedTextDocument=s},ExtractionRequest=function(n,t,i){this.FrameInfo=n;this.SecureInfo=t;this.TimeoutInMilliseconds=i};ExtractionResponse=function(){Object.defineProperty(this,"thumbInfo",{get:function(){return this._thumbInfo},set:function(n){this._thumbInfo=n},configurable:!0})};FrameInfo=function(n,t,i,r,u){this.Id=n;this.GroupId=t;this.UncPath=i;this.FrameNo=r;this.FrameRate=u};ThumbInfo=function(){Object.defineProperty(this,"groupId",{get:function(){return this._groupId},set:function(n){this._groupId=n},configurable:!0});Object.defineProperty(this,"thumbData",{get:function(){return this._thumbData},set:function(n){this._thumbData=n},configurable:!0});Object.defineProperty(this,"frameInfoIds",{get:function(){return this._frameInfoIds},set:function(n){this._frameInfoIds=n},configurable:!0})};PS_Buffering.prototype.triggerCMPEvent=function(n){var t;switch(n.detail.type){case TransportEvent.PLAY:this.StateMachine.stateTransitionHandler.play();break;case TransportEvent.PAUSE:this.StateMachine.stateTransitionHandler.pause();break;case TransportEvent.STOP:this.StateMachine.eventQueue.queue=null;this.StateMachine.cmpModel.accumulatedSeekTimeInSec=0;this.StateMachine.stateTransitionHandler.stop();break;case TransportEvent.FRAME_FORWARD:this.StateMachine.stateTransitionHandler.frameForward();break;case TransportEvent.FRAME_BACKWARD:this.StateMachine.stateTransitionHandler.frameBackward();break;case TransportEvent.SECOND_FORWARD:this.StateMachine.stateTransitionHandler.secondForward();break;case TransportEvent.SECOND_BACKWARD:this.StateMachine.stateTransitionHandler.secondBackward();break;case TransportEvent.MINUTE_FORWARD:this.StateMachine.stateTransitionHandler.minuteForward();break;case TransportEvent.MINUTE_BACKWARD:this.StateMachine.stateTransitionHandler.minuteBackward();break;case TransportEvent.PLAY_FORWARD:this.StateMachine.stateTransitionHandler.playForward();break;case TransportEvent.PLAY_BACKWARD:this.StateMachine.stateTransitionHandler.playBackward();break;case TransportEvent.SEEK:this.StateMachine.stateTransitionHandler.seek(n.detail.positionToSeek,n.detail.cumulativeOffsetForVideo,n.detail.cumulativeOffsetForAudio);break;case LoadEvent.SET_MEDIA_SOURCE:this.StateMachine.eventQueue.queue=null;this.StateMachine.EventQueue.enqueue(LoadEvent.SET_MEDIA_SOURCE);this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.url);this.StateMachine.currentState=this.StateMachine.stateCollection.INITIALISED;break;case AnnotationEvent.MARK_IN:this.StateMachine.stateTransitionHandler.createMarkInForSegmentOrAnnotation();break;case AnnotationEvent.MARK_OUT:this.StateMachine.stateTransitionHandler.createMarkOutForSegmentOrAnnotation();break;case AnnotationEvent.FINETUNE_SAVE:this.StateMachine.stateTransitionHandler.fineTuneSave();break;case LoadEvent.LOAD_RANGE_MARKER:this.StateMachine.stateTransitionHandler.loadClip(n.detail);break;case SequenceEvent.SWITCH_SEQUENCE_MODE:this.StateMachine.stateTransitionHandler.switchSequenceMode(n.detail);break;case AnnotationEvent.SET_MARK_IN_POSITION:this.StateMachine.stateTransitionHandler.setMarkInPosition(n.detail);break;case AnnotationEvent.SET_MARK_OUT_POSITION:this.StateMachine.stateTransitionHandler.setMarkOutPosition(n.detail);break;case AnnotationEvent.SEEK_TO_ACCUMULATED_TIME_ON_FRAME_SEEK:this.StateMachine.stateTransitionHandler.seekToAccumulatedTimeOnFrameSeek(n.detail);break;case TransportEvent.CAPTURE_FRAME:this.StateMachine.EventQueue.enqueue(SequenceEvent.SCREEN_CAPTURE);this.StateMachine.stateTransitionHandler.pause();break;case LoadEvent.LOAD_SEGMENT:this.StateMachine.eventQueue.queue=null;this.StateMachine.EventQueue.enqueue(LoadEvent.LOAD_SEGMENT);this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.segmentUrl,n.detail.clipStartTime);this.StateMachine.currentState=this.StateMachine.stateCollection.INITIALISED;break;case SequenceEvent.LOAD_CLIP:this.StateMachine.stateTransitionHandler.loadSequenceClip(n.detail);break;case LoadEvent.UNLOAD_MEDIA_URL:this.StateMachine.EventQueue.enqueue(LoadEvent.UNLOAD_MEDIA_URL);this.StateMachine.stateTransitionHandler.removeMediaSource(n.detail);break;case MarkerEvent.NAVIGATE_TO_MARKER_POSITION:this.StateMachine.stateTransitionHandler.navigateToMarkerPosition(n.detail);break;case CMPEvent.SET_CMP_STATE_EVENT:this.StateMachine.setCmpState(n.detail.newState);break;case TransportEvent.SEEK_TO_LIVE:this.StateMachine.stateTransitionHandler.seekToLive();break;default:t="Ready to play. Cannot '"+n.detail.type+"'."}};PS_Buffering.prototype.triggerNativePlayerEvent=function(n){var t;switch(n.arg.toUpperCase()){case"ONSEEKCOMPLETED":this.StateMachine.onSeekCompleted();break;case"LOADING":this.StateMachine.currentState=this.StateMachine.stateCollection.LOADING;break;case"READY":CMPUtils.IsNullOrEmpty(this.StateMachine.cmpModel.clearMediaPlayerTimer)&&this.StateMachine.stateTransitionHandler.setClearMediaPlayerTimer();this.StateMachine.onReady();document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(LoadEvent.CMP_READY));break;case"PLAYING":document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{display:!1}}));this.StateMachine.onPlaying();t=this.StateMachine.EventQueue.peekQueue();t==LoadEvent.LOAD_SEGMENT&&this.StateMachine.handleLoadSegmentOnReady();break;case"PAUSED":document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{display:!1}}));t=this.StateMachine.EventQueue.peekQueue();t==SequenceEvent.SCREEN_CAPTURE&&(this.StateMachine.EventQueue.dequeue(),this.StateMachine.stateTransitionHandler.captureFrame());this.StateMachine.onPaused();break;case"STOPPED":this.StateMachine.onStopped();break;case"UNINITIALIZED":t=this.StateMachine.EventQueue.peekQueue();t==LoadEvent.UNLOAD_MEDIA_URL&&this.StateMachine.resetCmpOnMediaUnload();break;case"MEDIAENDED":this.StateMachine.onMediaEnded();break;case"ERROR":this.StateMachine.onError(n.err)}};PS_Default.prototype.triggerCMPEvent=function(n){var t=null;switch(n.detail.type){default:t="Initialising... Cannot '"+n.detail.type+"'. Please wait!"}};PS_Default.prototype.triggerNativePlayerEvent=function(n){var t=null;switch(n.arg.toUpperCase()){case"PRE_INITIALISED":this.StateMachine.currentState=this.StateMachine.stateCollection.PRE_INITIALISED;this.StateMachine.stateTransitionHandler.setSecureInfo();break;default:t="Initialising... Cannot '"+uiEvent.detail.type+"'. Please wait!"}};PS_Error.prototype.triggerCMPEvent=function(n){switch(n.eventType){}};PS_Error.prototype.triggerNativePlayerEvent=function(n){switch(n.detail.type){}};PS_WaitingForMediaSource.prototype.triggerCMPEvent=function(n){var t=null;switch(n.detail.type){case LoadEvent.SET_MEDIA_SOURCE:this.StateMachine.eventQueue.queue=null;document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(UIEvent.SHOW_HIDE_GENERICS_ICON,{detail:{value:!1}}));document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_REPORT));document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{message:"Loading Media",display:!0}}));this.StateMachine.EventQueue.enqueue(LoadEvent.SET_MEDIA_SOURCE);this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.url);break;case LoadEvent.LOAD_SEGMENT:this.StateMachine.eventQueue.queue=null;this.StateMachine.EventQueue.enqueue(LoadEvent.LOAD_SEGMENT);document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_REPORT));document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{message:"Loading Media",display:!0}}));this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.segmentUrl,n.detail.clipStartTime);document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(UIEvent.SHOW_HIDE_GENERICS_ICON,{detail:{value:!1}}));break;case SequenceEvent.LOAD_CLIP:document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_REPORT));document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{message:"Loading Media",display:!0}}));this.StateMachine.stateTransitionHandler.loadSequenceClip(n.detail);document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(UIEvent.SHOW_HIDE_GENERICS_ICON,{detail:{value:!1}}));break;case SequenceEvent.SWITCH_SEQUENCE_MODE:this.StateMachine.stateTransitionHandler.switchSequenceMode(n.detail);document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(UIEvent.SHOW_HIDE_GENERICS_ICON,{detail:{value:!1}}));break;default:t="Initialising... Cannot '"+n.detail.type+"'. Please wait!"}};PS_WaitingForMediaSource.prototype.triggerNativePlayerEvent=function(n){var i=null,t;switch(n.arg.toUpperCase()){case"LOADING":this.StateMachine.currentState=this.StateMachine.stateCollection.LOADING;break;case"READY":CMPUtils.IsNullOrEmpty(this.StateMachine.cmpModel.clearMediaPlayerTimer)&&this.StateMachine.stateTransitionHandler.setClearMediaPlayerTimer();this.StateMachine.onReady();document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(LoadEvent.CMP_READY));break;case"ONNONAVPRELOADREADY":(this.StateMachine.cmpModel.playerMode==PlayerMode.NON_AV_DOCUMENT||this.StateMachine.cmpModel.playerMode==PlayerMode.NON_AV_IMAGE)&&(this.StateMachine.currentState=this.StateMachine.stateCollection.READY,t=n.params,this.StateMachine.handleNonAV(),this.StateMachine.handleNonAVPreLoadReady(t));break;case"ERROR":this.StateMachine.onError(n.err);break;default:i="Initialising... Cannot '"+n.type+"'. Please wait!"}};PS_Initialised.prototype.triggerCMPEvent=function(n){var t=null;switch(n.detail.type){case LoadEvent.SET_MEDIA_SOURCE:this.StateMachine.eventQueue.queue=null;this.StateMachine.EventQueue.enqueue(LoadEvent.SET_MEDIA_SOURCE);document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{message:"Loading Media",display:!0}}));document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_REPORT));this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.url);break;case LoadEvent.LOAD_SEGMENT:this.StateMachine.eventQueue.queue=null;this.StateMachine.EventQueue.enqueue(LoadEvent.LOAD_SEGMENT);document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{message:"Loading Media",display:!0}}));document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_REPORT));this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.segmentUrl,n.detail.clipStartTime);break;case SequenceEvent.LOAD_CLIP:document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{message:"Loading Media",display:!0}}));document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_REPORT));this.StateMachine.stateTransitionHandler.loadSequenceClip(n.detail);break;case CMPEvent.SET_CMP_STATE_EVENT:this.StateMachine.setCmpState(n.detail.newState);break;case LoadEvent.UNLOAD_MEDIA_URL:this.StateMachine.EventQueue.enqueue(LoadEvent.UNLOAD_MEDIA_URL);this.StateMachine.stateTransitionHandler.removeMediaSource(n.detail);break;default:t="Initialising... Cannot '"+n.detail.type+"'. Please wait!"}};PS_Initialised.prototype.triggerNativePlayerEvent=function(n){var r=null,t,i;switch(n.arg.toUpperCase()){case"LOADING":this.StateMachine.currentState=this.StateMachine.stateCollection.LOADING;this.StateMachine.onLoading();break;case"READY":CMPUtils.IsNullOrEmpty(this.StateMachine.cmpModel.clearMediaPlayerTimer)&&this.StateMachine.stateTransitionHandler.setClearMediaPlayerTimer();this.StateMachine.onReady();document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(LoadEvent.CMP_READY));break;case"ONNONAVPRELOADREADY":(this.StateMachine.cmpModel.playerMode==PlayerMode.NON_AV_DOCUMENT||this.StateMachine.cmpModel.playerMode==PlayerMode.NON_AV_IMAGE)&&(this.StateMachine.currentState=this.StateMachine.stateCollection.READY,t=n.params,this.StateMachine.handleNonAV(),this.StateMachine.handleNonAVPreLoadReady(t));break;case"ERROR":this.StateMachine.onError(n.err);break;case"UNINITIALIZED":i=this.StateMachine.EventQueue.peekQueue();i==LoadEvent.UNLOAD_MEDIA_URL&&this.StateMachine.resetCmpOnMediaUnload();break;default:r="Initialising... Cannot '"+n.type+"'. Please wait!"}};PS_Loading.prototype.triggerCMPEvent=function(n){switch(n.detail.type){case LoadEvent.SET_MEDIA_SOURCE:this.StateMachine.eventQueue.queue=null;this.StateMachine.EventQueue.enqueue(LoadEvent.SET_MEDIA_SOURCE);this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.url);this.StateMachine.currentState=this.StateMachine.stateCollection.INITIALISED;break;case SequenceEvent.LOAD_CLIP:this.StateMachine.stateTransitionHandler.loadSequenceClip(n.detail);break;case LoadEvent.UNLOAD_MEDIA_URL:this.StateMachine.EventQueue.enqueue(LoadEvent.UNLOAD_MEDIA_URL);this.StateMachine.stateTransitionHandler.removeMediaSource(n.detail);break;case SequenceEvent.SWITCH_SEQUENCE_MODE:this.StateMachine.stateTransitionHandler.switchSequenceMode(n.detail);break;case LoadEvent.LOAD_SEGMENT:this.StateMachine.eventQueue.queue=null;this.StateMachine.EventQueue.enqueue(LoadEvent.LOAD_SEGMENT);this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.segmentUrl,n.detail.clipStartTime);this.StateMachine.currentState=this.StateMachine.stateCollection.INITIALISED;break;case"load":msg="Already loading...Please wait";break;default:msg="Loading... Cannot '"+n.detail.type+"'. Please wait!"}};PS_Loading.prototype.triggerNativePlayerEvent=function(n){var i=document.getElementById(this.StateMachine.instanceId),t;switch(n.arg.toUpperCase()){case"READY":CMPUtils.IsNullOrEmpty(this.StateMachine.cmpModel.clearMediaPlayerTimer)&&this.StateMachine.stateTransitionHandler.setClearMediaPlayerTimer();this.StateMachine.onReady();document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(LoadEvent.CMP_READY));break;case"LOADING":this.StateMachine.currentState=this.StateMachine.stateCollection.LOADING;this.StateMachine.onLoading();break;case"UNINITIALIZED":t=this.StateMachine.EventQueue.peekQueue();t==LoadEvent.UNLOAD_MEDIA_URL&&this.StateMachine.resetCmpOnMediaUnload();break;case"ERROR":this.StateMachine.onError(n.err)}};PS_Paused.prototype.triggerCMPEvent=function(n){var t;switch(n.detail.type){case TransportEvent.PLAY:this.StateMachine.stateTransitionHandler.play();break;case TransportEvent.STOP:this.StateMachine.eventQueue.queue=null;this.StateMachine.cmpModel.accumulatedSeekTimeInSec=0;this.StateMachine.stateTransitionHandler.stop();break;case TransportEvent.FRAME_FORWARD:this.StateMachine.stateTransitionHandler.frameForward();break;case TransportEvent.FRAME_BACKWARD:this.StateMachine.stateTransitionHandler.frameBackward();break;case TransportEvent.SECOND_FORWARD:this.StateMachine.stateTransitionHandler.secondForward();break;case TransportEvent.SECOND_BACKWARD:this.StateMachine.stateTransitionHandler.secondBackward();break;case TransportEvent.MINUTE_FORWARD:this.StateMachine.stateTransitionHandler.minuteForward();break;case TransportEvent.MINUTE_BACKWARD:this.StateMachine.stateTransitionHandler.minuteBackward();break;case TransportEvent.PLAY_FORWARD:this.StateMachine.stateTransitionHandler.playForward();break;case TransportEvent.PLAY_BACKWARD:this.StateMachine.stateTransitionHandler.playBackward();break;case TransportEvent.SEEK:this.StateMachine.stateTransitionHandler.seek(n.detail.positionToSeek,n.detail.cumulativeOffsetForVideo,n.detail.cumulativeOffsetForAudio);break;case LoadEvent.SET_MEDIA_SOURCE:this.StateMachine.eventQueue.queue=null;this.StateMachine.EventQueue.enqueue(LoadEvent.SET_MEDIA_SOURCE);this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.url);this.StateMachine.currentState=this.StateMachine.stateCollection.INITIALISED;break;case AnnotationEvent.POINT_ANNOTATION:this.StateMachine.stateTransitionHandler.createPointAnnotation();break;case AnnotationEvent.MARK_IN:this.StateMachine.stateTransitionHandler.createMarkInForSegmentOrAnnotation();break;case AnnotationEvent.MARK_OUT:this.StateMachine.stateTransitionHandler.createMarkOutForSegmentOrAnnotation();break;case LoadEvent.LOAD_SEGMENT:this.StateMachine.eventQueue.queue=null;this.StateMachine.EventQueue.enqueue(LoadEvent.LOAD_SEGMENT);this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.segmentUrl,n.detail.clipStartTime);this.StateMachine.currentState=this.StateMachine.stateCollection.INITIALISED;break;case TransportEvent.SET_LAST_PLAYBACK_TIME:this.StateMachine.stateTransitionHandler.play();this.StateMachine.stateTransitionHandler.resetSeek(n.detail.time);break;case AnnotationEvent.FINETUNE_SAVE:this.StateMachine.stateTransitionHandler.fineTuneSave();break;case LoadEvent.LOAD_RANGE_MARKER:this.StateMachine.stateTransitionHandler.loadClip(n.detail);break;case AnnotationEvent.SET_MARK_IN_POSITION:this.StateMachine.stateTransitionHandler.setMarkInPosition(n.detail);break;case AnnotationEvent.SET_MARK_OUT_POSITION:this.StateMachine.stateTransitionHandler.setMarkOutPosition(n.detail);break;case AnnotationEvent.SEEK_TO_ACCUMULATED_TIME_ON_FRAME_SEEK:this.StateMachine.stateTransitionHandler.seekToAccumulatedTimeOnFrameSeek(n.detail);break;case SequenceEvent.SWITCH_SEQUENCE_MODE:this.StateMachine.stateTransitionHandler.switchSequenceMode(n.detail);break;case TransportEvent.CAPTURE_FRAME:this.StateMachine.stateTransitionHandler.captureFrame();break;case SequenceEvent.LOAD_CLIP:this.StateMachine.stateTransitionHandler.loadSequenceClip(n.detail);break;case LoadEvent.UNLOAD_MEDIA_URL:this.StateMachine.EventQueue.enqueue(LoadEvent.UNLOAD_MEDIA_URL);this.StateMachine.stateTransitionHandler.removeMediaSource(n.detail);break;case MarkerEvent.NAVIGATE_TO_MARKER_POSITION:this.StateMachine.stateTransitionHandler.navigateToMarkerPosition(n.detail);break;case CMPEvent.SET_CMP_STATE_EVENT:this.StateMachine.setCmpState(n.detail.newState);break;case TransportEvent.SEEK_TO_LIVE:this.StateMachine.stateTransitionHandler.seekToLive();break;default:t="Ready to play. Cannot '"+n.detail.type+"'."}};PS_Paused.prototype.triggerNativePlayerEvent=function(n){switch(n.arg.toUpperCase()){case"ONSEEKCOMPLETED":this.StateMachine.onSeekCompleted();break;case"LOADING":this.StateMachine.currentState=this.StateMachine.stateCollection.LOADING;this.StateMachine.onLoading();break;case"BUFFERING":this.StateMachine.onBuffering();break;case"READY":this.StateMachine.onReady();break;case"PLAYING":this.StateMachine.onPlaying();break;case"STOPPED":this.StateMachine.onStopped();break;case"UNINITIALIZED":var t=this.StateMachine.EventQueue.peekQueue();this.StateMachine.resetCmpOnMediaUnload();break;case"MEDIAENDED":this.StateMachine.onMediaEnded();break;case"ERROR":this.StateMachine.onError(n.err)}};PS_Playing.prototype.triggerCMPEvent=function(n){var i,t;switch(n.detail.type){case TransportEvent.PLAY:this.StateMachine.stateTransitionHandler.resetSpeed();break;case TransportEvent.PAUSE:this.StateMachine.EventQueue.enqueue(TransportEvent.PAUSE);this.StateMachine.stateTransitionHandler.pause();break;case TransportEvent.STOP:this.StateMachine.eventQueue.queue=null;this.StateMachine.cmpModel.accumulatedSeekTimeInSec=0;this.StateMachine.stateTransitionHandler.stop();break;case TransportEvent.FRAME_FORWARD:this.handleSeekEvent(1);break;case TransportEvent.FRAME_BACKWARD:this.handleSeekEvent(-1);break;case TransportEvent.SECOND_FORWARD:t=this.StateMachine.cmpModel._playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.SecondsNavigation.JumpToSecs"];this.StateMachine.cmpModel._playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.RetainStateForJump"]=="true"?this.StateMachine.stateTransitionHandler.secondForward():this.handleSeekEvent(t*this.StateMachine.cmpModel.mediaInfo.frameRate);break;case TransportEvent.SECOND_BACKWARD:t=this.StateMachine.cmpModel._playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.SecondsNavigation.JumpToSecs"];this.StateMachine.cmpModel._playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.RetainStateForJump"]=="true"?this.StateMachine.stateTransitionHandler.secondBackward():this.handleSeekEvent(-1*t*this.StateMachine.cmpModel.mediaInfo.frameRate);break;case TransportEvent.MINUTE_FORWARD:this.StateMachine.cmpModel._playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.RetainStateForJump"]=="true"?this.StateMachine.stateTransitionHandler.minuteForward():this.handleSeekEvent(60*this.StateMachine.cmpModel.mediaInfo.frameRate);break;case TransportEvent.MINUTE_BACKWARD:this.StateMachine.cmpModel._playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.RetainStateForJump"]=="true"?this.StateMachine.stateTransitionHandler.minuteBackward():this.handleSeekEvent(-60*this.StateMachine.cmpModel.mediaInfo.frameRate);break;case TransportEvent.PLAY_FORWARD:this.StateMachine.stateTransitionHandler.playForward();break;case TransportEvent.PLAY_BACKWARD:this.StateMachine.stateTransitionHandler.playBackward();break;case LoadEvent.LOAD_SEGMENT:this.StateMachine.eventQueue.queue=null;this.StateMachine.EventQueue.enqueue(LoadEvent.LOAD_SEGMENT);this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.segmentUrl,n.detail.clipStartTime);this.StateMachine.currentState=this.StateMachine.stateCollection.INITIALISED;break;case TransportEvent.SEEK:this.StateMachine.stateTransitionHandler.seek(n.detail.positionToSeek,n.detail.cumulativeOffsetForVideo,n.detail.cumulativeOffsetForAudio);break;case LoadEvent.SET_MEDIA_SOURCE:this.StateMachine.eventQueue.queue=null;this.StateMachine.EventQueue.enqueue(LoadEvent.SET_MEDIA_SOURCE);this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.url);this.StateMachine.currentState=this.StateMachine.stateCollection.INITIALISED;break;case AnnotationEvent.POINT_ANNOTATION:this.StateMachine.stateTransitionHandler.createPointAnnotation();break;case AnnotationEvent.MARK_IN:this.StateMachine.stateTransitionHandler.createMarkInForSegmentOrAnnotation();break;case AnnotationEvent.MARK_OUT:this.StateMachine.stateTransitionHandler.createMarkOutForSegmentOrAnnotation();break;case AnnotationEvent.FINETUNE_SAVE:this.StateMachine.stateTransitionHandler.fineTuneSave();break;case LoadEvent.LOAD_RANGE_MARKER:this.StateMachine.stateTransitionHandler.loadClip(n.detail);break;case SequenceEvent.SWITCH_SEQUENCE_MODE:this.StateMachine.stateTransitionHandler.switchSequenceMode(n.detail);break;case AnnotationEvent.SET_MARK_IN_POSITION:this.StateMachine.stateTransitionHandler.setMarkInPosition(n.detail);break;case AnnotationEvent.SET_MARK_OUT_POSITION:this.StateMachine.stateTransitionHandler.setMarkOutPosition(n.detail);break;case AnnotationEvent.SEEK_TO_ACCUMULATED_TIME_ON_FRAME_SEEK:this.StateMachine.stateTransitionHandler.seekToAccumulatedTimeOnFrameSeek(n.detail);break;case TransportEvent.CAPTURE_FRAME:this.StateMachine.EventQueue.enqueue(SequenceEvent.SCREEN_CAPTURE);this.StateMachine.stateTransitionHandler.pause();break;case SequenceEvent.LOAD_CLIP:this.StateMachine.stateTransitionHandler.loadSequenceClip(n.detail);break;case LoadEvent.UNLOAD_MEDIA_URL:this.StateMachine.EventQueue.enqueue(LoadEvent.UNLOAD_MEDIA_URL);this.StateMachine.stateTransitionHandler.removeMediaSource(n.detail);break;case MarkerEvent.NAVIGATE_TO_MARKER_POSITION:this.StateMachine.stateTransitionHandler.navigateToMarkerPosition(n.detail);break;case CMPEvent.SET_CMP_STATE_EVENT:this.StateMachine.setCmpState(n.detail.newState);break;case TransportEvent.SEEK_TO_LIVE:this.StateMachine.stateTransitionHandler.seekToLive();break;default:i="Ready to play. Cannot '"+n.detail.type+"'."}};PS_Playing.prototype.triggerNativePlayerEvent=function(n){var t;switch(n.arg.toUpperCase()){case"ONSEEKCOMPLETED":this.StateMachine.onSeekCompleted();break;case"LOADING":this.StateMachine.currentState=this.StateMachine.stateCollection.LOADING;this.StateMachine.onLoading();break;case"BUFFERING":this.StateMachine.onBuffering();break;case"READY":this.StateMachine.onReady();break;case"PLAYING":this.StateMachine.onPlaying();break;case"PAUSED":t=this.StateMachine.EventQueue.peekQueue();t==TransportEvent.SEEK&&(this.StateMachine.EventQueue.dequeue(),this.StateMachine.stateTransitionHandler._mediaManager.getCurrentTime()!=0&&this.StateMachine.stateTransitionHandler.seekToAccumulatedTimeOnFrameSeek());t==TransportEvent.PAUSE&&(this.StateMachine.EventQueue.dequeue(),this.StateMachine.stateTransitionHandler.snapToNearestTime());t==SequenceEvent.SCREEN_CAPTURE&&(this.StateMachine.EventQueue.dequeue(),this.StateMachine.stateTransitionHandler.captureFrame());this.StateMachine.onPaused();break;case"STOPPED":this.StateMachine.onStopped();break;case"UNINITIALIZED":t=this.StateMachine.EventQueue.peekQueue();t==LoadEvent.UNLOAD_MEDIA_URL&&this.StateMachine.resetCmpOnMediaUnload();break;case"MEDIAENDED":this.StateMachine.onMediaEnded();break;case"ERROR":this.StateMachine.onError(n.err)}};PS_Playing.prototype.handleSeekEvent=function(n){this.StateMachine.EventQueue.peekQueue()!=TransportEvent.SEEK&&this.StateMachine.EventQueue.enqueue(TransportEvent.SEEK);this.StateMachine.stateTransitionHandler.addToAccumulatedSeekTime(n);this.StateMachine.stateTransitionHandler.pause()};PS_PreInitialised.prototype.triggerCMPEvent=function(n){var t=null;switch(n.detail.type){default:t="Initialising... Cannot '"+n.detail.type+"'. Please wait!"}};PS_PreInitialised.prototype.triggerNativePlayerEvent=function(n){var t=null;switch(n.arg.toUpperCase()){case"INITIALISED":this.StateMachine.onInitialised();break;case"ERROR":this.StateMachine.onError(n.err);break;default:t="Initialising... Cannot '"+uiEvent.detail.type+"'. Please wait!"}};PS_Ready.prototype.triggerCMPEvent=function(n){var t;switch(n.detail.type){case TransportEvent.PLAY:this.StateMachine.stateTransitionHandler.play();break;case TransportEvent.STOP:this.StateMachine.eventQueue.queue=null;this.StateMachine.cmpModel.accumulatedSeekTimeInSec=0;this.StateMachine.stateTransitionHandler.stop();break;case TransportEvent.FRAME_FORWARD:this.StateMachine.stateTransitionHandler.frameForward();break;case TransportEvent.FRAME_BACKWARD:this.StateMachine.stateTransitionHandler.frameBackward();break;case TransportEvent.SECOND_FORWARD:this.StateMachine.stateTransitionHandler.secondForward();break;case TransportEvent.SECOND_BACKWARD:this.StateMachine.stateTransitionHandler.secondBackward();break;case TransportEvent.MINUTE_FORWARD:this.StateMachine.stateTransitionHandler.minuteForward();break;case TransportEvent.MINUTE_BACKWARD:this.StateMachine.stateTransitionHandler.minuteBackward();break;case TransportEvent.PLAY_FORWARD:this.StateMachine.stateTransitionHandler.playForward();break;case TransportEvent.PLAY_BACKWARD:this.StateMachine.stateTransitionHandler.playBackward();break;case TransportEvent.SEEK:this.StateMachine.stateTransitionHandler.seek(n.detail.positionToSeek,n.detail.cumulativeOffsetForVideo,n.detail.cumulativeOffsetForAudio);break;case LoadEvent.SET_MEDIA_SOURCE:this.StateMachine.eventQueue.queue=null;this.StateMachine.EventQueue.enqueue(LoadEvent.SET_MEDIA_SOURCE);this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.url);this.StateMachine.currentState=this.StateMachine.stateCollection.INITIALISED;break;case TransportEvent.SET_LAST_PLAYBACK_TIME:this.StateMachine.stateTransitionHandler.play();this.StateMachine.stateTransitionHandler.resetSeek(n.detail.time);break;case AnnotationEvent.POINT_ANNOTATION:this.StateMachine.stateTransitionHandler.createPointAnnotation();break;case AnnotationEvent.MARK_IN:this.StateMachine.stateTransitionHandler.createMarkInForSegmentOrAnnotation();break;case AnnotationEvent.MARK_OUT:this.StateMachine.stateTransitionHandler.createMarkOutForSegmentOrAnnotation();break;case LoadEvent.LOAD_SEGMENT:this.StateMachine.eventQueue.queue=null;this.StateMachine.EventQueue.enqueue(LoadEvent.LOAD_SEGMENT);this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.segmentUrl,n.detail.clipStartTime);this.StateMachine.currentState=this.StateMachine.stateCollection.INITIALISED;break;case AnnotationEvent.FINETUNE_SAVE:this.StateMachine.stateTransitionHandler.fineTuneSave();break;case LoadEvent.LOAD_RANGE_MARKER:this.StateMachine.stateTransitionHandler.loadClip(n.detail);break;case SequenceEvent.SWITCH_SEQUENCE_MODE:this.StateMachine.stateTransitionHandler.switchSequenceMode(n.detail);break;case AnnotationEvent.SET_MARK_IN_POSITION:this.StateMachine.stateTransitionHandler.setMarkInPosition(n.detail);break;case AnnotationEvent.SET_MARK_OUT_POSITION:this.StateMachine.stateTransitionHandler.setMarkOutPosition(n.detail);break;case AnnotationEvent.SEEK_TO_ACCUMULATED_TIME_ON_FRAME_SEEK:this.StateMachine.stateTransitionHandler.seekToAccumulatedTimeOnFrameSeek(n.detail);break;case TransportEvent.CAPTURE_FRAME:this.StateMachine.stateTransitionHandler.captureFrame();break;case SequenceEvent.LOAD_CLIP:this.StateMachine.stateTransitionHandler.loadSequenceClip(n.detail);break;case LoadEvent.UNLOAD_MEDIA_URL:this.StateMachine.EventQueue.enqueue(LoadEvent.UNLOAD_MEDIA_URL);this.StateMachine.stateTransitionHandler.removeMediaSource(n.detail);break;case MarkerEvent.NAVIGATE_TO_MARKER_POSITION:this.StateMachine.stateTransitionHandler.navigateToMarkerPosition(n.detail);break;case CMPEvent.SET_CMP_STATE_EVENT:this.StateMachine.setCmpState(n.detail.newState);break;case TransportEvent.SEEK_TO_LIVE:this.StateMachine.stateTransitionHandler.seekToLive();break;default:t="Ready to play. Cannot '"+n.detail.type+"'."}};PS_Ready.prototype.triggerNativePlayerEvent=function(n){var i,t;switch(n.arg.toUpperCase()){case"ONSEEKCOMPLETED":this.StateMachine.onSeekCompleted();break;case"LOADING":this.StateMachine.currentState=this.StateMachine.stateCollection.LOADING;this.StateMachine.onLoading();break;case"BUFFERING":this.StateMachine.onBuffering();break;case"PLAYING":this.StateMachine.onPlaying();document.getElementById(this.StateMachine.instanceId).dispatchEvent(new CustomEvent(TransportEvent.HIDE_PLAY_BACK_OVERLAY));break;case"PAUSED":this.StateMachine.onPaused();break;case"STOPPED":this.StateMachine.onStopped();break;case"UNINITIALIZED":i=this.StateMachine.EventQueue.peekQueue();i==LoadEvent.UNLOAD_MEDIA_URL&&this.StateMachine.resetCmpOnMediaUnload();break;case"ONNONAVREADY":(this.StateMachine.cmpModel.playerMode==PlayerMode.NON_AV_DOCUMENT||this.StateMachine.cmpModel.playerMode==PlayerMode.NON_AV_IMAGE)&&(t=n.params,this.StateMachine.handleNonAVReady(t));break;case"ONNONAVPRELOADREADY":(this.StateMachine.cmpModel.playerMode==PlayerMode.NON_AV_DOCUMENT||this.StateMachine.cmpModel.playerMode==PlayerMode.NON_AV_IMAGE)&&(this.StateMachine.currentState=this.StateMachine.stateCollection.READY,t=n.params,this.StateMachine.handleNonAVPreLoadReady(t));break;case"ERROR":this.StateMachine.onError(n.err)}};PS_Stopped.prototype.triggerCMPEvent=function(n){var t;switch(n.detail.type){case TransportEvent.PLAY:this.StateMachine.stateTransitionHandler.play();break;case TransportEvent.FRAME_FORWARD:this.StateMachine.stateTransitionHandler.frameForward();break;case TransportEvent.SECOND_FORWARD:this.StateMachine.stateTransitionHandler.secondForward();break;case TransportEvent.MINUTE_FORWARD:this.StateMachine.stateTransitionHandler.minuteForward();break;case TransportEvent.PLAY_FORWARD:this.StateMachine.stateTransitionHandler.playForward();break;case TransportEvent.SEEK:this.StateMachine.stateTransitionHandler.seek(n.detail.positionToSeek,n.detail.cumulativeOffsetForVideo,n.detail.cumulativeOffsetForAudio);break;case LoadEvent.LOAD_SEGMENT:return this.StateMachine.eventQueue.queue=null,this.StateMachine.EventQueue.enqueue(LoadEvent.LOAD_SEGMENT),this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.segmentUrl,n.detail.clipStartTime),this.StateMachine.currentState=this.StateMachine.stateCollection.INITIALISED,!0;case TransportEvent.SET_LAST_PLAYBACK_TIME:this.StateMachine.stateTransitionHandler.play();this.StateMachine.stateTransitionHandler.resetSeek(n.detail.time);break;case AnnotationEvent.POINT_ANNOTATION:this.StateMachine.stateTransitionHandler.createPointAnnotation();break;case AnnotationEvent.MARK_IN:this.StateMachine.stateTransitionHandler.createMarkInForSegmentOrAnnotation();break;case AnnotationEvent.MARK_OUT:this.StateMachine.stateTransitionHandler.createMarkOutForSegmentOrAnnotation();break;case AnnotationEvent.FINETUNE_SAVE:this.StateMachine.stateTransitionHandler.fineTuneSave();break;case LoadEvent.LOAD_RANGE_MARKER:this.StateMachine.stateTransitionHandler.loadClip(n.detail);break;case AnnotationEvent.SET_MARK_IN_POSITION:this.StateMachine.stateTransitionHandler.setMarkInPosition(n.detail);break;case AnnotationEvent.SET_MARK_OUT_POSITION:this.StateMachine.stateTransitionHandler.setMarkOutPosition(n.detail);break;case AnnotationEvent.SEEK_TO_ACCUMULATED_TIME_ON_FRAME_SEEK:this.StateMachine.stateTransitionHandler.seekToAccumulatedTimeOnFrameSeek(n.detail);break;case SequenceEvent.SWITCH_SEQUENCE_MODE:this.StateMachine.stateTransitionHandler.switchSequenceMode(n.detail);break;case TransportEvent.CAPTURE_FRAME:this.StateMachine.stateTransitionHandler.captureFrame();break;case SequenceEvent.LOAD_CLIP:this.StateMachine.stateTransitionHandler.loadSequenceClip(n.detail);break;case LoadEvent.SET_MEDIA_SOURCE:this.StateMachine.eventQueue.queue=null;this.StateMachine.EventQueue.enqueue(LoadEvent.SET_MEDIA_SOURCE);this.StateMachine.stateTransitionHandler.setMediaSource(n.detail.url);this.StateMachine.currentState=this.StateMachine.stateCollection.INITIALISED;break;case LoadEvent.UNLOAD_MEDIA_URL:this.StateMachine.EventQueue.enqueue(LoadEvent.UNLOAD_MEDIA_URL);this.StateMachine.stateTransitionHandler.removeMediaSource(n.detail);break;case MarkerEvent.NAVIGATE_TO_MARKER_POSITION:this.StateMachine.stateTransitionHandler.navigateToMarkerPosition(cmpEvent.detail);break;case CMPEvent.SET_CMP_STATE_EVENT:this.StateMachine.setCmpState(n.detail.newState);break;case TransportEvent.SEEK_TO_LIVE:this.StateMachine.stateTransitionHandler.seekToLive();break;default:t="Ready to play. Cannot '"+n.detail.type+"'."}};PS_Stopped.prototype.triggerNativePlayerEvent=function(n){switch(n.arg.toUpperCase()){case"ONSEEKCOMPLETED":this.StateMachine.onSeekCompleted();break;case"LOADING":this.StateMachine.currentState=this.StateMachine.stateCollection.LOADING;this.StateMachine.onLoading();break;case"BUFFERING":this.StateMachine.onBuffering();break;case"READY":this.StateMachine.onReady();break;case"PLAYING":this.StateMachine.onPlaying();break;case"PAUSED":this.StateMachine.onPaused();break;case"STOPPED":this.StateMachine.onStopped();break;case"UNINITIALIZED":var t=this.StateMachine.EventQueue.peekQueue();t==LoadEvent.UNLOAD_MEDIA_URL&&this.StateMachine.resetCmpOnMediaUnload();break;case"ERROR":this.StateMachine.onError(n.err)}};StateMachine.prototype.triggerCMPEvent=function(n){this.CurrentState!=undefined&&this.CurrentState.triggerCMPEvent(n)};StateMachine.prototype.triggerNativePlayerEvent=function(n){this.cmpModel.supportedFeatures.contains("CheckFlashPluginInstallation")&&this.cmpModel.pluginLoadTimer&&(clearTimeout(this.cmpModel.pluginLoadTimer),this.cmpModel.pluginLoadTimer=null);CMPUtils.IsNullOrEmpty(n.detail)||CMPUtils.IsNullOrEmpty(n.detail.oldState)||this.cmpModel.oldState==n.detail.oldState||n.detail.arg==n.detail.oldState||(this.cmpModel.oldState=n.detail.oldState);this.CurrentState!=undefined&&this.CurrentState.triggerNativePlayerEvent(n.detail)};StateMachine.prototype.getPda=function(){return this.pda==undefined&&(this.pda=new PushDownAutomaton),this.pda};StateMachine.prototype.setPda=function(n){this.pda=n};StateMachine.prototype.getQueue=function(){return this.queue==undefined&&(this.queue=new EventQueue),this.queue};StateMachine.prototype.setQueue=function(n){this.queue=n};StateMachine.prototype.handleTopAction=function(n,t,i){var r=this.EventQueue.peekQueue();return n==r&&(t(),(CMPUtils.IsNullOrEmpty(i)||i!=!0)&&this.EventQueue.dequeue()),r};StateMachine.prototype.onSeekCompleted=function(){var n=this,t;this.cmpModel.showBufferingIcon=!1;this.stateTransitionHandler.isSegmentSeekPositionReached(this.cmpModel.segmentSeekPosition)?this.cmpModel.segmentSeekPosition==-1:this.cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW&&this.stateTransitionHandler.seek(this.cmpModel.segmentSeekPosition);this.handleTopAction(LoadEvent.LOAD_SEGMENT,function(){return function(){n.handleSegmentLoaded()}}(n));this.handleTopAction(TransportEvent.PLAYBACK_SPEED_CHANGE,function(){return function(){n.stateTransitionHandler.setPlaybackSpeed()}}(n));this.stateTransitionHandler.seekToAccumulatedTime();t=this.eventQueue.peekQueue();t==TransportEvent.SEEK&&this.eventQueue.dequeue();(this.cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW||this.cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW)&&this.cmpModel.timelineMetadata.addEvent();document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.HIDE_PLAY_BACK_OVERLAY));this.validateStateAfterSeek();document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TimelineMetadataEvent.RESET_TIMELINE_METADATA));this.cmpModel.mediaInfo.isLive&&this.stateTransitionHandler.checkAndDispatchEventOnLivePlayHeadChange()};StateMachine.prototype.onReady=function(){var n=this;this.stateTransitionHandler.pauseOnFirstFrame();document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{display:!1}}));document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_REPORT));document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(UIEvent.SHOW_HIDE_GENERICS_ICON,{detail:{value:!1}}));this.currentState=this.stateCollection.READY;this.cmpModel.showBufferingIcon=!1;this.handleTopAction(LoadEvent.SET_MEDIA_SOURCE,function(){return function(){n.onSetMediaSource()}}(n));this.handleTopAction(LoadEvent.LOAD_SEGMENT,function(){return function(){n.handleLoadSegmentOnReady()}}(n),!0);this.handleTopAction(SequenceEvent.LOAD_CLIP,function(){return function(){n.loadClip()}}(n));this.showMediaInfoIfEnabled();this.stateTransitionHandler.loadConfiguredAudioTrack();this.stateTransitionHandler.setDefaultVolume();this.cmpModel.mediaInfo.isLive=this.stateTransitionHandler.isLive();this.cmpModel.mediaInfo.isLive&&this.stateTransitionHandler.initiliseLiveStream();CMPUtils.IsNullOrEmpty(this.cmpModel.timelinethumbnail)||this.cmpModel.timelinethumbnail.activate()};StateMachine.prototype.onBuffering=function(){this.currentState=this.stateCollection.BUFFERING;this.cmpModel.bufferingTimer&&(clearTimeout(this.cmpModel.bufferingTimer),this.cmpModel.bufferingTimer=null);this.cmpModel.bufferingTimer=setTimeout(function(n){n.currentState==n.stateCollection.BUFFERING&&document.getElementById(n.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{message:"Buffering",display:!0}}))},1e3,this)};StateMachine.prototype.onLoading=function(){document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{message:"Buffering",display:!0}}))};StateMachine.prototype.onPlaying=function(){this.currentState=this.stateCollection.PLAYING;this.cmpModel.showBufferingIcon=!1;this.cmpModel.playbackSpeedRange[this.cmpModel.currentPlaybackSpeedIndex]==1&&this.cmpModel.playerInfo.UserPreferredSetting.playbackMode=="Normal"||this.cmpModel.playerInfo.UserPreferredSetting.playbackMode!="Normal"?document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.PLAY_SUCCESS)):this.cmpModel.playerInfo.UserPreferredSetting.playbackMode=="Normal"&&document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.PAUSE_SUCCESS));document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.HIDE_PLAY_OVERLAY));document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.SHOW_PAUSE_OVERLAY));document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_REPORT))};StateMachine.prototype.onPaused=function(n){var t,i,r;this.cmpModel.showBufferingIcon=!1;t=CMPUtils.getDefaultSpeedIndex(this.cmpModel.playbackSpeedRange);this.cmpModel.currentPlaybackSpeedIndex<t&&(i=new CLEARMediaPlayerAPI(activePlayerInstance),r=i.getCurrentPlaybackTime(),r==0&&(document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.RESET_PLAYBACK_SPEED)),this.cmpModel.currentPlaybackSpeedIndex=t-1,this.stateTransitionHandler.changePlaybackSpeed(!0)));document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.PAUSE_SUCCESS));document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(ErrorEvent.HIDE_ERROR_REPORT));(CMPUtils.IsNullOrEmpty(n)||n=="false")&&this.cmpModel.playerMode!=PlayerMode.NON_AV_DOCUMENT&&this.cmpModel.playerMode!=PlayerMode.NON_AV_IMAGE&&(document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.SHOW_PLAY_OVERLAY)),document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.HIDE_PAUSE_OVERLAY)));this.currentState=this.stateCollection.PAUSED;this.cmpModel.mediaInfo.isLive&&(this.cmpModel.isSeekToLiveRequested=!1,this.stateTransitionHandler.checkAndDispatchEventOnLivePlayHeadChange())};StateMachine.prototype.onStopped=function(){this.cmpModel.showBufferingIcon=!1;document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{display:!1}}));document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.STOP_SUCCESS));document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.RESET_PLAYBACK_SPEED));document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TimelineMetadataEvent.RESET_TIMELINE_METADATA));this.currentState=this.stateCollection.STOPPED};StateMachine.prototype.onInitialised=function(){var n=!!window.chrome&&!!window.chrome.webstore;n&&(document.getElementById(this.instanceId+"_ClearMediaPlayer").style.visibility="visible");document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{display:!1}}));this.cmpModel.playerInfo.IsloadBlankPlayer?(this.currentState=this.stateCollection.WAITINGFORMEDIASOURCE,document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(UIEvent.SHOW_HIDE_GENERICS_ICON,{detail:{value:!0}}))):(this.currentState=this.stateCollection.INITIALISED,this.stateTransitionHandler.loadUrl(),this.stateTransitionHandler.addAnnotationsToTimeline());document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(LoadEvent.CMP_INITIALISED));this.cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW&&this.cmpModel.playerInfo.CMPConfig.CMPConfigValue.EnableMixedFrameRateSupport.toUpperCase()==="TRUE"&&this.cmpModel.isMixedFrameRate&&document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(UIEvent.ON_MIXEDFRAMERATE_PLAYBACK))};StateMachine.prototype.onSetMediaSource=function(){if(this.cmpModel.playerMode!=PlayerMode.NON_AV_DOCUMENT&&this.cmpModel.playerMode!=PlayerMode.NON_AV_IMAGE){this.stateTransitionHandler.updateMediaDuration();document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(SeekBarEvent.LOAD_SEEKBAR));this.stateTransitionHandler.getStreamBitrates();this.stateTransitionHandler.checkLastPlayBackTimeThreshold();var n=!1;this.cmpModel.mediaInfo.islastPlayBackTimeEnabled&&this.cmpModel.mediaInfo.lastPlayBackTime!=0&&(n=this.cmpModel.mediaInfo.lastPlayBackTime==this.cmpModel.mediaDuration?!0:!1,n?this.stateTransitionHandler.seek(0):this.stateTransitionHandler.seek(this.cmpModel.mediaInfo.lastPlayBackTime*1e3));this.cmpModel.playerMode==PlayerMode.STRATA&&(this.stateTransitionHandler.seek(this.cmpModel.mediaInfo.startSeek),new TimelineManager(this.stateTransitionHandler._nativeApi,this.cmpModel,this.instanceId).loadStrataMarkersToTimelineMetadata());this.cmpModel.autoPlay?this.stateTransitionHandler.play():document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(CMPEvent.STATE_CHANGE_EVENT,{detail:{state:"READY",lastPlayBackTime:this.cmpModel.mediaInfo.lastPlayBackTime}}));document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.SHOW_PLAY_OVERLAY,{detail:{lastPlaybackTimeReachedMediaEnd:n}}));document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.HIDE_PAUSE_OVERLAY))}else this.handleNonAV()};StateMachine.prototype.onMediaEnded=function(){if(this.cmpModel.isMediaDurationReached=!0,this.cmpModel.playerMode!=PlayerMode.SEQUENCE_PREVIEW&&this.cmpModel.playerMode!=PlayerMode.STRATA&&this.cmpModel.playerMode!=PlayerMode.SEQUENCE_CPL_PREVIEW)if(document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{display:!1}})),this.cmpModel.mediaInfo.islastPlayBackTimeEnabled&&(this.cmpModel.isMediaFullyWatched=!0,document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(LastPlayBackTimeEvent.ADD_OR_UPDATE_LPT,{detail:{playerContainerId:this.instanceId}}))),document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TimelineEvent.LAST_FRAME_REACHED)),this.cmpModel.playerInfo.UserPreferredSetting.playbackMode=="Normal")this.stateTransitionHandler.stop();else{if(this.cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.PauseOnMediaDurationReached"]&&this.cmpModel.playerInfo.CMPConfig.CMPConfigValue["VideoPanelConfig.PauseOnMediaDurationReached"].toString()=="true"){this.cmpModel.currentPlaybackSpeedIndex!=CMPUtils.getDefaultSpeedIndex(this.cmpModel.playbackSpeedRange)&&document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.RESET_PLAYBACK_SPEED));return}this.stateTransitionHandler.stop()}this.stateTransitionHandler.pause()};StateMachine.prototype.resetCmpOnMediaUnload=function(){this.stateTransitionHandler.resetCmpOnMediaUnload()};StateMachine.prototype.loadClip=function(){this.stateTransitionHandler.updateMediaDuration()};StateMachine.prototype.handleLoadSegmentOnReady=function(){this.cmpModel.currentSegment!=null&&(this.cmpModel.segmentSeekPosition>=0||this.cmpModel.videoSyncOffsetValue>=0)&&(this.stateTransitionHandler.updateMediaDuration(),this.cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW?this.stateTransitionHandler.seek(this.cmpModel.segmentSeekPosition,parseFloat(this.cmpModel.videoSyncOffsetValue*1e3),0):this.stateTransitionHandler.seek(this.cmpModel.segmentSeekPosition))};StateMachine.prototype.handleSegmentLoaded=function(){if(!CMPUtils.IsNullOrEmpty(this.cmpModel.currentSegment))if(this.cmpModel.autoPlay==!0&&(this.cmpModel.playerMode==PlayerMode.SEQUENCE_PREVIEW||this.cmpModel.playerMode==PlayerMode.SEQUENCE_CPL_PREVIEW))this.cmpModel.autoPlay=!1,this.isInPlayingState()||(this.stateTransitionHandler.play(),document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.HIDE_PLAY_OVERLAY)),document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.SHOW_PAUSE_OVERLAY)));else if(this.cmpModel.autoPlay==!0&&this.cmpModel.playerMode==PlayerMode.SEQUENCE_SEGMENT_EDIT)this.stateTransitionHandler.play(),document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.HIDE_PLAY_OVERLAY)),document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.SHOW_PAUSE_OVERLAY));else{this.stateTransitionHandler.pause();var n=!0;this.cmpModel.mediaInfo.islastPlayBackTimeEnabled&&this.cmpModel.mediaInfo.lastPlayBackTime!=0&&(n=this.cmpModel.mediaInfo.lastPlayBackTime==this.cmpModel.mediaDuration?!0:!1);document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.SHOW_PLAY_OVERLAY,{detail:{lastPlaybackTimeReachedMediaEnd:n}}));document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.HIDE_PAUSE_OVERLAY))}document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.ENABLE_SEEKBAR_UPDATE))};StateMachine.prototype.isInPlayingState=function(){return this.CurrentState==this.stateCollection.PLAYING||this.CurrentState==this.stateCollection.BUFFERING&&_this._cmpModel.oldState=="PLAYING"?!0:!1};StateMachine.prototype.handleNonAV=function(){var n=this.cmpModel.nonAVMediaInfo,t,i;this.cmpModel.playerMode==PlayerMode.NON_AV_DOCUMENT?(t=n.documentMetadata.currentPage,i=n.documentMetadata.totalPages,document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(NonAvViewerEvent.UPDATE_UI_CONTROLS,{detail:{currentPage:t,totalPages:i}}))):this.cmpModel.playerMode==PlayerMode.NON_AV_IMAGE;document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(CMPEvent.STATE_CHANGE_EVENT,{detail:{state:"READY"}}))};StateMachine.prototype.validateStateAfterSeek=function(){this.cmpModel.stateAfterSeek!=null&&(this.cmpModel.stateAfterSeek.toUpperCase()=="PAUSE"?(this.cmpModel.stateAfterSeek=null,this.stateTransitionHandler.pause(),document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.SHOW_PLAY_OVERLAY)),document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.HIDE_PAUSE_OVERLAY))):this.cmpModel.stateAfterSeek.toUpperCase()=="PLAY"&&(this.cmpModel.stateAfterSeek=null,this.stateTransitionHandler.play(),document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.SHOW_PAUSE_OVERLAY)),document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.HIDE_PLAY_OVERLAY))))};StateMachine.prototype.handleNonAVPreLoadReady=function(n){var i=this.cmpModel.nonAVMediaInfo.nonAvViewInfo._activeContainerIds,t;for(document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{message:"Buffering",display:!0}})),t=0;t<i.length;t++)if(i[t]==n){this.stateTransitionHandler.updateNonAvContainerDisplay(n);break}else this.stateTransitionHandler.preloadNextContainer(n)};StateMachine.prototype.handleNonAVReady=function(n){var r=this.cmpModel.nonAVMediaInfo,i,t;for(document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(UIEvent.UPDATE_PLAYER_STATE,{detail:{display:!1}})),document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(LoadEvent.CMP_READY)),i=JSON.parse(n.updatedContainerDetails),t=0;t<i.length;t++)r.nonAvViewInfo.containers[r.nonAvViewInfo.activeContainerIds[t]].isBuffered=!0,document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(TransportEvent.NON_AV_BUFFERING_SUCCESS,{detail:{containerId:i[t].id}}));this.stateTransitionHandler.handleNonAVReady(n)};StateMachine.prototype.setCmpState=function(n){switch(n){case"WAITINGFORMEDIASOURCE":this.currentState=this.stateCollection.WAITINGFORMEDIASOURCE}};StateMachine.prototype.showMediaInfoIfEnabled=function(){this.cmpModel.isMediaInfoModeEnabled&&document.getElementById(this.instanceId).dispatchEvent(new CustomEvent(LoadEvent.GET_MEDIAINFO))};StateMachine.prototype.onError=function(n){this.currentState=this.stateCollection.ERROR;this.stateTransitionHandler.handleError(n)};PushDownAutomaton.prototype.push=function(n){this.stack==undefined&&(this.stack=[]);this.stack.push(n)};PushDownAutomaton.prototype.pop=function(){this.peek()!=undefined&&this.stack.pop()};PushDownAutomaton.prototype.peek=function(){return this.stack[this.stack.length-1]};EventQueue.prototype.enqueue=function(n){this.queue==undefined&&(this.queue=[]);this.peekQueue()!=n&&this.queue.push(n)};EventQueue.prototype.dequeue=function(){this.peekQueue()!=undefined&&this.queue.shift()};EventQueue.prototype.peekQueue=function(){return this.queue!=undefined?this.queue[0]:undefined};markerIds=[];selectorClick=!1;Bin=function(){Object.defineProperty(this,"clips",{get:function(){return this._clips},set:function(n){this._clips=n},configurable:!0})};ClearEditorProject=function(){Object.defineProperty(this,"sequence",{get:function(){return this._sequence},set:function(n){this._sequence=n},configurable:!0});Object.defineProperty(this,"bin",{get:function(){return this._bin},set:function(n){this._bin=n},configurable:!0})};SequenceClipInfo=function(){Object.defineProperty(this,"clipId",{get:function(){return this._clipId},set:function(n){this._clipId=n}});Object.defineProperty(this,"clipUiId",{get:function(){return this._clipUiId},set:function(n){this._clipUiId=n}});Object.defineProperty(this,"position",{get:function(){return this._position},set:function(n){this._position=n},configurable:!0})};ScreenShot=function(){Object.defineProperty(this,"id",{get:function(){return this._id},set:function(n){this._id=n},configurable:!0});Object.defineProperty(this,"captureTimeSecs",{get:function(){return this._captureTimeSecs},set:function(n){this._captureTimeSecs=n},configurable:!0});Object.defineProperty(this,"selected",{get:function(){return this._selected},set:function(n){this._selected=n},configurable:!0});Object.defineProperty(this,"clipOrderId",{get:function(){return this._clipOrderId},set:function(n){this._clipOrderId=n},configurable:!0});Object.defineProperty(this,"dataUri",{get:function(){return this._dataUri},set:function(n){this._dataUri=n},configurable:!0})};FormattingObject=function(){Object.defineProperty(this,"XPos",{get:function(){return this._XPos},set:function(n){this._XPos=n},configurable:!0});Object.defineProperty(this,"YPos",{get:function(){return this._YPos},set:function(n){this._YPos=n},configurable:!0});Object.defineProperty(this,"Color",{get:function(){return this._Color},set:function(n){this._Color=n},configurable:!0});Object.defineProperty(this,"ARGB",{get:function(){return this._ARGB},set:function(n){this._ARGB=n},configurable:!0});Object.defineProperty(this,"FontStyle",{get:function(){return this._FontStyle},set:function(n){this._FontStyle=n},configurable:!0});Object.defineProperty(this,"Justification",{get:function(){return this._Justification},set:function(n){this._Justification=n},configurable:!0});Object.defineProperty(this,"HorizontalAlign",{get:function(){return this._HorizontalAlign},set:function(n){this._HorizontalAlign=n},configurable:!0});this._YPos;this._XPos;this._Color="0xFFFFFF";this._ARGB="0xFFFFFF";this._FontStyle;this._Justification;this._HorizontalAlign};MarkerLayer=function(){Object.defineProperty(MarkerLayer.prototype,"id",{get:function(){return this._id},set:function(n){this._id=n},configurable:!0});Object.defineProperty(MarkerLayer.prototype,"name",{get:function(){return this._name},set:function(n){this._name=n},configurable:!0});Object.defineProperty(MarkerLayer.prototype,"isSelected",{get:function(){return this._isSelected},set:function(n){this._isSelected=n},configurable:!0});Object.defineProperty(MarkerLayer.prototype,"markers",{get:function(){return this._markers},set:function(n){this._markers=n},configurable:!0});this._id;this._name;this._isSelected;this._markers={}};var NonAvDisplayRequest=function(){this.id;this.rotationOffset;this.zoomPercentage;this.contentX;this.contentY;this.contentHeight;this.contentWidth;this.containerWidth;this.containerHeight;this.containerX;this.containerY},NonAvViewInfo=function(){Object.defineProperty(NonAvViewInfo.prototype,"containers",{get:function(){return this._containers},set:function(n){this._containers=n},configurable:!0});Object.defineProperty(NonAvViewInfo.prototype,"activeContainerIds",{get:function(){return this._activeContainerIds},set:function(n){this._activeContainerIds=n},configurable:!0});this._containers;this._activeContainerIds=[]},DocumentInfo=function(){Object.defineProperty(DocumentInfo.prototype,"documentMetadata",{get:function(){return this._documentMetadata},set:function(n){this._documentMetadata=n},configurable:!0});Object.defineProperty(DocumentInfo.prototype,"nonAvViewInfo",{get:function(){return this._nonAvViewInfo},set:function(n){this._nonAvViewInfo=n},configurable:!0});this._documentMetadata;this._nonAvViewInfo},DocumentMetadata=function(){Object.defineProperty(DocumentMetadata.prototype,"id",{get:function(){return this._id},set:function(n){this._id=n},configurable:!0});Object.defineProperty(DocumentMetadata.prototype,"title",{get:function(){return this._title},set:function(n){this._title=n},configurable:!0});Object.defineProperty(DocumentMetadata.prototype,"size",{get:function(){return this._size},set:function(n){this._size=n},configurable:!0});Object.defineProperty(DocumentMetadata.prototype,"url",{get:function(){return this._url},set:function(n){this._url=n},configurable:!0});Object.defineProperty(DocumentMetadata.prototype,"currentPage",{get:function(){return this._currentPage},set:function(n){this._currentPage=n},configurable:!0});Object.defineProperty(DocumentMetadata.prototype,"totalPages",{get:function(){return this._totalPages},set:function(n){this._totalPages=n},configurable:!0});Object.defineProperty(DocumentMetadata.prototype,"resolution",{get:function(){return this._resolution},set:function(n){this._resolution=n},configurable:!0});Object.defineProperty(DocumentMetadata.prototype,"isPreLoadEnabled",{get:function(){return this._isPreLoadEnabled},set:function(n){this._isPreLoadEnabled=n},configurable:!0});this._id;this._title;this._size;this._url;this._currentPage;this._totalPages;this._resolution;this._isPreLoadEnabled},Container=function(){Object.defineProperty(Container.prototype,"id",{get:function(){return this._id},set:function(n){this._id=n},configurable:!0});Object.defineProperty(Container.prototype,"rotationOffset",{get:function(){return this._rotationOffset},set:function(n){this._rotationOffset=n},configurable:!0});Object.defineProperty(Container.prototype,"zoomPercentage",{get:function(){return this._zoomPercentage},set:function(n){this._zoomPercentage=n},configurable:!0});Object.defineProperty(Container.prototype,"contentX",{get:function(){return this._contentX},set:function(n){this._contentX=n},configurable:!0});Object.defineProperty(Container.prototype,"contentY",{get:function(){return this._contentY},set:function(n){this._contentY=n},configurable:!0});Object.defineProperty(Container.prototype,"viewType",{get:function(){return this._viewType},set:function(n){this._viewType=n},configurable:!0});Object.defineProperty(Container.prototype,"contentWidth",{get:function(){return this._contentWidth},set:function(n){this._contentWidth=n},configurable:!0});Object.defineProperty(Container.prototype,"contentHeight",{get:function(){return this._contentHeight},set:function(n){this._contentHeight=n},configurable:!0});Object.defineProperty(Container.prototype,"contentOrginalWidth",{get:function(){return this._contentOrginalWidth},set:function(n){this._contentOrginalWidth=n},configurable:!0});Object.defineProperty(Container.prototype,"contentOrginalHeight",{get:function(){return this._contentOrginalHeight},set:function(n){this._contentOrginalHeight=n},configurable:!0});Object.defineProperty(Container.prototype,"sequenceNumber",{get:function(){return this._sequenceNumber},set:function(n){this._sequenceNumber=n},configurable:!0});Object.defineProperty(Container.prototype,"containerWidth",{get:function(){return this._containerWidth},set:function(n){this._containerWidth=n},configurable:!0});Object.defineProperty(Container.prototype,"containerHeight",{get:function(){return this._containerHeight},set:function(n){this._containerHeight=n},configurable:!0});Object.defineProperty(Container.prototype,"containerX",{get:function(){return this._containerX},set:function(n){this._containerX=n},configurable:!0});Object.defineProperty(Container.prototype,"containerY",{get:function(){return this._containerY},set:function(n){this._containerY=n},configurable:!0});Object.defineProperty(Container.prototype,"isContainerVisible",{get:function(){return this._isContainerVisible},set:function(n){this._isContainerVisible=n},configurable:!0});Object.defineProperty(Container.prototype,"isBuffered",{get:function(){return this._isBuffered},set:function(n){this._isBuffered=n},configurable:!0});this._id=0;this._rotationOffset=0;this._zoomPercentage=null;this._contentX=0;this._contentY=0;this._viewType=0;this._contentHeight=null;this._contentWidth=null;this._contentOrginalHeight=null;this._contentOrginalWidth=null;this._sequenceNumber=null;this._containerWidth=null;this._containerHeight=null;this._containerX=0;this._containerY=0;this._isContainerVisible=!0;this._isBuffered=!1};ImageInfo=function(){Object.defineProperty(ImageInfo.prototype,"imageMetadata",{get:function(){return this._imageMetadata},set:function(n){this._imageMetadata=n},configurable:!0});Object.defineProperty(ImageInfo.prototype,"nonAvViewInfo",{get:function(){return this._nonAvViewInfo},set:function(n){this._nonAvViewInfo=n},configurable:!0});this._imageMetadata;this._nonAvViewInfo};ImageMetadata=function(){Object.defineProperty(ImageMetadata.prototype,"id",{get:function(){return this._id},set:function(n){this._id=n},configurable:!0});Object.defineProperty(ImageMetadata.prototype,"title",{get:function(){return this._title},set:function(n){this._title=n},configurable:!0});Object.defineProperty(ImageMetadata.prototype,"size",{get:function(){return this._size},set:function(n){this._size=n},configurable:!0});Object.defineProperty(ImageMetadata.prototype,"url",{get:function(){return this._url},set:function(n){this._url=n},configurable:!0});Object.defineProperty(ImageMetadata.prototype,"resolution",{get:function(){return this._resolution},set:function(n){this._resolution=n},configurable:!0});Object.defineProperty(ImageMetadata.prototype,"tenantId",{get:function(){return this._tenantId},set:function(n){this._tenantId=n},configurable:!0});this._id;this._title;this._size;this._url;this._resolution;this._tenantId};ImageInfoCollection=function(){Object.defineProperty(ImageInfo.prototype,"currentImageNumber",{get:function(){return this._currentImageNumber},set:function(n){this._currentImageNumber=n},configurable:!0});Object.defineProperty(ImageInfo.prototype,"imageMetadata",{get:function(){return this._imageMetadata},set:function(n){this._imageMetadata=n},configurable:!0});Object.defineProperty(ImageInfo.prototype,"isSlideShowStarted",{get:function(){return this._isSlideShowStarted},set:function(n){this._isSlideShowStarted=n},configurable:!0});this._currentImageNumber=1;this._imageMetadata=[];this._isSlideShowStarted=!1};MediaSourceInfo=function(){Object.defineProperty(MediaSourceInfo.prototype,"mediaInfo",{get:function(){return this._mediaInfo},set:function(n){this._mediaInfo=n},configurable:!0});Object.defineProperty(MediaSourceInfo.prototype,"autoPlay",{get:function(){return this._autoPlay},set:function(n){this._autoPlay=n},configurable:!0});Object.defineProperty(MediaSourceInfo.prototype,"playerMode",{get:function(){return this._playerMode},set:function(n){this._playerMode=n},configurable:!0})};ErrorMessage=function(){var n=[];return n.PLUGIN_LOAD_ERROR="SWF File Missing or Incorrect Configuration",n.SWF_ACCESS_DENIED="SWF File Inaccessible / Insufficient Permissions",n.SERVER_UNAVAILABLE="Server unavailable",n.GATEWAY_ERROR="Gateway error",n.GATEWAY_TIMEOUT="Gateway timeout",n.SECURITY_ERROR="Possibe reasons for this error: 1. Incorrect Secure Information. Ensure that secure info is correct in CustomDLL xml under webservices configurations folder. 2. Incorrect key.",n.PLUGIN_NOT_FOUND="Plugin missing",n.UNKNOWN_HLS_ERROR="Unknown HLS error",n.MANIFEST_ACCESS_DENIED="'possible violation of crossdomain policy OR M3U8 is not accessible",n.MANIFEST_NOT_FOUND="M3U8 file missing",n.MANIFEST_PARSING_ERROR="M3U8 could not be parsed",n.FRAGMENT_ACCESS_DENIED="possible violation of crossdomain policy or ts is not accessible",n.FRAGMENT_NOT_FOUND="TS files missing",n.FRAGMENT_PARSING_ERROR="Fragment parsing error",n.KEY_ACCESS_DENIED="possible violation of crossdomain policy OR key file is not accessible",n.KEY_NOT_FOUND="Possibe reasons for this error: 1. Key file missing. 2. Incorrect Key 3. No entry in the list of MIME types in the IIS for .ckf.",n.TAGS_ERROR="Media corrupted. Possible missing tags in media",n.MEDIA_NOT_INITIALIZED="Media not initialized",n.IDLE_NETWORK="Network idle",n.PROGRESSIVE_DOWNLOAD_FAILED="Possible reasons: 1. Media file missing. 2. Streaming server is down.",n.PLAYER_LOAD_FAILED="Player Error: Unable to load player object",n.MEDIA_ACCESS_DENIED="Security Error: Cannot load media",n.PLUGIN_ERROR="System is unable to playback the selected content. Please ensure that you have installed and enabled Adobe Flash Player version 16.0.0 or above. For download and instructions, <a class='linkedItem' target='_blank' rel='noopener' href='http://get.adobe.com/flashplayer'>see here<\/a>.",n.MEDIA_ERROR="Media Error: Unable to playback media",n.FRAGMENT_NOT_AVAILABLE="Some parts of the media are missing",n.CONNECTION_ERROR="Connection Error: Unable to load media",n.ITEM_LOAD_FAILED="Connection Error: Item couldn't be loaded",n.BAD_REQUEST="Bad request. HTTP Response: 400",n.ITEM_ACCESS_DENIED="Security Error: Item couldn't be loaded",n.ITEM_UNAUTHORIZED_ERROR="Unauthorized error. HTTP Response: 401",n.ITEM_FORBIDDEN_ERROR="Forbidden error. HTTP Response: 403",n.ITEM_UNAVAILABLE="Item couldn't be found. HTTP Response: 404",n.INTERNAL_SERVER_ERROR="Internal server error. HTTP Response: 500",n.BAD_GATEWAY="Bad gateway error. HTTP Response: 502",n.SERVICE_UNAVAILABLE="Service unavailable. HTTP Response: 503",n.NETWORK_AUTHENTICATION_REQUIRED="Network authentication required. HTTP Response: 511",n.SERVER_SECURITY_ERROR="Security Error: Item couldn't be loaded",n.MEDIA_LOAD_ERROR="Media Error: Item couldn't be loaded",n.DECRYPTION_ERROR="Possible curruption of the SWF file or the decryption key",n.DEBUGER_VERSION_DETECTED="Unsupported flash player detected.  For download and instructions, <a class='linkedItem' target='_blank' rel='noopener'  href='http://get.adobe.com/flashplayer'>see here<\/a>.",n.UNENCRYPTED_FRAGMENT="Content is not secure",n.NON_CONFORMING_MEDIA_DETECTED="Non conforming media detected",n.UNSUPPORTED_MEDIA_TYPE="The media cannot be played because it requires a feature that your browser does not support",n.MEDIA_SOURCE_ERROR="Dash.js fails to allocate a (audio/video/text) SourceBuffer",n.LICENCE_KEY_FAILED="DRM license acquisition failed",n.KEY_MESSAGE_ERROR="Multiple key sessions were creates with a user-agent that does not support sessionIDs",n}();ErrorHashTable={};ErrorHashTable[11201]=[!0,ErrorMessage.PLAYER_LOAD_FAILED,ErrorMessage.PLUGIN_LOAD_ERROR];ErrorHashTable[11202]=[!0,ErrorMessage.PLUGIN_ERROR,ErrorMessage.PLUGIN_NOT_FOUND];ErrorHashTable[11301]=[!0,ErrorMessage.MEDIA_ERROR,ErrorMessage.UNKNOWN_HLS_ERROR];ErrorHashTable[11302]=[!0,ErrorMessage.MEDIA_ACCESS_DENIED,ErrorMessage.MANIFEST_ACCESS_DENIED];ErrorHashTable[11303]=[!0,ErrorMessage.MEDIA_ERROR,ErrorMessage.MANIFEST_NOT_FOUND];ErrorHashTable[11304]=[!0,ErrorMessage.MEDIA_ERROR,ErrorMessage.MANIFEST_PARSING_ERROR];ErrorHashTable[11305]=[!1,ErrorMessage.FRAGMENT_NOT_FOUND,ErrorMessage.FRAGMENT_ACCESS_DENIED];ErrorHashTable[11306]=[!1,ErrorMessage.FRAGMENT_NOT_FOUND,ErrorMessage.FRAGMENT_NOT_FOUND];ErrorHashTable[11307]=[!1,ErrorMessage.FRAGMENT_NOT_FOUND,ErrorMessage.FRAGMENT_PARSING_ERROR];ErrorHashTable[11308]=[!0,ErrorMessage.MEDIA_ACCESS_DENIED,ErrorMessage.KEY_ACCESS_DENIED];ErrorHashTable[11309]=[!0,ErrorMessage.MEDIA_ERROR,ErrorMessage.KEY_NOT_FOUND];ErrorHashTable[11310]=[!0,ErrorMessage.MEDIA_ERROR,ErrorMessage.TAGS_ERROR];ErrorHashTable[11311]=[!1,ErrorMessage.NON_CONFORMING_MEDIA_DETECTED,ErrorMessage.NON_CONFORMING_MEDIA_DETECTED];ErrorHashTable[11312]=[!0,ErrorMessage.MEDIA_ACCESS_DENIED,ErrorMessage.UNENCRYPTED_FRAGMENT];ErrorHashTable[11321]=[!0,ErrorMessage.DEBUGER_VERSION_DETECTED,ErrorMessage.DEBUGER_VERSION_DETECTED];ErrorHashTable[11322]=[!0,ErrorMessage.MEDIA_ACCESS_DENIED,ErrorMessage.SECURITY_ERROR];ErrorHashTable[11401]=[!0,ErrorMessage.MEDIA_ACCESS_DENIED,ErrorMessage.SECURITY_ERROR];ErrorHashTable[12101]=[!0,ErrorMessage.MEDIA_ERROR,ErrorMessage.MEDIA_NOT_INITIALIZED];ErrorHashTable[12102]=[!0,ErrorMessage.CONNECTION_ERROR,ErrorMessage.IDLE_NETWORK];ErrorHashTable[12301]=[!0,ErrorMessage.MEDIA_ERROR,ErrorMessage.PROGRESSIVE_DOWNLOAD_FAILED];ErrorHashTable[13301]=[!0,ErrorMessage.MEDIA_ACCESS_DENIED,ErrorMessage.UNSUPPORTED_MEDIA_TYPE];ErrorHashTable[13302]=[!0,ErrorMessage.MEDIA_ACCESS_DENIED,ErrorMessage.MANIFEST_ACCESS_DENIED];ErrorHashTable[13303]=[!0,ErrorMessage.MEDIA_ERROR,ErrorMessage.MANIFEST_NOT_FOUND];ErrorHashTable[13304]=[!0,ErrorMessage.MEDIA_ERROR,ErrorMessage.MANIFEST_PARSING_ERROR];ErrorHashTable[13305]=[!1,ErrorMessage.FRAGMENT_NOT_FOUND,ErrorMessage.FRAGMENT_PARSING_ERROR];ErrorHashTable[13306]=[!0,ErrorMessage.MEDIA_ERROR,ErrorMessage.LICENCE_KEY_FAILED];ErrorHashTable[13307]=[!0,ErrorMessage.MEDIA_ERROR,ErrorMessage.MEDIA_SOURCE_ERROR];ErrorHashTable[13308]=[!0,ErrorMessage.MEDIA_ERROR,ErrorMessage.KEY_MESSAGE_ERROR];ErrorHashTable[21101]=[!0,ErrorMessage.ITEM_LOAD_FAILED,ErrorMessage.BAD_REQUEST];ErrorHashTable[21102]=[!0,ErrorMessage.CONNECTION_ERROR,ErrorMessage.INTERNAL_SERVER_ERROR];ErrorHashTable[21103]=[!0,ErrorMessage.CONNECTION_ERROR,ErrorMessage.BAD_GATEWAY];ErrorHashTable[21104]=[!0,ErrorMessage.CONNECTION_ERROR,ErrorMessage.SERVICE_UNAVAILABLE];ErrorHashTable[21105]=[!0,ErrorMessage.CONNECTION_ERROR,ErrorMessage.GATEWAY_TIMEOUT];ErrorHashTable[21301]=[!0,ErrorMessage.MEDIA_LOAD_ERROR,ErrorMessage.ITEM_UNAVAILABLE];ErrorHashTable[21401]=[!0,ErrorMessage.ITEM_ACCESS_DENIED,ErrorMessage.ITEM_UNAUTHORIZED_ERROR];ErrorHashTable[21402]=[!0,ErrorMessage.ITEM_ACCESS_DENIED,ErrorMessage.ITEM_FORBIDDEN_ERROR];ErrorHashTable[21403]=[!0,ErrorMessage.SERVER_SECURITY_ERROR,ErrorMessage.NETWORK_AUTHENTICATION_REQUIRED];ErrorHashTable[21404]=[!0,ErrorMessage.MEDIA_LOAD_ERROR,ErrorMessage.DECRYPTION_ERROR];swfobject=function(){function v(){var i,r,n;if(!a){try{i=t.getElementsByTagName("body")[0].appendChild(h("span"));i.parentNode.removeChild(i)}catch(u){return}for(a=!0,r=w.length,n=0;n<r;n++)w[n]()}}function vt(n){a?n():w[w.length]=n}function yt(n){if(typeof r.addEventListener!=i)r.addEventListener("load",n,!1);else if(typeof t.addEventListener!=i)t.addEventListener("load",n,!1);else if(typeof r.attachEvent!=i)ri(r,"onload",n);else if(typeof r.onload=="function"){var u=r.onload;r.onload=function(){u();n()}}else r.onload=n}function dt(){lt?gt():it()}function gt(){var o=t.getElementsByTagName("body")[0],f=h(u),r,e;f.setAttribute("type",p);r=o.appendChild(f);r?(e=0,function(){if(typeof r.GetVariable!=i){var t=r.GetVariable("$version");t&&(t=t.split(" ")[1].split(","),n.pv=[parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10)])}else if(e<10){e++;setTimeout(arguments.callee,10);return}o.removeChild(f);r=null;it()}()):it()}function it(){var y=o.length,r,t,h,l,v;if(y>0)for(r=0;r<y;r++){var u=o[r].id,f=o[r].callbackFn,e={success:!1,id:u};if(n.pv[0]>0){if(t=s(u),t)if(!g(o[r].swfVersion)||n.wk&&n.wk<312)if(o[r].expressInstall&&ut()){h={};h.data=o[r].expressInstall;h.width=t.getAttribute("width")||"0";h.height=t.getAttribute("height")||"0";t.getAttribute("class")&&(h.styleclass=t.getAttribute("class"));t.getAttribute("align")&&(h.align=t.getAttribute("align"));var p={},a=t.getElementsByTagName("param"),w=a.length;for(l=0;l<w;l++)a[l].getAttribute("name").toLowerCase()!="movie"&&(p[a[l].getAttribute("name")]=a[l].getAttribute("value"));ft(h,p,u,f)}else ni(t),f&&f(e);else c(u,!0),f&&(e.success=!0,e.ref=rt(u),f(e))}else c(u,!0),f&&(v=rt(u),v&&typeof v.SetVariable!=i&&(e.success=!0,e.ref=v),f(e))}}function rt(n){var r=null,t=s(n),f;return t&&t.nodeName=="OBJECT"&&(typeof t.SetVariable!=i?r=t:(f=t.getElementsByTagName(u)[0],f&&(r=f))),r}function ut(){return!d&&g("6.0.65")&&(n.win||n.mac)&&!(n.wk&&n.wk<312)}function ft(r,u,f,e){var o,a,c,l;d=!0;nt=e||null;at={success:!1,id:f};o=s(f);o&&(o.nodeName=="OBJECT"?(y=et(o),k=null):(y=o,k=f),r.id=ht,(typeof r.width==i||!/%$/.test(r.width)&&parseInt(r.width,10)<310)&&(r.width="310"),(typeof r.height==i||!/%$/.test(r.height)&&parseInt(r.height,10)<137)&&(r.height="137"),t.title=t.title.slice(0,47)+" - Flash Player Installation",a=n.ie&&n.win?"ActiveX":"PlugIn",c="MMredirectURL="+encodeURI(window.location).toString().replace(/&/g,"%26")+"&MMplayerType="+a+"&MMdoctitle="+t.title,typeof u.flashvars!=i?u.flashvars+="&"+c:u.flashvars=c,n.ie&&n.win&&o.readyState!=4&&(l=h("div"),f+="SWFObjectNew",l.setAttribute("id",f),o.parentNode.insertBefore(l,o),o.style.display="none",function(){o.readyState==4?o.parentNode.removeChild(o):setTimeout(arguments.callee,10)}()),ot(r,u,f))}function ni(t){if(n.ie&&n.win&&t.readyState!=4){var i=h("div");t.parentNode.insertBefore(i,t);i.parentNode.replaceChild(et(t),i);t.style.display="none",function(){t.readyState==4?t.parentNode.removeChild(t):setTimeout(arguments.callee,10)}()}else t.parentNode.replaceChild(et(t),t)}function et(t){var f=h("div"),e,i,o,r;if(n.win&&n.ie)f.innerHTML=t.innerHTML;else if(e=t.getElementsByTagName(u)[0],e&&(i=e.childNodes,i))for(o=i.length,r=0;r<o;r++)i[r].nodeType==1&&i[r].nodeName=="PARAM"||i[r].nodeType==8||f.appendChild(i[r].cloneNode(!0));return f}function ot(t,r,f){var v,y=s(f),w,e,k,a,c,o,l;if(n.wk&&n.wk<312)return v;if(y)if(typeof t.id==i&&(t.id=f),n.ie&&n.win){w="";for(e in t)t[e]!=Object.prototype[e]&&(e.toLowerCase()=="data"?r.movie=t[e]:e.toLowerCase()=="styleclass"?w+=' class="'+t[e]+'"':e.toLowerCase()!="classid"&&(w+=" "+e+'="'+t[e]+'"'));k="";for(a in r)r[a]!=Object.prototype[a]&&(k+='<param name="'+a+'" value="'+r[a]+'" />');y.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+w+">"+k+"<\/object>";b[b.length]=t.id;v=s(t.id)}else{c=h(u);c.setAttribute("type",p);for(o in t)t[o]!=Object.prototype[o]&&(o.toLowerCase()=="styleclass"?c.setAttribute("class",t[o]):o.toLowerCase()!="classid"&&c.setAttribute(o,t[o]));for(l in r)r[l]!=Object.prototype[l]&&l.toLowerCase()!="movie"&&ti(c,l,r[l]);y.parentNode.replaceChild(c,y);v=c}return v}function ti(n,t,i){var r=h("param");r.setAttribute("name",t);r.setAttribute("value",i);n.appendChild(r)}function pt(t){var i=s(t);i&&i.nodeName=="OBJECT"&&(n.ie&&n.win?(i.style.display="none",function(){i.readyState==4?ii(t):setTimeout(arguments.callee,10)}()):i.parentNode.removeChild(i))}function ii(n){var t=s(n),i;if(t){for(i in t)typeof t[i]=="function"&&(t[i]=null);t.parentNode.removeChild(t)}}function s(n){var i=null;try{i=t.getElementById(n)}catch(r){}return i}function h(n){return t.createElement(n)}function ri(n,t,i){n.attachEvent(t,i);l[l.length]=[n,t,i]}function g(t){var r=n.pv,i=t.split(".");return i[0]=parseInt(i[0],10),i[1]=parseInt(i[1],10)||0,i[2]=parseInt(i[2],10)||0,r[0]>i[0]||r[0]==i[0]&&r[1]>i[1]||r[0]==i[0]&&r[1]==i[1]&&r[2]>=i[2]?!0:!1}function ui(r,e,o,s){var a,c,l;n.ie&&n.mac||(a=t.getElementsByTagName("head")[0],a)&&(c=o&&typeof o=="string"?o:"screen",s&&(f=null,tt=null),f&&tt==c||(l=h("style"),l.setAttribute("type","text/css"),l.setAttribute("media",c),f=a.appendChild(l),n.ie&&n.win&&typeof t.styleSheets!=i&&t.styleSheets.length>0&&(f=t.styleSheets[t.styleSheets.length-1]),tt=c),n.ie&&n.win?f&&typeof f.addRule==u&&f.addRule(r,e):f&&typeof t.createTextNode!=i&&f.appendChild(t.createTextNode(r+" {"+e+"}")))}function c(){}function wt(n){var t=/[\\\"<>\.;]/.exec(n)!=null;return t&&typeof encodeURIComponent!=i?encodeURIComponent(n):n}var i="undefined",u="object",st="Shockwave Flash",bt="ShockwaveFlash.ShockwaveFlash",p="application/x-shockwave-flash",ht="SWFObjectExprInst",ct="onreadystatechange",r=window,t=document,e=navigator,lt=!1,w=[dt],o=[],b=[],l=[],y,k,nt,at,a=!1,d=!1,f,tt,kt=!0,n=function(){var l=typeof t.getElementById!=i&&typeof t.getElementsByTagName!=i&&typeof t.createElement!=i,o=e.userAgent.toLowerCase(),s=e.platform.toLowerCase(),a=s?/win/.test(s):/win/.test(o),v=s?/mac/.test(s):/mac/.test(o),y=/webkit/.test(o)?parseFloat(o.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,h=!+"\v1",f=[0,0,0],n=null,c;if(typeof e.plugins!=i&&typeof e.plugins[st]==u)n=e.plugins[st].description,!n||typeof e.mimeTypes!=i&&e.mimeTypes[p]&&!e.mimeTypes[p].enabledPlugin||(lt=!0,h=!1,n=n.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),f[0]=parseInt(n.replace(/^(.*)\..*$/,"$1"),10),f[1]=parseInt(n.replace(/^.*\.(.*)\s.*$/,"$1"),10),f[2]=/[a-zA-Z]/.test(n)?parseInt(n.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof r.ActiveXObject!=i)try{c=new ActiveXObject(bt);c&&(n=c.GetVariable("$version"),n&&(h=!0,n=n.split(" ")[1].split(","),f=[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)]))}catch(w){}return{w3:l,pv:f,wk:y,ie:h,win:a,mac:v}}(),fi=function(){n.w3&&((typeof t.readyState!=i&&t.readyState=="complete"||typeof t.readyState==i&&(t.getElementsByTagName("body")[0]||t.body))&&v(),a||(typeof t.addEventListener!=i&&t.addEventListener("DOMContentLoaded",v,!1),n.ie&&n.win&&(t.attachEvent(ct,function(){t.readyState=="complete"&&(t.detachEvent(ct,arguments.callee),v())}),r==top&&function(){if(!a){try{t.documentElement.doScroll("left")}catch(n){setTimeout(arguments.callee,0);return}v()}}()),n.wk&&function(){if(!a){if(!/loaded|complete/.test(t.readyState)){setTimeout(arguments.callee,0);return}v()}}(),yt(v)))}(),ei=function(){n.ie&&n.win&&window.attachEvent("onunload",function(){for(var r,i,u,f,e=l.length,t=0;t<e;t++)l[t][0].detachEvent(l[t][1],l[t][2]);for(r=b.length,i=0;i<r;i++)pt(b[i]);for(u in n)n[u]=null;n=null;for(f in swfobject)swfobject[f]=null;swfobject=null})}();return{registerObject:function(t,i,r,u){if(n.w3&&t&&i){var f={};f.id=t;f.swfVersion=i;f.expressInstall=r;f.callbackFn=u;o[o.length]=f;c(t,!1)}else u&&u({success:!1,id:t})},getObjectById:function(t){if(n.w3)return rt(t)},embedSWF:function(t,r,f,e,o,s,h,l,a,v){var y={success:!1,id:r};n.w3&&!(n.wk&&n.wk<312)&&t&&r&&f&&e&&o?(c(r,!1),vt(function(){var n,b,p,k,w,d;if(f+="",e+="",n={},a&&typeof a===u)for(b in a)n[b]=a[b];if(n.data=t,n.width=f,n.height=e,p={},l&&typeof l===u)for(k in l)p[k]=l[k];if(h&&typeof h===u)for(w in h)typeof p.flashvars!=i?p.flashvars+="&"+w+"="+h[w]:p.flashvars=w+"="+h[w];if(g(o))d=ot(n,p,r),n.id==r&&c(r,!0),y.success=!0,y.ref=d;else{if(s&&ut()){n.data=s;ft(n,p,r,v);return}c(r,!0)}v&&v(y)})):v&&v(y)},switchOffAutoHideShow:function(){kt=!1},ua:n,getFlashPlayerVersion:function(){return{major:n.pv[0],minor:n.pv[1],release:n.pv[2]}},hasFlashPlayerVersion:g,createSWF:function(t,i,r){return n.w3?ot(t,i,r):undefined},showExpressInstall:function(t,i,r,u){n.w3&&ut()&&ft(t,i,r,u)},removeSWF:function(t){n.w3&&pt(t)},createCSS:function(t,i,r,u){n.w3&&ui(t,i,r,u)},addDomLoadEvent:vt,addLoadEvent:yt,getQueryParamValue:function(n){var r=t.location.search||t.location.hash,u,i;if(r){if(/\?/.test(r)&&(r=r.split("?")[1]),n==null)return wt(r);for(u=r.split("&"),i=0;i<u.length;i++)if(u[i].substring(0,u[i].indexOf("="))==n)return wt(u[i].substring(u[i].indexOf("=")+1))}return""},expressInstallCallback:function(){if(d){var t=s(ht);t&&y&&(t.parentNode.replaceChild(y,t),k&&(c(k,!0),n.ie&&n.win&&(y.style.display="block")),nt&&nt(at));d=!1}}}}();PreferenceSetting=function(){return{rememberViewerSettings:!1,viewerSettings:{playerPreferencesSettings:{nonAvViewer:{images:{zoomLevel:""},documents:{zoomLevel:""}},avViewer:{common:{volumeLevel:"",isPinned:!1,takeOrTotal:""}}}}}}